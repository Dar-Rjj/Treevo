```python
import pandas as pd

def heuristics_v2(df):
    # Compute the difference between today's close and yesterday's close, then multiply by today's volume
    df['close_diff_vol'] = (df['close'] - df['close'].shift(1)) * df['volume']
    
    # Compute the average of the last 3 days' closing prices and multiply by today's volume
    df['avg_close_vol'] = df['close'].rolling(window=3).mean() * df['volume']
    
    # Calculate the range (High - Low) and divide by the previous day's Close
    df['range_over_prev_close'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Calculate the ratio of today's range (High - Low) to the 5-day moving average of the range
    df['range_ratio'] = (df['high'] - df['low']) / (df['high'] - df['low']).rolling(window=5).mean()
    
    # Determine if the open is higher or lower than the previous day's close and assign a value (+1 or -1)
    df['open_vs_close'] = (df['open'] > df['close'].shift(1)).astype(int) * 2 - 1
    
    # Calculate the difference between today's open and the previous day's close
    df['open_diff_close'] = df['open'] - df['close'].shift(1)
    
    # Calculate the rolling sum of the last 5 days' open-to-close differences
    df['open_diff_close_sum'] = df['open_diff_close'].rolling(window=5).sum()
    
    # Calculate the ratio of the current day's amount to the moving average of the past 5 days' amounts
    df['amount_ratio'] = df['amount'] / df['amount'].rolling(window=5).mean()
    
    # Compute the difference between the current day's amount and the previous day's amount
    df['amount_diff'] = df['amount'] - df['amount'].shift(1)
    
    # Calculate the rolling sum of the last 5 days' amount differences
    df['amount_diff_sum'] = df['amount_diff'].rolling(window=5).sum()
    
    # Compute the sum of the last 5 days' closing price differences
    df['close_diff_sum'] = (df['close'] - df['close'].shift(1)).rolling(window=5).sum()
    
    # Calculate the rolling standard deviation of the last 5 days' closing prices
    df['close_std_5d'] = df['close'].rolling(window=5).std()
    
    # Calculate the rolling mean of the last 5 days' closing prices
    df['close_mean_5d'] = df['close'].rolling(window=5).mean()
    
    # Calculate the ratio of today's high minus today's low to today's volume
    df['hl_range_vol'] = (df['high'] - df['low']) / df['volume']
    
    # Calculate the ratio of today's high minus today's low to the 5-day moving average of volume
    df['hl_range_vol_avg'] = (df['high'] - df['low']) / df['volume'].rolling(window=5).mean()
    
    # Combine all factors into a single factor
    factor_values = (
        df['close_diff_vol'] + 
        df['avg_close_vol'] + 
        df['range_over_prev_close'] + 
        df['range_ratio'] + 
        df['open_vs_close'] + 
        df['open_diff_close_sum'] + 
        df['amount_ratio'] + 
        df['amount_diff_sum'] + 
        df['close_diff_sum'] + 
        df['close_std_5d'] + 
        df['close_mean_5d'] + 
        df['hl_range_vol'] + 
        df['hl_range_vol_avg']
    )
    
    return factor_values
```
