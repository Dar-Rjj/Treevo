```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Averaged Momentum
    df['1d_return'] = df['close'].pct_change()
    df['5d_return'] = df['close'].pct_change(5)
    df['20d_return'] = df['close'].pct_change(20)
    df['avg_momentum'] = (df['1d_return'] + df['5d_return'] + df['20d_return']) / 3

    # Weighted Average of Price Gaps
    df['price_gap'] = abs(df['open'] - df['close'])
    
    # Calculate Volume Trend
    df['5d_vol_avg'] = df['volume'].rolling(window=5).mean()
    df['vol_growth'] = df['volume'] / df['volume'].shift(1)
    df['vol_trend'] = df['5d_vol_avg'] * df['vol_growth']
    
    # Weight the Price Gaps
    df['weighted_price_gap'] = df['price_gap'] * df['vol_trend']

    # Adjust for Volume
    df['vol_pct_change'] = df['volume'].pct_change()
    df['adj_weighted_price_gap'] = df['weighted_price_gap'] * df['vol_pct_change']

    # High-to-Low Range and Momentum
    df['high_low_range'] = df['high'] - df['low']
    df['combined_value'] = (df['high_low_range'] * 100) + df['adj_weighted_price_gap']
    df['sma_5_combined'] = df['combined_value'].rolling(window=5).mean()
    df['momentum_high_low'] = df['sma_5_combined'] - df['sma_5_combined'].shift(5)

    # Calculate Rolling High-Low Differential
    df['20d_high'] = df['high'].rolling(window=20).max()
    df['20d_low'] = df['low'].rolling(window=20).min()
    df['rolling_high_low_diff'] = df['20d_high'] - df['20d_low']

    # Weight by Volume Volatility
    df['vol_volatility'] = df['volume'].rolling(window=10).std()
    df['weighted_high_low_diff'] = df['rolling_high_low_diff'] * df['vol_volatility']

    # Aggregate the Signals
    df['signal'] = df['weighted_high_low_diff'] - df['adj_weighted_price_gap']

    # Generate Alpha Factor
    df['alpha_factor'] = (df['adj_weighted_price_gap'] +
                          df['momentum_high_low'] +
                          df['weighted_high_low_diff'] -
                          df['avg_momentum'])

    return df['alpha_factor']
```
