```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 1-day, 5-day, and 20-day price returns
    df['1d_return'] = (df['close'] / df['close'].shift(1)) - 1
    df['5d_return'] = (df['close'] / df['close'].shift(5)) - 1
    df['20d_return'] = (df['close'] / df['close'].shift(20)) - 1

    # Apply EMA on Price Returns with alpha = 0.2
    df['ema_momentum'] = df[['1d_return', '5d_return', '20d_return']].apply(lambda x: (x * [0.7, 0.2, 0.1]).sum(), axis=1).ewm(alpha=0.2).mean()

    # Calculate Price Gap Between Open and Close
    df['price_gap'] = (df['close'] - df['open']).abs()

    # Calculate Volume Trend
    df['volume_5d_ma'] = df['volume'].rolling(window=5).mean()
    df['volume_growth'] = df['volume'] / df['volume'].shift(1)
    df['volume_trend'] = df['volume_5d_ma'] * df['volume_growth']

    # Weight the Price Gaps
    df['weighted_price_gaps'] = df['price_gap'] * df['volume_trend']

    # Adjust for Volume
    df['volume_pct_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['adjusted_weighted_price_gaps'] = df['weighted_price_gaps'] * df['volume_pct_change']

    # Adaptive High-to-Low Range and Momentum
    df['high_low_range'] = df['high'] - df['low']
    df['combined_value'] = df['high_low_range'] * 100 + df['adjusted_weighted_price_gaps']
    df['smoothed_combined_value'] = df['combined_value'].ewm(span=10).mean()
    df['momentum'] = df['smoothed_combined_value'] - df['smoothed_combined_value'].shift(10)

    # Calculate Rolling High-Low Differential
    df['rolling_high'] = df['high'].rolling(window=10).max()
    df['rolling_low'] = df['low'].rolling(window=10).min()
    df['rolling_high_low_diff'] = df['rolling_high'] - df['rolling_low']

    # Weight by Volume Volatility
    df['volume_volatility'] = df['volume'].rolling(window=20).std()
    df['weighted_high_low_diff'] = df['rolling_high_low_diff'] * df['volume_volatility']

    # Aggregate the Signals
    df['signal'] = df['weighted_high_low_diff'] - df['adjusted_weighted_price_gaps']

    # Generate Alpha Factor
    df['alpha_factor'] = (df['adjusted_weighted_price_gaps'] + 
                          df['momentum'] + 
                          df['weighted_high_low_diff'] - 
                          df['ema_momentum'])

    return df['alpha_factor']
```
