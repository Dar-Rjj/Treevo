```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Price Range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate Volume Trend
    df['volume_5d_ma'] = df['volume'].rolling(window=5).mean()
    df['volume_growth'] = df['volume'] / df['volume'].shift(1)
    df['volume_trend'] = df['volume_5d_ma'] * df['volume_growth']
    
    # Filter by Relative Volume
    n = 30  # Define the period for average volume
    df['avg_volume'] = df['volume'].rolling(window=n).mean()
    df_filtered = df[df['volume'] > df['avg_volume']]
    
    # Calculate Adjusted Price Difference
    df_filtered['adj_price_diff'] = (df_filtered['close'] - df_filtered['close'].shift(10)) * np.log(df_filtered['close'] / df_filtered['close'].shift(1))
    
    # Calculate Rolling High-Low Differential
    df_filtered['rolling_high'] = df_filtered['high'].rolling(window=20).max()
    df_filtered['rolling_low'] = df_filtered['low'].rolling(window=20).min()
    df_filtered['high_low_diff'] = df_filtered['rolling_high'] - df_filtered['rolling_low']
    
    # Weight by Volume Volatility
    df_filtered['vol_volatility'] = df_filtered['volume'].rolling(window=10).std()
    df_filtered['weighted_high_low_diff'] = df_filtered['high_low_diff'] * df_filtered['vol_volatility']
    
    # Calculate Weighted Average of Price Gaps
    df_filtered['price_gap'] = df_filtered['high'] - df_filtered['low']
    df_filtered['weighted_price_gap'] = df_filtered['price_gap'] * df_filtered['volume_trend']
    df_filtered['sum_weighted_price_gap'] = df_filtered['weighted_price_gap'].rolling(window=5).sum()
    
    # Combine High-to-Low Range with Weighted Price Gaps
    df_filtered['combined_value'] = (df_filtered['high_low_diff'] * 100) + df_filtered['sum_weighted_price_gap']
    
    # Smoothing and Momentum Calculation
    df_filtered['sma_combined'] = df_filtered['combined_value'].rolling(window=5).mean()
    df_filtered['momentum'] = df_filtered['sma_combined'] - df_filtered['sma_combined'].shift(5)
    
    # Calculate Multi-Day Price Momentum
    df_filtered['1d_return'] = (df_filtered['close'] - df_filtered['close'].shift(1)) / df_filtered['close'].shift(1)
    df_filtered['5d_return'] = (df_filtered['close'] - df_filtered['close'].shift(5)) / df_filtered['close'].shift(5)
    df_filtered['20d_return'] = (df_filtered['close'] - df_filtered['close'].shift(20)) / df_filtered['close'].shift(20)
    
    # Average the Momentum
    df_filtered['avg_momentum'] = (df_filtered['1d_return'] + df_filtered['5d_return'] + df_filtered['20d_return']) / 3
    
    # Adjust for Volume Changes
    df_filtered['volume_change'] = (df_filtered['volume'] - df_filtered['volume'].shift(1)) / df_filtered['volume'].shift(1)
    df_filtered['final_volume_adjustment'] = df_filtered['avg_momentum'] * (1 + df_filtered['volume_change'])
    
    # Intermediate Factor Combination
    df_filtered['intermediate_factor'] = df_filtered['momentum'] + df_filtered['final_volume_adjustment']
    
    # Calculate Volume Adjusted Momentum
    df_filtered['volume_adj_momentum'] = (df_filtered['volume'] - df_filtered['volume'].shift(1)) * (df_filtered['close'] - df_filtered['close'].rolling(window=10).mean())
    
    # Aggregate Price and Volume Signals
    df_filtered['aggregated_signal'] = (
        df_filtered['weighted_high_low_diff'] - 
        df_filtered['adj_price_diff'] + 
        df_filtered['volume_adj_momentum'] + 
        df_filtered['sum_weighted_price_gap']
    )
    
    # Generate Alpha Factor
    df_filtered['alpha_factor'] = (
        df_filtered['aggregated_signal'] + 
        df_filtered['sum_weighted_price_gap'] + 
        df_filtered['combined_value'] + 
        df_filtered['intermediate_factor']
    ) / df_filtered['volume']
    
    return df_filtered['alpha_factor']
```
