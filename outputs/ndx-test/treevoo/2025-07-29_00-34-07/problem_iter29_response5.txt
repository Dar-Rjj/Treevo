```python
def heuristics_v2(df):
    # Calculate individual components
    price_change = df['close'] - df['open']
    price_range = df['high'] - df['low']
    upper_shadow = df['high'] - df[['open', 'close']].max(axis=1)
    lower_shadow = df[['open', 'close']].min(axis=1) - df['low']
    volume_ratio_day = df['volume'] / df['volume'].shift(1)
    volume_ratio_avg5 = df['volume'] / df['volume'].rolling(window=5).mean()
    amount_volume_ratio = df['amount'] / df['volume']
    amount_ratio_day = df['amount'] / df['amount'].shift(1)
    close_ratio_day = df['close'] / df['close'].shift(1)
    close_ratio_avg5 = df['close'] / df['close'].rolling(window=5).mean()
    volume_consistency = df['volume'].rolling(window=5).std() / df['volume'].rolling(window=5).mean()
    amount_ratio_avg5 = df['amount'] / df['amount'].rolling(window=5).mean()
    
    # Combine components to create composite alpha factor
    alpha_factor = (price_change + 
                    price_range + 
                    volume_ratio_day + 
                    (price_range * volume_ratio_avg5 * amount_volume_ratio))
    
    return alpha_factor
```
