```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    df['1d_Price_Return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['5d_Price_Return'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    df['20d_Price_Return'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)

    # Weights for Weighted Average Momentum
    short_term_weight = 0.4
    medium_term_weight = 0.3
    long_term_weight = 0.3

    # Calculate Weighted Average Momentum
    df['Weighted_Avg_Momentum'] = (short_term_weight * df['1d_Price_Return'] +
                                   medium_term_weight * df['5d_Price_Return'] +
                                   long_term_weight * df['20d_Price_Return'])

    # Adjust for Volume
    df['Daily_Volume_Change'] = df['volume'] - df['volume'].shift(1)

    # Integrate Transaction Amount
    df['Daily_Amount_Change'] = df['amount'] - df['amount'].shift(1)

    # Final Factor
    df['Final_Factor'] = df['Weighted_Avg_Momentum'] * \
                         (1 + (df['Daily_Volume_Change'] + df['Daily_Amount_Change']) / df['volume'].shift(1))

    return df['Final_Factor']
```
