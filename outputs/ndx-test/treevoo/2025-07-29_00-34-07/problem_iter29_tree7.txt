```txt
Calculate High-to-Low Range
├── Use High price
└── Use Low price

Calculate Price Gap and Volume-Weighted Gaps
├── Calculate Price Gap Between Open and Close
│   └── Subtract Close price from Open price
├── Calculate Current Day Volume Growth
│   └── Divide Current Day's Volume by Previous Day's Volume
└── Weight the Price Gaps
    └── Multiply Each Price Gap by Corresponding Volume Growth, then Sum

Combine High-to-Low Range with Volume-Weighted Gaps
├── Multiply High-to-Low Range by 150
└── Add to Volume-Weighted Gaps

Smoothing and Initial Momentum Calculation
├── Apply Exponential Moving Average on Combined Value over 7 days
└── Calculate the difference between day t and day t-7

Calculate Multi-Day Price Momentum
├── 4-day Price Return: (Close price (t) - Close price (t-4)) / Close price (t-4)
├── 8-day Price Return: (Close price (t) - Close price (t-8)) / Close price (t-8)
└── 20-day Price Return: (Close price (t) - Close price (t-20)) / Close price (t-20)

Average the Momentum
└── (4-day Price Return + 8-day Price Return + 20-day Price Return) / 3

Adjust for Volume Changes
├── Daily Volume Percentage Change: (Volume (t) - Volume (t-1)) / Volume (t-1)
└── Final Volume Adjustment: Average Momentum * (1 + 3 * Daily Volume Percentage Change)

Intermediate Factor Combination
├── Sum Smoothing and Initial Momentum
└── Sum Averaged and Volume-Adjusted Price Momentum

Calculate 20-day Rolling High-Low Differential
├── Determine 20-day Rolling High
│   └── Use High price
└── Subtract 20-day Rolling Low
    └── Use Low price

Weight by Volume Volatility
├── Calculate Volume Volatility
│   ├── Use Volume on days t-1 to t-15
│   └── Calculate standard deviation
└── Multiply 20-day Rolling High-Low Differential by Volume Volatility

Aggregate the Signals
├── Add Weighted 20-day Rolling High-Low Differential
└── Subtract Price Difference

Adjust for Volume
├── Calculate Daily Volume Percentage Change
│   ├── Use Volume (t)
│   └── Use Volume (t-1)
└── Multiply Aggregated Signal by Volume Percentage Change

Calculate Volume-Weighted Close-to-Open Return
├── Use Open price
└── Use Close price
    └── Multiply by Volume
        └── Sum over the lookback period

Combine Cumulative High-Low Momentum and Volume-Weighted Close-to-Open Return
├── Use Cumulative High-Low Momentum
├── Use Volume-Weighted Close-to-Open Return
└── Generate Alpha Factor

Calculate Price Momentum
├── Compute 1-day Price Return
│   └── Calculate Close price (t) divided by Close price (t-1) minus 1
├── Compute 7-day Price Return
│   └── Calculate Close price (t) divided by Close price (t-7) minus 1
└── Compute 35-day Price Return
    └── Calculate Close price (t) divided by Close price (t-35) minus 1

Average the Price Momentum
└── Average 1-day, 7-day, and 35-day Price Returns

Final Factor Construction
├── Sum Intermediate Factor Combination
├── Add Volume-Adjusted Momentum
├── Add Weighted Price Momentum
└── Add Alpha Factor from Cumulative High-Low Momentum and Volume-Weighted Close-to-Open Return
```
