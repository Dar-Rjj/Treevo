```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Typical Price
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    
    # Weight by Volume to get Volume Adjusted Price (VAP)
    vap = typical_price * df['volume']
    
    # Calculate 20-day EMA of VAP
    ema_20 = vap.ewm(span=20).mean()
    
    # Volume Adjusted Momentum: current VAP - 20-day EMA
    momentum = vap - ema_20
    
    # Daily Returns
    daily_returns = (df['close'].diff() / df['close'].shift())
    
    # 10-day Standard Deviation of daily returns
    std_10 = daily_returns.rolling(window=10).std()
    
    # Inverse Volatility Adjustment
    adjusted_momentum = momentum * (1 / std_10)
    
    # High-Low Range
    high_low_range = df['high'] - df['low']
    
    # 20-Day Moving Standard Deviation of High-Low Ranges
    high_low_volatility = high_low_range.rolling(window=20).std()
    
    # Open-Close Range
    open_close_range = abs(df['open'] - df['close'])
    
    # 20-Day Moving Standard Deviation of Open-Close Ranges
    open_close_volatility = open_close_range.rolling(window=20).std()
    
    # Composite Range Volatility
    composite_volatility = (high_low_volatility + open_close_volatility) / 2
    
    # Combine Adjusted Momentum and Composite Range Volatility
    factor = adjusted_momentum - composite_volatility
    
    return factor
```
