```python
def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = df['close'].pct_change()

    # Calculate the difference between high and low price
    df['high_low_diff'] = df['high'] - df['low']

    # Calculate the difference between close and open price
    df['close_open_diff'] = df['close'] - df['open']

    # Calculate a weighted moving average of the daily return with the volume as weight
    df['wma_daily_return'] = (df['daily_return'] * df['volume']).rolling(window=5).mean() / df['volume'].rolling(window=5).mean()

    # Calculate a momentum factor based on the 10-day and 30-day close price
    df['momentum_10d'] = df['close'] / df['close'].shift(10) - 1
    df['momentum_30d'] = df['close'] / df['close'].shift(30) - 1
    df['momentum_factor'] = df['momentum_10d'] - df['momentum_30d']

    # Combine all the factors to create the final alpha factor
    df['alpha_factor'] = (
        df['wma_daily_return'] 
        + (df['high_low_diff'] / df['close']) 
        + (df['close_open_diff'] / df['close']) 
        + df['momentum_factor']
    )

    return df['alpha_factor']
```
