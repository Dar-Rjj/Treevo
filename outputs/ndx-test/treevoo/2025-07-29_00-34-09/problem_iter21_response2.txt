```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 10-day simple moving average (SMA) of the close price
    df['10_day_SMA'] = df['close'].rolling(window=10).mean()
    
    # Momentum factor: difference between the current close price and the 10-day SMA
    df['momentum'] = df['close'] - df['10_day_SMA']
    
    # Define high-activity days as those where the volume is above its 30-day SMA
    df['30_day_vol_SMA'] = df['volume'].rolling(window=30).mean()
    df['high_activity'] = df['volume'] > df['30_day_vol_SMA']
    
    # On high-activity days, calculate the percentage change in the closing price from the previous day
    df['prev_close'] = df['close'].shift(1)
    df['price_change_pct'] = (df['close'] - df['prev_close']) / df['prev_close']
    
    # Adjust the momentum score based on the percentage change
    df['momentum_adj'] = df['momentum'] + df['high_activity'] * df['price_change_pct']
    
    # Calculate the daily price range (high - low)
    df['daily_range'] = df['high'] - df['low']
    
    # Midpoint of the daily range
    df['midpoint'] = (df['high'] + df['low']) / 2
    
    # Directional bias indicator: bullish if close is above midpoint, bearish otherwise
    df['directional_bias'] = (df['close'] > df['midpoint']).astype(int) * 2 - 1
    
    # Composite sentiment-adjusted momentum signal
    df['composite_momentum'] = df['momentum_adj'] * df['directional_bias']
    
    # Calculate the average true range (ATR) over the last 10 days
    df['tr'] = df[['high', 'close']].max(axis=1) - df[['low', 'close']].min(axis=1)
    df['atr_10'] = df['tr'].rolling(window=10).mean()
    
    # Adjust the composite sentiment-adjusted momentum score by ATR
    df['enhanced_momentum'] = df['composite_momentum'] * df['atr_10']
    
    # Incorporate a trend-following element using the 50-day and 200-day SMAs
    df['50_day_SMA'] = df['close'].rolling(window=50).mean()
    df['200_day_SMA'] = df['close'].rolling(window=200).mean()
    
    # Long-term trend factor
    df['long_term_trend'] = df['50_day_SMA'] - df['200_day_SMA']
    
    # Adjust the final momentum score based on the long-term trend direction
    df['final_momentum'] = df['enhanced_momentum'] * (df['long_term_trend'] > 0).astype(int) * 2 - 1
    
    return df['final_momentum'].dropna()

# Example usage:
# df = pd.read_csv('your_stock_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
```
