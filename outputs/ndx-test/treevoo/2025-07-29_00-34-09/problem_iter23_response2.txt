```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the average of (open, high, low, close) prices
    df['avg_price'] = (df['open'] + df['high'] + df['low'] + df['close']) / 4
    
    # Calculate the price range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate the momentum factor using the average price
    df['momentum'] = df['avg_price'].pct_change()
    
    # Calculate the volatility factor using the standard deviation of the price range
    df['volatility'] = df['price_range'].rolling(window=20).std()
    
    # Create a factor that combines momentum and volatility
    df['factor'] = (df['momentum'] / df['volatility']).shift(1)
    
    return df['factor']

# Example usage:
# df = pd.DataFrame({
#     'open': [...],
#     'high': [...],
#     'low': [...],
#     'close': [...],
#     'volume': [...]
# }, index=pd.DatetimeIndex([...]))
# factor = heuristics_v2(df)
# print(factor)
```
