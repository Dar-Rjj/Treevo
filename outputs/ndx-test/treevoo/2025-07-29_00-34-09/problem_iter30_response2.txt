```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the rate of change in closing prices over different time windows
    df['ROC_5'] = (df['close'] / df['close'].shift(5)) - 1
    df['ROC_20'] = (df['close'] / df['close'].shift(20)) - 1
    df['ROC_60'] = (df['close'] / df['close'].shift(60)) - 1

    # Analyze price movement relative to the highest and lowest prices within a given period
    high_14 = df['high'].rolling(window=14).max()
    low_14 = df['low'].rolling(window=14).min()
    df['Williams_R_14'] = (high_14 - df['close']) / (high_14 - low_14) * -100
    df['Stochastic_Osc_14'] = (df['close'] - low_14) / (high_14 - low_14) * 100

    # Measure the volatility based on the standard deviation of price changes
    df['Volatility_30'] = df['close'].rolling(window=30).std()
    df['Volatility_60'] = df['close'].rolling(window=60).std()

    # Evaluate trading activity and liquidity by analyzing volume
    df['Avg_Volume_10'] = df['volume'].rolling(window=10).mean()
    df['Avg_Volume_20'] = df['volume'].rolling(window=20).mean()
    df['VRS'] = df['Avg_Volume_10'] / df['Avg_Volume_20']
    max_volume_20 = df['volume'].rolling(window=20).max()
    df['VBI'] = (df['volume'] - max_volume_20) / max_volume_20
    df['VBI'] = df['VBI'].apply(lambda x: x if x > 0 else 0)

    # Identify breakouts and consolidation patterns
    min_low_20 = df['low'].rolling(window=20).min()
    max_high_20 = df['high'].rolling(window=20).max()
    df['PBI'] = (df['close'] - min_low_20) / min_low_20 * 100
    df['PBI'] = df['PBI'].where(df['close'] > max_high_20, 0)
    df['PCI'] = (max_high_20 - min_low_20) / df['close']

    # Examine the relationship between open and close prices
    df['OCR'] = df['close'] / df['open']
    positive_ocr = (df['OCR'] > 1).rolling(window=20).sum()
    negative_ocr = (df['OCR'] < 1).rolling(window=20).sum()
    df['Positive_OCR_Count'] = positive_ocr
    df['Negative_OCR_Count'] = negative_ocr

    # Combine all factors into a single factor
    factor = (df['ROC_5'] + df['ROC_20'] + df['ROC_60'] +
              df['Williams_R_14'] + df['Stochastic_Osc_14'] +
              df['Volatility_30'] + df['Volatility_60'] +
              df['VRS'] + df['VBI'] + df['PBI'] + df['PCI'] +
              df['Positive_OCR_Count'] - df['Negative_OCR_Count'])

    return factor
```
