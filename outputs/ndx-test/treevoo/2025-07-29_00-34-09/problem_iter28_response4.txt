```python
import pandas as pd
import talib

def heuristics_v2(df):
    # Momentum Indicators
    ema_5 = df['close'].ewm(span=5, adjust=False).mean()
    ema_20 = df['close'].ewm(span=20, adjust=False).mean()
    ema_60 = df['close'].ewm(span=60, adjust=False).mean()
    volume_ema_20 = df['volume'].ewm(span=20, adjust=False).mean()
    volume_momentum = df['volume'] / volume_ema_20
    
    # Volatility Indicators
    daily_returns = df['close'].pct_change()
    std_10 = daily_returns.rolling(window=10).std()
    std_30 = daily_returns.rolling(window=30).std()
    std_60 = daily_returns.rolling(window=60).std()
    std_120 = daily_returns.rolling(window=120).std()
    intraday_volatility_5 = (df['high'] - df['low']) / df['open']
    avg_intraday_volatility_5 = intraday_volatility_5.rolling(window=5).mean()
    intraday_volatility_20 = (df['high'] - df['low']) / df['open']
    avg_intraday_volatility_20 = intraday_volatility_20.rolling(window=20).mean()

    # Trend Strength Indicators
    adx = talib.ADX(df['high'], df['low'], df['close'], timeperiod=14)
    rsi_14 = talib.RSI(df['close'], timeperiod=14)
    rsi_28 = talib.RSI(df['close'], timeperiod=28)
    
    # Sentiment Indicators
    open_close_ratio = df['close'] / df['open']
    high_low_range_to_close = (df['high'] - df['low']) / df['close']
    
    # Liquidity Indicators
    amount_turnover_rate = df['amount'] / (df['close'] * df['volume'])
    avg_volume_100 = df['volume'].rolling(window=100).mean()
    volume_to_avg_volume_ratio = df['volume'] / avg_volume_100
    
    # Pattern Recognition
    doji = (abs(df['close'] - df['open']) / (df['high'] - df['low'])) < 0.1
    hammer = (df['close'] > df['open']) & ((df['high'] - df['close']) <= 2 * (df['close'] - df['low']))
    shooting_star = (df['open'] > df['close']) & ((df['high'] - df['open']) <= 2 * (df['open'] - df['low']))
    bullish_engulfing = (df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    bearish_engulfing = (df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))
    
    # Composite Factors
    integrated_momentum_volatility_score = (ema_20 + volume_momentum - std_30) / 3
    sentiment_adjusted_trend_strength = adx * (open_close_ratio + high_low_range_to_close) / 2
    liquidity_adjusted_momentum = (ema_20 / amount_turnover_rate)

    # Combine all factors into a single alpha factor
    alpha_factor = (integrated_momentum_volatility_score + 
                    sentiment_adjusted_trend_strength + 
                    liquidity_adjusted_momentum) / 3

    return alpha_factor
```
