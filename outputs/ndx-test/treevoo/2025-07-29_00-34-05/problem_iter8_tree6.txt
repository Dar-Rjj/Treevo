```txt
Volume Adjusted Momentum with Enhanced Price Volatility, Trade Amount Adjustment, and Range Expansion Indicator
├── Calculate Momentum
│   ├── Use Close price (t)
│   └── Subtract Close price (t-20)  // 20 days in the past for momentum lookback
├── Volume Impact Factor
│   ├── Use Volume (t)
│   └── Average Volume (last 30 days)  // 30 days average to smooth out short-term fluctuations
│       ├── Use Volume (t-1)
│       ├── Use Volume (t-2)
│       ├── ...
│       └── Use Volume (t-29)
├── Price Volatility
│   ├── Use High price (t)
│   └── Calculate Standard Deviation of High prices (last 30 days)  // 30 days lookback for volatility
│       ├── Use High price (t-1)
│       ├── Use High price (t-2)
│       ├── ...
│       ┎── Use High price (t-29)
├── Trade Amount Influence
│   ├── Use Amount (t)
│   └── Median Amount (last 30 days)  // 30 days median to stabilize the trade amount factor
│       ├── Use Amount (t-1)
│       ├── Use Amount (t-2)
│       ├── ...
│       └── Use Amount (t-29)
├── Combine Momentum and Volume Impact
│   ├── Momentum (t)
│   └── Divide by Volume Impact Factor
├── Adjust for Price Volatility
│   ├── Combined Momentum and Volume (t)
│   └── Divide by Price Volatility (last 30 days)
├── Final Adjustment with Trade Amount
│   ├── Adjusted Momentum, Volume, and Volatility (t)
│   └── Multiply by Trade Amount Influence (t)
├── Calculate Short-Term Price Momentum
│   ├── Use Close price
│   └── Calculate Exponential Moving Average (EMA) of Close for 5 days
├── Calculate Long-Term Price Momentum
│   ├── Use Close price
│   └── Calculate Exponential Moving Average (EMA) of Close for 20 days
├── Compute Momentum Difference
│   ├── Subtract Short-Term EMA from Long-Term EMA
├── Calculate Daily Price Range
│   ├── Use High price
│   └── Use Low price
├── Calculate Average Price
│   ├── Add (High + Low + Close)
│   └── Divide by 3
├── Compute Volume Adjusted Range
│   ├── Multiply (Daily Price Range / Average Price)
│   │   └── Ensure non-zero division
│   └── Multiply by Volume
├── Calculate Short-Term Rolling Average
│   ├── Use last 14 days' Volume Adjusted Range
│   └── Sum and divide by 14
├── Calculate Long-Term Rolling Average
│   ├── Use last 28 days' Volume Adjusted Range
│   └── Sum and divide by 28
├── Combine Momentum and Volume Adjusted Range
│   ├── Multiply Final Adjustment with Trade Amount (t) by Volume Adjusted Range (t)
├── Adjust with Rolling Averages
    ├── Subtract Long-Term Rolling Average from Short-Term Rolling Average
    └── Multiply the result by Combined Momentum and Volume Adjusted Range
```
