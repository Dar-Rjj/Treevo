```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-Based Factors
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()
    df['SMA_Crossover'] = df['SMA_50'] - df['SMA_200']
    
    df['ROC'] = df['close'].pct_change(periods=12)
    
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['Short_Term_Momentum'] = df['EMA_5'] - df['EMA_10']
    
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Long_Term_Momentum'] = df['EMA_5'] - df['EMA_20']
    
    # Reversal-Based Factors
    def rsi(data, window=14):
        diff = data.diff(1)
        up = diff.where(diff > 0, 0.0)
        down = -diff.where(diff < 0, 0.0)
        avg_gain = up.rolling(window=window).mean()
        avg_loss = down.rolling(window=window).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))
    
    df['RSI'] = rsi(df['close'])
    
    df['Close_to_Open_Ratio'] = df['close'] / df['open'].shift(1)
    df['Average_Close_to_Open_Ratio'] = df['Close_to_Open_Ratio'].rolling(window=30).mean()
    df['Extreme_Price_Movements'] = df['Close_to_Open_Ratio'] - df['Average_Close_to_Open_Ratio']
    
    # Volume-Price Interaction
    df['OBV'] = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    
    adl = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    df['Chaikin_Money_Flow'] = (adl * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    df['Volume_Moving_Avg_5'] = df['volume'].rolling(window=5).mean()
    df['Volume_Moving_Avg_10'] = df['volume'].rolling(window=10).mean()
    df['Volume_Deviation_Score'] = (df['Volume_Moving_Avg_5'] - df['Volume_Moving_Avg_10']) / df['Volume_Moving_Avg_10']
    
    # Hybrid Factors
    df['Momentum_Volume_Hybrid'] = df['ROC'] * df['Chaikin_Money_Flow']
    df['Reversal_Volume_Hybrid'] = df['RSI'] * df['OBV']
    
    # Enhanced Intraday Range
    df['Intraday_Range'] = (df['high'] - df['low'] + df['close'] - df['open']) / 2
    
    # Volatility Adjustment
    df['Daily_Range'] = df['high'] - df['low']
    df['Volatility'] = df['Daily_Range'].rolling(window=30).mean()
    
    # New Factor: Price-Volatility Ratio
    df['Price_Volatility_Ratio'] = df['close'] / df['Volatility']
    
    # New Factor: Price-Volume Trend
    df['Close_Volume_Product'] = df['close'] * df['volume']
    df['EMA_5_Close_Volume'] = df['Close_Volume_Product'].ewm(span=5, adjust=False).mean()
    df['EMA_20_Close_Volume'] = df['Close_Volume_Product'].ewm(span=20, adjust=False).mean()
    df['Price_Volume_Trend'] = df['EMA_5_Close_Volume'] - df['EMA_20_Close_Volume']
    
    # Combine Factors
    df['Momentum_Adjusted_by_Volatility'] = (df['Long_Term_Momentum'] * (1 / df['Volatility']))
    df['Adjusted_Momentum_by_Volume'] = df['Momentum_Adjusted_by_Volatility'] * df['Volume_Deviation_Score']
    
    df['Final
