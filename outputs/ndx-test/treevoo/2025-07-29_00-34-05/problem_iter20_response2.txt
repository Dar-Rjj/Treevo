```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-Based Factors
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()
    df['SMA_Crossover'] = df['SMA_50'] - df['SMA_200']
    
    df['ROC_12'] = (df['close'] / df['close'].shift(12) - 1) * 100
    
    avg_vol_30 = df['volume'].rolling(window=30).mean()
    df['Momentum_Vol_Impact'] = (df['close'] - df['close'].shift(20)) / (df['volume'] / avg_vol_30)
    
    # Reversal-Based Factors
    df['RSI_14'] = df['close'].rolling(window=14).apply(lambda x: talib.RSI(x, timeperiod=14), raw=False)
    
    df['Close_Open_Ratio'] = df['close'] / df['open']
    df['Avg_Close_Open_Ratio'] = df['Close_Open_Ratio'].rolling(window=30).mean()
    df['Extreme_Price_Movements'] = (df['Close_Open_Ratio'] - df['Avg_Close_Open_Ratio']).abs()
    
    df['Daily_Price_Range'] = df['high'] - df['low']
    alpha = 2 / (7 + 1)
    df['EMA_Daily_Price_Range'] = df['Daily_Price_Range'].ewm(alpha=alpha, adjust=False).mean()
    df['Daily_Change_in_EMA'] = df['EMA_Daily_Price_Range'].diff()
    
    # Volume-Price Interaction
    obv = [0]
    for i in range(1, len(df)):
        if df['close'][i] > df['close'][i-1]:
            obv.append(obv[-1] + df['volume'][i])
        elif df['close'][i] < df['close'][i-1]:
            obv.append(obv[-1] - df['volume'][i])
        else:
            obv.append(obv[-1])
    df['OBV'] = obv
    
    adl = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    adl = adl * df['volume']
    cmf = adl.rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    df['CMF'] = cmf
    
    df['Volume_Adjusted_Range'] = (df['Daily_Price_Range'] / df['close']) * df['volume']
    df['Short_Term_Rolling_Avg_Volume_Adjusted_Range'] = df['Volume_Adjusted_Range'].rolling(window=15).mean()
    df['Long_Term_Rolling_Avg_Volume_Adjusted_Range'] = df['Volume_Adjusted_Range'].rolling(window=25).mean()
    
    # Volume and Amount-Based Factors
    df['Volume_Breakout'] = df['volume'] / df['volume'].rolling(window=30).mean()
    
    vwap = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3).cumsum() / df['volume'].cumsum()
    df['VWAP'] = vwap
    
    df['Volume_Price_Correlation'] = df['close'].pct_change().rolling(window=30).corr(df['volume'].pct_change())
    
    avg_amount_30 = df['amount'].rolling(window=30).mean()
    df['Trade_Amount_Influence'] = df['amount'] / avg_amount_30
    
    # Hybrid Factors
    df['Momentum_Volume_Combined'] = df['ROC_12'] * df['CMF']
    
    df['Reversal_Volume_Combined'] = df['RSI_14'] * df['OBV']
    
    vol_shock_threshold = 0.6
    df['Volume_Shock_Flag'] = (df['volume'] / df['volume'].shift(1) - 1).abs() > vol_shock_threshold
    df['High_Low_Range_Momentum_Volume_Shock'] = df['Daily_Change_in_EMA'] * df['Volume_Shock_Flag'].astype(int)
    
    # Finalize Alpha Factor
    price_volatility = df['close'].rolling(window=30).std()
    df['
