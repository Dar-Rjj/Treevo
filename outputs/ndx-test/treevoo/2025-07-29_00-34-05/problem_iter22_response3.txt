```python
import pandas as pd

def heuristics_v2(df):
    # Momentum Indicators
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    RS = gain / loss
    df['RSI'] = 100 - (100 / (1 + RS))
    
    # Volatility Indicators
    df['Bollinger_MA_20'] = df['close'].rolling(window=20).mean()
    df['Bollinger_STD_20'] = df['close'].rolling(window=20).std()
    df['Bollinger_Upper'] = df['Bollinger_MA_20'] + 2 * df['Bollinger_STD_20']
    df['Bollinger_Lower'] = df['Bollinger_MA_20'] - 2 * df['Bollinger_STD_20']
    
    tr1 = df['high'] - df['low']
    tr2 = abs(df['high'] - df['close'].shift())
    tr3 = abs(df['low'] - df['close'].shift())
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    df['ATR_14'] = true_range.rolling(window=14).mean()
    
    # Volume Indicators
    df['OBV'] = (df['close'] > df['close'].shift()).astype(int) * df['volume'] - (df['close'] < df['close'].shift()).astype(int) * df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    money_flow_volume = money_flow_multiplier * df['volume']
    cmf_20 = money_flow_volume.rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    df['CMF_20'] = cmf_20
    
    # Price Pattern Indicators
    doji_condition = (abs(df['open'] - df['close']) / (df['high'] - df['low']) < 0.1) & (df['high'] - df['low'] > 0.001)
    df['Doji'] = doji_condition.astype(int)
    
    bullish_engulfing = (df['open'] > df['close'].shift()) & (df['close'] > df['open'].shift()) & (df['close'] > df['open'].shift(2)) & (df['open'] > df['close'].shift(2))
    bearish_engulfing = (df['open'] < df['close'].shift()) & (df['close'] < df['open'].shift()) & (df['close'] < df['open'].shift(2)) & (df['open'] < df['close'].shift(2))
    df['Engulfing'] = bullish_engulfing.astype(int) - bearish_engulfing.astype(int)
    
    # Advanced Indicators
    df['EMA_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['EMA_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = df['EMA_12'] - df['EMA_26']
    df['Signal_Line'] = df['MACD'].ewm(span=9, adjust=False).mean()
    
    df['Stochastic_K'] = (df['close'] - df['low'].rolling(window=14).min()) / (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min()) * 100
    df['Stochastic_D'] = df['Stochastic_K'].rolling(window=3).mean()
    
    # Factor
    factor = df['SMA_5'] - df['SMA_20'] + df['RSI'] - 50 + df['OBV'] + df['CMF_20'] + df['Doji'] * 2 + df['Engulfing'] * 2 + df['MACD'] - df['Signal_Line'] + df['Stochastic_K'] - df
