```python
import pandas as pd

def heuristics_v2(df):
    # Compute 5-day and 20-day simple moving averages for close prices
    df['SMA5'] = df['close'].rolling(window=5).mean()
    df['SMA20'] = df['close'].rolling(window=20).mean()
    # Determine if SMA5 is above SMA20
    df['SMA_trend'] = (df['SMA5'] > df['SMA20']).astype(int)
    
    # Calculate the difference between high and low prices
    df['price_range'] = df['high'] - df['low']
    # Calculate the ratio of close to open prices
    df['close_to_open_ratio'] = df['close'] / df['open']
    # Determine if the close price is higher than the open price
    df['positive_day'] = (df['close'] > df['open']).astype(int)
    
    # Calculate 5-day and 20-day moving averages of volume
    df['VMA5'] = df['volume'].rolling(window=5).mean()
    df['VMA20'] = df['volume'].rolling(window=20).mean()
    # Determine if VMA5 is above VMA20
    df['VMA_trend'] = (df['VMA5'] > df['VMA20']).astype(int)
    # Compute the ratio of current day's volume to the 20-day average volume
    df['volume_spike'] = (df['volume'] > 1.5 * df['VMA20']).astype(int)  # Assuming a threshold of 1.5 times VMA20 for a volume spike
    
    # Assign weights to each binary indicator based on their predictive power
    # These weights can be adjusted based on backtesting results or other methods
    weights = {
        'SMA_trend': 0.4,
        'positive_day': 0.3,
        'VMA_trend': 0.2,
        'volume_spike': 0.1
    }
    
    # Calculate a weighted score for each day
    df['composite_factor'] = (df['SMA_trend'] * weights['SMA_trend'] +
                              df['positive_day'] * weights['positive_day'] +
                              df['VMA_trend'] * weights['VMA_trend'] +
                              df['volume_spike'] * weights['volume_spike'])
    
    return df['composite_factor']
```
