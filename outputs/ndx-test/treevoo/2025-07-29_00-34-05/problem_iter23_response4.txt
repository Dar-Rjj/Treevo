```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 5-day and 10-day EMA
    df['5_day_ema'] = df['close'].ewm(span=5, adjust=False).mean()
    df['10_day_ema'] = df['close'].ewm(span=10, adjust=False).mean()
    df['short_term_momentum'] = df['5_day_ema'] - df['10_day_ema']
    
    # Calculate 20-day EMA for long-term momentum
    df['20_day_ema'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Momentum Difference
    df['momentum_difference'] = df['5_day_ema'] - df['20_day_ema']
    
    # Daily Price Range
    df['daily_price_range'] = (df['high'] - df['low']) / df['close']
    
    # Volume-Weighted Range
    df['volume_weighted_range'] = df['daily_price_range'] * (df['volume'] ** 0.5) / ((df['high'] + df['low']) / 2)
    
    # Short-Term Rolling Average of Volume-Weighted Range
    df['short_term_vol_weighted_avg'] = df['volume_weighted_range'].rolling(window=10).mean()
    
    # Long-Term Rolling Average of Volume-Weighted Range
    df['long_term_vol_weighted_avg'] = df['volume_weighted_range'].rolling(window=30).mean()
    
    # Combine Price Momentum and Volume-Weighted Range
    df['short_term_indicator'] = df['20_day_ema'] * df['short_term_vol_weighted_avg']
    df['long_term_indicator'] = df['20_day_ema'] / df['long_term_vol_weighted_avg']
    df['composite_indicator'] = (df['short_term_indicator'] + df['long_term_indicator']) / 2
    
    # Adjust Momentum by Volatility
    df['daily_range'] = df['high'] - df['low']
    df['range_volatility'] = df['daily_range'].rolling(window=30).sum() / 30
    
    # Incorporate Volume Influence
    df['5_day_vol_ema'] = df['volume'].ewm(span=5, adjust=False).mean()
    df['10_day_vol_ema'] = df['volume'].ewm(span=10, adjust=False).mean()
    df['volume_deviation'] = df['5_day_vol_ema'] - df['10_day_vol_ema']
    
    # Enhanced Intraday Range
    df['enhanced_intraday_range'] = ((df['high'] - df['low']) + (df['open'] - df['close'])) / 2
    
    # Adjust Momentum by Volatility
    df['adjusted_momentum'] = df['momentum_difference'] / df['range_volatility']
    
    # Final Integrated Alpha Factor
    df['final_factor'] = (df['composite_indicator'] 
                          + df['adjusted_momentum'] * df['volume_deviation'] 
                          + df['volume_deviation']) / (df['enhanced_intraday_range'] * df['close'])
    
    return df['final_factor']
```
