```python
import pandas as pd

def heuristics_v2(df):
    # Momentum Indicators
    df['1d_return'] = df['close'].pct_change()
    df['5d_return'] = df['close'].pct_change(periods=5)
    df['20d_return'] = df['close'].pct_change(periods=20)
    
    df['volume_weighted_return_1d'] = df['1d_return'] * df['volume']
    df['volume_weighted_return_5d'] = df['5d_return'] * df['volume']
    df['volume_weighted_return_20d'] = df['20d_return'] * df['volume']
    
    # Volatility Measures
    df['historical_volatility'] = df['close'].pct_change().rolling(window=20).std()
    
    df['close_to_high_ratio'] = df['close'] / df['high']
    df['close_to_low_ratio'] = df['close'] / df['low']
    
    # Reversal Indicators
    df['daily_range'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    df['open_close_spread'] = (df['close'] - df['open']) / df['open']
    
    # Volume Trends
    df['volume_change'] = df['volume'].pct_change()
    
    df['volume_short_ma'] = df['volume'].rolling(window=5).mean()
    df['volume_long_ma'] = df['volume'].rolling(window=20).mean()
    df['volume_oscillator'] = (df['volume_short_ma'] - df['volume_long_ma']) / df['volume_long_ma']
    
    # Market Structure Analysis
    df['gap_analysis'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    df['previous_high'] = df['high'].rolling(window=5).max().shift(1)
    df['previous_low'] = df['low'].rolling(window=5).min().shift(1)
    df['breakout_potential'] = ((df['high'] > df['previous_high']) | (df['low'] < df['previous_low'])).astype(int)
    
    # Price Pattern Recognition
    df['bullish_engulfing'] = ((df['open'] < df['close']) & (df['open'].shift(1) > df['close'].shift(1)) & (df['open'] > df['close'].shift(1)) & (df['close'] > df['open'].shift(1))).astype(int)
    df['bearish_engulfing'] = ((df['open'] > df['close']) & (df['open'].shift(1) < df['close'].shift(1)) & (df['open'] < df['close'].shift(1)) & (df['close'] < df['open'].shift(1))).astype(int)
    
    df['doji_pattern'] = ((df['open'] == df['close']) | (abs(df['open'] - df['close']) <= 0.01)).astype(int)
    
    # Combined Factors
    df['momentum_and_volatility'] = df['20d_return'] / df['historical_volatility']
    
    df['volume_and_price_movement'] = (df['close'] - df['open']) / df['open'] * df['volume']
    
    # Final Alpha Factor
    alpha_factor = (
        df['20d_return'] + 
        df['volume_weighted_return_20d'] + 
        df['close_to_high_ratio'] - 
        df['close_to_low_ratio'] + 
        df['daily_range'] - 
        df['open_close_spread'] + 
        df['volume_oscillator'] + 
        df['gap_analysis'] + 
        df['breakout_potential'] + 
        df['bullish_engulfing'] - 
        df['bearish_engulfing'] + 
        df['doji_pattern'] + 
        df['momentum_and_volatility'] + 
        df['volume_and_price_movement']
    )
    
    return alpha_factor.dropna()
```
