```txt
Integrated and Enhanced Volume-Weighted Momentum Alpha Factor with Volatility and Trend Adjustments
├── Calculate Volume-Weighted Price
│   └── Sum of (Volume * Close Price)
├── EMA of Volume-Weighted Prices
├── Intraday Volatility Adjustment
│   ├── Intraday Volatility = High - Low
│   └── Adjusted EMA = EMA + Intraday Volatility
├── Volume Spike Indicator
│   ├── Volume Change = Current Volume - Previous Volume
│   └── If Volume Change > Threshold, Increase Final Alpha Factor
├── Short-Term Momentum
│   ├── Use Close prices over the last 5 days
│   └── Compute the sum
├── Long-Term Momentum
│   ├── Use Close prices over the last 20 days
│   └── Compute the sum
├── Determine the Difference between Short and Long-Term Momentum
├── Incorporate Volume Trend
│   ├── Calculate Sum of Volume over the last 5 days
│   ├── Calculate Sum of Volume over the last 20 days
│   └── Compute the difference between short and long-term volume sums
├── Calculate Adjusted High-Low Range
│   ├── Use High price
│   ├── Use Low price
│   └── Scale by Volume
│       ├── Use Volume
│       └── Divide Volume by Sum of Volume of Last 20 Days
├── Calculate Previous Day's Return
│   ├── Use Close price (current day)
│   └── Use Open price (previous day)
├── Adjust Momentum by Volatility
│   ├── Use Previous Day's Return
│   └── Use Realized Volatility
├── Combine Factors
│   ├── Multiply Adjusted High-Low Range by Scaled Volume
│   ├── Inverse of Intraday Range
│   ├── Combine Adjusted High-Low Range, Inversed Intraday Range, and Previous Day's Return
│   │   ├── Multiply Adjusted High-Low Range by Inversed Intraday Range
│   │   └── Add Previous Day's Return
│   ├── Add Adjusted Short-Term Momentum
│   └── Add Adjusted Momentum by Volatility
├── True Average Price
│   └── (High + Low + Close) / 3
├── Long-Term Price Momentum (EMA over 20 days)
├── Momentum Difference
│   └── Short-Term Momentum - Long-Term Momentum
├── Daily Return
│   └── (Close - Previous Close) / Previous Close
├── Rolling Average Daily Return (21-day window)
├── Rolling Volatility of Close Prices (20-day window)
├── Adjusted Momentum by Volatility
│   └── Rolling Average Daily Return / Rolling Volatility
├── Volume-Price Movement Score
│   └── Volume * (High - Open)
├── Volume Trend
│   ├── Short-Term Volume EMA (5-day)
│   ├── Long-Term Volume EMA (20-day)
│   └── Volume Trend Difference = Short-Term - Long-Term
├── Combined Momentum and Volume Trends
│   └── Momentum Difference + Volume Trend Difference
├── Adjusted True Average Price
│   └── True Average Price * (1 / Moving Standard Deviation of Price Range)
├── Final Momentum Indicator
│   └── Adjusted True Average Price * Volume-Price Movement Score
└── Integrate with Combined Momentum and Volume Trends
    ├── Final Alpha Factor = (Adjusted Momentum + Final Momentum Indicator + 
    │   Volume Momentum / Rolling Volatility) * Weight
    └── Weight by Volume
        ├── Use Volume
        └── Multiply by Combined Factor
```
