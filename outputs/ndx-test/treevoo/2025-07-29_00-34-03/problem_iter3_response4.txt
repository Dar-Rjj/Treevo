```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Volume-Weighted Price
    df['weighted_close'] = df['volume'] * df['close']
    volume_weighted_price = df['weighted_close'].rolling(window=10).sum() / df['volume'].rolling(window=10).sum()

    # Calculate Simple Moving Average (SMA) of Volume-Weighted Prices
    sma_volume_weighted_price = volume_weighted_price.rolling(window=20).mean()

    # Volatility Adjustment Factor
    df['log_high_low_returns'] = np.log(df['high'] / df['low'])
    realized_volatility = df['log_high_low_returns'].rolling(window=20).std()
    smoothed_realized_volatility = realized_volatility.ewm(span=10, adjust=False).mean()
    
    # Adjust SMA with Smoothed Volatility
    volatility_adjusted_sma = sma_volume_weighted_price - smoothed_realized_volatility

    # Volume Surge Indicator
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    volume_surge = (df['volume_change'] > 0) & (df['volume_change'] > df['volume'].quantile(0.9))

    # Adjust Final Alpha Factor
    final_alpha_factor = volatility_adjusted_sma
    final_alpha_factor[volume_surge] = final_alpha_factor + (df['volume_change'][volume_surge] / df['volume'].rolling(window=10).mean())

    return final_alpha_factor
```
