```txt
Volume and Price Momentum Adjusted Factor with Enhanced Volume and Range Analysis
├── Calculate Daily Return
│   ├── Use Close price of day t
│   └── Use Close price of day t-1
├── Calculate Rolling Average Daily Return
│   ├── Use Daily Return
│   └── Specify rolling window (e.g., 21 days)
├── Calculate Rolling Volatility of Close Prices
│   ├── Use Close price
│   └── Specify rolling window (e.g., 20 days)
├── Adjust Momentum by Volatility
│   ├── Use Rolling Average Daily Return
│   └── Use Rolling Volatility of Close Prices
├── Weight by Volume
│   ├── Use Volume
│   └── Multiply by Adjusted Momentum
├── Calculate Volume Change
│   ├── Use Volume of day t
│   └── Use Volume of day t-1
├── Calculate Daily Range
│   ├── Use High price of day t
│   └── Use Low price of day t
├── Calculate Rolling Average Daily Range
│   ├── Use Daily Range
│   └── Specify rolling window (e.g., 21 days)
├── Adjust Range by Volatility
│   ├── Use Rolling Average Daily Range
│   └── Use Rolling Volatility of Close Prices
├── Integrate Adjusted Range into Combined Factors
│   ├── Add Adjusted Range to Weighted Momentum
├── Combine Factors
│   ├── Add Volume Change to Integrated Factors
└── Integrate Volume Momentum
    ├── Calculate Volume Momentum
    │   ├── Use Volume of day t
    │   └── Use Volume of day t-n (e.g., n=5)
    ├── Adjust Volume Momentum by Volatility
    │   ├── Use Volume Momentum
    │   └── Use Rolling Volatility of Close Prices
    ├── Add Adjusted Volume Momentum to Combined Factors
    └── Specify weight for integration (e.g., 0.5)
```
