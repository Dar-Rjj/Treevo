```txt
Volume and Price Momentum Factor with Enhanced Filtering
├── Calculate Daily Log Return
│   ├── Use Close price of day t
│   └── Use Close price of day t-1
├── Calculate Volume Change
│   ├── Use Volume of day t
│   └── Use Volume of day t-1
├── Combine Momentum and Volume
│   ├── Multiply Daily Log Return by Volume Change
│   ├── Use result as preliminary factor
├── Apply Price Filter
│   ├── Use Open and Close prices
│   │   ├── Calculate average of Open and Close of day t
│   │   └── Calculate average of Open and Close of day t-1
│   └── Finalize Alpha Factor
│       ├── If average of (Open,Close) of day t > average of (Open,Close) of day t-1
│       │   └── Increase final factor value
│       └── Else
│           └── Decrease final factor value
└── Apply Volume Spike Filter
    ├── Calculate Volume Spike
    │   ├── Use Volume of day t
    │   └── Use Volume of day t-1
    │   │   ├── If Volume of day t > 2 * Volume of day t-1
    │   │   │   └── Increase final factor value
    │   │   └── Else
    │   │       └── No change to final factor value
```
