```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Volatility
    intraday_volatility = df['high'] - df['low']
    
    # Calculate Short-Term Momentum
    short_term_momentum = (df['close'].shift(1) + 
                           df['close'].shift(2) + 
                           df['close'].shift(3) + 
                           df['close'].shift(4)) / 4
    current_momentum = df['close'] - short_term_momentum
    adjusted_momentum = current_momentum / intraday_volatility
    
    # Calculate Volume-Weighted Prices
    weighted_close_price = df['volume'] * df['close']
    sma_weighted_close = weighted_close_price.rolling(window=10).mean()
    
    # Calculate Realized Volatility and Smooth it
    log_returns = np.log(df['high'] / df['low'])
    realized_volatility = log_returns.rolling(window=10).std()
    smoothed_volatility = realized_volatility.ewm(span=10).mean()
    adjusted_sma = sma_weighted_close - smoothed_volatility
    
    # Calculate Price Momentum
    short_term_avg_close = df['close'].rolling(window=10).mean()
    long_term_avg_close = df['close'].rolling(window=60).mean()
    price_momentum = short_term_avg_close - long_term_avg_close
    
    # Calculate Volume Surge
    short_term_avg_volume = df['volume'].rolling(window=10).mean()
    long_term_avg_volume = df['volume'].rolling(window=60).mean()
    volume_surge = short_term_avg_volume - long_term_avg_volume
    
    # Calculate Volume Weighted Close-to-Open Return
    close_to_open_return = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    volume_weighted_return = close_to_open_return * df['volume']
    
    # Combine all factors
    factor = (adjusted_momentum + 
              adjusted_sma + 
              price_momentum + 
              volume_surge + 
              volume_weighted_return)
    
    return factor
```
