```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Calculate Volume Change
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Combine Momentum and Volume
    df['prelim_factor'] = df['log_return'] * df['volume_change']
    
    # Apply Price Filter
    df['avg_price_t'] = (df['open'] + df['close']) / 2
    df['avg_price_t-1'] = df['avg_price_t'].shift(1)
    df['price_filter'] = np.where(df['avg_price_t'] > df['avg_price_t-1'], 1, -1)
    df['final_factor'] = df['prelim_factor'] * df['price_filter']
    
    # Apply Volume Spike Filter
    df['volume_spike'] = np.where(df['volume'] > 2 * df['volume'].shift(1), 1, 0)
    df['final_factor'] += df['volume_spike']
    
    # Incorporate Intraday Dynamics
    df['intraday_momentum'] = df['high'] - df['low']
    df['weighted_intraday_momentum'] = df['volume'] * df['intraday_momentum']
    
    # Identify Volume Shock
    df['volume_shock'] = np.where(df['volume'] > 1.5 * df['volume'].shift(1), 1, 0)
    
    # Smooth Realized Volatility
    df['realized_volatility'] = np.log(df['high'] / df['low']).rolling(window=20).std()
    df['smoothed_volatility'] = df['realized_volatility'].ewm(span=20).mean()
    
    # Adjust Combined Momentum Factor with Shock and Volatility
    df['adjusted_factor'] = df['final_factor'] * df['volume_shock'] - df['smoothed_volatility']
    
    # Add Trend Confirmation
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['trend_confirmation'] = np.where(df['close'] > df['sma_5'], 1, 0)
    
    # Final Adjustment
    df['final_alpha'] = df['adjusted_factor'] + df['trend_confirmation']
    
    return df['final_alpha']
```
