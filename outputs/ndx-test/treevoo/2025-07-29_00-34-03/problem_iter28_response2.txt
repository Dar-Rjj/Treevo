```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Average (SMA) of closing prices
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate Exponential Moving Average (EMA) of closing prices
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Determine the trend by comparing current price to moving averages
    df['Bullish_Trend'] = (df['close'] > df['SMA_20']) & (df['close'] > df['EMA_20'])
    df['Bearish_Trend'] = (df['close'] < df['SMA_20']) & (df['close'] < df['EMA_20'])
    
    # Calculate the standard deviation of closing prices over a period
    df['StdDev_20'] = df['close'].rolling(window=20).std()
    
    # Determine if the volatility is increasing or decreasing
    df['Volatility_Increasing'] = df['StdDev_20'] > df['StdDev_20'].shift(1)
    df['Volatility_Decreasing'] = df['StdDev_20'] < df['StdDev_20'].shift(1)
    
    # Calculate the percentage change in volume
    df['Volume_Change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Determine if there is a significant increase or decrease in volume
    df['Volume_Significant_Increase'] = df['Volume_Change'] > 0.1
    df['Volume_Significant_Decrease'] = df['Volume_Change'] < -0.1
    
    # Identify if there is a price gap between today's open and yesterday's close
    df['Price_Gap'] = df['open'] - df['close'].shift(1)
    
    # Determine if the gap is significant
    df['Significant_Upward_Gap'] = df['Price_Gap'] > 0.05 * df['close'].shift(1)
    df['Significant_Downward_Gap'] = df['Price_Gap'] < -0.05 * df['close'].shift(1)
    
    # Create a composite factor combining trend, volatility, and volume changes
    df['Composite_Factor'] = (
        df['Bullish_Trend'].astype(int) + 
        (-1 * df['Bearish_Trend'].astype(int)) + 
        df['Volatility_Increasing'].astype(int) + 
        (-1 * df['Volatility_Decreasing'].astype(int)) + 
        df['Volume_Significant_Increase'].astype(int) + 
        (-1 * df['Volume_Significant_Decrease'].astype(int)) + 
        df['Significant_Upward_Gap'].astype(int) + 
        (-1 * df['Significant_Downward_Gap'].astype(int))
    )
    
    return df['Composite_Factor']
```
