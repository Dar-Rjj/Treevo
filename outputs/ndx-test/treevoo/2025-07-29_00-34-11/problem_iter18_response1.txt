```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Gain and Loss
    df['Gain'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['Loss'] = (df['close'].shift(1) - df['close']) / df['close'].shift(1)
    df['Gain'] = df['Gain'].apply(lambda x: x if x > 0 else 0)
    df['Loss'] = df['Loss'].apply(lambda x: -x if x < 0 else 0)

    # Aggregate Gains and Losses over a period (e.g., 14 days)
    df['Sum_Gain'] = df['Gain'].rolling(window=14).sum()
    df['Sum_Loss'] = df['Loss'].rolling(window=14).sum()

    # Calculate Relative Strength
    df['RS'] = df['Sum_Gain'] / df['Sum_Loss']

    # Convert to ARSI
    df['ARSI'] = 100 - (100 / (1 + df['RS']))

    # Adjust for Advanced Features
    df['Average_Volume'] = df['volume'].rolling(window=14).mean()
    df['Momentum'] = (df['close'] - df['open']) / df['open']
    df['ARSI_Adjusted'] = df['ARSI'] * df['Average_Volume'] * df['Momentum']

    # Calculate Short-Term and Long-Term Logarithmic Returns
    df['Log_Return_5'] = np.log(df['close'] / df['close'].shift(5))
    df['Log_Return_20'] = np.log(df['close'] / df['close'].shift(20))

    # Calculate Volume-Weighted Returns
    df['Volume_Weighted_Log_Return_5'] = df['Log_Return_5'] * df['volume']
    df['Volume_Weighted_Log_Return_20'] = df['Log_Return_20'] * df['volume']

    # Calculate Short-Term Volatility
    df['True_Range'] = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    df['Short_Term_Volatility'] = df['True_Range'].rolling(window=5).mean()

    # Adjust for Volatility
    df['Adjusted_Short_Term_Return'] = df['Volume_Weighted_Log_Return_5'] / df['Short_Term_Volatility']
    df['Adjusted_Return'] = df['Adjusted_Short_Term_Return'] - df['Volume_Weighted_Log_Return_20']

    # Intraday Price Movement Intensity
    df['High_Low_Spread'] = df['high'] - df['low']
    df['Open_Close_Change'] = df['close'] - df['open']
    df['Intraday_Intensity'] = df['High_Low_Spread'] + df['Open_Close_Change']

    # Measure Momentum-Volatility Correlation
    df['Intraday_Volatility'] = (df['high'] - df['low']) * df['volume']
    df['Momentum_Sentiment'] = np.sign(df['Intraday_Intensity'].corr(df['Intraday_Volatility']))

    # Intraday Price Movement Ratio
    df['High_Low_Ratio'] = df['high'] / df['low']
    df['Open_Close_Ratio'] = df['close'] / df['open']
    df['Intraday_Ratio'] = (df['High_Low_Ratio'] + df['Open_Close_Ratio']) / 2
    df['Price_Volatility_Alignment'] = np.sign(df['Intraday_Ratio'].corr(df['Intraday_Volatility']))
    df['Sentiment'] = df['Momentum_Sentiment'] * df['Price_Volatility_Alignment']

    # Combine Intraday Price Movement Intensity and Momentum Sentiment
    df['Intraday_Intensity_Sentiment'] = df['Intraday_Intensity'] * df['Momentum_Sentiment']

    # Combine Intraday Price Movement Ratio and Sentiment
    df['Intraday_Ratio_Sentiment'] = df['Intraday_Ratio'] * df['Sentiment']

    # Combine ARSI, Adjusted Returns, and Price Oscillator
    df['Price_Oscillator'] = df['close'] - df['close'].shift(20)
    df['Combined_Factor'] = (df['ARSI_Adjusted'] * df['Adjusted_Short_Term_Return']) + \
                            df['Price_Oscillator'] - \
                            df['Volume_Weighted_Log_Return_
