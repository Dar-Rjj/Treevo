```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between closing and opening price
    df['daily_performance'] = df['close'] - df['open']
    
    # Count the number of days the daily performance was positive in the last 5 days
    df['positive_days_5d'] = df['daily_performance'].rolling(window=5).apply(lambda x: (x > 0).sum(), raw=True)
    
    # Calculate the average daily performance over the past 20 trading days
    df['avg_daily_performance_20d'] = df['daily_performance'].rolling(window=20).mean()
    
    # Evaluate if the current day's performance is above or below this 20-day average
    df['above_avg_20d'] = df['daily_performance'] > df['avg_daily_performance_20d']
    
    # Compute the ratio of the closing price to the highest price of the day
    df['close_to_high_ratio'] = df['close'] / df['high']
    
    # Measure the consistency of this ratio over the past 10 days
    df['resilience_count'] = df['close_to_high_ratio'].rolling(window=10).apply(lambda x: (x > 0.95).sum(), raw=True)
    
    # Compare today's volume with the average volume over the past 30 days
    df['avg_volume_30d'] = df['volume'].rolling(window=30).mean()
    df['volume_spike'] = df['volume'] > 2 * df['avg_volume_30d']
    
    # Calculate the correlation between the daily amount and the closing price over the last 60 days
    df['amount_close_corr_60d'] = df['amount'].rolling(window=60).corr(df['close'])
    df['positive_corr'] = df['amount_close_corr_60d'] > 0
    
    # Analyze the pattern of the low prices over the past 10 days
    df['low_price_breakout'] = df['low'].rolling(window=10).min() < df['low'].shift(1).rolling(window=9).min()
    df['breakout_count'] = df['low_price_breakout'].rolling(window=10).sum()
    
    # Generate the alpha factor
    df['alpha_factor'] = (
        df['positive_days_5d'] +
        df['above_avg_20d'].astype(int) +
        df['resilience_count'] +
        df['volume_spike'].astype(int) +
        df['positive_corr'].astype(int) +
        df['breakout_count']
    )
    
    return df['alpha_factor']
```
