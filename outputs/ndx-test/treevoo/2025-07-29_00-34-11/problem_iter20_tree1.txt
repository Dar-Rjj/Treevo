```txt
Calculate Short-Term Logarithmic Return
├── Use Close price of day t
└── Apply Logarithm on (Close(t) / Close(t-5))

Calculate Long-Term Logarithmic Return
├── Use Close price of day t
└── Apply Logarithm on (Close(t) / Close(t-20))

Calculate Volume-Weighted Intraday Ratios
├── Compute High-Low Ratio
│   ├── Use High price (day t)
│   └── Use Low price (day t)
├── Compute Open-Close Ratio
│   ├── Use Open price (day t)
│   └── Use Close price (day t)
└── Combine Ratios and Weight by Volume
    ├── Average High-Low and Open-Close Ratios
    ├── Use Volume (day t)
    └── Multiply Averaged Ratios by Volume

Adjust for Volatility with Intraday Sentiment
├── Calculate Intraday Volatility
│   ├── Use High price (day t)
│   ├── Use Low price (day t)
│   └── Subtract to get range
├── Evaluate Alignment
│   ├── Compare Intraday Movement Ratio with Volatility
│   └── Determine Sentiment
│       ├── Positive if High Alignment
│       └── Negative if Low Alignment
├── Divide Volume-Weighted Short-Term Logarithmic Return by Intraday Volatility
└── Subtract Volume-Weighted Long-Term Logarithmic Return

Combine Intraday Volatility, Close-to-Close Return, and Momentum
├── Calculate Intraday Volatility
│   ├── Use High price (day t)
│   ├── Use Low price (day t)
│   └── Subtract Low from High
├── Calculate Close-to-Close Return
│   ├── Use Current Close price (day t)
│   ├── Use Previous Close price (day t-1)
│   └── Divide Current Close by Previous Close, then subtract 1
├── Multiply Intraday Volatility with Close-to-Close Return
└── Add Intraday Momentum
    ├── Use Open price of day t
    ├── Use Close price of day t
    └── Divide Close by Open, then subtract 1

Incorporate Enhanced Momentum into Adjusted Ratios
├── Calculate Close-to-Close Return
│   ├── Use Close price (day t)
│   └── Use Close price (day t-1)
└── Adjust Volume-Weighted Ratios by Close-to-Close Return
    ├── Multiply Volume-Weighted Ratios by Close-to-Close Return
    └── Ensure Non-Zero Division Handling

Aggregate Volume Changes
├── Calculate Daily Volume Change
│   ├── Use Volume
│   └── Calculate (Volume(t) - Volume(t-1))
└── Sum over the last M days
    └── M = 5

Final Adjustment
├── Add the result of Adjust for Volatility with Intraday Sentiment
├── Add the result of Combine Intraday Volatility, Close-to-Close Return, and Momentum
├── Multiply by Aggregated Volume Changes
└── Add Volume-Weighted Intraday Ratios
```
