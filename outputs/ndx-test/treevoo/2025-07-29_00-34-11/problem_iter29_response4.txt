```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Price Difference
    df['price_diff'] = df['high'] - df['low']
    
    # Determine Gain and Loss
    df['gain'] = 0
    df['loss'] = 0
    for i in range(1, len(df)):
        if df.loc[df.index[i], 'close'] > df.loc[df.index[i-1], 'close']:
            df.loc[df.index[i], 'gain'] = df.loc[df.index[i], 'close'] - df.loc[df.index[i-1], 'close']
        else:
            df.loc[df.index[i], 'loss'] = df.loc[df.index[i-1], 'close'] - df.loc[df.index[i], 'close']

    # Aggregate Gains and Losses
    df['sum_gain_14'] = df['gain'].rolling(window=14).sum()
    df['sum_loss_14'] = df['loss'].rolling(window=14).sum()

    # Calculate Relative Strength
    df['RS'] = df['sum_gain_14'] / df['sum_loss_14'].replace(0, 1)

    # Convert to ARSI
    df['ARSI'] = 100 - (100 / (1 + df['RS']))
    df['ARSI_vol_adj'] = df['ARSI'] * df['volume'].rolling(window=14).mean()

    # Calculate Intraday Price Movement Ratio
    df['high_low_ratio'] = df['high'] / df['low']
    df['open_close_ratio'] = df['close'] / df['open']
    df['avg_ratio'] = (df['high_low_ratio'] + df['open_close_ratio']) / 2

    # Measure Price-Volatility Alignment
    df['intraday_volatility'] = (df['high'] - df['low']) * df['volume']
    df['sentiment'] = np.where(df['intraday_volatility'] > df['avg_ratio'], 1, -1)

    # Calculate Short-Term and Long-Term Logarithmic Returns
    df['short_term_log_return'] = np.log(df['close'] / df['close'].shift(5))
    df['long_term_log_return'] = np.log(df['close'] / df['close'].shift(20))

    # Volume-Weighted Short-Term and Long-Term Logarithmic Returns
    df['vol_weighted_short_term_log_return'] = df['short_term_log_return'] * df['volume']
    df['vol_weighted_long_term_log_return'] = df['long_term_log_return'] * df['volume']

    # Calculate Short-Term Volatility
    df['atr_5'] = df[['high', 'low']].diff(axis=1).iloc[:, 0].abs().rolling(window=5).mean()

    # Adjust for Volatility
    df['adj_ratios'] = (df['vol_weighted_short_term_log_return'] / df['atr_5']) - df['vol_weighted_long_term_log_return']

    # Adjust based on Intraday Sentiment
    df['adj_ratios_sentiment'] = df['adj_ratios'] * df['sentiment']

    # Incorporate Momentum
    df['close_to_close_return'] = df['close'] - df['close'].shift(1)
    df['momentum_adjusted_ratios'] = df['adj_ratios_sentiment'] * df['close_to_close_return']

    # Final Volume Adjustment
    df['final_factor'] = df['momentum_adjusted_ratios'] / df['volume']

    # Calculate High-Low Spread
    df['high_low_spread'] = df['high'] - df['low']

    # Compute VWMA of High-Low Spread
    df['weighted_high_low_spread'] = df['high_low_spread'] * df['volume']
    df['vwm_high_low_spread'] = df['weighted_high_low_spread'].rolling(window=14).sum() / df['volume'].rolling(window=14).sum()

    # Incorporate Close-to-Close Return
    df['vwm_multiplied'] = df['vwm_high_low_spread'] * df['close_to_close_return']

    # Adjust with Volume Change
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['final_factor'] *= df['vwm_multiplied'] * df['volume_change']

    return df['final_factor']
```
