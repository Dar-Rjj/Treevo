```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Gain and Loss
    df['Gain'] = np.where(df['close'] > df['close'].shift(1), df['close'] - df['close'].shift(1), 0)
    df['Loss'] = np.where(df['close'] < df['close'].shift(1), df['close'].shift(1) - df['close'], 0)

    # Aggregate Gains and Losses over a period (e.g., 14 days)
    gain_sum = df['Gain'].rolling(window=14).sum()
    loss_sum = df['Loss'].rolling(window=14).sum()

    # Calculate Relative Strength
    rs = gain_sum / loss_sum

    # Convert to ARSI
    arsi = 100 - (100 / (1 + rs))

    # Adjust for Advanced Features
    arsi = arsi * df['volume'].rolling(window=14).mean() * (df['close'] / df['open'])

    # Calculate Short-Term Logarithmic Return
    short_term_log_return = np.log(df['close'] / df['close'].shift(5))

    # Calculate Long-Term Logarithmic Return
    long_term_log_return = np.log(df['close'] / df['close'].shift(20))

    # Calculate Volume-Weighted Short-Term Logarithmic Return
    vol_weighted_short_term_log_return = df['volume'] * short_term_log_return

    # Calculate Volume-Weighted Long-Term Logarithmic Return
    vol_weighted_long_term_log_return = df['volume'] * long_term_log_return

    # Calculate Short-Term Volatility
    true_range = df[['high', 'low']].rolling(window=5).apply(lambda x: x.max() - x.min(), raw=True)
    short_term_volatility = true_range.rolling(window=5).mean()

    # Adjust for Volatility
    adjusted_returns = (vol_weighted_short_term_log_return / short_term_volatility) - vol_weighted_long_term_log_return

    # Combine Intraday Price Movement Intensity and Momentum Sentiment
    high_low_spread = df['high'] - df['low']
    open_close_change = df['close'] - df['open']
    intraday_price_movement_intensity = high_low_spread + open_close_change

    intraday_volatility = (df['high'] - df['low']) / df['volume']
    momentum_sentiment = np.sign(df['close'].pct_change().corr(intraday_volatility, method='pearson'))
    combined_intensity_sentiment = intraday_price_movement_intensity * momentum_sentiment

    # Combine Intraday Price Movement Ratio and Sentiment
    high_low_ratio = df['high'] / df['low']
    open_close_ratio = df['close'] / df['open']
    intraday_price_movement_ratio = (high_low_ratio + open_close_ratio) / 2

    intraday_volatility_alignment = (df['high'] - df['low']) * df['volume']
    price_volatility_alignment = np.sign(intraday_price_movement_ratio.corr(intraday_volatility_alignment, method='pearson'))
    combined_ratio_sentiment = intraday_price_movement_ratio * price_volatility_alignment

    # Integrate Market Trend Indicator
    ma_50 = df['close'].rolling(window=50).mean()
    market_trend_indicator = np.where(df['close'] > ma_50, 1, -1)

    # Combine ARSI, Adjusted Returns, and Intraday Movements
    combined_factor = (arsi * adjusted_returns) + combined_intensity_sentiment + combined_ratio_sentiment
    combined_factor = combined_factor * market_trend_indicator

    # Final Adjustment
    final_factor = combined_factor + adjusted_returns

    return final_factor.dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
