def heuristics_v2(df):
    # Calculate the 21-day Rate of Change (ROC)
    roc = ((df['close'] - df['close'].shift(21)) / df['close'].shift(21)) * 100
    
    # Calculate the 30-day custom volatility as the standard deviation of daily returns
    daily_returns = df['close'].pct_change()
    volatility = daily_returns.rolling(window=30).std()
    
    # Combine ROC and custom volatility into a single heuristics measure
    heuristics_matrix = (roc + volatility) / 2

    return heuristics_matrix
