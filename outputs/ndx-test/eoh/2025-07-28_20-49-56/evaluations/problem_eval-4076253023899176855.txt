import pandas as pd

def heuristics_v2(df):
    def directional_movement(df, n=14):
        high = df['high'].rolling(window=n).max()
        low = df['low'].rolling(window=n).min()
        positive_dm = (high - high.shift(1)) * (high - high.shift(1) > low - low.shift(1))
        negative_dm = (low - low.shift(1)) * (low - low.shift(1) > high - high.shift(1))
        return positive_dm - negative_dm

    def cumulative_volume_change(df, n=14):
        return df['volume'].diff().rolling(window=n).sum()

    df['directional_movement'] = directional_movement(df)
    df['cumulative_volume_change'] = cumulative_volume_change(df)

    heuristics_matrix = (df['directional_movement'] + df['cumulative_volume_change']) / 2

    return heuristics_matrix
