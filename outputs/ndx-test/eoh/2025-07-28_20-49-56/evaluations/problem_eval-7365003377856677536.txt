def heuristics_v2(df):
    # Calculate the 10-day and 30-day EMA of the closing price
    ema_10 = df['close'].ewm(span=10, adjust=False).mean()
    ema_30 = df['close'].ewm(span=30, adjust=False).mean()

    # Compute the difference between the two EMAs
    ema_diff = ema_10 - ema_30

    # Calculate the 20-day moving average of the volume
    avg_volume = df['volume'].rolling(window=20).mean()

    # Compute the difference between the current volume and its 20-day average
    volume_diff = df['volume'] - avg_volume

    # Combine the EMA difference and volume difference into a composite score
    heuristics_matrix = 0.6 * ema_diff + 0.4 * volume_diff

    return heuristics_matrix
