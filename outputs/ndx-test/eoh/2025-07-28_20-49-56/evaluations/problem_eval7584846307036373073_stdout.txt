[*] Running ...
/home/rjj/reevo/problems/ndx/tmp/gpt_temp_1_cfad9eeb.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[3.4500e-01 7.7800e-01 1.3270e+00 7.1000e-01 7.2000e-01 9.4300e-01
 3.9750e+00 1.9930e+00 1.3520e+00 7.5000e-01 1.9350e+00 6.8000e-01
 1.0680e+00 1.0117e+01 5.2230e+00 4.0200e+00 7.9200e-01 2.7680e+00
 1.0880e+00 1.1630e+00 1.2300e+00 6.4750e+00 3.9170e+00 1.8130e+00
 4.5570e+00 3.8000e+00 1.5000e-01 7.0000e-01 2.9000e+00 2.6700e+00
 2.1900e+00 2.8800e+00 1.9500e+00 4.6000e-01 1.2800e+00 8.5000e-01
 6.0000e-01 8.1800e+00 2.1000e-01 3.5000e-01 7.3000e-01 1.5000e+00
 8.1000e-01 4.1000e+00 4.0300e+00 2.7900e+00 2.0400e+00 9.0000e-01
 1.3200e+00 9.0000e-01 7.4000e-01 3.4800e+00 2.5000e+00 4.1000e-01
 1.7100e+00 4.1000e-01 5.9000e-01 4.5500e+00 4.7000e-01 1.2100e+00
 6.1000e+00 1.0300e+00 3.8800e+00 1.4500e+00 5.8000e-01 1.0000e+00
 1.7600e+00 3.7800e+00 7.1800e+00 1.8000e-01 5.2400e+00 9.3000e-01
 1.6300e+00 2.2500e-01 9.1700e-01 7.1500e-01 3.0800e+00 7.9000e-01
 1.0600e+00 1.1000e-01 1.0400e+00 2.8300e+00 3.2200e+00 2.4400e+00
 3.7000e-01 1.1000e+00 3.1170e+00 6.6000e-01 1.9800e+00 9.7000e-01
 7.9000e-01 2.4700e+00 2.6500e+00 1.8100e+00 3.4000e-01 8.0000e-01
 4.0000e-01 9.7000e-01 3.5000e-01 2.0500e+00 5.1000e-01 1.7280e+00
 1.5100e+00 1.7400e+00 2.8050e+00 2.8000e-01 3.8000e-01 1.3100e+00
 1.6000e-01 2.1400e+00 3.1000e+00 6.0000e-02 1.6600e+00 1.6700e+00
 2.4000e-01 3.2000e-01 1.3550e+00 1.2450e+00 9.2000e-01 2.6700e+00
 3.1500e+00 1.7400e+00 1.5900e+00 6.7000e-01 1.1400e+00 2.1100e+00
 3.0300e+00 2.0650e+00 5.2300e-01 1.1120e+00 6.2000e-01 1.0950e+00
 1.0100e+00 2.3300e+00 3.9400e-01 4.9000e-01 5.0000e-01 1.6900e+00
 6.7000e-01 4.7400e+00 2.1800e+00 2.6300e+00 1.8300e+00 6.5000e-01
 3.9000e-01 3.0000e-02 2.0650e+00 2.4800e+00 1.0150e+00 1.9450e+00
 2.3300e+00 5.8400e-01 5.4000e-01 1.4700e+00 3.4350e+00 1.8700e+00
 4.0000e-01 4.6000e-01 9.7000e-01 1.4800e+00 3.5120e+00 3.6700e+00
 2.3500e+00 4.6800e+00 3.4000e-01 7.4000e-01 4.3300e+00 4.7800e+00
 7.6000e-01 2.9200e+00 3.7000e+00 4.3800e+00 7.9000e-01 2.8800e+00
 2.5000e+00 1.7600e+00 1.6400e+00 2.6200e+00 2.6600e+00 9.9000e-01
 3.5700e+00 9.1000e-01 3.6500e+00 6.0000e-02 2.6800e+00 2.0000e+00
 4.6000e-01 1.6290e+00 6.5100e+00 4.6500e+00 1.0400e+00 1.4040e+00
 1.3000e+00 3.3700e+00 3.9000e-01 2.2700e+00 3.0000e-01 1.1800e+00
 7.6000e-01 1.5500e+00 5.3000e-01 1.4500e+00 4.4300e+00 1.0000e+00
 3.4800e+00 1.8700e+00 3.0700e+00 3.2200e+00 1.5000e+00 1.1400e+00
 3.2800e+00 6.0000e-01 3.6100e+00 8.4000e-01 1.1700e+00 1.2220e+00
 1.0600e+00 2.6500e+00 4.7250e+00 1.6850e+00 2.4800e+00 5.7700e+00
 9.1000e-01 1.9050e+00 2.2500e+00 2.5600e+00 2.5550e+00 5.3400e+00
 9.8000e-01 1.0800e+00 5.9900e-01 8.7000e-01 3.4500e+00 6.8900e-01
 3.9810e+00 7.0000e-01 8.3000e-01 3.3200e+00 1.5800e+00 6.7000e-01
 2.5700e+00 2.5100e+00 2.4300e+00 1.0000e+00 1.8100e+00 2.5000e+00
 1.9100e+00 2.4900e+00 1.8500e+00 7.1000e-01 4.2450e+00 3.1000e-01
 5.9900e+00 4.1800e+00 6.0000e-01 1.9600e+00 3.5200e+00 1.6500e+00
 1.1800e+00 1.2200e+00 3.2000e-01 2.4400e+00 2.0300e+00 1.9420e+00
 1.4600e+00 6.4400e+00 3.2100e+00 3.5200e+00 6.6000e-01 2.3000e+00
 9.5000e-01 3.1500e+00 1.6000e-01 9.3000e-01 3.8000e+00 9.4100e-01
 1.9580e+00 2.3820e+00 2.2600e+00 8.4540e+00 2.2850e+00 8.3200e+00
 3.1400e+00 2.7000e-01 3.3100e+00 1.6100e+00 1.2200e+00 1.4100e+00
 3.9100e+00 4.1000e-01 2.9200e+00 1.5000e-01 2.0500e+00 5.4690e+00
 3.5600e+00 2.5200e+00 3.1200e+00 2.2460e+00 7.5000e-01 6.6000e-01
 2.3700e+00 1.3200e+00 1.7700e+00 5.2950e+00 1.8200e+00 2.9800e+00
 2.2700e+00 4.5700e+00 6.2000e+00 2.1300e+00 2.9200e+00 1.7300e+00
 8.3000e-01 3.9000e-01 1.9800e+00 4.4000e+00 5.1900e+00 2.2000e+00
 2.6000e-01 3.2150e+00 2.8000e-01 1.0800e+00 1.5800e+00 2.7400e+00
 4.3000e-01 2.5600e+00 1.4200e+00 2.5300e+00 1.2900e+00 5.5000e-01
 3.3000e-01 3.7400e+00 5.2000e-01 2.0200e+00 7.5000e-01 7.0500e-01
 3.2800e+00 1.2900e+00 6.0000e-01 5.7000e-01 7.2600e+00 4.9000e-01
 5.6000e-01 2.3150e+00 1.1500e+00 1.4770e+00 1.8750e+00 3.2200e+00
 3.6000e-01 7.7000e-01 1.6600e+00 3.1710e+00 1.0900e+00 1.3900e+00
 1.6600e+00 2.6000e-01 2.1300e+00 4.7000e-01 1.6350e+00 5.1500e-01
 4.9000e-01 3.4000e-01 1.5100e+00 1.7000e-01 4.4100e+00 6.5000e-01
 2.4000e+00 3.1400e+00 1.0000e-02 3.9000e+00 1.2000e+00 1.5600e+00
 2.4000e-01 6.6000e-01 1.0700e+00 1.0300e+00 1.5500e+00 3.8700e+00
 1.4400e+00 4.3100e+00 2.9500e+00 1.2700e+00 8.0000e-01 2.0290e+00
 3.9500e-01 2.8850e+00 2.5000e-01 7.7900e-01 1.0400e+00 1.2300e+00
 5.8000e-01 1.2400e+00 2.5400e+00 1.0600e+00 6.7000e-01 2.4900e+00
 2.6500e-01 2.2100e+00 3.3300e+00 3.5500e+00 2.6100e+00 3.0100e+00
 1.0100e+00 6.7000e-01 2.6850e+00 2.0800e+00 1.3900e+00 1.4600e+00
 1.5250e+00 1.4100e+00 4.1000e-01 1.0100e+00 1.2400e+00 4.3500e+00
 3.6000e-01 2.4000e-01 9.9000e-01 1.2300e+00 3.2800e+00 1.6200e+00
 3.2000e-01 1.1600e+00 2.8400e+00 1.2500e+00 6.5000e-01 6.2100e+00
 2.8100e+00 3.3800e+00 4.2000e-01 6.3000e-01 1.9200e+00 6.0000e-02
 1.7400e+00 6.9500e-01]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[(df['up_move'] > df['down_move']) & (df['up_move'] > 0), '+dm'] = df['up_move']
/home/rjj/reevo/problems/ndx/tmp/gpt_temp_1_cfad9eeb.py:10: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[1.38  0.585 0.065 0.14  4.593 2.865 0.232 0.293 0.892 0.883 0.885 1.25
 3.53  6.5   9.61  2.76  2.5   1.57  3.33  2.62  2.99  2.39  1.77  3.61
 1.3   0.03  1.47  3.15  0.03  1.86  0.31  1.4   3.44  4.48  0.4   0.535
 1.92  0.7   0.96  1.19  3.54  1.16  0.69  2.09  0.85  1.92  2.67  0.94
 1.68  4.96  2.05  1.73  1.64  1.76  0.06  0.96  3.71  6.49  1.    0.94
 1.45  0.63  0.078 0.902 3.32  2.06  3.2   7.21  1.69  3.17  3.22  1.05
 1.36  2.1   2.379 2.016 0.645 2.075 1.065 0.08  1.87  0.36  1.53  0.51
 1.03  1.385 5.13  0.84  2.665 4.04  0.52  0.68  0.39  1.92  1.34  0.53
 0.61  0.92  0.58  0.929 1.03  0.12  0.11  1.995 0.59  1.21  4.21  2.15
 3.01  0.47  0.11  0.32  0.11  1.8   2.94  1.65  1.35  0.29  0.68  0.415
 0.025 5.25  1.84  0.54  1.461 4.49  1.74  2.13  0.75  2.17  0.84  0.99
 0.16  0.75  0.77  1.84  0.25  1.019 0.52  3.307 0.36  0.1   2.21  0.169
 0.09  1.94  3.28  6.73  3.32  1.06  2.23  0.39  0.05  0.83  4.48  3.
 0.61  2.86  3.03  0.7   1.685 3.465 1.76  1.88  7.6   1.21  1.22  3.35
 3.51  1.48  1.58  2.28  4.04  2.4   7.75  3.45  3.06  3.24  3.43  1.48
 4.4   0.75  2.3   2.46  0.025 4.285 0.28  0.65  3.7   1.73  1.47  4.41
 3.04  1.74  1.34  3.98  4.31  0.54  2.69  7.12  7.01  6.78  3.3   3.99
 0.32  0.82  2.4   0.8   4.93  5.47  5.62  3.12  3.64  0.655 2.896 1.22
 2.93  1.5   1.13  1.48  1.26  1.2   0.95  1.81  4.175 0.485 0.405 4.79
 3.74  2.1   0.58  2.47  1.275 0.08  0.93  5.93  2.231 3.01  2.69  2.35
 5.105 4.16  2.68  0.315 1.25  5.775 0.872 0.353 0.06  3.79  1.32  3.91
 2.79  4.13  6.25  4.14  2.897 1.271 2.255 0.79  2.22  3.74  3.025 0.96
 3.85  1.92  3.08  5.135 2.295 2.41  1.43  2.45  0.66  0.92  2.85  0.3
 3.26  0.32  1.77  1.26  1.49  0.23  0.57  0.748 0.97  0.06  2.498 2.445
 1.245 1.52  0.62  1.82  1.11  2.33  1.605 2.615 0.18  0.13  1.89  3.31
 1.92  0.73  1.07  0.6   0.93  1.1   2.85  0.51  0.93  1.379 1.49  2.175
 0.755 0.605 0.42  1.82  1.14  1.42  3.205 0.435 0.15  0.155 1.265 3.429
 1.161 8.77  4.57  0.81  0.255 0.55  3.02  1.52  2.315 0.19  0.67  6.14
 7.93  0.45  2.52  0.84  0.4   1.73  1.54  2.49  2.61  1.43  0.11  0.35
 0.9   1.63  1.71  2.55  2.71  0.8   4.98  0.97  2.11  0.08  0.14  1.575
 0.35  0.78  1.779 2.25  2.61  1.06  1.33  0.53  0.14  1.74  1.445 7.84
 0.455 2.55  0.71  4.256 0.634 1.227 1.173 2.36  2.11  3.12  0.53  4.57
 1.26  1.21  3.277 1.073]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[(df['down_move'] > df['up_move']) & (df['down_move'] > 0), '-dm'] = df['down_move']
Traceback (most recent call last):
  File "/home/rjj/reevo/problems/ndx/eval.py", line 69, in <module>
    mean_ic = solve(market_data, heuristics)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/reevo/problems/ndx/eval.py", line 28, in solve
    market_data['factor'] = market_data.groupby('stock_code').apply(lambda x: heuristics(x)).reset_index(level=0, drop=True)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/groupby.py", line 1825, in apply
    result = self._python_apply_general(f, self._selected_obj)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/groupby.py", line 1886, in _python_apply_general
    values, mutated = self._grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/ops.py", line 919, in apply_groupwise
    res = f(group)
          ^^^^^^^^
  File "/home/rjj/reevo/problems/ndx/eval.py", line 28, in <lambda>
    market_data['factor'] = market_data.groupby('stock_code').apply(lambda x: heuristics(x)).reset_index(level=0, drop=True)
                                                                              ^^^^^^^^^^^^^
  File "/home/rjj/reevo/problems/ndx/tmp/gpt_temp_1_cfad9eeb.py", line 33, in heuristics_v2
    df['dmi'] = dmi(df)
                ^^^^^^^
  File "/home/rjj/reevo/problems/ndx/tmp/gpt_temp_1_cfad9eeb.py", line 13, in dmi
    di_pos = 100 * (df['+dm'].rolling(window=n).sum() / atr).replace([np.inf, -np.inf], 0).fillna(0)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/arraylike.py", line 214, in __rtruediv__
    return self._arith_method(other, roperator.rtruediv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/frame.py", line 7917, in _arith_method
    self, other = self._align_for_op(other, axis, flex=True, level=None)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/frame.py", line 8218, in _align_for_op
    left, right = left.align(
                  ^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/generic.py", line 10466, in align
    left, _right, join_index = self._align_series(
                               ^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/generic.py", line 10603, in _align_series
    join_index, lidx, ridx = join_index.join(
                             ^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 279, in join
    join_index, lidx, ridx = meth(self, other, how=how, level=level, sort=sort)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 4622, in join
    return self._join_multi(other, how=how)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 4746, in _join_multi
    raise ValueError("cannot join with no overlapping index names")
ValueError: cannot join with no overlapping index names
