def heuristics_v2(df):
    # Calculate the 30-day and 100-day moving averages for the closing price
    short_term_ma = df['close'].rolling(window=30).mean()
    long_term_ma = df['close'].rolling(window=100).mean()

    # Calculate the volatility using the standard deviation of the last 20 days
    volatility = df['close'].rolling(window=20).std()

    # Calculate the momentum as the difference between the current close and the close 90 days ago
    momentum = df['close'] - df['close'].shift(90)

    # Adjust the momentum by the volatility
    adjusted_momentum = momentum / volatility

    # Combine the MA difference and the adjusted momentum
    ma_diff = short_term_ma - long_term_ma
    heuristics_matrix = (ma_diff + adjusted_momentum) / 2

    return heuristics_matrix
