import pandas as pd

def heuristics_v2(df):
    # Calculate Bollinger Bands for a 14-day period
    df['middle_band'] = df['close'].rolling(window=14).mean()
    df['std_dev'] = df['close'].rolling(window=14).std()
    df['upper_band'] = df['middle_band'] + 2 * df['std_dev']
    df['lower_band'] = df['middle_band'] - 2 * df['std_dev']
    
    # Calculate the Moving Average Convergence Divergence (MACD)
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12 - ema_26
    signal = macd.ewm(span=9, adjust=False).mean()
    
    # Calculate the Stochastic Oscillator for a 14-day period
    low_14 = df['low'].rolling(window=14).min()
    high_14 = df['high'].rolling(window=14).max()
    k_percent = 100 * (df['close'] - low_14) / (high_14 - low_14)
    d_percent = k_percent.rolling(window=3).mean()
    
    # Combine Bollinger Bands (using the distance from the middle band), MACD, and Stochastic Oscillator into a single heuristic measure with weights
    bb_distance = abs(df['close'] - df['middle_band'])
    heuristics_matrix = (0.4 * bb_distance + 0.3 * macd + 0.3 * d_percent)
    
    return heuristics_matrix
