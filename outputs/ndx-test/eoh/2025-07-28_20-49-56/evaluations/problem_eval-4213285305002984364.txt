import pandas as pd

def heuristics_v2(df):
    # Calculate the MACD
    short_term_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_term_ema = df['close'].ewm(span=26, adjust=False).mean()
    macd_line = short_term_ema - long_term_ema
    
    # Calculate the On-Balance Volume (OBV)
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    obv = obv.cumsum()
    
    # Calculate the Williams %R
    l14 = df['low'].rolling(window=14).min()
    h14 = df['high'].rolling(window=14).max()
    williams_r = -100 * (h14 - df['close']) / (h14 - l14)
    
    # Combine MACD, OBV, and Williams %R into a single heuristic measure with different weights
    heuristics_matrix = (macd_line * 0.5 + obv * 0.3 + williams_r * 0.2)
    
    return heuristics_matrix
