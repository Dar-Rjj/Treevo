import pandas as pd

def heuristics_v2(df):
    # Calculate short and long term exponentially weighted moving averages for the closing price
    short_term_ewma = df['close'].ewm(span=20, adjust=False).mean()
    long_term_ewma = df['close'].ewm(span=100, adjust=False).mean()

    # Calculate the EWMA difference
    ewma_diff = short_term_ewma - long_term_ewma

    # Calculate the positive and negative volume over a 14-day window
    pos_volume = df['volume'].where(df['close'] > df['close'].shift(1), 0)
    neg_volume = df['volume'].where(df['close'] < df['close'].shift(1), 0)

    # Calculate the ratio of positive to negative volume
    vol_ratio = pos_volume.rolling(window=14).sum() / neg_volume.rolling(window=14).sum()

    # Combine the EWMA difference and the volume ratio
    heuristics_matrix = ewma_diff + vol_ratio

    return heuristics_matrix
