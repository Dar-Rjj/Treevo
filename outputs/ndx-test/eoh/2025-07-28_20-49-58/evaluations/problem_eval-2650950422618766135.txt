import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    
    # Calculate momentum (using 10-day simple moving average return)
    momentum = daily_returns.rolling(window=10).mean().fillna(0)
    
    # Calculate relative volume change
    volume_change = df['volume'].pct_change().fillna(0)
    
    # Calculate historical volatility of close prices (using 30-day rolling standard deviation of daily returns)
    volatility = daily_returns.rolling(window=30).std().fillna(0)
    
    # Weighted sum to generate heuristics matrix
    heuristics_matrix = (momentum * (1 - volatility)) + (volume_change * volatility)
    
    return heuristics_matrix
