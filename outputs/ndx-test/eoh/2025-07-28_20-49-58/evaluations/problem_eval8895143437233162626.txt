def heuristics_v2(df):
    def momentum(df, window):
        return df['close'].pct_change(window)

    def volatility(df, window):
        return df['close'].pct_change().rolling(window=window).std()

    def trading_activity(df, window):
        return df['volume'].rolling(window=window).mean()

    mom_5 = momentum(df, 5)
    mom_20 = momentum(df, 20)
    vol_5 = volatility(df, 5)
    vol_20 = volatility(df, 20)
    act_5 = trading_activity(df, 5)
    act_20 = trading_activity(df, 20)

    heuristics_matrix = (mom_5 + mom_20 + vol_5 + vol_20 + act_5 + act_20) / 6
    return heuristics_matrix
