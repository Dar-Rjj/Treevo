def heuristics_v2(df):
    def calculate_rsi(column, n=14):
        delta = column.diff()
        up = delta.clip(lower=0)
        down = -delta.clip(upper=0)
        ema_up = up.ewm(com=n-1, adjust=False).mean()
        ema_down = down.ewm(com=n-1, adjust=False).mean()
        rs = ema_up / ema_down
        rsi = 100 - (100 / (1 + rs))
        return rsi

    def calculate_volatility(column, n=20):
        return column.rolling(window=n).std()

    rsi = calculate_rsi(df['close'])
    volatility = calculate_volatility(df['close'])

    heuristics_matrix = rsi - volatility
    return heuristics_matrix
