def heuristics_v2(df):
    def calculate_roc(column, n):
        return (column - column.shift(n)) / column.shift(n)
    
    # Calculate 60-day EMA of the closing price
    ema_60 = df['close'].ewm(span=60, adjust=False).mean()
    
    # Calculate ROC over a 40-day period using EMA
    roc_ema = calculate_roc(ema_60, 40)
    
    # Calculate 20-day standard deviation of volume
    vol_std_20 = df['volume'].rolling(window=20).std()
    
    # Combine factors
    heuristics_matrix = roc_ema + (ema_60 - df['close']) - vol_std_20
    
    return heuristics_matrix
