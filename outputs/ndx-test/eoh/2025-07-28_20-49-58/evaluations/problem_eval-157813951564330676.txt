def heuristics_v2(df):
    def calculate_roc(column, n):
        return (column - column.shift(n)) / column.shift(n)
    
    # Calculate ROC over a 10-day period of the volume
    roc_volume = calculate_roc(df['volume'], 10)
    
    # Calculate 20-day SMA of the high price
    sma_high_20 = df['high'].rolling(window=20).mean()
    
    # Calculate 50-day SMA of the low price
    sma_low_50 = df['low'].rolling(window=50).mean()
    
    # Calculate 30-day momentum of the closing price
    momentum_30 = df['close'] - df['close'].shift(30)
    
    # Combine factors
    heuristics_matrix = roc_volume + (sma_high_20 - sma_low_50) + momentum_30
    
    return heuristics_matrix
