def heuristics_v2(df):
    def calculate_rsi(column, n):
        delta = column.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=n).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=n).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    # Calculate 14-day RSI
    rsi = calculate_rsi(df['close'], 14)

    # Calculate 50-day and 20-day cumulative volumes
    cum_vol_50 = df['volume'].rolling(window=50).sum()
    cum_vol_20 = df['volume'].rolling(window=20).sum()

    # Calculate the volume ratio
    vol_ratio = cum_vol_50 / cum_vol_20

    # Calculate 30-day MACD Line
    ema12 = df['close'].ewm(span=12, adjust=False).mean()
    ema26 = df['close'].ewm(span=26, adjust=False).mean()
    macd_line = ema12 - ema26

    # Combine factors
    heuristics_matrix = rsi + vol_ratio + macd_line

    return heuristics_matrix
