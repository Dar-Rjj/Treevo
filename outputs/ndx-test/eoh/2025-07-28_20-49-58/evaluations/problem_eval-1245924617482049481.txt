def heuristics_v2(df):
    def calculate_hl_diff(df):
        return df['high'] - df['low']

    hl_diff = calculate_hl_diff(df)
    hl_vol_adj = hl_diff * df['volume']
    heuristics_matrix = hl_vol_adj.ewm(span=10, adjust=False).mean()
    return heuristics_matrix
