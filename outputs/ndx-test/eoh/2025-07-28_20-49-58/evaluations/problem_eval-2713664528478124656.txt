def heuristics_v2(df):
    def calculate_roc(column, n):
        return (column - column.shift(n)) / column.shift(n)

    # Calculate 100-day EMA
    ema_100 = df['close'].ewm(span=100, adjust=False).mean()
    
    # Calculate ROC over a 30-day period
    roc_30 = calculate_roc(df['close'], 30)
    
    # Combine factors
    heuristics_matrix = (ema_100 - df['close']) + roc_30
    
    return heuristics_matrix
