import pandas as pd

def heuristics_v2(df):
    def calculate_rsi(column, n=14):
        delta = column.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=n).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=n).mean()
        rs = gain / loss
        rsi = 100 - (100 / (1 + rs))
        return rsi

    def calculate_macd_signal(close, fast_window=12, slow_window=26, signal_window=9):
        ema_fast = close.ewm(span=fast_window, adjust=False).mean()
        ema_slow = close.ewm(span=slow_window, adjust=False).mean()
        macd_line = ema_fast - ema_slow
        signal_line = macd_line.ewm(span=signal_window, adjust=False).mean()
        return signal_line

    rsi = calculate_rsi(df['close'])
    macd_signal = calculate_macd_signal(df['close'])

    heuristics_matrix = 0.5 * rsi + 0.5 * macd_signal
    return heuristics_matrix
