def heuristics_v2(df):
    def calculate_roc(column, n):
        return (column - column.shift(n)) / column.shift(n)

    # Calculate ROC of closing price over a 10-day period
    roc_close = calculate_roc(df['close'], 10)
    
    # Calculate 30-day simple moving average of the volume
    sma30_volume = df['volume'].rolling(window=30).mean()
    
    # Calculate 30-day median of the volume
    median30_volume = df['volume'].rolling(window=30).median()
    
    # Calculate the coefficient of variation of the closing price over a 5-day period
    mean_close_5 = df['close'].rolling(window=5).mean()
    std_close_5 = df['close'].rolling(window=5).std()
    cv_close = std_close_5 / mean_close_5
    
    # Combine factors
    heuristics_matrix = roc_close + (sma30_volume - median30_volume) + cv_close
    
    return heuristics_matrix
