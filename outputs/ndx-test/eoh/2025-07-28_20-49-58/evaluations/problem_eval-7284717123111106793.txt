def heuristics_v2(df):
    def calculate_momentum(column, n):
        return column - column.shift(n)

    def calculate_ppo(close, short_window=12, long_window=26):
        short_ema = close.ewm(span=short_window, adjust=False).mean()
        long_ema = close.ewm(span=long_window, adjust=False).mean()
        ppo = ((short_ema - long_ema) / long_ema) * 100
        return ppo

    momentum_short = calculate_momentum(df['close'], 5)
    momentum_medium = calculate_momentum(df['close'], 21)
    momentum_long = calculate_momentum(df['close'], 63)
    ppo = calculate_ppo(df['close'])

    heuristics_matrix = 0.1 * momentum_short + 0.2 * momentum_medium + 0.3 * momentum_long + 0.4 * ppo
    return heuristics_matrix
