def heuristics_v2(df):
    # Calculate 20-day SMA
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Calculate 50-day SMA
    sma_50 = df['close'].rolling(window=50).mean()
    
    # Calculate 30-day average volume
    avg_vol_30 = df['volume'].rolling(window=30).mean()
    
    # Combine factors
    heuristics_matrix = (sma_20 - sma_50) * (df['volume'] / avg_vol_30)
    
    return heuristics_matrix
