def heuristics_v2(df):
    def calculate_rsi(close, n=10):
        delta = close.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=n).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=n).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    def calculate_macd(close, short_window=9, long_window=21, signal_window=7):
        short_ema = close.ewm(span=short_window, adjust=False).mean()
        long_ema = close.ewm(span=long_window, adjust=False).mean()
        macd = short_ema - long_ema
        signal = macd.ewm(span=signal_window, adjust=False).mean()
        return macd - signal

    rsi = calculate_rsi(df['close'])
    macd = calculate_macd(df['close'])

    heuristics_matrix = 0.7 * rsi + 0.3 * macd
    return heuristics_matrix
