import pandas as pd

def heuristics_v2(df):
    def calculate_pct_change(column, n):
        return (column - column.shift(n)) / column.shift(n)

    # Calculate percentage change in volume over a 10-day period
    vol_pct_change = calculate_pct_change(df['volume'], 10)
    
    # Calculate 50-day EMA
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    
    # Combine factors
    heuristics_matrix = vol_pct_change + (df['close'] - ema_50)
    
    return heuristics_matrix
