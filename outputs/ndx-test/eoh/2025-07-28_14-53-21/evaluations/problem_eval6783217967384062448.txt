import pandas as pd

def heuristics_v2(df):
    def calculate_ema(series, window):
        return series.ewm(span=window, adjust=False).mean()

    short_window = 10
    medium_window = 30
    long_window = 90
    
    # Calculate exponential moving averages
    short_ema = calculate_ema(df['close'], short_window)
    medium_ema = calculate_ema(df['close'], medium_window)
    long_ema = calculate_ema(df['close'], long_window)
    
    # Calculate the average of EMAs
    ema_avg = (short_ema + medium_ema + long_ema) / 3
    
    # Calculate the average of high-low and open-close ranges over the past 5 days
    high_low_range = (df['high'] - df['low']).rolling(window=5).mean()
    open_close_range = (df['open'] - df['close']).rolling(window=5).mean()
    range_avg = (high_low_range + open_close_range) / 2
    
    # Compute the heuristics
    heuristics_matrix = ema_avg - range_avg
    
    return heuristics_matrix
