import pandas as pd
    
    def calculate_momentum(df, period):
        return df['close'].pct_change(period)
    
    def calculate_volatility(df, period):
        return df['close'].rolling(window=period).std() * df['volume']
    
    # Calculate momentum over 10, 30, and 60 days
    momentum_10 = calculate_momentum(df, 10)
    momentum_30 = calculate_momentum(df, 30)
    momentum_60 = calculate_momentum(df, 60)
    
    # Calculate volatility over 10, 30, and 60 days
    vol_10 = calculate_volatility(df, 10)
    vol_30 = calculate_volatility(df, 30)
    vol_60 = calculate_volatility(df, 60)
    
    # Dynamically adjust weights based on the last 5 days' performance
    adjustment_window = 5
    perf_10d = (df['close'] - df['close'].shift(adjustment_window)) / df['close'].shift(adjustment_window)
    weights = (perf_10d + 1) / (perf_10d + 1).sum()
    
    # Compute the composite factor
    heuristic_factor = (weights * momentum_10 + 
                       weights * momentum_30 + 
                       weights * momentum_60 -
                       weights * vol_10 - 
                       weights * vol_30 - 
                       weights * vol_60)
    
    heuristics_matrix = heuristic_factor
    return heuristics_matrix
