import pandas as pd

def heuristics_v2(df):
    def calculate_roc(series, window):
        return series.pct_change(window)

    short_window = 10
    medium_window = 30
    long_window = 90
    
    # Calculate ROCs
    short_roc = calculate_roc(df['close'], short_window)
    medium_roc = calculate_roc(df['close'], medium_window)
    long_roc = calculate_roc(df['close'], long_window)
    
    # Calculate Accumulation/Distribution Line
    adl = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    adl = adl * df['volume']
    adl = adl.cumsum()

    # Compute the heuristics
    heuristics_matrix = (short_roc * 0.4 + medium_roc * 0.3 + long_roc * 0.2) + adl
    
    return heuristics_matrix
