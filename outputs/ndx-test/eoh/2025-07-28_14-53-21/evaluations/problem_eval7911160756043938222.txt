import pandas as pd
import numpy as pd

def heuristics_v2(df):
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    ema_200 = df['close'].ewm(span=200, adjust=False).mean()
    ema_crossover = ema_50 - ema_200
    delta = df['close'].diff()
    gain_13 = (delta.where(delta > 0, 0)).rolling(window=13).mean()
    loss_13 = (-delta.where(delta < 0, 0)).rolling(window=13).mean()
    rs_13 = gain_13 / loss_13
    rsi_13 = 100 - (100 / (1 + rs_13))
    gain_21 = (delta.where(delta > 0, 0)).rolling(window=21).mean()
    loss_21 = (-delta.where(delta < 0, 0)).rolling(window=21).mean()
    rs_21 = gain_21 / loss_21
    rsi_21 = 100 - (100 / (1 + rs_21))
    rsi_diff = rsi_13 - rsi_21
    heuristics_matrix = (ema_crossover + rsi_diff) / 2
    return heuristics_matrix
