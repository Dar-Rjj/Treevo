def heuristics_v2(df):
    high_low = df['high'] - df['low']
    high_close = abs(df['high'] - df['close'].shift())
    low_close = abs(df['low'] - df['close'].shift())
    tr = pd.concat([high_low, high_close, low_close], axis=1).max(axis=1)
    atr_7 = tr.rolling(window=7).mean()
    atr_21 = tr.rolling(window=21).mean()
    atr_diff = atr_7 - atr_21
    wma_30 = df['close'].ewm(span=30, adjust=False).mean()
    wma_100 = df['close'].ewm(span=100, adjust=False).mean()
    wma_difference = wma_30 - wma_100
    heuristics_matrix = atr_diff + wma_difference
    return heuristics_matrix
