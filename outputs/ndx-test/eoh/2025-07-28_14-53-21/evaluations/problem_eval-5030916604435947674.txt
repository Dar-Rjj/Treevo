import pandas as pd

def heuristics_v2(df):
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    sma_crossover = sma_50 - sma_200
    delta = df['close'].diff()
    gain_13 = (delta.where(delta > 0, 0)).rolling(window=13).mean()
    loss_13 = (-delta.where(delta < 0, 0)).rolling(window=13).mean()
    rs_13 = gain_13 / loss_13
    rsi_13 = 100 - (100 / (1 + rs_13))
    gain_21 = (delta.where(delta > 0, 0)).rolling(window=21).mean()
    loss_21 = (-delta.where(delta < 0, 0)).rolling(window=21).mean()
    rs_21 = gain_21 / loss_21
    rsi_21 = 100 - (100 / (1 + rs_21))
    rsi_diff = rsi_13 - rsi_21
    momentum = df['close'] / df['close'].shift(90) * df['volume']
    heuristics_matrix = (sma_crossover + rsi_diff + momentum) / 3
    return heuristics_matrix
