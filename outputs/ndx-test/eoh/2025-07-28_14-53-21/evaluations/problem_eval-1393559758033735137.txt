def heuristics_v2(df):
    # Calculate 21-day simple moving average
    sma_21 = df['close'].rolling(window=21).mean()
    # Calculate rate of change (ROC) for the 21-day SMA
    roc_sma_21 = sma_21.pct_change()

    # Calculate Accumulation/Distribution Line (ADL)
    mfm = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    adl = (mfm * df['volume']).cumsum()

    # Calculate 3-day EMA of ADL
    ema_adl_3 = adl.ewm(span=3, adjust=False).mean()
    # Calculate 10-day EMA of ADL
    ema_adl_10 = adl.ewm(span=10, adjust=False).mean()

    # Calculate Chaikin Oscillator
    chaikin_oscillator = ema_adl_3 - ema_adl_10

    # Combine ROC of 21-day SMA and Chaikin Oscillator into a single heuristic factor
    heuristics_matrix = roc_sma_21 + chaikin_oscillator

    return heuristics_matrix
