def heuristics_v2(df):
    # Calculate 50-day and 200-day simple moving averages
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    sma_ratio = sma_50 / sma_200

    # Calculate Relative Strength Index (RSI)
    delta = df['close'].diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))

    # Calculate the Exponential Moving Average (EMA) of RSI
    ema_rsi = rsi.ewm(span=14, adjust=False).mean()

    # Combine SMA ratio and EMA of RSI into a single heuristic factor
    heuristics_matrix = sma_ratio * ema_rsi

    return heuristics_matrix
