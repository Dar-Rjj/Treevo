def heuristics_v2(df):
    # Calculate 30-day and 100-day simple moving averages
    sma_30 = df['close'].rolling(window=30).mean()
    sma_100 = df['close'].rolling(window=100).mean()
    sma_diff = sma_30 - sma_100

    # Calculate On-Balance Volume (OBV)
    obv = (df['volume'] * (df['close'] > df['close'].shift(1)).apply(lambda x: 1 if x else -1)).cumsum()

    # Combine SMA difference and OBV into a single heuristic factor
    heuristics_matrix = sma_diff + obv

    return heuristics_matrix
