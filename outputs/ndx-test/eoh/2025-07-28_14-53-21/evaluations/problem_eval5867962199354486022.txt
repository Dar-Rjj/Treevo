def heuristics_v2(df):
    # Calculate On-Balance Volume (OBV)
    obv = (df['close'].diff() > 0).astype(int) * df['volume'] - (df['close'].diff() < 0).astype(int) * df['volume']
    obv = obv.cumsum()
    
    # Calculate Bollinger Bands
    moving_avg = df['close'].rolling(window=20).mean()
    moving_std = df['close'].rolling(window=20).std()
    upper_band = moving_avg + 2 * moving_std
    lower_band = moving_avg - 2 * moving_std
    
    # Combine OBV and Bollinger Bands into a single heuristic factor
    heuristics_matrix = (obv / df['close']) + (upper_band - lower_band)
    
    return heuristics_matrix
