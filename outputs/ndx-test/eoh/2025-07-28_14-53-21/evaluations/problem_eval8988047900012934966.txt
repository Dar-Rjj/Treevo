import pandas as pd

def heuristics_v2(df):
    def bollinger_bands(series, window=20, num_std=2):
        sma = series.rolling(window=window, min_periods=1).mean()
        std = series.rolling(window=window, min_periods=1).std()
        upper_band = sma + (std * num_std)
        lower_band = sma - (std * num_std)
        bb_value = (series - lower_band) / (upper_band - lower_band)
        return bb_value

    def volume_adjustment(volume_series, window=20):
        vol_change = volume_series.pct_change(periods=window)
        vol_adjusted = (vol_change + 1).cumprod()
        return vol_adjusted

    close_prices = df['close']
    volume = df['volume']
    bb_values = bollinger_bands(close_prices)
    vol_adjusted = volume_adjustment(volume)
    heuristics_matrix = bb_values * vol_adjusted
    return heuristics_matrix
