def heuristics_v2(df):
    # Calculate 50-day and 200-day simple moving averages
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    sma_diff = sma_50 - sma_200

    # Calculate typical price and money flow
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    
    # Identify positive and negative money flows
    positive_money_flow = money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_money_flow = money_flow.where(typical_price < typical_price.shift(1), 0)
    
    # Calculate total money flow
    total_money_flow = positive_money_flow + negative_money_flow
    
    # Calculate the ratio of positive to total money flow
    pos_to_total_flow_ratio = positive_money_flow.rolling(window=14).sum() / total_money_flow.rolling(window=14).sum()

    # Combine SMA difference and positive to total flow ratio into a single heuristic factor
    heuristics_matrix = sma_diff + pos_to_total_flow_ratio

    return heuristics_matrix
