import pandas as pd

def heuristics_v2(df):
    def modified_macd(series, fast=15, slow=30, signal=9):
        exp1 = series.ewm(span=fast, adjust=False).mean()
        exp2 = series.ewm(span=slow, adjust=False).mean()
        macd = exp1 - exp2
        signal_line = macd.ewm(span=signal, adjust=False).mean()
        return macd - signal_line

    def stochastic_oscillator(high, low, close, k_period=14, d_period=3):
        lowest_low = low.rolling(window=k_period, min_periods=1).min()
        highest_high = high.rolling(window=k_period, min_periods=1).max()
        k = 100 * ((close - lowest_low) / (highest_high - lowest_low))
        d = k.rolling(window=d_period, min_periods=1).mean()
        return k, d
    
    close_prices = df['close']
    high_prices = df['high']
    low_prices = df['low']
    
    modified_macd_values = modified_macd(close_prices)
    k, d = stochastic_oscillator(high_prices, low_prices, close_prices)
    heuristics_matrix = 0.7 * modified_macd_values + 0.3 * (k - d)
    
    return heuristics_matrix
