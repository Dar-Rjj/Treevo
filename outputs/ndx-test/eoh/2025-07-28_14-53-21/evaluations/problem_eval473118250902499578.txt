def heuristics_v2(df):
    df['high_low_avg'] = (df['high'] + df['low']) / 2
    df['vol_adj_factor'] = df['high_low_avg'] * df['volume']
    heuristics_matrix = df.groupby(df.index).apply(lambda x: (x['close'] - x['open']) / x['vol_adj_factor'].mean())
    return heuristics_matrix
