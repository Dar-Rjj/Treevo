def heuristics_v2(df):
    def calculate_predictive_power(rolling_df):
        X = rolling_df[['open', 'high', 'low', 'close']].values
        y = rolling_df['volume'].values
        model = LinearRegression().fit(X, y)
        return model.coef_

    window_size = 30
    coefficients = df.rolling(window=window_size).apply(calculate_predictive_power, raw=False)
    heuristics_matrix = (df[['open', 'high', 'low', 'close']] * coefficients).sum(axis=1)
    return heuristics_matrix
