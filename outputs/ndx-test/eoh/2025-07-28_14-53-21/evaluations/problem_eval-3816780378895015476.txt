def heuristics_v2(df):
    # Calculate 14-day Stochastic Oscillator
    low_14 = df['low'].rolling(window=14).min()
    high_14 = df['high'].rolling(window=14).max()
    k_percent = 100 * (df['close'] - low_14) / (high_14 - low_14)

    # Calculate 30-day ADX
    tr = pd.DataFrame(index=df.index)
    tr['h-l'] = df['high'] - df['low']
    tr['h-pc'] = abs(df['high'] - df['close'].shift(1))
    tr['l-pc'] = abs(df['low'] - df['close'].shift(1))
    tr['tr'] = tr[['h-l', 'h-pc', 'l-pc']].max(axis=1)
    atr = tr['tr'].rolling(window=14).mean()

    dm_pos = df['high'].diff()
    dm_neg = -df['low'].diff()
    dm_pos[dm_pos < 0] = 0
    dm_neg[dm_neg < 0] = 0

    di_pos = 100 * (dm_pos.rolling(window=14).sum() / atr)
    di_neg = 100 * (dm_neg.rolling(window=14).sum() / atr)
    dx = 100 * (abs(di_pos - di_neg) / (di_pos + di_neg))
    adx = dx.rolling(window=30).mean()

    # Combine Stochastic Oscillator and ADX into a single heuristic factor
    heuristics_matrix = (k_percent + adx) / 2

    return heuristics_matrix
