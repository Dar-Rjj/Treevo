def heuristics_v2(df):
    # Calculate 30-day average price change
    price_change = df['close'].pct_change(30)
    
    # Calculate volume-weighted moving average
    vwma = (df['close'] * df['volume']).rolling(window=30).sum() / df['volume'].rolling(window=30).sum()
    
    # Combine the two factors
    heuristics_matrix = price_change * vwma
    
    return heuristics_matrix
