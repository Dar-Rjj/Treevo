def heuristics_v2(df):
    # Calculate Positive and Negative Volume Flow
    df['volume_change'] = df['volume'].diff()
    pos_volume_flow = (df['volume_change'] > 0) * df['volume']
    neg_volume_flow = (df['volume_change'] < 0) * df['volume']
    total_pos_volume = pos_volume_flow.rolling(window=30).sum()
    total_neg_volume = neg_volume_flow.rolling(window=30).sum().abs()
    volume_ratio = total_pos_volume / total_neg_volume

    # Calculate Aroon Oscillator
    df['aroon_up'] = df['high'].rolling(window=14).apply(lambda x: (x.argmax() - 13) / 13 * 100, raw=True)
    df['aroon_down'] = df['low'].rolling(window=14).apply(lambda x: (x.argmin() - 13) / 13 * 100, raw=True)
    aroon_oscillator = df['aroon_up'] - df['aroon_down']

    # Add Momentum Indicator
    sma_5 = df['close'].rolling(window=5).mean()
    sma_20 = df['close'].rolling(window=20).mean()
    momentum_indicator = sma_5 - sma_20

    # Combine all factors into a single heuristic factor
    heuristics_matrix = volume_ratio + aroon_oscillator + momentum_indicator

    return heuristics_matrix
