import pandas as pd

def heuristics_v2(df):
    # Calculate VWAP for 10 and 30 days
    vwap_10 = (df['close'] * df['volume']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    vwap_30 = (df['close'] * df['volume']).rolling(window=30).sum() / df['volume'].rolling(window=30).sum()
    vwap_crossover = vwap_10 - vwap_30
    
    # Calculate ADL
    adl = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    adl_cumulative = adl.cumsum()
    
    # Calculate 7-day and 28-day ADL differences
    adl_7 = adl_cumulative.diff(periods=7)
    adl_28 = adl_cumulative.diff(periods=28)
    adl_diff = adl_7 - adl_28
    
    # Combine all factors into a single heuristic factor
    heuristics_matrix = vwap_crossover + adl_diff
    
    return heuristics_matrix
