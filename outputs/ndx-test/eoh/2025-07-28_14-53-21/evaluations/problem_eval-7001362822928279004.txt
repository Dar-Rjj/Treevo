def heuristics_v2(df):
    def calculate_momentum(price_series, window=10):
        return price_series.pct_change(window)

    def calculate_mean_reversion(price_series, window=20):
        return (price_series - price_series.rolling(window=window).mean()) / price_series.rolling(window=window).std()

    def calculate_volatility(price_series, window=20):
        return price_series.pct_change().rolling(window=window).std()

    close_prices = df['close']
    
    momentum_signal = calculate_momentum(close_prices)
    mean_reversion_signal = calculate_mean_reversion(close_prices)
    volatility_weight = 1 / calculate_volatility(close_prices)
    
    # Combining the signals with their weights
    combined_signal = (momentum_signal + mean_reversion_signal) * volatility_weight
    
    heuristics_matrix = pd.Series(combined_signal, index=df.index, name='heuristic_factor')
    return heuristics_matrix
