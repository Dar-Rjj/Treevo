def heuristics_v2(df):
    sma_20 = df['close'].rolling(window=20).mean()
    sma_60 = df['close'].rolling(window=60).mean()
    sma_ratio = sma_20 / sma_60
    tr = df['high'] - df['low']
    atr = tr.rolling(window=14).mean()
    vol_scaled_atr = np.log(df['volume']) * atr
    heuristics_matrix = (sma_ratio + vol_scaled_atr) / 2
    return heuristics_matrix
