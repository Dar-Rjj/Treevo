def heuristics_v2(df):
    # Calculate Momentum
    momentum = df['close'].pct_change(periods=10)

    # Calculate Cumulative Volume Flow
    df['volume_change'] = df['volume'].diff()
    pos_volume_flow = (df['volume_change'] > 0) * df['volume']
    neg_volume_flow = (df['volume_change'] < 0) * df['volume']
    total_pos_volume = pos_volume_flow.rolling(window=20).sum()
    total_neg_volume = neg_volume_flow.rolling(window=20).sum().abs()
    cum_volume_flow = total_pos_volume - total_neg_volume

    # Calculate Average True Range
    tr = df['high'] - df['low']
    tr = tr.rolling(window=14).mean()

    # Combine all factors into a single heuristic factor
    heuristics_matrix = momentum + cum_volume_flow + tr

    return heuristics_matrix
