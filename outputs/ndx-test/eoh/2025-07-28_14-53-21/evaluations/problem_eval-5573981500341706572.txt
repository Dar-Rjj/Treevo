def heuristics_v2(df):
    # Calculate the 20-day standard deviation of log returns as a measure of volatility
    log_returns = (df['close'] / df['close'].shift(1)).apply(np.log)
    volatility = log_returns.rolling(window=20).std()
    
    # Calculate the trend-following measure using the 50-day moving average of closing prices
    trend_following = df['close'] - df['close'].rolling(window=50).mean()
    
    # Adjust for trading volume by considering the ratio of current volume to 20-day average volume
    volume_adjustment = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Combine the volatility, trend-following, and volume adjustment into a single heuristic factor
    heuristics_matrix = (volatility + trend_following) * volume_adjustment
    
    return heuristics_matrix
