def heuristics_v2(df):
    # Calculate RSI using Wilder's smoothing
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).apply(lambda x: x.mean() if len(x) < 14 else (x[:-1].mean() * 13 + x[-1]) / 14)
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).apply(lambda x: x.mean() if len(x) < 14 else (x[:-1].mean() * 13 + x[-1]) / 14)
    avg_gain = gain.rolling(window=14).mean().shift(1).fillna(gain.rolling(window=14).mean())
    avg_loss = loss.rolling(window=14).mean().shift(1).fillna(loss.rolling(window=14).mean())
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))

    # Calculate logarithmic price-to-volume ratio
    log_price_to_volume = np.log(df['close'] / df['volume'])

    # Momentum as 14-day return
    momentum = df['close'].pct_change(periods=14)

    # Combine RSI, log price-to-volume, and momentum into a single heuristic factor
    heuristics_matrix = (rsi + log_price_to_volume + momentum) / 3

    return heuristics_matrix
