import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily log returns
    daily_log_returns = np.log(df['close']).diff()
    # Sum the positive daily log returns over the past 30 days
    positive_log_returns_sum = daily_log_returns.rolling(window=30).apply(lambda x: x[x > 0].sum(), raw=False)
    # Create a Series for the heuristic factor
    heuristics_matrix = pd.Series(positive_log_returns_sum, index=df.index)
    return heuristics_matrix
