def heuristics_v2(df):
    daily_returns = df['close'].pct_change()
    pos_return_sum_10 = daily_returns[daily_returns > 0].rolling(window=10).sum().fillna(0)
    abs_return_sum_30 = daily_returns.abs().rolling(window=30).sum().fillna(0)
    heuristics_matrix = pos_return_sum_10 / abs_return_sum_30
    return heuristics_matrix
