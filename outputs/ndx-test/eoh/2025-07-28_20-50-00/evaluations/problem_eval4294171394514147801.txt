import pandas as pd

def heuristics_v2(df):
    def calculate_momentum(series, window=20):
        return series / series.shift(window) - 1

    def calculate_volume_ratio(series, window=10):
        return series / series.rolling(window).mean()

    momentum = calculate_momentum(df['close'])
    volume_ratio = calculate_volume_ratio(df['volume'])

    heuristics_matrix = (momentum + volume_ratio) / 2
    
    return heuristics_matrix
