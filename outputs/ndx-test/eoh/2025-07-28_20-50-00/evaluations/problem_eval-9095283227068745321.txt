def heuristics_v2(df):
    min_50 = df['close'].rolling(window=50).min()
    max_50 = df['close'].rolling(window=50).max()
    close_to_range_ratio = (df['close'] - min_50) / (max_50 - min_50)
    volume_change = df['volume'].pct_change().fillna(0)
    heuristics_matrix = close_to_range_ratio * (1 + volume_change)
    return heuristics_matrix
