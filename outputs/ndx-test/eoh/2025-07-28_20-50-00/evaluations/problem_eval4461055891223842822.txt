import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 10-day momentum of daily closing prices
    momentum = df['close'].pct_change(periods=10)
    
    # Calculate the True Range
    tr1 = df['high'] - df['low']
    tr2 = abs(df['high'] - df['close'].shift())
    tr3 = abs(df['low'] - df['close'].shift())
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    
    # Calculate the 30-day Average True Range
    atr = true_range.rolling(window=30).mean()
    
    # Compute the heuristic factor
    heuristic_factor = momentum / atr
    
    # Create a Series for the heuristic factor, ensuring it is indexed correctly
    heuristics_matrix = pd.Series(heuristic_factor, index=df.index)
    return heuristics_matrix
