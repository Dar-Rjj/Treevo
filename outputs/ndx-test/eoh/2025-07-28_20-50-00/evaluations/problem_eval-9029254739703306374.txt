import pandas as pd

def heuristics_v2(df):
    def calculate_ema(series, span):
        return series.ewm(span=span, adjust=False).mean()
    
    # Calculate MACD
    ema_short = calculate_ema(df['close'], 12)
    ema_long = calculate_ema(df['close'], 26)
    macd_line = ema_short - ema_long
    signal_line = calculate_ema(macd_line, 9)
    macd_histogram = macd_line - signal_line
    
    # Calculate OBV
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume']
    obv -= (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    obv.cumsum()
    
    # Composite heuristic
    heuristics_matrix = macd_histogram + obv
    
    return heuristics_matrix
