def heuristics_v2(df):
    weighted_avg = (df['high'] + df['low']) / 2 * df['volume']
    smoothed_avg = weighted_avg.ewm(span=10).mean()
    heuristics_matrix = (df['close'] - smoothed_avg) / df['volume']
    return heuristics_matrix
