import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    returns = df['close'].pct_change()
    
    # Calculate the rolling standard deviation (volatility) of returns over a 30-day window
    volatility = returns.rolling(window=30).std()
    
    # Calculate the rolling skewness of returns over a 30-day window
    skewness = returns.rolling(window=30).skew()
    
    # Calculate the momentum by comparing the current close price to the close price 10 days ago
    momentum = df['close'] / df['close'].shift(10)
    
    # Combine the factors into a heuristics matrix
    heuristics_matrix = (volatility + skewness + momentum).rank(pct=True)
    
    return heuristics_matrix
