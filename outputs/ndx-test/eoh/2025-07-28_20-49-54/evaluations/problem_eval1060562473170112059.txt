import pandas as pd

def heuristics_v2(df):
    # Initialize an empty DataFrame to store the correlation scores
    corr_scores = pd.DataFrame(index=df.index)
    
    # Calculate the rolling 21-day correlation for each pair of columns
    for col1 in df.columns:
        for col2 in df.columns:
            if col1 != col2:
                corr_label = f'{col1}_corr_{col2}'
                corr_scores[corr_label] = df[col1].rolling(window=21).corr(df[col2])
    
    # Compute the sum of positive and negative correlations for each row
    pos_corr_sum = (corr_scores > 0).multiply(corr_scores).sum(axis=1)
    neg_corr_sum = (corr_scores < 0).multiply(corr_scores).sum(axis=1)
    
    # Generate the heuristic score
    heuristics_matrix = pos_corr_sum - neg_corr_sum
    
    return heuristics_matrix
