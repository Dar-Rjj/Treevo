import pandas as pd

def heuristics_v2(df):
    price_range = df['high'] - df['low']
    price_ratio = price_range / df['close']
    daily_returns = df['close'].pct_change()
    volatility_ema = daily_returns.rolling(window=30).std().ewm(span=30, adjust=False).mean()
    price_ratio_ema = price_ratio.ewm(span=30, adjust=False).mean()
    heuristics_matrix = (price_ratio_ema + volatility_ema)
    return heuristics_matrix
