import pandas as pd

def heuristics_v2(df):
    # Calculate the 20-day rate of change (ROC) for the closing price
    roc_20 = df['close'].pct_change(periods=20)
    
    # Calculate the 20-day standard deviation of the daily returns as a measure of volatility
    volatility = df['close'].pct_change().rolling(window=20).std()
    
    # Combine ROC and volatility into a composite factor
    composite_factor = roc_20 - volatility
    
    # Rank the composite factor
    heuristics_matrix = composite_factor.rank(pct=True)
    
    return heuristics_matrix
