import pandas as pd

def heuristics_v2(df):
    # Calculate the 5-day percentage change in closing price
    pct_change_5d = df['close'].pct_change(periods=5)
    
    # Calculate the 30-day average volume
    avg_volume_30d = df['volume'].rolling(window=30).mean()
    
    # Calculate the volume ratio
    volume_ratio = df['volume'] / avg_volume_30d
    
    # Apply a custom heuristic to combine the 5-day percentage change and volume ratio
    heuristics_matrix = (pct_change_5d + volume_ratio).rank(pct=True)
    
    return heuristics_matrix
