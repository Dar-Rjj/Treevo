import pandas as pd

def heuristics_v2(df):
    # Calculate the momentum (rate of change) using the close prices
    momentum = df['close'].pct_change(periods=14)
    
    # Calculate the 20-day simple moving average of the close price
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Calculate the ratio of closing price to its 20-day moving average
    ca_ratio = df['close'] / sma_20
    
    # Apply a custom heuristic: combining momentum and the close-to-average price ratio
    heuristics_matrix = (momentum + ca_ratio).rank(pct=True)

    return heuristics_matrix
