def heuristics_v2(df):
    short_sma = df['close'].rolling(window=10).mean()
    long_sma = df['close'].rolling(window=20).mean()
    daily_return_5day_avg = df['close'].pct_change().rolling(window=5).mean()
    pv_momentum_smoothed = (df['close'] * df['volume']).rolling(window=7).sum() / df['volume'].rolling(window=7).sum()
    sma_ratio = short_sma / long_sma
    heuristics_matrix = (sma_ratio + daily_return_5day_avg + pv_momentum_smoothed).rank(pct=True)
    return heuristics_matrix
