def heuristics_v2(df):
    # Calculate the difference between the high and low prices over the past 15 days
    diff_high_low = df['high'].rolling(window=15).max() - df['low'].rolling(window=15).min()
    # Apply a 20-day exponential moving average for smoothing the factor values
    smoothed_factor = diff_high_low.ewm(span=20).mean()
    heuristics_matrix = smoothed_factor.dropna()
    return heuristics_matrix
