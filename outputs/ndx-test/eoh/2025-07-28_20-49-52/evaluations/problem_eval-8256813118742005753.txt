def heuristics_v2(df):
    def sma(series, window):
        return series.rolling(window=window).mean()

    def roc(series, period):
        return series.pct_change(periods=period)

    df['SMA_20'] = sma(df['close'], 20)
    df['SMA_50'] = sma(df['close'], 50)
    diff_sma = df['SMA_20'] - df['SMA_50']
    heuristics_matrix = roc(diff_sma, 10)
    return heuristics_matrix
