import pandas as pd

def heuristics_v2(df):
    # Calculate rolling standard deviation over a 30-day window for volatility
    vol = df.rolling(window=30).std()
    
    # Normalize the volatility to sum up to 1 for each row
    weights = vol.divide(vol.sum(axis=1), axis=0)
    
    # Compute the weighted sum of the original dataframe with these weights
    weighted_sum = (df * weights).sum(axis=1)
    
    # Smooth the result using a 5-day simple moving average
    heuristics_matrix = weighted_sum.rolling(window=5).mean()
    
    return heuristics_matrix
