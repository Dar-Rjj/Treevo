def heuristics_v2(df):
    # Calculate the weighted moving average of the last 10 days' closing prices
    weights = list(range(1, 11))
    wma_last_10_close = df['close'].rolling(window=10).apply(lambda x: (x * weights).sum() / sum(weights), raw=True)
    # Calculate the exponential moving average of the next 10 days' volumes
    ema_next_10_volume = df['volume'].shift(-10).ewm(span=10).mean()
    # Calculate the factor as the ratio of the two calculated values
    factor_values = wma_last_10_close / ema_next_10_volume
    heuristics_matrix = factor_values.dropna()
    return heuristics_matrix
