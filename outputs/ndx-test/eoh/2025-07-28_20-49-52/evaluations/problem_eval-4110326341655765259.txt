def heuristics_v2(df):
    short_window = 5
    long_window = 20
    short_mavg = df['close'].rolling(window=short_window, min_periods=1).mean()
    long_mavg = df['close'].rolling(window=long_window, min_periods=1).mean()
    mavg_ratio = short_mavg / long_mavg

    df['volume_change'] = df['volume'].pct_change().fillna(0)
    volume_change_threshold = 3
    high_volume_change = (df['volume_change'] > volume_change_threshold).astype(int)

    df['signal'] = 0
    df.loc[(mavg_ratio > 1) & (high_volume_change == 1), 'signal'] = 1
    df.loc[(mavg_ratio < 1) & (high_volume_change == 1), 'signal'] = -1

    heuristics_matrix = df['signal']
    
    return heuristics_matrix
