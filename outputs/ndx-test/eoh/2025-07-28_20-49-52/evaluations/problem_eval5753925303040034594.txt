def heuristics_v2(df):
    # Calculate the weighted sum of the last 10 days' closing prices
    weights = [1.0 / (i + 1) for i in range(10)]
    weighted_sum_last_10_close = df['close'].rolling(window=10).apply(lambda x: (x * weights).sum(), raw=True)
    # Calculate the weighted sum of the next 10 days' opening prices
    weighted_sum_next_10_open = df['open'].shift(-10).rolling(window=10).apply(lambda x: (x * weights[::-1]).sum(), raw=True)
    # Calculate the factor as the difference between the two weighted sums
    factor_values = weighted_sum_last_10_close - weighted_sum_next_10_open
    # Apply a rolling median for smoothing the factor values
    smoothed_factor = factor_values.rolling(window=10).median()
    heuristics_matrix = smoothed_factor.dropna()
    return heuristics_matrix
