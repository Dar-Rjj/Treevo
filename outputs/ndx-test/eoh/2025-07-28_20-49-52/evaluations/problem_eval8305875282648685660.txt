def heuristics_v2(df):
    # Calculate the WMA of the last 10 days' low prices
    wma_last_10_low = df['low'].rolling(window=10).apply(lambda x: (x * range(1, 11)).sum() / sum(range(1, 11)), raw=True)
    # Calculate the WMA of the next 10 days' volume
    wma_next_10_volume = df['volume'].shift(-10).rolling(window=10).apply(lambda x: (x * range(1, 11)).sum() / sum(range(1, 11)), raw=True)
    # Calculate the factor as the ratio of the two WMAs
    factor_values = wma_last_10_low / wma_next_10_volume
    # Apply a simple moving average for smoothing the factor values
    smoothed_factor = factor_values.rolling(window=20).mean()
    heuristics_matrix = smoothed_factor.dropna()
    return heuristics_matrix
