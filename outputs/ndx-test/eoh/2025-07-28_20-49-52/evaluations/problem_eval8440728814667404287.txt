def heuristics_v2(df):
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    # Calculate the 10-day simple moving average of daily returns
    sma_10_returns = daily_returns.rolling(window=10).mean()
    # Calculate the 30-day simple moving average of daily volumes
    sma_30_volumes = df['volume'].rolling(window=30).mean()
    # Calculate the factor as the difference between the two SMAs
    factor_values = sma_10_returns - sma_30_volumes
    # Apply a weighted moving average for smoothing the factor values
    smoothed_factor = factor_values.rolling(window=10, win_type='gaussian').mean(std=5)
    heuristics_matrix = smoothed_factor.dropna()
    return heuristics_matrix
