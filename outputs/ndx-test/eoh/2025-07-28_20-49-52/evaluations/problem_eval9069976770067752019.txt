def heuristics_v2(df):
    # Calculate the weighted sum of the last 15 days' high prices
    weights = [1.0 / (i + 1) for i in range(15)]
    weighted_sum_last_15_high = df['high'].rolling(window=15).apply(lambda x: (x * weights).sum(), raw=True)
    # Calculate the weighted sum of the next 15 days' low prices
    weighted_sum_next_15_low = df['low'].shift(-15).rolling(window=15).apply(lambda x: (x * weights[::-1]).sum(), raw=True)
    # Calculate the factor as the difference between the two weighted sums
    factor_values = weighted_sum_last_15_high - weighted_sum_next_15_low
    # Apply a rolling mean for smoothing the factor values
    smoothed_factor = factor_values.rolling(window=15).mean()
    heuristics_matrix = smoothed_factor.dropna()
    return heuristics_matrix
