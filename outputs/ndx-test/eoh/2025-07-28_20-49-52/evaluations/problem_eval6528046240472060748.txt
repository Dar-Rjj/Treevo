import pandas as pd

def heuristics_v2(df):
    def ema(series, span):
        return series.ewm(span=span, adjust=False).mean()

    def roc(series, period):
        return series.pct_change(periods=period)
    
    df['EMA_10'] = ema(df['close'], 10)
    heuristics_matrix = roc(df['EMA_10'], 3)
    return heuristics_matrix
