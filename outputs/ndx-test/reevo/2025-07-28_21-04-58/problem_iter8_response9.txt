```python
def heuristics_v2(df: pd.DataFrame, macroeconomic_data: pd.DataFrame) -> pd.Series:
    # Ensure the DataFrame is in the correct order
    df = df.sort_index()
    
    # Calculate the 5-day return as a momentum indicator
    df['momentum_5'] = df['close'] / df['close'].shift(5) - 1
    
    # Calculate the volume-weighted average price over the last 10 days
    df['vwap_10'] = (df['close'] * df['volume']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    
    # Calculate the 10-day price volatility
    df['volatility_10'] = df['close'].pct_change().rolling(window=10).std()
    
    # Calculate the 10-day moving average of the close price
    df['ma_10'] = df['close'].rolling(window=10).mean()
    
    # Calculate the 30-day moving average of the close price
    df['ma_30'] = df['close'].rolling(window=30).mean()
    
    # Calculate the interaction between the momentum and the relative position of the 10-day MA to the 30-day MA
    df['trend_strength'] = (df['ma_10'] - df['ma_30']) / df['close']
    
    # Calculate the 20-day high-low range to capture price movement
    df['range_20'] = df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min()
    
    # Calculate the 50-day high-low range to capture longer-term price movement
    df['range_50'] = df['high'].rolling(window=50).max() - df['low'].rolling(window=50).min()
    
    # Calculate the 50-day volume trend
    df['volume_trend'] = df['volume'].rolling(window=50).mean() / df['volume'].rolling(window=200).mean()
    
    # Incorporate seasonality
    df['month'] = df.index.month
    df['day_of_week'] = df.index.dayofweek
    df['day_of_month'] = df.index.day
    
    # Merge with macroeconomic data
    df = df.merge(macroeconomic_data, left_index=True, right_index=True, how='left')
    
    # Feature selection and weighting using machine learning (e.g., Random Forest)
    from sklearn.ensemble import RandomForestRegressor
    from sklearn.model_selection import train_test_split
    from sklearn.metrics import mean_squared_error
    
    # Prepare the feature matrix and target variable
    X = df[['momentum_5', 'vwap_10', 'volatility_10', 'trend_strength', 'range_20', 'range_50', 'volume_trend', 'month', 'day_of_week', 'day_of_month', 'inflation_rate', 'unemployment_rate', 'interest_rate']].dropna()
    y = df['close'].pct_change().shift(-1).loc[X.index]
    
    # Split the data into training and testing sets
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
    
    # Train the Random Forest model
    rf = RandomForestRegressor(n_estimators=100, random_state=42)
    rf.fit(X_train, y_train)
    
    # Predict the factor values
    factor_values = rf.predict(X)
    
    # Rank the factors
    factor = pd.Series(factor_values, index=X.index).rank(pct=True)
    
    return factor
```
