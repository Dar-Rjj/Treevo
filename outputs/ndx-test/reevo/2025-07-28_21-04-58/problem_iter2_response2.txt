```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the momentum based on the price difference between current and 5 days ago
    momentum = df['close'] - df['close'].shift(5)
    
    # Calculate the average volume over the last 10 days
    avg_volume = df['volume'].rolling(window=10).mean()
    
    # Calculate the daily return
    daily_return = df['close'].pct_change()
    
    # Calculate the volatility (standard deviation of daily returns over the last 30 days)
    volatility = daily_return.rolling(window=30).std()
    
    # Create a factor that considers high momentum stocks with relatively lower volume and lower volatility
    factor = (momentum / (avg_volume + 1e-7)) * (1 / (volatility + 1e-7))
    
    # Rank the factor in percentile
    factor_rank = factor.rank(pct=True)
    
    return factor_rank
```
