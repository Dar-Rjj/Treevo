```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price and volume changes
    df['price_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()

    # Calculate the weighted moving average of price and volume changes
    df['wma_price_change'] = df['price_change'].rolling(window=10).mean()
    df['wma_volume_change'] = df['volume_change'].rolling(window=10).mean()

    # Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10'] = df['close'].rolling(window=10).mean()
    df['ma_30'] = df['close'].rolling(window=30).mean()

    # Calculate the relative position of the 10-day MA to the 30-day MA
    df['trend_strength'] = (df['ma_10'] - df['ma_30']) / df['close']

    # Calculate the 10-day price volatility
    df['volatility'] = df['close'].pct_change().rolling(window=10).std()

    # Alpha factor: the product of the weighted moving averages of price and volume changes, adjusted by trend strength and volatility
    df['alpha_factor'] = df['wma_price_change'] * df['wma_volume_change'] * df['trend_strength'] / (df['volatility'] + 1e-7)

    return df['alpha_factor']
```
