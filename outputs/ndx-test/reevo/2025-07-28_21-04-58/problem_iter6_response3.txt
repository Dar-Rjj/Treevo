```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price and volume changes
    df['price_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()

    # Calculate the weighted moving average of price and volume changes
    df['wma_price_change'] = (df['price_change'] * df['volume']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    df['wma_volume_change'] = (df['volume_change'] * df['volume']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()

    # Calculate the 10-day and 30-day exponential moving averages of the close price
    df['ema_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['ema_30'] = df['close'].ewm(span=30, adjust=False).mean()

    # Calculate the relative position of the 10-day EMA to the 30-day EMA
    df['trend_strength'] = (df['ema_10'] - df['ema_30']) / df['close']

    # Calculate the 10-day GARCH volatility
    from arch import arch_model
    model = arch_model(df['price_change'].dropna(), vol='Garch', p=1, q=1, dist='Normal')
    fitted_model = model.fit(disp='off')
    df['garch_volatility'] = fitted_model.conditional_volatility

    # Detect volume anomalies using Z-score
    df['volume_zscore'] = (df['volume'] - df['volume'].rolling(window=20).mean()) / df['volume'].rolling(window=20).std()

    # Alpha factor: the product of the weighted moving averages of price and volume changes, adjusted by trend strength, GARCH volatility, and volume anomaly
    df['alpha_factor'] = df['wma_price_change'] * df['wma_volume_change'] * df['trend_strength'] / (df['garch_volatility'] + 1e-7) * (1 + df['volume_zscore'])

    return df['alpha_factor']
```
