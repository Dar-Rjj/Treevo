```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=14):
    # Calculate the weighted average of close prices over the last N days
    df['weighted_close'] = df['close'].rolling(window=N).apply(lambda x: (np.arange(1, len(x) + 1) * x).sum() / (len(x) * (len(x) + 1) / 2), raw=True)
    
    # High-low spread
    df['high_low_spread'] = df['high'] - df['low']
    
    # Average True Range (ATR) over the past M days
    df['tr'] = np.maximum(np.maximum(df['high'] - df['low'], np.abs(df['high'] - df['close'].shift())), np.abs(df['low'] - df['close'].shift()))
    df['atr'] = df['tr'].rolling(window=M).mean()
    
    # Factor measuring the ratio of the high-low spread to the ATR
    df['high_low_atr_ratio'] = df['high_low_spread'] / df['atr']
    
    # Volume factor: today's volume divided by the median volume over the past N days
    df['volume_factor'] = df['volume'] / df['volume'].rolling(window=N).median()
    
    # Cumulative sum of the product of volume changes and price changes over a specified time window
    df['volume_change'] = df['volume'].pct_change()
    df['price_change'] = df['close'].pct_change()
    df['cum_vol_price_change'] = (df['volume_change'] * df['price_change']).rolling(window=N).sum()
    
    # Percentage change in closing price and percentage change in volume
    df['price_pct_change'] = df['close'].pct_change()
    df['volume_pct_change'] = df['volume'].pct_change()
    df['price_vol_relationship'] = df['price_pct_change'] / df['volume_pct_change']
    
    # Open-close spread normalized by the average daily range and multiplied by the opening volume
    df['avg_daily_range'] = df['high'].rolling(window=N).mean() - df['low'].rolling(window=N).mean()
    df['open_close_spread'] = df['close'] - df['open']
    df['open_close_vol_intensity'] = (df['open_close_spread'] / df['avg_daily_range']) * df['volume']
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['weighted_close'] + 
                          df['high_low_atr_ratio'] + 
                          df['volume_factor'] + 
                          df['cum_vol_price_change'] + 
                          df['price_vol_relationship'] + 
                          df['open_close_vol_intensity'])
    
    return df['alpha_factor']
```
