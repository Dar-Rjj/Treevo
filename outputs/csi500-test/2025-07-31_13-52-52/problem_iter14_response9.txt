```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low and Close-Open Momentum
    high_low_range = df['high'] - df['low']
    price_movement_ratio = (df['close'] - df['open']) / (df['high'] - df['low'])
    five_day_rolling_momentum = price_movement_ratio.rolling(window=5).sum() / high_low_range.rolling(window=5).sum()
    adjusted_five_day_momentum = five_day_rolling_momentum * df['volume']

    # Calculate 10-Day Price and Intraday Momentum
    ten_day_price_momentum = df['close'] - df['close'].shift(10)
    intraday_return = (df['high'] - df['low']) / df['low']
    combined_momentum = ten_day_price_momentum + intraday_return
    volume_change_indicator = (df['volume'] > df['volume'].shift()).astype(int)
    adjusted_combined_momentum = combined_momentum * volume_change_indicator

    # Calculate Daily Volatility
    daily_volatility = (df['high'] - df['low']).abs()

    # Calculate Price Trend Indicator
    short_sma = df['close'].rolling(window=5).mean()
    long_sma = df['close'].rolling(window=20).mean()
    price_trend_indicator = (short_sma > long_sma).astype(int) * 2 - 1

    # Combine Factors
    close_open_return = (df['close'] - df['open']) / df['open']
    combined_factor = (close_open_return * df['volume']) / daily_volatility

    # Calculate Averaged High-to-Low Volatility
    lookback_period = 30
    high_low_volatility = (df['high'] - df['low']).pct_change().abs()
    averaged_high_low_volatility = high_low_volatility.rolling(window=lookback_period).sum() / lookback_period

    # Integrate Both Metrics
    integrated_metric = (combined_momentum + averaged_high_low_volatility) / 2

    # Final Alpha Factor
    final_alpha_factor = (adjusted_five_day_momentum + adjusted_combined_momentum) * price_trend_indicator
    final_alpha_factor += integrated_metric
    final_alpha_factor = final_alpha_factor.ewm(span=10, adjust=False).mean()

    return final_alpha_factor

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
