```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Momentum signals
    df['short_term_momentum'] = df['daily_return'].rolling(window=5).mean()
    df['long_term_momentum'] = df['daily_return'].rolling(window=20).mean()
    df['momentum_crossover'] = df['short_term_momentum'] - df['long_term_momentum']
    
    # Volume-based indicators
    df['daily_volume_change'] = df['volume'].diff()
    df['volume_moving_avg_10'] = df['volume'].rolling(window=10).mean()
    df['volume_increase_ratio'] = df['volume'] / df['volume_moving_avg_10']
    
    # Price volatility
    df['daily_high_low_range'] = df['high'] - df['low']
    df['average_true_range_14'] = df['daily_high_low_range'].rolling(window=14).mean()
    df['volatility_ratio'] = df['daily_high_low_range'] / df['average_true_range_14']
    
    # Money flow
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['raw_money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df[df['typical_price'] > df['typical_price'].shift(1)]['raw_money_flow']
    df['negative_money_flow'] = df[df['typical_price'] < df['typical_price'].shift(1)]['raw_money_flow']
    df['money_flow_ratio_14'] = df['positive_money_flow'].rolling(window=14).sum() / df['negative_money_flow'].rolling(window=14).sum()
    
    # Price patterns
    df['engulfing_pattern'] = (df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1))
    df['doji_pattern'] = abs(df['close'] - df['open']) <= 0.1 * (df['high'] - df['low'])
    df['hammer_or_inverted_hammer'] = (df['low'] < df['close'].shift(1)) & (df['close'] > df['open']) & (df['close'] - df['open'] > 2 * (df['open'] - df['low']))
    df['bullish_harami'] = (df['close'] > df['open']) & (df['open'] < df['close'].shift(1)) & (df['close'] < df['open'].shift(1))
    
    # Trend indicators
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['ema_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['trend_signal'] = df['ema_20'] > df['sma_50']
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Relative Strength Index (RSI)
    df['gain'] = df['daily_return'].apply(lambda x: x if x > 0 else 0)
    df['loss'] = df['daily_return'].apply(lambda x: -x if x < 0 else 0)
    df['avg_gain_14'] = df['gain'].rolling(window=14).mean()
    df['avg_loss_14'] = df['loss'].rolling(window=14).mean()
    df['rsi'] = 100 - (100 / (1 + (df['avg_gain_14'] / df['avg_loss_14'])))
    
    # Combine all the factors into a single alpha factor
    df['alpha_factor'] = (df['momentum_crossover'] + 
                          df['volume_increase_ratio'] + 
                          df['volatility_ratio'] + 
                          df['money_flow_ratio_14'] + 
                          df['engulfing_pattern'] + 
                          df['doji_pattern'] + 
                          df['hammer_or_inverted_hammer'] + 
                          df['bullish_harami'] + 
                          df['trend_signal'] + 
                          df['macd_histogram'] + 
                          df
