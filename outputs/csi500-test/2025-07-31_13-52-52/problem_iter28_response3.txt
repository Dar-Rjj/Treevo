```python
import pandas as pd

def heuristics_v2(df, N=10, M=14):
    # Calculate the weighted average of close prices over the last N days
    weights = pd.Series(range(1, N+1))
    df['weighted_close'] = df['close'].rolling(window=N).apply(lambda x: (x * weights).sum() / weights.sum(), raw=True)
    
    # Calculate the high-low spread
    df['high_low_spread'] = df['high'] - df['low']
    
    # Calculate the average true range over the past M days
    df['tr'] = df[['high', 'low', 'close']].diff(axis=1).abs().max(axis=1)
    df['atr'] = df['tr'].rolling(window=M).mean()
    
    # Introduce a factor that measures the ratio of the high-low spread to the average true range
    df['hl_spread_to_atr'] = df['high_low_spread'] / df['atr']
    
    # Formulate a factor by dividing today's volume by the median volume over the past N days
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=N).median()
    
    # Create a factor that measures the cumulative sum of the product of volume changes and price changes over a specified time window
    df['price_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()
    df['cumulative_pv'] = (df['price_change'] * df['volume_change']).rolling(window=N).sum()
    
    # Design a factor based on the relationship between the percentage change in closing price and the percentage change in volume
    df['price_vol_relation'] = df['price_change'] / df['volume_change']
    
    # Investigate the interaction between the open-close spread and the volume traded at the opening session
    df['open_close_spread'] = df['close'] - df['open']
    df['open_volume_sentiment'] = df['open_close_spread'] * df['volume']
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['weighted_close'] + 
                          df['hl_spread_to_atr'] + 
                          df['volume_ratio'] + 
                          df['cumulative_pv'] + 
                          df['price_vol_relation'] + 
                          df['open_volume_sentiment'])
    
    return df['alpha_factor']
```
