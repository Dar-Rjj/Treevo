```python
import pandas as pd

def heuristics_v2(df, n=5):
    # Calculate Daily Price Movement
    df['Price_Movement'] = df['close'] - df['open']
    
    # Identify Enhanced Price Breakaways
    df['High_Breakaway'] = (df['high'] > df['high'].shift(1)) & ((df['high'] - df['high'].shift(1)) / df['high'].shift(1) > 0.05)
    df['Low_Breakaway'] = (df['low'] < df['low'].shift(1)) & ((df['low'].shift(1) - df['low']) / df['low'].shift(1) > 0.05)
    
    # Volume-Weighted Score with Volume Momentum
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    conditions = [
        (df['High_Breakaway'] == True) & (df['Low_Breakaway'] == False),
        (df['High_Breakaway'] == False) & (df['Low_Breakaway'] == True),
        (df['High_Breakaway'] == False) & (df['Low_Breakaway'] == False)
    ]
    choices = [
        df['Price_Movement'] * df['volume'] * df['Volume_Ratio'],
        -(df['Price_Movement'] * df['volume'] * df['Volume_Ratio']),
        0
    ]
    df['Volume_Weighted_Score'] = pd.np.select(conditions, choices, default=0)
    
    # Final Alpha Factor
    df['Final_Alpha_Factor'] = df['Volume_Weighted_Score'].rolling(window=n).sum()
    
    return df['Final_Alpha_Factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
```
