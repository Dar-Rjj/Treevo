import pandas as pd

def heuristics_v2(df):
    # Calculate the 20-day maximum of the high prices
    df['high_max_20d'] = df['high'].rolling(window=20).max()
    
    # Calculate the ratio of the close price to the 20-day maximum of the high prices
    df['price_to_high_max_ratio'] = df['close'] / df['high_max_20d']
    
    # Calculate the logarithm of the trading volume
    df['log_volume'] = df['volume'].apply(lambda x: pd.np.log(x) if x > 0 else 0)
    
    # Calculate the 10-day rate of change in the lowest price
    df['low_roc_10d'] = df['low'].pct_change(periods=10)
    
    # Composite heuristic score: sum of the price-to-high-max ratio, log of volume, and rate of change in the lowest price
    heuristics_matrix = df['price_to_high_max_ratio'] + df['log_volume'] + df['low_roc_10d']
    
    return heuristics_matrix
