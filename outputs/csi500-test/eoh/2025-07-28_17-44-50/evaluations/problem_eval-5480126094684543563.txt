import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the daily return
    daily_return = df['close'].pct_change()
    
    # Calculate the 5-day Exponential Moving Average (EMA) of the daily return
    ema_daily_return = daily_return.ewm(span=5, adjust=False).mean().fillna(0)
    
    # Calculate the square root of the ratio of the difference between high and low to the closing price
    sqrt_high_low_close_ratio = np.sqrt((df['high'] - df['low']) / df['close'])
    
    # Calculate the natural logarithm of the trading volume
    log_volume = np.log(df['volume'])
    
    # Define weights for each component
    w1, w2, w3 = 0.4, 0.4, 0.2
    
    # Combine the components into a single alpha factor
    heuristics_matrix = w1 * ema_daily_return + w2 * sqrt_high_low_close_ratio + w3 * log_volume
    
    return heuristics_matrix
