import pandas as pd

def heuristics_v2(df):
    # Exponentially weighted moving average of returns over the last 20 days
    ewma_returns = df['close'].pct_change().ewm(span=20).mean()
    
    # Coefficient of variation of the daily closing prices over the last 60 days
    cv_close_prices = (df['close'].rolling(window=60).std() / df['close'].rolling(window=60).mean())
    
    # Ratio of the 30-day sum of trading volume to the 180-day sum of trading volume
    vol_ratio = df['volume'].rolling(window=30).sum() / df['volume'].rolling(window=180).sum()
    
    # Combine the calculated features into a single factor
    heuristics_matrix = ewma_returns * cv_close_prices * vol_ratio
    
    return heuristics_matrix
