import pandas as pd

def heuristics_v2(df):
    df['ewma_close_20'] = df['close'].ewm(span=20).mean()
    df['volume_ratio_ewma'] = df['volume'] / df['volume'].ewm(span=5).mean()
    df['heuristics_factor'] = (df['close'] - df['ewma_close_20']) * df['volume_ratio_ewma']
    heuristics_matrix = df['heuristics_factor'].copy()
    return heuristics_matrix
