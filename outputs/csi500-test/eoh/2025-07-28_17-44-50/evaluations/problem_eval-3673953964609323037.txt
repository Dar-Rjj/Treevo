def heuristics_v2(df):
    # Calculate the 10-day momentum of the closing prices
    momentum_10 = df['close'].pct_change(10)
    
    # Calculate the 30-day median volume
    median_volume_30 = df['volume'].rolling(window=30).median()
    
    # Calculate the signed volume difference from the 30-day median
    signed_vol_diff = (df['volume'] - median_volume_30) / median_volume_30
    
    # Calculate the cumulative sum of the signed volume difference
    cum_sum_signed_vol_diff = signed_vol_diff.cumsum()
    
    # Calculate the True Range
    df['tr'] = df[['high', 'low', 'close']].diff(axis=1).abs().max(axis=1)
    
    # Calculate the 20-day Average True Range
    atr_20 = df['tr'].rolling(window=20).mean()
    
    # Define weights for each component
    w1, w2, w3 = 0.4, 0.3, 0.3
    
    # Combine the components into a single alpha factor
    heuristics_matrix = w1 * momentum_10 + w2 * cum_sum_signed_vol_diff + w3 * atr_20
    
    return heuristics_matrix
