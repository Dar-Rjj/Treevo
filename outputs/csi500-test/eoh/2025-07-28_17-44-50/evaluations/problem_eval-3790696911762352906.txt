def heuristics_v2(df):
    # Calculate the 50-day moving average of the closing price
    df['close_ma_50d'] = df['close'].rolling(window=50).mean()
    
    # Calculate the ratio of the close price to its 50-day moving average
    df['price_to_close_ma_ratio'] = df['close'] / df['close_ma_50d']
    
    # Calculate the 10-day average of the trading volume
    df['vol_avg_10d'] = df['volume'].rolling(window=10).mean()
    
    # Calculate the percentage change in the trading volume relative to its 10-day average
    df['vol_change_to_avg'] = df['volume'] / df['vol_avg_10d']
    
    # Calculate the ADX (Average Directional Index) for trend strength
    df['high_low_diff'] = df['high'] - df['low']
    df['high_prev_close_abs_diff'] = (df['high'] - df['close'].shift(1)).abs()
    df['low_prev_close_abs_diff'] = (df['low'] - df['close'].shift(1)).abs()
    df['TR'] = df[['high_low_diff', 'high_prev_close_abs_diff', 'low_prev_close_abs_diff']].max(axis=1)
    df['DMp'] = df['high'].diff().apply(lambda x: max(x, 0))
    df['DMm'] = df['low'].diff().apply(lambda x: max(-x, 0))
    df['Smoothed_TR'] = df['TR'].rolling(window=14).sum()
    df['Smoothed_DMp'] = df['DMp'].rolling(window=14).sum()
    df['Smoothed_DMm'] = df['DMm'].rolling(window=14).sum()
    df['PDI'] = 100 * (df['Smoothed_DMp'] / df['Smoothed_TR'])
    df['MDI'] = 100 * (df['Smoothed_DMm'] / df['Smoothed_TR'])
    df['ADX'] = 100 * (abs(df['PDI'] - df['MDI']) / (df['PDI'] + df['MDI']))
    
    # Composite heuristic score: sum of the price-to-close-ma ratio, the vol change to avg, and the ADX
    heuristics_matrix = df['price_to_close_ma_ratio'] + df['vol_change_to_avg'] + df['ADX']
    
    return heuristics_matrix
