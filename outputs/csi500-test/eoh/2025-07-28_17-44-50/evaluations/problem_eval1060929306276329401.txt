import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Trend signal: 10-day exponential moving average of closing price
    ema_10d = df['close'].ewm(span=10).mean()
    
    # Risk measure: 20-day standard deviation of log returns
    log_returns = np.log(df['close'] / df['close'].shift(1))
    std_log_returns = log_returns.rolling(window=20).std()
    
    # Volume momentum: 30-day cumulative volume divided by the 60-day cumulative volume
    cum_vol_30d = df['volume'].rolling(window=30).sum()
    cum_vol_60d = df['volume'].rolling(window=60).sum()
    vol_momentum = cum_vol_30d / cum_vol_60d
    
    # Combine the calculated features into a single factor
    heuristics_matrix = (ema_10d - std_log_returns) * vol_momentum
    
    return heuristics_matrix
