import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum signal: 5-day return
    mom_5d = df['close'] / df['close'].shift(5) - 1
    
    # Volatility: 10-day standard deviation of daily returns
    daily_returns = df['close'].pct_change()
    std_daily_returns = daily_returns.rolling(window=10).std()
    
    # Relative trading activity: Today's volume divided by the 10-day average volume
    avg_vol_10d = df['volume'].rolling(window=10).mean()
    rel_vol = df['volume'] / avg_vol_10d
    
    # Combine the calculated features into a single factor
    heuristics_matrix = (mom_5d - std_daily_returns) * rel_vol
    
    return heuristics_matrix
