import pandas as pd

def heuristics_v2(df):
    # Calculate the Z-score of the 10-day closing price
    z_score_close = (df['close'] - df['close'].rolling(window=10).mean()) / df['close'].rolling(window=10).std()
    
    # Calculate the Exponential Moving Average (EMA) of the volume over 20 days
    ema_volume_20d = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Calculate the ratio of the current day's trading amount to the sum of the last 5 days' trading amounts
    amount_ratio = df['amount'] / df['amount'].rolling(window=5).sum()
    
    # Combine the components into a single alpha factor
    heuristics_matrix = z_score_close * ema_volume_20d * amount_ratio
    
    return heuristics_matrix
