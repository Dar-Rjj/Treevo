import pandas as pd

def heuristics_v2(df):
    # Calculate the 5-day cumulative return
    five_day_return = df['close'].pct_change(periods=5)
    
    # Calculate the 5-day moving average volume
    avg_vol_5d = df['volume'].rolling(window=5).mean()
    
    # Calculate the ratio of today's volume to the 5-day moving average volume
    vol_ratio = df['volume'] / avg_vol_5d
    
    # Calculate the 10-day closing price and trading amount series
    close_10d = df['close'].rolling(window=10).mean()
    amount_10d = df['amount'].rolling(window=10).mean()
    
    # Calculate the 10-day rolling correlation between closing price and trading amount
    corr_10d = close_10d.rolling(window=10).corr(amount_10d)
    
    # Combine the calculated features into a single factor
    heuristics_matrix = (five_day_return + vol_ratio) * corr_10d
    
    return heuristics_matrix
