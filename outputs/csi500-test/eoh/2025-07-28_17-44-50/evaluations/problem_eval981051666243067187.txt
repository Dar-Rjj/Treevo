import pandas as pd

def heuristics_v2(df):
    # Momentum signal: 20-day rate of change in closing price
    momentum = df['close'].pct_change(20)
    
    # Volatility: Standard deviation of daily returns over the last 10 days
    daily_returns = df['close'].pct_change()
    vol = daily_returns.rolling(window=10).std()
    
    # Volume-activity ratio: 30-day sum of volume divided by the 90-day sum of volume
    sum_vol_30d = df['volume'].rolling(window=30).sum()
    sum_vol_90d = df['volume'].rolling(window=90).sum()
    vol_activity_ratio = sum_vol_30d / sum_vol_90d
    
    # Combine the calculated features into a single factor
    heuristics_matrix = (momentum - vol) * vol_activity_ratio
    
    return heuristics_matrix
