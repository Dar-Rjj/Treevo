def heuristics_v2(df):
    # Calculate the 50-day exponential moving average of the closing price
    df['ema_50'] = df['close'].ewm(span=50, adjust=False).mean()
    
    # Calculate the absolute difference between the closing price and the 50-day EMA
    df['distance_to_ema'] = abs(df['close'] - df['ema_50'])
    
    # Count the number of positive and negative volume change days over the last 30 days
    df['positive_volume_days'] = (df['volume'].pct_change() > 0).rolling(window=30).sum()
    df['negative_volume_days'] = (df['volume'].pct_change() < 0).rolling(window=30).sum()
    
    # Adjust the volume ratio by dividing it by the standard deviation of the last 30 days' volume
    df['volume_ratio_pos_neg_volatility_adjusted'] = df['positive_volume_days'] / (df['negative_volume_days'] + 1e-8) / df['volume'].rolling(window=30).std()
    
    # Calculate the standard deviation of daily price changes (difference between high and low) over the last 10 days
    df['price_std_dev'] = (df['high'] - df['low']).rolling(window=10).std()
    
    # Composite factor: weighted sum of distance to EMA, volatility-adjusted volume ratio, and price standard deviation
    df['composite_factor'] = (df['distance_to_ema'] * 0.4 + 
                              df['volume_ratio_pos_neg_volatility_adjusted'] * 0.3 + 
                              df['price_std_dev'] * 0.3)
    
    heuristics_matrix = df['composite_factor'].copy()
    
    return heuristics_matrix
