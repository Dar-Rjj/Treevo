def heuristics_v2(df):
    # Calculate the 20-day rate of change (ROC) of the closing price
    df['roc_20'] = df['close'].pct_change(periods=20)
    
    # Calculate the 10-day exponential moving average (EMA) of the volume
    df['ema_volume_10'] = df['volume'].ewm(span=10, adjust=False).mean()
    
    # Composite factor: weighted sum of ROC and EMA of volume
    df['composite_factor'] = (df['roc_20'] * 0.5 + 
                              df['ema_volume_10'] * 0.5)
    
    # Apply a logarithmic transformation to the composite factor
    df['log_composite'] = np.log1p(df['composite_factor'])
    
    heuristics_matrix = df['log_composite'].copy()
    
    return heuristics_matrix
