import pandas as pd

def heuristics_v2(df):
    # Calculate price return over the last 5 days
    df['momentum'] = df['close'].pct_change(periods=5)
    
    # Calculate average daily return over the last 10 days
    df['avg_return_10d'] = df['close'].pct_change().rolling(window=10).mean()
    
    # Calculate standard deviation of returns over the last 10 days as a measure of volatility
    df['volatility'] = df['close'].pct_change().rolling(window=10).std()
    
    # Calculate the ratio of current volume to the 30-day average volume
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=30).mean()
    
    # Composite factor: weighted sum of momentum, inverse of volatility, and volume ratio
    df['composite_factor'] = (df['momentum'] + 
                              1/df['volatility'] + 
                              df['volume_ratio'])
    
    heuristics_matrix = df['composite_factor'].copy()
    
    return heuristics_matrix
