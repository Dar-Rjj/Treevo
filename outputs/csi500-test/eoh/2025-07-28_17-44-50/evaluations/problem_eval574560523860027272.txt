import pandas as pd

def heuristics_v2(df):
    # Calculate the Relative Strength Index (RSI) over the last 14 days
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    # Calculate the ratio of current volume to the 10-day average volume
    volume_ratio = df['volume'] / df['volume'].rolling(window=10).mean()
    
    # Calculate the 50-day moving average of the close price
    ma_50 = df['close'].rolling(window=50).mean()
    
    # Composite factor: weighted sum of RSI, inverse of MA50, and volume ratio
    df['composite_factor'] = (rsi + 
                              1/ma_50 + 
                              volume_ratio)
    
    heuristics_matrix = df['composite_factor'].copy()
    
    return heuristics_matrix
