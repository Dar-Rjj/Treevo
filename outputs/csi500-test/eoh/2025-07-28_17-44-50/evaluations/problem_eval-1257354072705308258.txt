def heuristics_v2(df):
    # Calculate the log returns
    log_returns = np.log(df['close'] / df['close'].shift(1))
    
    # Cumulative sum of log returns
    cumsum_log_returns = log_returns.cumsum()
    
    # Adjusted close-to-open ratio using rolling standard deviation
    close_open_ratio = df['close'] / df['open']
    std_close_open_ratio = close_open_ratio.rolling(window=20).std()
    adj_close_open_ratio = close_open_ratio / std_close_open_ratio
    
    # Ratio of trading amount to volume
    amount_volume_ratio = df['amount'] / df['volume']
    
    # Define weights for each component
    w1, w2, w3 = 0.4, 0.3, 0.3
    
    # Combine the components into a single alpha factor
    heuristics_matrix = w1 * cumsum_log_returns + w2 * adj_close_open_ratio + w3 * amount_volume_ratio
    
    return heuristics_matrix
