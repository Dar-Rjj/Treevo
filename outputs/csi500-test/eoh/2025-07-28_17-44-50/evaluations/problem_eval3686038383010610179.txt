def heuristics_v2(df):
    df['trading_range'] = df['high'] - df['low']
    df['avg_trading_range_30'] = df['trading_range'].rolling(window=30).mean()
    df['range_factor'] = (df['trading_range'] - df['avg_trading_range_30']) / df['avg_trading_range_30']
    df['smoothed_range_factor'] = df['range_factor'].rolling(window=10).mean()
    heuristics_matrix = df['smoothed_range_factor'].dropna()
    return heuristics_matrix
