import pandas as pd
import numpy as tf

def heuristics_v2(df):
    # Calculate the exponential moving average of the closing price over a 5-day window
    ema_close = df['close'].ewm(span=5, adjust=False).mean()
    
    # Calculate the ratio between the highest and lowest prices
    high_low_ratio = df['high'] / df['low']
    
    # Calculate the difference between the log of the amount and the log of the volume
    log_diff_amount_volume = np.log(df['amount']) - np.log(df['volume'])
    
    # Apply a unique mathematical transformation to each component
    transformed_ema_close = np.sin(ema_close)
    transformed_high_low_ratio = np.cos(high_low_ratio)
    transformed_log_diff = np.tanh(log_diff_amount_volume)
    
    # Combine the transformed components into a single alpha factor using a cumulative product
    heuristics_matrix = transformed_ema_close * transformed_high_low_ratio * transformed_log_diff
    
    return heuristics_matrix
