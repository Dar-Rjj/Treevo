def heuristics_v2(df):
    # Calculate the 50-day moving average of the closing price
    df['ma_50'] = df['close'].rolling(window=50).mean()
    
    # Calculate the absolute difference between the closing price and the 50-day moving average
    df['distance_to_ma'] = abs(df['close'] - df['ma_50'])
    
    # Count the number of positive and negative volume change days over the last 30 days
    df['positive_volume_days'] = (df['volume'].pct_change() > 0).rolling(window=30).sum()
    df['negative_volume_days'] = (df['volume'].pct_change() < 0).rolling(window=30).sum()
    
    # Calculate the ratio of positive to negative volume days
    df['volume_ratio_pos_neg'] = df['positive_volume_days'] / (df['negative_volume_days'] + 1e-8)
    
    # Calculate the amplitude of daily price changes (difference between high and low) over the last 10 days
    df['amplitude'] = (df['high'] - df['low']).rolling(window=10).mean()
    
    # Composite factor: weighted sum of distance to MA, volume ratio, and amplitude
    df['composite_factor'] = (df['distance_to_ma'] * 0.4 + 
                              df['volume_ratio_pos_neg'] * 0.3 + 
                              df['amplitude'] * 0.3)
    
    heuristics_matrix = df['composite_factor'].copy()
    
    return heuristics_matrix
