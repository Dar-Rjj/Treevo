def heuristics_v2(df):
    # Rate of Change (ROC) over the past 14 days
    roc_14d = df['close'].pct_change(14)
    
    # Volatility: Standard Deviation of daily returns over the last 30 days
    daily_returns = df['close'].pct_change()
    std_dev = daily_returns.rolling(window=30).std()
    
    # Trading activity: Ratio of the current day's trading amount to the 20-day SMA of the trading amount
    sma_amount_20d = df['amount'].rolling(window=20).mean()
    amount_ratio = df['amount'] / sma_amount_20d
    
    # Combine the calculated features into a single factor
    heuristics_matrix = (roc_14d - std_dev) * amount_ratio
    
    return heuristics_matrix
