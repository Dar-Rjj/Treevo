import pandas as pd

def heuristics_v2(df):
    price_weighted_avg = df['open'] * 0.2 + df['high'] * 0.3 + df['low'] * 0.1 + df['close'] * 0.4
    vol_30ema = df['volume'].ewm(span=30, adjust=False).mean()
    heuristics_matrix = price_weighted_avg - vol_30ema
    return heuristics_matrix
