def heuristics_v2(df):
    df['sma_5_close'] = df['close'].rolling(window=5).mean()
    df['ema_10_volume'] = df['volume'].ewm(span=10, adjust=False).mean()
    df['volume_ratio'] = df['volume'] / (df['ema_10_volume'] + 1e-8)
    df['daily_returns'] = df['close'].pct_change()
    df['return_std_dev'] = df['daily_returns'].rolling(window=15).std()
    df['return_mean'] = df['daily_returns'].rolling(window=15).mean()
    df['coefficient_of_variation'] = df['return_std_dev'] / (df['return_mean'].abs() + 1e-8)
    df['composite_factor'] = df['sma_5_close'] * df['volume_ratio'] * df['coefficient_of_variation']
    heuristics_matrix = df['composite_factor'].copy()
    return heuristics_matrix
