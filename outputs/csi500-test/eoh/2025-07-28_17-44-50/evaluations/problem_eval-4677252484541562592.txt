import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the daily return (close-to-open) and then square it
    squared_daily_return = (df['close'] / df['open']) ** 2
    
    # Calculate the ratio of the highest price to the sum of the open and close prices
    high_to_sum_open_close_ratio = df['high'] / (df['open'] + df['close'])
    
    # Calculate the square root of the product of volume and amount
    sqrt_volume_amount_product = np.sqrt(df['volume'] * df['amount'])
    
    # Define weights for each component
    w1, w2, w3 = 0.4, 0.3, 0.3
    
    # Combine the components into a single alpha factor using the harmonic mean
    heuristics_matrix = 3 / (w1/squared_daily_return + w2/high_to_sum_open_close_ratio + w3/sqrt_volume_amount_product)
    
    return heuristics_matrix
