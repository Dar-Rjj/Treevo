def heuristics_v2(df):
    df['high_52w'] = df['close'].rolling(window=252).max()
    df['low_52w'] = df['close'].rolling(window=252).min()
    df['rel_strength'] = (df['close'] - df['low_52w']) / (df['high_52w'] - df['low_52w'])
    df['volume_diff'] = df['volume'] - df['volume'].rolling(window=30).mean()
    df['factor_value'] = df['rel_strength'] + df['volume_diff']
    heuristics_matrix = df['factor_value'].dropna()
    return heuristics_matrix
