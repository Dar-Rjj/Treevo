def heuristics_v2(df):
    # Calculate daily returns
    df['returns'] = df['close'].pct_change()
    
    # Separate positive and negative returns
    pos_returns = df['returns'].apply(lambda x: x if x > 0 else 0)
    neg_returns = df['returns'].apply(lambda x: x if x < 0 else 0)
    
    # Calculate 30-day cumulative positive and negative returns
    cum_pos_returns_30 = pos_returns.rolling(window=30).sum()
    cum_neg_returns_30 = neg_returns.rolling(window=30).sum().abs()
    
    # Generate the new factor by dividing the 30-day cumulative positive returns by the 30-day cumulative negative returns
    heuristics_matrix = cum_pos_returns_30 / cum_neg_returns_30
    
    return heuristics_matrix
