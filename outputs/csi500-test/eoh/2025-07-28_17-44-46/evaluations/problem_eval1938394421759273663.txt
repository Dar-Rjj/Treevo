def heuristics_v2(df):
    # Calculate 20-day high
    df['high_20'] = df['high'].rolling(window=20).max()
    
    # Compute the ratio of closing price to 20-day high
    df['price_to_high_ratio'] = df['close'] / df['high_20']
    
    # Calculate the 5-day percentage change in volume
    df['volume_change_5'] = (df['volume'] - df['volume'].shift(5)) / df['volume'].shift(5)
    
    # Generate the new factor by combining the price-to-high ratio with the volume change
    heuristics_matrix = df['price_to_high_ratio'] * (1 + df['volume_change_5'])
    
    return heuristics_matrix
