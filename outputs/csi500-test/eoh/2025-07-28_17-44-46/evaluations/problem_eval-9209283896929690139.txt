import pandas as pd

def heuristics_v2(df):
    def calculate_heuristic(row):
        max_high = df['high'].rolling(window=5).max().shift(1)
        min_low = df['low'].rolling(window=5).min().shift(1)
        return (max_high - min_low) / df['volume']
    
    heuristics_matrix = df.apply(calculate_heuristic, axis=1)
    return heuristics_matrix
