def heuristics_v2(df):
    # Calculate the 20-day and 100-day Exponential Moving Average (EMA) of volume
    ema_vol_20 = df['volume'].ewm(span=20, adjust=False).mean()
    ema_vol_100 = df['volume'].ewm(span=100, adjust=False).mean()
    
    # Calculate the 50-day EMA of volume
    ema_vol_50 = df['volume'].ewm(span=50, adjust=False).mean()
    
    # Generate the new factor by dividing the difference between 20-day and 100-day EMA volume by the 50-day EMA volume
    factor_volume_diff = (ema_vol_20 - ema_vol_100) / ema_vol_50
    
    # Calculate the 30-day Maximum daily return
    daily_returns = df['close'].pct_change()
    max_return_30 = daily_returns.rolling(window=30).max()
    
    # Combine the volume diff ratio with the maximum return
    heuristics_matrix = factor_volume_diff * max_return_30
    
    return heuristics_matrix
