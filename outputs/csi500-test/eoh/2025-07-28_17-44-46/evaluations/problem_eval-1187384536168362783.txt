def heuristics_v2(df):
    df['sma50'] = df['close'].rolling(window=50).mean()
    df['max_amount_50'] = df['amount'].rolling(window=50).max()
    
    df['new_factor'] = (df['close'] / df['sma50']) * (df['amount'] / df['max_amount_50'])
    
    heuristics_matrix = df['new_factor']
    
    return heuristics_matrix
