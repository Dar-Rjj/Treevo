import pandas as pd

def heuristics_v2(df):
    # Calculate True Range
    tr = pd.DataFrame({'hl': df['high'] - df['low'], 'hc': abs(df['high'] - df['close'].shift(1)), 'lc': abs(df['low'] - df['close'].shift(1))})
    tr['tr'] = tr.max(axis=1)
    
    # Calculate 14-day EMA of True Range
    ematr = tr['tr'].ewm(span=14, adjust=False).mean()
    
    # Calculate 50-day and 200-day moving averages of the close price
    ma_close_50 = df['close'].rolling(window=50).mean()
    ma_close_200 = df['close'].rolling(window=200).mean()
    
    # Generate the difference between the 50-day and 200-day SMA of the close price
    ma_diff = ma_close_50 - ma_close_200
    
    # Generate the new factor by dividing EMATR by the difference of the 50-day and 200-day SMA of the Close Price
    heuristics_matrix = ematr / ma_diff
    
    return heuristics_matrix
