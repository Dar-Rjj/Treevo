import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the difference between high and low for each day
    hl_diff = df['high'] - df['low']
    
    # Calculate the logarithmic return
    log_return = np.log(df['close'] / df['close'].shift(1))
    
    # Adjust the HL difference by the log return
    adj_hl_diff = hl_diff * log_return
    
    # Calculate the cumulative sum of the adjusted HL difference
    cum_sum_adj_hl = adj_hl_diff.cumsum()
    
    # Generate the heuristics matrix
    heuristics_matrix = cum_sum_adj_hl
    
    return heuristics_matrix
