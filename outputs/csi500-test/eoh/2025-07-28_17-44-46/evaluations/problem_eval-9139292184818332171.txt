import pandas as pd

def heuristics_v2(df):
    # Calculate the price change
    delta = df['close'].diff()
    
    # Get gains and losses
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    
    # Calculate average gain and average loss for 14 days
    avg_gain_14 = gain.rolling(window=14).mean()
    avg_loss_14 = loss.rolling(window=14).mean()
    
    # Calculate RS and RSI for 14 days
    rs_14 = avg_gain_14 / avg_loss_14
    rsi_14 = 100 - (100 / (1 + rs_14))
    
    # Calculate average gain and average loss for 30 days
    avg_gain_30 = gain.rolling(window=30).mean()
    avg_loss_30 = loss.rolling(window=30).mean()
    
    # Calculate RS and RSI for 30 days
    rs_30 = avg_gain_30 / avg_loss_30
    rsi_30 = 100 - (100 / (1 + rs_30))
    
    # Generate the new factor by dividing the 14-day RSI by the 30-day RSI
    heuristics_matrix = rsi_14 / rsi_30
    
    return heuristics_matrix
