import pandas as pd

def heuristics_v2(df):
    # Calculate the 60-day and 180-day momentum of the closing price
    momentum_60 = df['close'] / df['close'].shift(60)
    momentum_180 = df['close'] / df['close'].shift(180)
    
    # Generate the new factor by dividing the 60-day momentum by the 180-day momentum
    factor_momentum_ratio = momentum_60 / momentum_180
    
    # Calculate the 30-day coefficient of variation of the daily trading amount
    mean_amt_30 = df['amount'].rolling(window=30).mean()
    std_dev_amt_30 = df['amount'].rolling(window=30).std()
    coeff_variation_30 = std_dev_amt_30 / mean_amt_30
    
    # Combine the momentum ratio with the coefficient of variation of the amount
    heuristics_matrix = factor_momentum_ratio * coeff_variation_30
    
    return heuristics_matrix
