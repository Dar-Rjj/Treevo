import pandas as pd

def heuristics_v2(df):
    # Calculate the 50-day and 200-day cumulative high and low prices
    cum_high_50 = df['high'].rolling(window=50).sum()
    cum_low_200 = df['low'].rolling(window=200).sum()
    
    # Generate the new factor by dividing the 50-day cumulative high price by the 200-day cumulative low price
    factor_price_ratio = cum_high_50 / cum_low_200
    
    # Calculate the 10-day average of daily returns
    daily_returns = df['close'].pct_change()
    avg_returns_10 = daily_returns.rolling(window=10).mean()
    
    # Combine the price ratio with the average of returns
    heuristics_matrix = factor_price_ratio * avg_returns_10
    
    return heuristics_matrix
