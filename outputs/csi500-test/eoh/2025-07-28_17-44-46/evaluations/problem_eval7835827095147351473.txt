def heuristics_v2(df):
    # Calculate 20-day standard deviation of the close price
    df['std_20'] = df['close'].rolling(window=20).std()
    
    # Calculate 20-day average of the trading amount
    df['avg_amount_20'] = df['amount'].rolling(window=20).mean()
    
    # Compute the volatility-based factor
    df['volatility_factor'] = (df['std_20'] / df['close']) * (df['amount'] / df['avg_amount_20'])
    
    # Prepare the output
    heuristics_matrix = df['volatility_factor']
    
    return heuristics_matrix
