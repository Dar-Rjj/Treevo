def heuristics_v2(df):
    # Calculate the 20-day and 100-day Simple Moving Average (SMA) of the closing price
    sma_close_20 = df['close'].rolling(window=20).mean()
    sma_close_100 = df['close'].rolling(window=100).mean()
    
    # Generate the new factor by finding the difference between the 20-day and 100-day SMA of the closing price
    factor_sma_diff = sma_close_20 - sma_close_100
    
    # Calculate the 60-day Average True Range (ATR)
    high_low = df['high'] - df['low']
    high_close = (df['high'] - df['close'].shift()).abs()
    low_close = (df['low'] - df['close'].shift()).abs()
    ranges = pd.concat([high_low, high_close, low_close], axis=1).max(axis=1)
    atr_60 = ranges.rolling(window=60).mean()
    
    # Combine the SMA difference with the ATR
    heuristics_matrix = factor_sma_diff * atr_60
    
    return heuristics_matrix
