def heuristics_v2(df):
    # Calculate the 30-day and 120-day Simple Moving Average (SMA) of closing prices
    sma_close_30 = df['close'].rolling(window=30).mean()
    sma_close_120 = df['close'].rolling(window=120).mean()

    # Generate the new factor by dividing the 30-day SMA of closing prices by the 120-day SMA of closing prices
    price_ratio = sma_close_30 / sma_close_120

    # Calculate the 20-day Standard Deviation and Mean of daily volume
    std_dev_vol_20 = df['volume'].rolling(window=20).std()
    mean_vol_20 = df['volume'].rolling(window=20).mean()

    # Calculate the 20-day Coefficient of Variation of daily volume
    coef_var_20 = std_dev_vol_20 / mean_vol_20

    # Combine the price ratio with the coefficient of variation of volume
    heuristics_matrix = price_ratio * coef_var_20

    return heuristics_matrix
