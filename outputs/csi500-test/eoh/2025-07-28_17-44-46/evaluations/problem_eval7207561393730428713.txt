def heuristics_v2(df):
    # Calculate the 50-day standard deviation of the close price
    df['std50'] = df['close'].rolling(window=50).std()
    
    # Compute the volatility-adjusted momentum factor
    df['volatility_adjusted_momentum'] = (df['close'] / df['std50']) * (df['volume'] / df['volume'].shift(1))
    
    # Apply a 7-day simple moving average to smooth the volatility-adjusted momentum factor
    df['smoothed_volatility_momentum'] = df['volatility_adjusted_momentum'].rolling(window=7).mean()
    
    # Prepare the output
    heuristics_matrix = df['smoothed_volatility_momentum']
    
    return heuristics_matrix
