def heuristics_v2(df):
    # Compute daily price change
    df['price_change'] = df['close'].diff()
    # Weighted price change using volume as weight
    df['weighted_change'] = df['price_change'] * df['volume']
    # Moving average of the weighted price change
    df['moving_avg_change'] = df['weighted_change'].rolling(window=10).mean()
    # Momentum calculation (change in moving average)
    df['momentum'] = df['moving_avg_change'].diff(periods=5)
    # Factor value is the momentum adjusted by recent volume
    df['factor'] = df['momentum'] * df['volume'].rolling(window=5).mean()
    heuristics_matrix = df['factor'].copy()
    return heuristics_matrix
