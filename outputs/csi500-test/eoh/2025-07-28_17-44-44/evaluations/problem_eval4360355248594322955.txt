def heuristics_v2(df):
    ema_12_close = df['close'].ewm(span=12, adjust=False).mean()
    ema_26_close = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12_close - ema_26_close
    
    ema_9_macd = macd.ewm(span=9, adjust=False).mean()
    
    macd_line_5 = df['close'].ewm(span=5, adjust=False).mean() - df['close'].ewm(span=35, adjust=False).mean()
    signal_line_5 = macd_line_5.ewm(span=9, adjust=False).mean()
    macd_hist_5 = macd_line_5 - signal_line_5
    
    macd_line_10 = df['close'].ewm(span=10, adjust=False).mean() - df['close'].ewm(span=40, adjust=False).mean()
    signal_line_10 = macd_line_10.ewm(span=9, adjust=False).mean()
    macd_hist_10 = macd_line_10 - signal_line_10
    
    macd_diff = macd_hist_5 - macd_hist_10
    
    ema_7_amount = df['amount'].ewm(span=7, adjust=False).mean()
    mean_7_high_low = (df['high'] + df['low']).rolling(window=7).mean() / 2
    
    heuristics_matrix = -(macd_diff - (ema_7_amount * mean_7_high_low))
    
    return heuristics_matrix
