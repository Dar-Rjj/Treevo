def heuristics_v2(df):
    # Bollinger Bands
    sma_20 = df['close'].rolling(window=20).mean()
    std_20 = df['close'].rolling(window=20).std()
    upper_band = sma_20 + 2 * std_20
    lower_band = sma_20 - 2 * std_20
    bollinger_width = (upper_band - lower_band) / sma_20

    # Momentum signal: Rate of Change (ROC) over 20 days
    roc_20 = (df['close'] / df['close'].shift(20) - 1) * 100

    # Volume signal: Today's volume divided by the 20-day SMA of volume
    vol_sma_20 = df['volume'].rolling(window=20).mean()
    volume_signal = df['volume'] / vol_sma_20

    # Composite alpha factor as the simple average of the above signals
    heuristics_matrix = (bollinger_width + roc_20 + volume_signal) / 3

    return heuristics_matrix
