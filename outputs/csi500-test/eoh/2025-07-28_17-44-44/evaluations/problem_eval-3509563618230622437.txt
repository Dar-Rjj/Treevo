import pandas as pd

def heuristics_v2(df):
    # Calculate RSI for close prices
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    # Calculate On-Balance Volume (OBV)
    obv = ((df['close'] - df['close'].shift(1)) / df['close']).apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    obv = (obv * df['volume']).cumsum()
    
    # Calculate ADX
    tr = pd.DataFrame({'HL': df['high'] - df['low'],
                       'HPC': abs(df['high'] - df['close'].shift(1)),
                       'LPC': abs(df['low'] - df['close'].shift(1))}).max(axis=1)
    atr = tr.rolling(window=14).mean()
    plus_dm = (df['high'].diff() > 0) & (df['high'].diff() > df['low'].diff())
    minus_dm = (df['low'].diff() < 0) & (df['low'].diff() < df['high'].diff())
    plus_di = 100 * (plus_dm * tr).rolling(window=14).sum() / (atr * 14)
    minus_di = 100 * (minus_dm * tr).rolling(window=14).sum() / (atr * 14)
    dx = (abs(plus_di - minus_di) / (plus_di + minus_di)) * 100
    adx = dx.rolling(window=14).mean()
    
    # Composite alpha factor as the simple average of the above signals
    heuristics_matrix = (rsi + obv + adx) / 3
    
    return heuristics_matrix
