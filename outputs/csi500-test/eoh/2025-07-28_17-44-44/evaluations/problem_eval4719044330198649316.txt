import pandas as pd

def heuristics_v2(df):
    # Rate of change in closing prices over 20 days
    roc_close = df['close'].pct_change(periods=20)
    
    # Ratio between the average volume over the last 30 days and the latest day's volume
    avg_vol_30d = df['volume'].rolling(window=30).mean()
    latest_vol = df['volume']
    vol_ratio = avg_vol_30d / latest_vol
    
    # Volatility-adjusted momentum: difference between high and low adjusted by MAD of returns over 10 days
    daily_returns = df['close'].pct_change()
    mad_returns = daily_returns.rolling(window=10).apply(lambda x: x.mad(), raw=True)
    vol_adj_momentum = (df['high'] - df['low']) / mad_returns
    
    # Composite alpha factor
    heuristics_matrix = roc_close + vol_ratio + vol_adj_momentum
    
    return heuristics_matrix
