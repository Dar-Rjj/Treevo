def heuristics_v2(df):
    # Calculate 10-day and 30-day RSI of close prices
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain_10 = gain.rolling(window=10).mean()
    avg_loss_10 = loss.rolling(window=10).mean()
    rs_10 = avg_gain_10 / avg_loss_10
    rsi_10 = 100 - (100 / (1 + rs_10))

    avg_gain_30 = gain.rolling(window=30).mean()
    avg_loss_30 = loss.rolling(window=30).mean()
    rs_30 = avg_gain_30 / avg_loss_30
    rsi_30 = 100 - (100 / (1 + rs_30))

    # Calculate 20-day EMA of volume
    ema_20_volume = df['volume'].ewm(span=20, adjust=False).mean()

    # Calculate 5-day average of the true range
    tr = df['high'] - df['low']
    avg_tr_5 = tr.rolling(window=5).mean()

    # Calculate the 10-day standard deviation of closing prices
    std_dev_close_10 = df['close'].rolling(window=10).std()

    # Composite alpha factor
    heuristics_matrix = rsi_10 + rsi_30 + ema_20_volume + (avg_tr_5 / std_dev_close_10)

    return heuristics_matrix
