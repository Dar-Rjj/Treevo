def heuristics_v2(df):
    # Calculate 50-day and 100-day EMAs of close prices
    ema_50_close = df['close'].ewm(span=50, adjust=False).mean()
    ema_100_close = df['close'].ewm(span=100, adjust=False).mean()

    # Calculate the difference between 50-day and 100-day EMAs
    ema_diff = ema_50_close - ema_100_close

    # Calculate 20-day standard deviation of daily returns
    daily_returns = df['close'].pct_change()
    std_dev_20 = daily_returns.rolling(window=20).std()

    # Compute the main factor
    main_factor = ema_diff / std_dev_20

    # Calculate 14-day EMA of volume
    ema_14_volume = df['volume'].ewm(span=14, adjust=False).mean()

    # Calculate 14-day Average True Range
    tr = df['high'] - df['low']
    atr_14 = tr.rolling(window=14).mean()

    # Heuristic score calculation
    heuristics_matrix = main_factor + (ema_14_volume * atr_14 ** 0.5)
    
    return heuristics_matrix
