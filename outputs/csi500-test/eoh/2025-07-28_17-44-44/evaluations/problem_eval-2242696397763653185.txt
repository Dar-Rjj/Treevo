def heuristics_v2(df):
    delta_close = df['close'].diff()
    gain_21 = (delta_close.where(delta_close > 0, 0)).rolling(window=21).mean()
    loss_21 = (-delta_close.where(delta_close < 0, 0)).rolling(window=21).mean()
    rsi_21 = 100 - (100 / (1 + gain_21 / loss_21))
    
    gain_42 = (delta_close.where(delta_close > 0, 0)).rolling(window=42).mean()
    loss_42 = (-delta_close.where(delta_close < 0, 0)).rolling(window=42).mean()
    rsi_42 = 100 - (100 / (1 + gain_42 / loss_42))
    
    rsi_ratio = rsi_21 / rsi_42
    
    ema_10_volume = df['volume'].ewm(span=10, adjust=False).mean()
    std_10_close = df['close'].rolling(window=10).std()
    
    mom_30 = df['close'].pct_change(30)
    
    heuristics_matrix = rsi_ratio - (ema_10_volume * std_10_close) + mom_30
    
    return heuristics_matrix
