import pandas as pd

def heuristics_v2(df):
    df['close_diff'] = df['close'].diff()
    pos_changes_sum_10 = df['close_diff'].apply(lambda x: x if x > 0 else 0).rolling(window=10).sum()
    abs_changes_sum_30 = df['close_diff'].abs().rolling(window=30).sum()
    volume_ma_5 = df['volume'].rolling(window=5).mean()
    heuristics_matrix = (pos_changes_sum_10 / abs_changes_sum_30) * volume_ma_5
    return heuristics_matrix
