def heuristics_v2(df):
    # Calculate 14-day and 28-day EMAs of high prices
    ema_14_high = df['high'].ewm(span=14, adjust=False).mean()
    ema_28_high = df['high'].ewm(span=28, adjust=False).mean()

    # Calculate 14-day and 28-day EMAs of low prices
    ema_14_low = df['low'].ewm(span=14, adjust=False).mean()
    ema_28_low = df['low'].ewm(span=28, adjust=False).mean()

    # Difference between EMAs of high and low prices
    diff_ema_high = ema_14_high - ema_28_high
    diff_ema_low = ema_14_low - ema_28_low

    # Average of the differences
    avg_diff_ema = (diff_ema_high + diff_ema_low) / 2

    # Calculate 5-day EMA of volume
    ema_5_volume = df['volume'].ewm(span=5, adjust=False).mean()

    # Calculate 5-day mean of high minus low prices
    mean_5_hl = (df['high'] - df['low']).rolling(window=5).mean()

    # Calculate 5-day standard deviation of high minus low prices
    std_5_hl = (df['high'] - df['low']).rolling(window=5).std()

    # Coefficient of variation (CV) of high minus low prices
    cv_5_hl = std_5_hl / mean_5_hl

    # Heuristic score calculation
    heuristics_matrix = avg_diff_ema - (ema_5_volume * cv_5_hl)

    return heuristics_matrix
