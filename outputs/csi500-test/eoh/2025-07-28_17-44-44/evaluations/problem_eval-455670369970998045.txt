def heuristics_v2(df):
    def compute_lagged_diffs(series, lags=[1, 2, 3]):
        return pd.concat([series.shift(lag) - series for lag in lags], axis=1).sum(axis=1)
    
    price_diff_heuristic = compute_lagged_diffs(df['high'] - df['low'])
    volume_change_heuristic = df['volume'].pct_change().fillna(0)
    heuristics_matrix = price_diff_heuristic + volume_change_heuristic
    return heuristics_matrix
