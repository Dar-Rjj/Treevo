def heuristics_v2(df):
    # Calculate %K and %D for 10-day and 30-day Stochastic Oscillator
    lowest_10 = df['low'].rolling(window=10).min()
    highest_10 = df['high'].rolling(window=10).max()
    k_10 = 100 * (df['close'] - lowest_10) / (highest_10 - lowest_10)
    d_10 = k_10.rolling(window=3).mean()

    lowest_30 = df['low'].rolling(window=30).min()
    highest_30 = df['high'].rolling(window=30).max()
    k_30 = 100 * (df['close'] - lowest_30) / (highest_30 - lowest_30)
    d_30 = k_30.rolling(window=3).mean()

    stoch_ratio = d_10 / d_30

    # Adjust the 14-day EMA of the volume using the mean of the last 14 days' high and low prices
    ema_14_volume = df['volume'].ewm(span=14, adjust=False).mean()
    mean_14_high_low = (df['high'] + df['low']).rolling(window=14).mean() / 2

    heuristics_matrix = stoch_ratio - (ema_14_volume * mean_14_high_low)

    return heuristics_matrix
