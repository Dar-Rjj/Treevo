def heuristics_v2(df):
    # Calculate 50-day and 100-day EMAs of adjusted close prices
    ema_50_close = df['close'].ewm(span=50, adjust=False).mean()
    ema_100_close = df['close'].ewm(span=100, adjust=False).mean()

    # Difference between EMAs of adjusted close prices
    diff_ema_close = ema_50_close - ema_100_close

    # Calculate daily returns
    daily_returns = df['close'].pct_change()

    # Calculate the sum of positive and negative returns over the past 10 days
    pos_returns = daily_returns.rolling(window=10).apply(lambda x: np.sum(x[x > 0]), raw=False)
    neg_returns = daily_returns.rolling(window=10).apply(lambda x: np.sum(x[x < 0]), raw=False)

    # Weighted average of positive and negative returns
    weighted_avg_returns = (pos_returns * 2 + neg_returns) / 3

    # Calculate the standard deviation of the last 30 days' returns for volatility
    vol_penalty = daily_returns.rolling(window=30).std()

    # Heuristic score calculation
    heuristics_matrix = diff_ema_close + weighted_avg_returns - vol_penalty

    return heuristics_matrix
