def heuristics_v2(df):
    # Calculate 14-day and 28-day Bollinger Bands
    ma_14_close = df['close'].rolling(window=14).mean()
    ma_28_close = df['close'].rolling(window=28).mean()
    std_14_close = df['close'].rolling(window=14).std()
    std_28_close = df['close'].rolling(window=28).std()

    bb_width_14 = 2 * std_14_close
    bb_width_28 = 2 * std_28_close

    # Ratio between Bollinger Bands widths
    bb_ratio = bb_width_14 / bb_width_28

    # Calculate 20-day EMA of volume
    ema_20_volume = df['volume'].ewm(span=20, adjust=False).mean()

    # Calculate 20-day coefficient of variation of close prices
    cv_20_close = std_28_close / ma_28_close

    # Heuristic score calculation
    heuristics_matrix = bb_ratio * (ema_20_volume * cv_20_close)

    return heuristics_matrix
