import pandas as pd

def heuristics_v2(df):
    df['close_diff'] = df['close'].diff()
    pos_changes_sum_5 = df['close_diff'].apply(lambda x: x if x > 0 else 0).rolling(window=5).sum()
    abs_changes_sum_20 = df['close_diff'].abs().rolling(window=20).sum()
    heuristics_matrix = (pos_changes_sum_5 / abs_changes_sum_20) * df['volume']
    return heuristics_matrix
