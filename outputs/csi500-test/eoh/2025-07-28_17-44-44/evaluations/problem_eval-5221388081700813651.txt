import pandas as pd
import ta

def heuristics_v2(df):
    price_ratio = df['close'] / ((df['high'].rolling(window=30).median() + df['low'].rolling(window=30).median()) / 2)
    volume_rsi = ta.momentum.RSIIndicator(df['volume'], window=14).rsi()
    combined_factors = price_ratio * volume_rsi
    heuristics_matrix = combined_factors.rolling(window=20).mean()
    return heuristics_matrix
