def heuristics_v2(df):
    def wma_momentum(row, window=10):
        return (row['close'] - df.loc[row.name - pd.Timedelta(days=window-1):row.name, 'close'].mean()) * row['volume']
    
    heuristics_matrix = df.apply(wma_momentum, axis=1)
    return heuristics_matrix
