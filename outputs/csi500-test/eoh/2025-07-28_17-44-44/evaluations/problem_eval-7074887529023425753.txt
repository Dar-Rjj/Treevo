def heuristics_v2(df):
    ma_10_close = df['close'].rolling(window=10).mean()
    ma_20_close = df['close'].rolling(window=20).mean()
    
    price_change = df['close'].pct_change().fillna(0)
    ema_7_price_change = price_change.ewm(span=7, adjust=False).mean()
    
    avg_5_volume = df['volume'].rolling(window=5).mean()
    
    ma_diff = ma_10_close - ma_20_close
    weighted_ema = ema_7_price_change * avg_5_volume
    
    heuristics_matrix = ma_diff + weighted_ema
    
    return heuristics_matrix
