import pandas as pd
import talib

def heuristics_v2(df):
    # ADX over 14 days
    adx = talib.ADX(df['high'], df['low'], df['close'], timeperiod=14)
    
    # EMA of closing prices over 50 days
    ema_close_50 = talib.EMA(df['close'], timeperiod=50)
    
    # Ratio between the highest and lowest close price in the last 20 days
    high_close_20 = df['close'].rolling(window=20).max()
    low_close_20 = df['close'].rolling(window=20).min()
    close_ratio = high_close_20 / low_close_20
    
    # Composite alpha factor
    heuristics_matrix = adx + ema_close_50 + close_ratio
    
    return heuristics_matrix
