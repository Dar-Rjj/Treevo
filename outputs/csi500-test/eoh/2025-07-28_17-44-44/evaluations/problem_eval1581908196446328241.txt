def heuristics_v2(df):
    # Price Trend Direction: difference between 50-day and 200-day moving average of close prices
    ma_50 = df['close'].rolling(window=50).mean()
    ma_200 = df['close'].rolling(window=200).mean()
    trend_direction = ma_50 - ma_200
    
    # Price Stability: standard deviation of daily returns over the past 20 days
    daily_returns = df['close'].pct_change()
    price_stability = daily_returns.rolling(window=20).std()
    
    # Liquidity Measure: ratio of volume to the 30-day average volume
    avg_volume_30 = df['volume'].rolling(window=30).mean()
    liquidity_measure = df['volume'] / avg_volume_30

    # Composite alpha factor as a weighted sum of the above three signals
    heuristics_matrix = 2 * trend_direction - 1.5 * price_stability + 1 * liquidity_measure
    heuristics_matrix = pd.Series(heuristics_matrix, index=df.index)
    
    return heuristics_matrix
