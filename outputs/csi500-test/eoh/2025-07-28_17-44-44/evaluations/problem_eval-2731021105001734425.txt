def heuristics_v2(df):
    lowest_30_close = df['close'].rolling(window=30).min()
    highest_30_close = df['close'].rolling(window=30).max()
    stoch_30 = (df['close'] - lowest_30_close) / (highest_30_close - lowest_30_close) * 100
    
    lowest_90_close = df['close'].rolling(window=90).min()
    highest_90_close = df['close'].rolling(window=90).max()
    stoch_90 = (df['close'] - lowest_90_close) / (highest_90_close - lowest_90_close) * 100
    
    stoch_ratio = stoch_30 / stoch_90
    
    ema_15_volume = df['volume'].ewm(span=15, adjust=False).mean()
    std_15_close = df['close'].rolling(window=15).std()
    
    heuristics_matrix = stoch_ratio - (ema_15_volume * std_15_close)
    
    return heuristics_matrix
