def heuristics_v2(df):
    lowest_50 = df['close'].rolling(window=50).min()
    highest_50 = df['close'].rolling(window=50).max()
    k_50 = 100 * (df['close'] - lowest_50) / (highest_50 - lowest_50)
    
    lowest_100 = df['close'].rolling(window=100).min()
    highest_100 = df['close'].rolling(window=100).max()
    k_100 = 100 * (df['close'] - lowest_100) / (highest_100 - lowest_100)
    
    stoch_osc_50_100 = k_50 - k_100
    
    ema_30_amount = df['amount'].ewm(span=30, adjust=False).mean()
    avg_30_open_close = (df['open'] + df['close']).rolling(window=30).mean() / 2
    
    heuristics_matrix = stoch_osc_50_100 - (ema_30_amount * avg_30_open_close)
    
    return heuristics_matrix
