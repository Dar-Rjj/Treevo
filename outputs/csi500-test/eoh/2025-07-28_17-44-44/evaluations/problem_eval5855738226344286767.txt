def heuristics_v2(df):
    delta_close = df['close'].diff()
    gain_21 = (delta_close.where(delta_close > 0, 0)).rolling(window=21).mean()
    loss_21 = (-delta_close.where(delta_close < 0, 0)).rolling(window=21).mean()
    rsi_21 = 100 - (100 / (1 + gain_21 / loss_21))
    
    gain_42 = (delta_close.where(delta_close > 0, 0)).rolling(window=42).mean()
    loss_42 = (-delta_close.where(delta_close < 0, 0)).rolling(window=42).mean()
    rsi_42 = 100 - (100 / (1 + gain_42 / loss_42))
    
    rsi_ratio = rsi_21 / rsi_42
    
    ema_10_volume = df['volume'].ewm(span=10, adjust=False).mean()
    high_low_diff_10 = df['close'].rolling(window=10).max() - df['close'].rolling(window=10).min()
    
    heuristics_matrix = rsi_ratio - (ema_10_volume * high_low_diff_10)
    
    return heuristics_matrix
