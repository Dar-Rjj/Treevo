def heuristics_v2(df):
    # Calculate 5-day RSI of close prices
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=5).mean()
    avg_loss = loss.rolling(window=5).mean()
    rs = avg_gain / avg_loss
    rsi_5 = 100 - (100 / (1 + rs))

    # Calculate 14-day ATR
    tr = df[['high', 'low']].apply(lambda x: x.diff().abs().max(axis=1), axis=1)
    tr['prev_close'] = df['close'].shift(1)
    tr['h_pc'] = (df['high'] - tr['prev_close']).abs()
    tr['l_pc'] = (df['low'] - tr['prev_close']).abs()
    tr['tr'] = tr[['high', 'low', 'h_pc', 'l_pc']].max(axis=1)
    atr_14 = tr['tr'].rolling(window=14).mean()

    # Calculate 30-day standard deviation of the daily returns
    daily_returns = df['close'].pct_change().fillna(0)
    std_30 = daily_returns.rolling(window=30).std()

    # Heuristic score calculation
    heuristics_matrix = (rsi_5 / atr_14) - std_30

    return heuristics_matrix
