import pandas as pd

def heuristics_v2(df):
    df['close_diff'] = df['close'].diff()
    pos_changes_avg_10 = df['close_diff'].apply(lambda x: x if x > 0 else 0).rolling(window=10).mean()
    abs_changes_avg_20 = df['close_diff'].abs().rolling(window=20).mean()
    heuristics_matrix = (pos_changes_avg_10 * df['volume']) / abs_changes_avg_20
    return heuristics_matrix
