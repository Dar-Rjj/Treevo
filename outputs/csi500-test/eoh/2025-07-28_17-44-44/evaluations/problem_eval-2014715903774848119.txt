import pandas as pd

def heuristics_v2(df):
    def calculate_roc(series, n=1):
        return series.pct_change(periods=n)
    
    rocs = df.apply(calculate_roc, n=1).dropna()
    future_returns = df['close'].pct_change().shift(-1).dropna()
    
    weights = rocs.corrwith(future_returns)
    heuristics_matrix = (rocs * weights).sum(axis=1)
    
    return heuristics_matrix
