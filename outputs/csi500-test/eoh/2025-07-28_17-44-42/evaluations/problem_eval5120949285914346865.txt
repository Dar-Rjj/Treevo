import pandas as pd

def heuristics_v2(df):
    def calculate_rsi(series, period=14):
        delta = series.diff(1)
        gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    close_prices = df['close']
    rsi_values = calculate_rsi(close_prices)
    ma_50 = close_prices.rolling(window=50).mean()
    ma_200 = close_prices.rolling(window=200).mean()
    heuristic_series = (rsi_values - 50) * (ma_50 - ma_200)
    return heuristics_matrix
