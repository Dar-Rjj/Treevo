def heuristics_v2(df):
    momentum = df['close'].pct_change()
    volatility = df['close'].rolling(window=40).std()  # Extended window from 30 to 40
    weight_close = (momentum / volatility).apply(lambda x: 4 * x if x > 0 else 2 * x)  # Dynamic weights based on momentum sign
    adjusted_factor = np.log1p(df['open'] + df['high'] + df['low']) + (df['close'] * weight_close) + (df['volume'] * df['amount'])  # Logarithmic adjustment and different combination
    smoothed_factor = (adjusted_factor) / 5  # Simplified divisor
    heuristics_matrix = smoothed_factor.ewm(span=20, adjust=False).mean()  # Increased span from 15 to 20 for smoother results
    return heuristics_matrix
