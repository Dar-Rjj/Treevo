def heuristics_v2(df):
    def calculate_moving_average(series, window):
        return series.rolling(window=window).mean()
    
    def calculate_momentum(series, window):
        return series / series.shift(window) - 1
    
    # Calculate short and long-term moving averages for close prices
    df['short_MA'] = calculate_moving_average(df['close'], window=5)
    df['long_MA'] = calculate_moving_average(df['close'], window=20)
    
    # Calculate momentum for close prices over 5 and 20 days
    df['momentum_5d'] = calculate_momentum(df['close'], window=5)
    df['momentum_20d'] = calculate_momentum(df['close'], window=20)
    
    # Weights for the linear combination (example values)
    weights = {'short_MA': 0.3, 'long_MA': -0.2, 'momentum_5d': 0.4, 'momentum_20d': 0.6}
    
    # Generate the heuristics factor
    heuristics_series = df.apply(lambda row: sum(row[col] * weights[col] for col in weights.keys()), axis=1)
    
    heuristics_matrix = heuristics_series.to_frame(name='heuristics_value')
    
    return heuristics_matrix
