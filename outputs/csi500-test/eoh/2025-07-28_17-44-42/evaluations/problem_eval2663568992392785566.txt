def heuristics_v2(df):
    def calculate_moving_average(series, window):
        return series.rolling(window=window).mean()
    
    def calculate_momentum(series, window):
        return series / series.shift(window) - 1
    
    df['short_MA'] = calculate_moving_average(df['close'], window=5)
    df['medium_MA'] = calculate_moving_average(df['close'], window=10)
    df['momentum_5d'] = calculate_momentum(df['close'], window=5)
    df['momentum_10d'] = calculate_momentum(df['close'], window=10)
    df['volume_change_5d'] = calculate_momentum(df['volume'], window=5)
    df['volume_change_10d'] = calculate_momentum(df['volume'], window=10)
    
    weights = {'short_MA': 0.4, 'medium_MA': -0.1, 'momentum_5d': 0.3, 'momentum_10d': 0.2, 'volume_change_5d': 0.2, 'volume_change_10d': 0.1}
    
    heuristics_series = df.apply(lambda row: sum(row[col] * weights[col] for col in weights.keys()), axis=1)
    
    heuristics_matrix = heuristics_series.to_frame(name='heuristics_value')
    
    return heuristics_matrix
