import pandas as pd

def heuristics_v2(df):
    rel_strength = (df['close'] - df[['open', 'high', 'low']].min(axis=1)) / (df[['open', 'high', 'low']].max(axis=1) - df[['open', 'high', 'low']].min(axis=1))
    smoothed_factor = rel_strength.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
