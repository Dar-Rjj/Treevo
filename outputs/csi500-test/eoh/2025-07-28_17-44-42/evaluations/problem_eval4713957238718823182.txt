def heuristics_v2(df):
    close = df['close']
    delta = close.diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up14 = up.rolling(window=14).mean()
    roll_down14_abs = down.abs().rolling(window=14).mean()
    rs = roll_up14 / roll_down14_abs
    rsi = 100.0 - (100.0 / (1.0 + rs))
    daily_return = df['close'].pct_change()
    factor = (rsi * daily_return * df['volume']) / 3
    heuristics_matrix = factor.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
