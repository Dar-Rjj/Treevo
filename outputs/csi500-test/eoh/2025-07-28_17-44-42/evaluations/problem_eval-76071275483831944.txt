def heuristics_v2(df):
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up1 = up.ewm(alpha=1/14, adjust=False).mean()
    roll_down1 = down.abs().ewm(alpha=1/14, adjust=False).mean()
    RS = roll_up1 / roll_down1
    RSI = 100.0 - (100.0 / (1.0 + RS))
    
    high_low = df['high'] - df['low']
    high_close = (df['high'] - df['close'].shift()).abs()
    low_close = (df['low'] - df['close'].shift()).abs()
    ranges = pd.concat([high_low, high_close, low_close], axis=1)
    true_range = pd.DataFrame(ranges.max(axis=1), columns=['true_range'])
    
    ATR = true_range['true_range'].ewm(span=14, adjust=False).mean()
    ATR_adjusted = ATR * df['volume'].rolling(window=5).mean() / df['volume'].rolling(window=20).mean()
    
    composite_indicator = (RSI + ATR_adjusted) / 2
    EMA = composite_indicator.ewm(span=14, adjust=False).mean()
    TEMA = 3 * EMA - 3 * EMA.ewm(span=14, adjust=False).mean() + EMA.ewm(span=14, adjust=False).mean().ewm(span=14, adjust=False).mean()
    
    heuristics_matrix = TEMA
    return heuristics_matrix
