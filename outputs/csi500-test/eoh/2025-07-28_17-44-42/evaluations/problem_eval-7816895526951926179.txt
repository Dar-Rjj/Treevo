import pandas as pd

def heuristics_v2(df):
    atr = df[['high', 'low', 'close']].max(axis=1) - df[['high', 'low', 'close']].min(axis=1)
    avg_atr = atr.rolling(window=14).mean()
    close_to_atr_ratio = df['close'] / avg_atr
    log_adjusted = (close_to_atr_ratio + 1).apply(np.log)
    smoothed_factor = (log_adjusted * df['volume']).ewm(span=20, adjust=False).mean()
    return heuristics_matrix
