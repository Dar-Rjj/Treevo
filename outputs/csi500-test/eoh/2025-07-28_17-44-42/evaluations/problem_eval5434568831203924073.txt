import pandas as pd

def heuristics_v2(df):
    macd_line = df['close'].ewm(span=12).mean() - df['close'].ewm(span=26).mean()
    signal_line = macd_line.ewm(span=9).mean()
    macd_weight = macd_line - signal_line
    weight_close = 1 / df['volume']
    smoothed_factor = (df['open'] * macd_weight + df['high'] * macd_weight + df['low'] * macd_weight + df['close'] * weight_close + df['amount'] * macd_weight) / 5
    heuristics_matrix = smoothed_factor.rolling(window=20).mean()
    return heuristics_matrix
