import pandas as pd

def heuristics_v2(df):
    close = df['close']
    volume = df['volume']
    momentum = (close - close.shift(20)) / close.shift(20)
    mean_reversion = (close - close.rolling(window=50).mean()) / close.rolling(window=50).std()
    volume_signal = (volume - volume.rolling(window=20).mean()) / volume.rolling(window=20).mean()
    heuristics_matrix = 0.5 * momentum + 0.3 * mean_reversion + 0.2 * volume_signal
    return heuristics_matrix
