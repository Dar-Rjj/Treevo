def heuristics_v2(df):
    roc_short = df['close'].pct_change(periods=10)
    roc_medium = df['close'].pct_change(periods=30)
    roc_long = df['close'].pct_change(periods=60)
    volume_wma = (df['volume'] * 3 + df['volume'].shift(1) * 2 + df['volume'].shift(2)).rolling(window=20).mean() / 6
    combined_factor = (roc_short + roc_medium + roc_long) / 3
    heuristics_matrix = (combined_factor * volume_wma).rolling(window=20).mean()
    return heuristics_matrix
