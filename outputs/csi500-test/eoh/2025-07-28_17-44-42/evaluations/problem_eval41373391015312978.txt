def heuristics_v2(df):
    relative_strength = df['close'].pct_change().rolling(window=20).mean()
    volatility = df['close'].rolling(window=30).std()
    weighted_score = (df['open'] * 1 + df['high'] * 2 + df['low'] * 3 + df['close'] * 4) / 10
    adjusted_score = weighted_score * (relative_strength / volatility)
    transformed_factor = adjusted_score.apply(lambda x: x ** 2 if x > 0 else -x ** 2)
    heuristics_matrix = transformed_factor.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
