import pandas as pd
import numpy as np

def heuristics_v2(df):
    lookback = 20
    df['highest_high'] = df['high'].rolling(window=lookback).max()
    df['lowest_low'] = df['low'].rolling(window=lookback).min()
    rs = (df['close'] - df['lowest_low']) / (df['highest_high'] - df['lowest_low'])
    log_volume_return = np.log(df['volume']).diff()
    adjusted_factor = rs * log_volume_return
    heuristics_matrix = adjusted_factor.ewm(span=10, adjust=False).mean()
    return heuristics_matrix
