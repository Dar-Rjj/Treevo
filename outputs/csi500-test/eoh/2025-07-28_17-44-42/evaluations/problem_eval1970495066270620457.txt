import pandas as pd

def heuristics_v2(df):
    log_returns = df['close'].apply(np.log).diff()
    vol_to_amt_ratio = df['volume'] / df['amount']
    raw_factor = log_returns * vol_to_amt_ratio
    heuristics_matrix = raw_factor.rolling(window=10).mean()
    return heuristics_matrix
