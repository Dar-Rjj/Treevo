import pandas as pd
import numpy as np

def heuristics_v2(df):
    ma_close_20 = df['close'].rolling(window=20).mean()
    ma_close_100 = df['close'].rolling(window=100).mean()
    ema_price_range_percentage_50 = ((df['high'] / df['low']).ewm(span=50, adjust=False).mean())
    volume_change_10 = df['volume'].pct_change(periods=10)
    
    heuristics_matrix = np.log(ma_close_20 / ma_close_100) + ema_price_range_percentage_50 + np.log(1 + volume_change_10)
    return heuristics_matrix
