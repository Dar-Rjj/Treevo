import pandas as pd

def heuristics_v2(df):
    df['tr'] = df[['high', 'low', 'close']].apply(lambda x: max(x[0], x[1]) - min(x[0], x[1]), axis=1)
    atr = df['tr'].rolling(window=14).mean()
    weight_close = atr / df['close']
    smoothed_factor = (df['open'] * weight_close + df['high'] + df['low'] + df['close'] + df['amount']) / 5
    heuristics_matrix = smoothed_factor.expanding().mean()
    return heuristics_matrix
