import pandas as pd

def heuristics_v2(df):
    def calc_rolling_stats(series, window=10):
        return series.rolling(window=window).agg(['mean', 'std'])
    
    def transform_non_linear(series):
        return (series - series.shift(1)) / series.shift(1)
    
    heuristics_list = []
    for col in df.columns:
        stats = calc_rolling_stats(df[col])
        transformed = transform_non_linear(df[col])
        heuristics_list.append(pd.concat([stats, transformed], axis=1))
    
    heuristics_matrix = pd.concat(heuristics_list, axis=1).fillna(0)
    return heuristics_matrix
