import pandas as pd

def heuristics_v2(df):
    close_strength = df['close'].pct_change().rolling(window=20).sum()
    vol_smoothed = df['volume'].ewm(span=30, adjust=False).mean()
    price_volatility = (df['high'] - df['low']).rolling(window=20).std()
    
    heuristics_matrix = close_strength * vol_smoothed / price_volatility
    return heuristics_matrix
