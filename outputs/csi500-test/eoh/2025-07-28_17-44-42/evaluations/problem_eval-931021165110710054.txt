def heuristics_v2(df):
    log_returns = np.log(df['close'] / df['close'].shift(1))
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    r_up = up.ewm(com=13, adjust=False).mean()
    r_down = down.ewm(com=13, adjust=False).mean().abs()
    rsi = 100 - (100 / (1 + r_up / r_down))
    vol_ratio = df['volume'] / df['volume'].rolling(window=20).mean()
    smoothed_factor = (log_returns + rsi + vol_ratio) / 3
    heuristics_matrix = smoothed_factor.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
