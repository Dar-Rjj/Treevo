def heuristics_v2(df):
    log_diff = (df['close'] - df['open']).apply(lambda x: math.log(abs(x) + 1))
    adj_returns = log_diff / df['volume']
    sma_adj_returns = adj_returns.rolling(window=50).mean()
    combined_factor = (adj_returns + sma_adj_returns) / 2
    heuristics_matrix = combined_factor.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
