def heuristics_v2(df):
    price_range = df['high'] - df['low']
    std_price_range_20 = price_range.rolling(window=20).std()
    ema_volume_10 = df['volume'].ewm(span=10, adjust=False).mean()
    interaction_matrix = std_price_range_20 * ema_volume_10
    weights = np.array([0.1, 0.2, 0.3, 0.2, 0.1, 0.05, 0.05])
    heuristics_matrix = interaction_matrix.rolling(window=7).apply(lambda x: np.sum(x * weights), raw=True)
    return heuristics_matrix
