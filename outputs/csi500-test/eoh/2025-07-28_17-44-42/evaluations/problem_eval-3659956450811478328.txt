import pandas as pd

def heuristics_v2(df):
    price_ratio = df['high'] / df['low']
    avg_price_ratio_20 = price_ratio.rolling(window=20).mean()
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    heuristics_matrix = (avg_price_ratio_20 * avg_volume_20).ewm(span=7, adjust=False).mean()
    return heuristics_matrix
