def heuristics_v2(df):
    close = df['close']
    rsi = 100 - (100 / (1 + (close.diff(1).rolling(window=14).apply(lambda x: x[x > 0].mean() / -x[x < 0].mean(), raw=True))))
    macd_line = close.ewm(span=12, adjust=False).mean() - close.ewm(span=26, adjust=False).mean()
    signal_line = macd_line.ewm(span=9, adjust=False).mean()
    macd_hist = macd_line - signal_line
    volume_trend = df['volume'].rolling(window=20).mean().pct_change()
    heuristics_matrix = (rsi * 0.5) + (macd_hist * 0.3) + (volume_trend * 0.2)
    return heuristics_matrix
