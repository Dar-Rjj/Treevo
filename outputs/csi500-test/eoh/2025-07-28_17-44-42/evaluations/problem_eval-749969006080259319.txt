import pandas as pd

def heuristics_v2(df):
    momentum = df['close'].pct_change()
    sma_50 = df['close'].rolling(window=50).mean()
    vol_ratio = df['volume'] / sma_50
    weighted_momentum = momentum * vol_ratio
    heuristics_matrix = (df['open'] + df['high'] + df['low'] + (df['close'] * weighted_momentum) + df['amount']) * df['volume']
    heuristics_matrix = heuristics_matrix.rolling(window=20).apply(lambda x: (x * df.loc[x.index, 'volume']).sum() / df.loc[x.index, 'volume'].sum(), raw=False)
    return heuristics_matrix
