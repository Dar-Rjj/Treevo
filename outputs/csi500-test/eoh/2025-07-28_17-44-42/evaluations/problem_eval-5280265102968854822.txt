def heuristics_v2(df):
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    
    # Momentum indicator: 10-day return
    momentum_10d = df['close'].pct_change(10)
    
    # Volatility: Standard deviation of daily returns over last 30 days
    volatility_30d = daily_returns.rolling(window=30).std()
    
    # Volume signal: Ratio of current day's volume to the average volume over the past 30 days
    avg_volume_30d = df['volume'].rolling(window=30).mean()
    volume_ratio = df['volume'] / avg_volume_30d
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * momentum_10d + 0.3 * (1 / volatility_30d) + 0.3 * volume_ratio
    
    return heuristics_matrix
