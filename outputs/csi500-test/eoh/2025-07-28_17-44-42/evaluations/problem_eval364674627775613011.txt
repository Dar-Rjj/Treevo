import pandas as pd

def heuristics_v2(df):
    def calculate_momentum(df, window):
        return df['close'].pct_change(window)

    def calculate_volatility(df, window):
        return df['close'].pct_change().rolling(window=window).std()

    def calculate_volume_change(df, window):
        return df['volume'].pct_change(window)
    
    momentum_7 = calculate_momentum(df, 7)
    momentum_21 = calculate_momentum(df, 21)
    volatility_7 = calculate_volatility(df, 7)
    volume_change_3 = calculate_volume_change(df, 3)
    
    heuristics_matrix = 0.5 * momentum_7 + 0.2 * momentum_21 - 0.15 * volatility_7 + 0.15 * volume_change_3
    return heuristics_matrix
