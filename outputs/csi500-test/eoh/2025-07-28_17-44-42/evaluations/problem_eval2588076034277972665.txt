def heuristics_v2(df):
    momentum = df['close'].pct_change()
    volatility = df['close'].rolling(window=30).std()
    weight_diff = 3 * (momentum / volatility)
    smoothed_factor = ((df['high'] - df['low']) * weight_diff) * 0.4 + (df['open'] * 0.1 + df['close'] * 0.2 + (df['volume'] * df['amount']) * 0.3)
    heuristics_matrix = smoothed_factor.rolling(window=15).mean()
    return heuristics_matrix
