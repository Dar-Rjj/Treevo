def heuristics_v2(df):
    def calculate_price_volatility(series, window):
        return series.rolling(window=window).std()
    
    def calculate_volume_volatility(series, window):
        return series.rolling(window=window).std()
    
    # Calculate short and long-term price volatility
    df['price_vol_5d'] = calculate_price_volatility(df['close'], window=5)
    df['price_vol_20d'] = calculate_price_volatility(df['close'], window=20)
    
    # Calculate short and long-term volume volatility
    df['volume_vol_5d'] = calculate_volume_volatility(df['volume'], window=5)
    df['volume_vol_20d'] = calculate_volume_volatility(df['volume'], window=20)
    
    # Weights for the linear combination (example values)
    weights = {'price_vol_5d': 0.4, 'price_vol_20d': 0.6, 'volume_vol_5d': 0.3, 'volume_vol_20d': 0.1}
    
    # Generate the heuristics factor
    heuristics_series = df.apply(lambda row: sum(row[col] * weights[col] for col in weights.keys()), axis=1)
    
    heuristics_matrix = heuristics_series.to_frame(name='heuristics_value')
    
    return heuristics_matrix
