def heuristics_v2(df):
    price_change = df['close'].diff()
    weight = price_change / df['volume']
    weighted_sum = (df['open'] * weight + df['high'] * weight + df['low'] * weight + df['close'] * weight + df['amount'] * weight) / 5
    heuristics_matrix = weighted_sum.rolling(window=20).mean()
    return heuristics_matrix
