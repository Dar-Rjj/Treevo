def heuristics_v2(df):
    def calculate_moving_average(series, window):
        return series.rolling(window=window).mean()
    
    def calculate_momentum(series, window):
        return series / series.shift(window) - 1
    
    # Calculate short and long-term moving averages for close prices
    df['short_MA'] = calculate_moving_average(df['close'], window=10)
    df['long_MA'] = calculate_moving_average(df['close'], window=30)
    
    # Calculate momentum for close prices over 10 and 30 days
    df['momentum_10d'] = calculate_momentum(df['close'], window=10)
    df['momentum_30d'] = calculate_momentum(df['close'], window=30)
    
    # Calculate the change in volume over 10 and 30 days
    df['volume_change_10d'] = calculate_momentum(df['volume'], window=10)
    df['volume_change_30d'] = calculate_momentum(df['volume'], window=30)
    
    # Weights for the linear combination (example values)
    weights = {'short_MA': 0.2, 'long_MA': -0.1, 'momentum_10d': 0.5, 'momentum_30d': 0.7, 'volume_change_10d': 0.15, 'volume_change_30d': 0.1}
    
    # Generate the heuristics factor
    heuristics_series = df.apply(lambda row: sum(row[col] * weights[col] for col in weights.keys()), axis=1)
    
    return heuristics_matrix
