import pandas as pd

def heuristics_v2(df):
    close = df['close']
    amount = df['amount']
    volume = df['volume']
    vwap = amount / volume
    diff = close - vwap
    std_30 = close.rolling(window=30).std()
    heuristics_matrix = diff / std_30
    return heuristics_matrix
