import pandas as pd

def heuristics_v2(df):
    def calculate_volatility(series, window=30):
        return series.pct_change().rolling(window).std()

    volatilities = df.apply(calculate_volatility)
    total_volatility = volatilities.sum(axis=1)
    weights = volatilities.div(total_volatility, axis=0)

    heuristics_matrix = (df * weights).sum(axis=1)
    
    return heuristics_matrix
