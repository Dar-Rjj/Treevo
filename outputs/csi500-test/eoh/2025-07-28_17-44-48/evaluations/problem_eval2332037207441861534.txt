import pandas as pd

def heuristics_v2(df):
    # Calculate the exponential moving average of the percentage change in closing price
    ema_close_pct_change = df['close'].pct_change().ewm(span=7, adjust=False).mean()
    
    # Calculate the absolute value of the difference between high and low prices as a measure of daily price range
    abs_price_diff = (df['high'] - df['low']).abs()
    
    # Calculate the ratio of amount to volume to infer investor sentiment
    amount_vol_ratio = df['amount'] / df['volume']
    
    # Combine the calculated features into a single heuristic factor
    heuristics_matrix = (ema_close_pct_change + abs_price_diff + amount_vol_ratio) / 3
    
    return heuristics_matrix
