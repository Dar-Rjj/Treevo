def heuristics_v2(df):
    # Calculate the daily price change
    daily_price_change = df['close'] - df['open']
    
    # Calculate the average true range (ATR) over a 14-day period
    tr = df[['high', 'low']].diff(axis=1).max(axis=1)
    atr = tr.rolling(window=14).mean()
    
    # Calculate the ratio of daily price change to ATR
    price_change_to_atr = daily_price_change / atr
    
    # Calculate the 20-day moving average of trading volume
    volume_ma = df['volume'].rolling(window=20).mean()
    
    # Calculate the logarithmic difference between volume and its moving average
    log_volume_diff = (df['volume'] / volume_ma).apply(np.log)
    
    # Integrate the components into a single factor
    heuristics_matrix = price_change_to_atr * log_volume_diff
    
    return heuristics_matrix
