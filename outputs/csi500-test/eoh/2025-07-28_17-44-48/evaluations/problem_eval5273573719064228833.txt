def heuristics_v2(df):
    ema_window = 15
    sma_window = 30
    trading_amount = df['amount']
    ema_trading_amount = trading_amount.ewm(span=ema_window, adjust=False).mean()
    sma_high = df['high'].rolling(window=sma_window).mean()
    heuristics_matrix = ema_trading_amount / sma_high
    return heuristics_matrix
