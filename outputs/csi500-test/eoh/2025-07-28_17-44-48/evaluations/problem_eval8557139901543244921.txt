def heuristics_v2(df):
    ema = df['close'].ewm(span=14, adjust=False).mean()
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    r_up = up.ewm(com=13, adjust=False).mean()
    r_down = down.ewm(com=13, adjust=False).mean().abs()
    rs = r_up / r_down
    rsi = 100 - (100 / (1 + rs))
    heuristics_matrix = ema * rsi
    return heuristics_matrix
