import pandas as pd

def heuristics_v2(df):
    def compute_ema(series, span=10):
        return series.ewm(span=span, adjust=False).mean()
    
    df['price_ratio'] = df['high'] / df['low']
    price_ratio_ema = compute_ema(df['price_ratio'])
    heuristics_matrix = (price_ratio_ema * (df['open'] - df['close']) * df['volume'])
    return heuristics_matrix
