def heuristics_v2(df):
    wma = df['close'].rolling(window=14).mean()
    lowest_low = df['low'].rolling(window=14).min()
    highest_high = df['high'].rolling(window=14).max()
    k_percent = 100 * (df['close'] - lowest_low) / (highest_high - lowest_low)
    heuristics_matrix = wma * k_percent
    return heuristics_matrix
