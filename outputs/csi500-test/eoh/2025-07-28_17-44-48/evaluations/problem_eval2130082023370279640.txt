import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the Exponential Moving Average (EMA) of the 'close' price over a span of 5 days.
    ema_close = df['close'].ewm(span=5, adjust=False).mean()
    # Compute the natural logarithm of the 'volume'.
    log_volume = np.log(df['volume'])
    # Generate the factor by combining EMA of the close and the natural logarithm of the volume.
    def compute_factor(row, ema_close, log_volume):
        return ema_close[row.name] * log_volume[row.name]
    
    heuristics_matrix = df.apply(compute_factor, args=(ema_close, log_volume), axis=1)
    return heuristics_matrix
