def heuristics_v2(df):
    wma = df['close'].rolling(window=14).apply(lambda x: (x * pd.Series(range(1, len(x) + 1))).sum() / pd.Series(range(1, len(x) + 1)).sum(), raw=False)
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).rolling(window=20).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=20).mean()
    std_dev = df['close'].rolling(window=20).std()
    rs = (gain + std_dev) / (loss + std_dev)
    rsi = 100 - (100 / (1 + rs))
    heuristics_matrix = wma * rsi
    return heuristics_matrix
