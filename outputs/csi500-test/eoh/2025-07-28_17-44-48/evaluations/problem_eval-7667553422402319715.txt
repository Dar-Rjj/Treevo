import numpy as np
import pandas as pd

def heuristics_v2(df):
    def compute_factor(row):
        return (row['high'] + row['low']) / 2 * np.log(row['volume'])
    
    # Calculate the EMA of the computed factor
    df['factor'] = df.apply(compute_factor, axis=1)
    df['factor_ema'] = df['factor'].ewm(span=5, adjust=False).mean()
    
    return heuristics_matrix
