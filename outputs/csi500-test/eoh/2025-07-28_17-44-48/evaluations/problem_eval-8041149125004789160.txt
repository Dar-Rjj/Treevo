def heuristics_v2(df):
    # Calculate the difference between the close and open prices
    price_diff = df['close'] - df['open']
    
    # Calculate the highest high and the lowest low over the past 20 days
    highest_high = df['high'].rolling(window=20).max()
    lowest_low = df['low'].rolling(window=20).min()
    
    # Calculate the scaling factor as the ratio of the highest high to the lowest low
    scale_factor = highest_high / lowest_low
    
    # Combine the price difference and the scaling factor
    combined_factor = price_diff * scale_factor
    
    # Add the cumulative sum of the volume
    heuristics_matrix = combined_factor + df['volume'].cumsum()
    
    return heuristics_matrix
