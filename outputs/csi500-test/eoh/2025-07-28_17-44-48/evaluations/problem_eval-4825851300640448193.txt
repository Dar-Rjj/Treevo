def heuristics_v2(df):
    def custom_heuristic(row):
        avg_high_low = df[['high', 'low']].mean(axis=1).rolling(window=20).mean()
        return row['close'] / avg_high_low[row.name]
    
    heuristics_matrix = df.apply(custom_heuristic, axis=1)
    return heuristics_matrix
