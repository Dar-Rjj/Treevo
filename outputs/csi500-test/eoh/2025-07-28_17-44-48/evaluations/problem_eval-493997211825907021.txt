def heuristics_v2(df):
    atr_window = 14
    sma_close_window = 30

    def true_range(row):
        tr = max(row['high'] - row['low'], abs(row['high'] - row['close'].shift(1)), abs(row['low'] - row['close'].shift(1)))
        return tr
    
    df['true_range'] = df.apply(true_range, axis=1)
    avg_true_range = df['true_range'].rolling(window=atr_window).mean()
    avg_close = df['close'].rolling(window=sma_close_window).mean()
    heuristics_matrix = avg_true_range / avg_close
    return heuristics_matrix
