def heuristics_v2(df):
    # Calculate the rate of change in volume
    roc_volume = df['volume'].pct_change()
    
    # Calculate the weighted average of the closing prices
    weights = np.arange(1, 21)
    wma_close = df['close'].rolling(window=20).apply(lambda x: np.dot(x, weights) / weights.sum(), raw=True)
    
    # Integrate the components into a single factor
    heuristics_matrix = roc_volume * wma_close
    
    return heuristics_matrix
