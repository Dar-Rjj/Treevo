```python
import pandas as pd

def heuristics_v2(df):
    # 30-Day Price Momentum
    df['Ct'] = df['close']
    df['Ct_30'] = df['close'].shift(30)
    df['price_momentum'] = (df['Ct'] - df['Ct_30']) / df['Ct_30']

    # Volume Shock
    df['Vt'] = df['volume']
    df['Avg_Vt_30'] = df['volume'].rolling(window=30, min_periods=1).mean().shift(1)  # Exclude day t
    df['volume_shock'] = (df['Vt'] > 2 * df['Avg_Vt_30']).astype(int)

    # High-Low Range
    df['Ht'] = df['high']
    df['Lt'] = df['low']
    df['range'] = df['Ht'] - df['Lt']

    # High-Low Range Momentum
    N = 30
    df['range_momentum'] = df['range'] - df['range'].shift(N-1)

    # Combine Factors
    df['factor'] = df['price_momentum'] * df['volume_shock'] + df['range_momentum']

    return df['factor']
```
