```python
import pandas as pd
import numpy as np
from talib import RSI, ATR

def heuristics_v2(df):
    # Calculate SMA of closing prices for 5, 10, and 20 days
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Compute the difference between the current close and each SMA
    df['SMA_diff_5'] = df['close'] - df['SMA_5']
    df['SMA_diff_10'] = df['close'] - df['SMA_10']
    df['SMA_diff_20'] = df['close'] - df['SMA_20']

    # Calculate the percentage change in closing prices over the last 5 and 10 days
    df['pct_change_5'] = df['close'].pct_change(periods=5)
    df['pct_change_10'] = df['close'].pct_change(periods=10)

    # Calculate the RSI (Relative Strength Index) over a 14-day period
    df['RSI_14'] = RSI(df['close'], timeperiod=14)

    # Calculate the ratio of current volume to the 20-day average volume
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()

    # Determine if the volume is above or below its 20-day moving average
    df['volume_above_avg'] = (df['volume'] > df['volume'].rolling(window=20).mean()).astype(int)

    # Calculate the standard deviation of daily returns over the last 20 days
    df['std_dev_20'] = df['close'].pct_change().rolling(window=20).std()

    # Compare the current day's return to the 20-day standard deviation
    df['return_vs_std_dev'] = df['close'].pct_change() / df['std_dev_20']

    # Create a factor by multiplying the 5-day price change with the 20-day volume ratio
    df['price_vol_factor'] = df['pct_change_5'] * df['volume_ratio']

    # Construct a factor from the 10-day RSI and the 20-day average volume
    df['rsi_vol_factor'] = df['RSI_14'] * (df['volume'] / df['volume'].rolling(window=20).mean())

    # Compute Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']

    # Calculate Intraday Volatility
    df['intraday_volatility'] = df['high'] - df['low']

    # Adjust Intraday Return for Volatility
    df['adj_intraday_return'] = df['intraday_return'] / df['intraday_volatility']

    # Compute High-Low Range
    df['high_low_range'] = df['high'] - df['low']

    # Compare High-Low Range to its 30-day average
    df['range_vs_avg'] = (df['high_low_range'] > 1.5 * df['high_low_range'].rolling(window=30).mean()).astype(int)

    # Combine High-Low Range Adjustment with 20-Day Momentum
    df['momentum_range_factor'] = df['pct_change_20'] * df['range_vs_avg']

    # Calculate 30-day Rolling Median Volume
    df['med_vol_30'] = df['volume'].rolling(window=30).median()

    # Identify Volume Spikes
    df['volume_shock'] = (df['volume'] > 3 * df['med_vol_30']).astype(int)

    # Calculate 30-day Rolling Median Amount
    df['med_amount_30'] = df['amount'].rolling(window=30).median()

    # Detect Significant Amount Changes
    df['amount_shock'] = (df['amount'] > 2.5 * df['med_amount_30']).astype(int)

    # Compute True Range
    df['true_range'] = df[['high', 'low']].sub(df['close'].shift(), axis=0).abs().max(axis=1)

    # Calculate 14-day ATR (Average True Range)
    df['ATR_14'] = ATR(df['high'], df['low'], df['close'], timeperiod=14)

    # Aggregate All Signals
   
