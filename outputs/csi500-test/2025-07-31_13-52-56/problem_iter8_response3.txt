```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Range
    high_low_range = df['high'] - df['low']
    
    # Compute High-Low Range Momentum over N periods
    n = 30
    high_low_range_momentum = high_low_range.rolling(window=n).apply(lambda x: x[-1] - x[0], raw=True)
    
    # Compute Close Price Momentum
    close_price_momentum = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)
    
    # Combine High-Low Range and Close Price Momentum
    integrated_momentum = (high_low_range_momentum + close_price_momentum) / 2
    
    # Identify Volume Shock
    volume_30_day_avg = df['volume'].rolling(window=30).mean().shift(1)
    volume_shock = (df['volume'] > 2 * volume_30_day_avg).astype(int)
    
    # Analyze Amount Trend
    amount_30_day_avg = df['amount'].rolling(window=30).mean().shift(1)
    amount_trend = (df['amount'] > 1.5 * amount_30_day_avg).astype(int)
    
    # Calculate Volume Momentum
    rolling_volume_sum = df['volume'].rolling(window=n).sum()
    volume_log_return = np.log(rolling_volume_sum) - np.log(rolling_volume_sum.shift(1))
    
    # Calculate Price Volatility
    true_range = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    price_volatility = true_range.rolling(window=n).std()
    
    # Calculate Volume Spike
    rolling_volume_avg = df['volume'].rolling(window=n).mean()
    volume_spike = (df['volume'] / rolling_volume_avg) - 1
    
    # Integrate All Factors
    factor = (integrated_momentum * volume_shock * amount_trend 
              + (-volume_log_return + price_volatility) * (1 + volume_spike))
    
    return factor
```
