```python
import pandas as pd

def heuristics_v2(df):
    # Intraday Volatility Adjusted
    intraday_return = (df['high'] - df['low']) / df['open']
    intraday_volatility = (df[['high', 'low', 'close', 'open']].std(axis=1))
    adjusted_intraday_return = intraday_return / intraday_volatility
    
    # 30-day Price Momentum
    close_prices = df['close']
    momentum_30d = (close_prices - close_prices.shift(30)) / close_prices.shift(30)
    
    # Volume Shock
    volume_shock = (df['volume'] > 2 * df['volume'].rolling(window=30, min_periods=1).mean().shift(1)).astype(int)
    
    # Combine Factors
    factor = adjusted_intraday_return * momentum_30d * volume_shock
    
    return factor
```
