```python
import pandas as pd

def heuristics_v2(df):
    # Compute Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate Intraday Volatility
    df['intraday_volatility'] = df['high'] - df['low']
    
    # Adjust Intraday Return for Volatility
    df['adjusted_intraday_return'] = df['intraday_return'] / df['intraday_volatility']
    
    # Compute 20-day Moving Average of Close Prices
    df['20_day_ma'] = df['close'].rolling(window=20).mean()
    
    # Compute 20-day Price Momentum
    df['20_day_momentum'] = (df['close'] - df['20_day_ma']) / df['20_day_ma']
    
    # Enhance Momentum with High-Low Range
    df['high_low_range'] = df['high'] - df['low']
    df['30_day_avg_high_low_range'] = df['high_low_range'].rolling(window=30).mean()
    df['high_low_adjustment'] = (df['high_low_range'] > 1.5 * df['30_day_avg_high_low_range']).astype(int)
    df['enhanced_momentum'] = df['20_day_momentum'] * df['high_low_adjustment']
    
    # Determine Volume Shocks
    df['30_day_median_volume'] = df['volume'].rolling(window=30).median()
    df['volume_shock'] = (df['volume'] > 3 * df['30_day_median_volume']).astype(int)
    
    # Evaluate Amount Shocks
    df['30_day_median_amount'] = df['amount'].rolling(window=30).median()
    df['amount_shock'] = (df['amount'] > 2.5 * df['30_day_median_amount']).astype(int)
    
    # Assess Price Volatility
    df['true_range'] = df[['high', 'low']].diff(axis=1).abs().max(axis=1).fillna(0) + \
                      (df['high'] - df['low']).shift(1).fillna(0)
    df['14_day_atr'] = df['true_range'].rolling(window=14).mean()
    
    # Aggregate All Signals
    df['dynamic_momentum'] = df['enhanced_momentum'] * df['volume_shock']
    df['signal_with_amount'] = df['dynamic_momentum'] * df['amount_shock']
    df['final_signal'] = df['signal_with_amount'] / df['14_day_atr']
    
    # Refinement through Contextual Analysis
    df['trend_direction'] = (df['close'] > df['open'].shift(1)).astype(int)
    df['trend_direction_multiplier'] = df['trend_direction'].replace({1: 1, 0: -1})
    df['composite_score'] = df['final_signal'] * df['trend_direction_multiplier']
    
    return df['composite_score']
```
