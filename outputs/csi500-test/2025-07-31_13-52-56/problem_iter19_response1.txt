```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate price changes over different time frames
    df['daily_price_change'] = df['close'].diff()
    df['weekly_price_change'] = df['close'] - df['close'].shift(7)
    df['monthly_price_change'] = df['close'] - df['close'].shift(30)
    
    # Calculate moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    
    # Calculate differences between moving averages
    df['SMA_5_20_diff'] = df['SMA_5'] - df['SMA_20']
    df['SMA_20_50_diff'] = df['SMA_20'] - df['SMA_50']
    
    # Calculate volume trends
    df['daily_volume_change'] = df['volume'].diff()
    df['VMA_5'] = df['volume'].rolling(window=5).mean()
    df['VMA_20'] = df['volume'].rolling(window=20).mean()
    df['VMA_5_20_diff'] = df['VMA_5'] - df['VMA_20']
    
    # Analyze price and volume relationship
    df['price_change_to_volume_ratio'] = df['daily_price_change'] / df['daily_volume_change']
    df['price_change_to_volume_ratio_MA'] = df['price_change_to_volume_ratio'].rolling(window=5).mean()
    
    # Study volatility
    df['true_range'] = df[['high', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['ATR_14'] = df['true_range'].rolling(window=14).mean()
    df['log_ret'] = np.log(df['close'] / df['close'].shift(1))
    df['std_log_ret_14'] = df['log_ret'].rolling(window=14).std()
    
    # Examine relative strength
    df['RSI_14'] = 100 - (100 / (1 + (df['daily_price_change'][df['daily_price_change'] > 0].rolling(window=14).mean() / -df['daily_price_change'][df['daily_price_change'] < 0].rolling(window=14).mean())))
    
    # Evaluate market sentiment
    df['up_days'] = (df['daily_price_change'] > 0).rolling(window=10).sum()
    df['down_days'] = (df['daily_price_change'] < 0).rolling(window=10).sum()
    df['up_down_ratio'] = df['up_days'] / df['down_days']
    
    # Consider intraday patterns
    df['range'] = df['high'] - df['low']
    df['open_to_close_return'] = df['close'] - df['open']
    
    # Analyze gap patterns
    df['gap_up'] = df['open'] - df['close'].shift(1)
    df['gap_down'] = df['close'].shift(1) - df['open']
    
    # Investigate breakout patterns
    df['breakout_above_high'] = (df['close'] > df['high'].rolling(window=10).max()).astype(int)
    df['breakdown_below_low'] = (df['close'] < df['low'].rolling(window=10).min()).astype(int)
    
    # Evaluate trading volume in relation to price levels
    df['dollar_volume'] = df['close'] * df['volume']
    df['liquidity_ratio'] = df['volume'] / df['dollar_volume']
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        0.2 * df['SMA_5_20_diff'] +
        0.2 * df['SMA_20_50_diff'] +
        0.1 * df['price_change_to_volume_ratio_MA'] +
        0.1 * df['ATR_14'] +
        0.1 * df['RSI_14'] +
        0.1 * df['up_down_ratio'] +
        0.1 * df['range'] +
        0.1 * df['breakout_above_high'] -
        0.1 * df['breakdown_below_low'] +
        0.1 * df['liquidity_ratio']
    )
    
    return alpha_factor
```
