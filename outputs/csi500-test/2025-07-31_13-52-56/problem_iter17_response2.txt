```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Integrated Momentum
    high_low_range = df['high'] - df['low']
    close_momentum_30 = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)
    integrated_momentum = (high_low_range + close_momentum_30) / 2

    # Identify Volume Shock
    avg_volume_30 = df['volume'].rolling(window=30).mean().shift(1)
    volume_shock = (df['volume'] > 2 * avg_volume_30).astype(int)

    # Integrate Momentum and Volume Shock
    integrated_momentum_vol_shock = integrated_momentum * volume_shock

    # Calculate Volume-Adjusted High-to-Low Range
    volume_adjusted_high_low = (df['high'] - df['low']) * df['volume']

    # Calculate Intraday Return
    intraday_return = df['high'] - df['low']

    # Calculate Intraday Volatility
    intraday_volatility = df[['high', 'low', 'open', 'close']].std(axis=1)

    # Adjust Intraday Return
    adjusted_intraday_return = intraday_return / intraday_volatility

    # Calculate Volume Displacement
    volume_displacement = df['volume'] - df['volume'].shift(1)

    # Combine Intraday Factors
    combined_intraday_factors = adjusted_intraday_return * volume_displacement

    # Integrate Intraday and Historical Factors
    integrated_factors = integrated_momentum_vol_shock * combined_intraday_factors

    # Add 20-day Price Momentum
    price_momentum_20 = df['close'] - df['close'].shift(20)

    # Add 10-day Volume Acceleration
    volume_acceleration_10 = df['volume'] - df['volume'].shift(10)

    # Add 20-day Average True Range
    true_range = df[['high', 'low', 'close']].max(axis=1) - df[['high', 'low', 'close']].min(axis=1)
    average_true_range_20 = true_range.rolling(window=20).mean()

    # Final Factor Combination
    final_factor = (integrated_factors +
                    price_momentum_20 +
                    volume_acceleration_10 +
                    average_true_range_20)

    return final_factor
```
