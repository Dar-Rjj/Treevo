```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-to-Low Range
    high_low_range = df['high'] - df['low']
    
    # Adjust for Volume
    adjusted_high_low_range = high_low_range * df['volume']
    
    # Calculate 10-day Momentum
    momentum_10_day = df['close'].diff(10)
    
    # Combine Adjusted Range with 10-day Momentum
    combined_factor = adjusted_high_low_range + momentum_10_day
    
    # Detect Volume Spike
    volume_moving_avg_5_day = df['volume'].rolling(window=5).mean()
    volume_spike_flag = (df['volume'] > 1.7 * volume_moving_avg_5_day).astype(int)
    
    # Adjust Combined Factor with Volume Spike
    combined_factor_adjusted = combined_factor * (volume_spike_flag * 1.5 + 1)
    
    # Calculate 30-Day Price Momentum
    momentum_30_day = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)
    
    # Identify Volume Shock
    volume_moving_avg_30_day = df['volume'].rolling(window=30).mean().shift(1)  # Exclude current day
    volume_shock_flag = (df['volume'] > 2 * volume_moving_avg_30_day).astype(int)
    
    # Multiply 30-day Momentum by Volume Shock indicator
    momentum_30_day_with_shock = momentum_30_day * volume_shock_flag
    
    # Calculate Cumulative High-Low Range
    cumulative_high_low_range = adjusted_high_low_range.rolling(window=30).sum()
    
    # Calculate Open-to-Close Price Change
    open_close_change = df['close'] - df['open']
    
    # Calculate Cumulative Open-to-Close Price Change
    cumulative_open_close_change = open_close_change.rolling(window=30).sum()
    
    # Calculate High-Low Range Momentum
    high_low_range_momentum = cumulative_high_low_range / cumulative_open_close_change
    
    # Calculate Difference in Volume Adjusted High-Low Range
    diff_volume_adjusted_high_low_range = adjusted_high_low_range - adjusted_high_low_range.shift(29)
    
    # Calculate Volume Momentum
    volume_sum = df['volume'].rolling(window=30).sum()
    volume_momentum = (volume_sum - volume_sum.shift(30))
    
    # Measure High-Low Range
    atr = df[['high', 'low']].diff().abs().max(axis=1).rolling(window=30).mean()
    high_low_ratio = df['high'] / df['low']
    
    # Combined Alpha Factor
    adjusted_volume_momentum = volume_momentum * high_low_ratio
    inverted_volume_momentum = -1 * volume_momentum
    composite_alpha = inverted_volume_momentum + high_low_range_momentum + adjusted_volume_momentum
    combined_alpha = (momentum_30_day_with_shock + combined_factor_adjusted) * diff_volume_adjusted_high_low_range
    
    final_alpha = composite_alpha + combined_alpha
    
    return final_alpha
```
