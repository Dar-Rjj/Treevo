```python
import pandas as pd

def heuristics_v2(df):
    # Intraday Volatility Adjusted
    df['intraday_volatility'] = df[['high', 'low', 'close', 'open']].std(axis=1)
    
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    df['intraday_volatility_adjusted'] = df['intraday_return'] / df['intraday_volatility']
    
    # 30-day Price Momentum
    df['close_30_days_ago'] = df['close'].shift(30)
    df['30_day_momentum'] = (df['close'] - df['close_30_days_ago']) / df['close_30_days_ago']
    
    # Volume Shock
    df['volume_30_day_avg'] = df['volume'].rolling(window=30, min_periods=1).mean().shift(1)  # Exclude current day
    df['volume_shock'] = (df['volume'] > 2 * df['volume_30_day_avg']).astype(int)
    
    # Combine Factors
    intraday_weight = 0.4
    momentum_weight = 0.4
    volume_shock_weight = 0.2
    
    df['factor'] = (intraday_weight * df['intraday_volatility_adjusted'] +
                    momentum_weight * df['30_day_momentum'] +
                    volume_shock_weight * df['volume_shock'])
    
    return df['factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor = heuristics_v2(df)
# print(factor)
```
