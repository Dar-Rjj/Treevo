```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Enhanced High-to-Low Price Ratio
    high_low_ratio = (df['high'] - df['low']) / df['low']

    # Evaluate Volume Trend
    volume_10_day_ma = df['volume'].rolling(window=10).mean()
    volume_trend = (df['volume'] > volume_10_day_ma).astype(int) * 2 - 1

    # Integrate Components for Adjusted High-to-Low Price Ratio
    adjusted_high_low_ratio = high_low_ratio * volume_trend

    # Adjust for Volume
    adjusted_high_low_range = adjusted_high_low_ratio * df['volume']

    # Calculate 30-day Price Momentum
    price_momentum_30 = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)

    # Identify Volume Shock
    volume_30_day_avg = df['volume'].rolling(window=30, min_periods=1).mean().shift(1)
    volume_shock = (df['volume'] > 2 * volume_30_day_avg).astype(int)

    # Combine 30-day Momentum and Volume Shock
    momentum_volume_shock = price_momentum_30 * volume_shock

    # Detect Volume Spike
    volume_5_day_ma = df['volume'].rolling(window=5).mean()
    volume_spike = (df['volume'] > 1.7 * volume_5_day_ma).astype(int)

    # Combine Adjusted High-to-Low Range, 30-day Momentum, and Volume Spike
    combined_signal = adjusted_high_low_range + momentum_volume_shock
    combined_signal *= (volume_spike * 2.5 + 1 - volume_spike)

    # Calculate 10-day Price Momentum
    price_momentum_10 = df['close'] - df['close'].shift(10)

    # Integrate 10-day Momentum into Combined Signal
    combined_signal += price_momentum_10

    # Calculate 5-day Price Momentum
    price_momentum_5 = df['close'] - df['close'].shift(5)

    # Integrate 5-day Momentum into Combined Signal
    combined_signal += price_momentum_5

    # Synthesize Final Alpha Factor
    final_alpha_factor = combined_signal + momentum_volume_shock

    return final_alpha_factor
```
