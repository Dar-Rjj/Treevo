```python
import pandas as pd

def heuristics_v2(df):
    # Compute Dynamic Momentum
    df['20_day_MA'] = df['close'].rolling(window=20).mean()
    df['momentum'] = (df['close'] - df['20_day_MA']) / df['20_day_MA']

    # Enhance Integrated Momentum with Volume and Range
    df['high_low_range'] = df['high'] - df['low']
    df['30_day_avg_range'] = df['high_low_range'].rolling(window=30).mean()
    df['range_adjustment'] = (df['high_low_range'] > 1.5 * df['30_day_avg_range']).astype(int)
    df['enhanced_momentum'] = df['momentum'] * df['range_adjustment']

    # Determine Volume Anomalies
    df['30_day_median_volume'] = df['volume'].rolling(window=30).median()
    df['volume_spike'] = (df['volume'] > 3 * df['30_day_median_volume']).astype(int)

    # Evaluate Amount Fluctuations
    df['30_day_median_amount'] = df['amount'].rolling(window=30).median()
    df['significant_amount_change'] = (df['amount'] > 2.5 * df['30_day_median_amount']).astype(int)

    # Assess Price Volatility
    df['true_range'] = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    df['true_range'] = df['true_range'].fillna(0)  # Handle first row
    df['14_day_ATR'] = df['true_range'].rolling(window=14).mean()

    # Aggregate All Signals
    df['aggregated_signals'] = df['enhanced_momentum'] * df['volume_spike'] * df['significant_amount_change'] / df['14_day_ATR']

    # Refinement through Contextual Analysis
    df['trend_direction'] = (df['close'] > df['open'].shift(1)).astype(int)
    df['trend_direction'] = df['trend_direction'].fillna(0)  # Handle first row
    df['final_factor'] = df['aggregated_signals'] * df['trend_direction']

    return df['final_factor']
```
