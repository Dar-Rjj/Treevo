```python
import pandas as pd

def heuristics_v2(df, N=20):
    # Calculate the daily range (high - low)
    df['daily_range'] = df['high'] - df['low']
    
    # Use the daily range as a raw factor to predict future returns
    df['daily_range_factor'] = df['daily_range']
    
    # Calculate the average daily range over the past N days
    df['avg_daily_range'] = df['daily_range'].rolling(window=N).mean()
    
    # Compare today's range with the average range to identify unusual volatility
    df['volatility_factor'] = df['daily_range'] - df['avg_daily_range']
    
    # Calculate the difference between the current day's volume and the previous day's volume
    df['volume_change'] = df['volume'].diff()
    
    # Use the change in volume as a raw factor to predict future returns
    df['volume_change_factor'] = df['volume_change']
    
    # Calculate the average volume over the past N days
    df['avg_volume'] = df['volume'].rolling(window=N).mean()
    
    # Compare today's volume with the average volume to identify unusual trading activity
    df['volume_ratio'] = df['volume'] / df['avg_volume']
    
    # Calculate the position of the close within the day's range
    df['close_position'] = (df['close'] - df['low']) / df['daily_range']
    
    # Use the position of the close as a raw factor to predict future returns
    df['close_position_factor'] = df['close_position']
    
    # Calculate the average position of the close over the past N days
    df['avg_close_position'] = df['close_position'].rolling(window=N).mean()
    
    # Compare today's close position with the average position to identify changes in closing behavior
    df['close_position_diff'] = df['close_position'] - df['avg_close_position']
    
    # Calculate the return from the open to the close
    df['open_to_close_return'] = (df['close'] - df['open']) / df['open']
    
    # Use the open-to-close return as a raw factor to predict future returns
    df['open_to_close_return_factor'] = df['open_to_close_return']
    
    # Calculate the average open-to-close return over the past N days
    df['avg_open_to_close_return'] = df['open_to_close_return'].rolling(window=N).mean()
    
    # Compare today's open-to-close return with the average return to identify significant changes
    df['return_diff'] = df['open_to_close_return'] - df['avg_open_to_close_return']
    
    # Calculate the total amount traded
    df['total_amount_traded'] = df['volume'] * df['close']
    
    # Use the total amount traded as a raw factor to predict future returns
    df['total_amount_traded_factor'] = df['total_amount_traded']
    
    # Calculate the average amount traded over the past N days
    df['avg_amount_traded'] = df['total_amount_traded'].rolling(window=N).mean()
    
    # Compare today's amount traded with the average amount to identify significant changes
    df['amount_ratio'] = df['total_amount_traded'] / df['avg_amount_traded']
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['volatility_factor'] +
        df['volume_ratio'] +
        df['close_position_diff'] +
        df['return_diff'] +
        df['amount_ratio']
    )
    
    return df['alpha_factor']
```
