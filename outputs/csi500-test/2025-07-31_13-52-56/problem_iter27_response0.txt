```python
import pandas as pd

def heuristics_v2(df, n=5):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate upper and lower shadows
    df['upper_shadow'] = df['high'] - df[['open', 'close']].max(axis=1)
    df['lower_shadow'] = df[['open', 'close']].min(axis=1) - df['low']
    df['range'] = df['high'] - df['low']
    
    # Bearish and bullish indicators
    df['bearish_indicator'] = df['upper_shadow'] / df['range']
    df['bullish_indicator'] = df['lower_shadow'] / df['range']
    
    # Momentum factor
    df['momentum_factor'] = df['daily_return'].rolling(window=n).mean()
    
    # Volatility factor
    df['volatility_factor'] = df['daily_return'].rolling(window=n).std()
    
    # Volume change
    df['volume_change'] = df['volume'].diff()
    
    # Daily return multiplied by volume change
    df['return_volume_weighted'] = df['daily_return'] * df['volume_change']
    
    # Composite score
    weights = {
        'bearish_indicator': -0.3,
        'bullish_indicator': 0.3,
        'momentum_factor': 0.2,
        'volatility_factor': -0.2,
        'return_volume_weighted': 0.4
    }
    
    df['composite_score'] = (df['bearish_indicator'] * weights['bearish_indicator'] +
                             df['bullish_indicator'] * weights['bullish_indicator'] +
                             df['momentum_factor'] * weights['momentum_factor'] +
                             df['volatility_factor'] * weights['volatility_factor'] +
                             df['return_volume_weighted'] * weights['return_volume_weighted'])
    
    # Specific candlestick patterns
    df['engulfing_pattern'] = ((df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) &
                               (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1)))
    df['doji_pattern'] = (abs(df['close'] - df['open']) / df['range'] < 0.05)
    
    # Assign scores based on the presence of these patterns
    df['candlestick_score'] = 0
    df.loc[df['engulfing_pattern'], 'candlestick_score'] = 1
    df.loc[df['doji_pattern'], 'candlestick_score'] = 0.5
    
    # Final composite score including candlestick patterns
    df['final_composite_score'] = df['composite_score'] + df['candlestick_score']
    
    return df['final_composite_score'].dropna()
```
