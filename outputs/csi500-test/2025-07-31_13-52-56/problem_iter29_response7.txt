```python
import pandas as pd

def heuristics_v2(df, n=10):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate upper and lower shadows
    df['upper_shadow'] = df['high'] - df[['open', 'close']].max(axis=1)
    df['lower_shadow'] = df[['open', 'close']].min(axis=1) - df['low']
    
    # Calculate range
    df['range'] = df['high'] - df['low']
    
    # Bearish and Bullish indicators
    df['bearish_indicator'] = df['upper_shadow'] / df['range']
    df['bullish_indicator'] = df['lower_shadow'] / df['range']
    
    # Momentum factor
    df['momentum'] = df['daily_return'].rolling(window=n).mean()
    
    # Volatility factor
    df['volatility'] = df['daily_return'].rolling(window=n).std()
    
    # Volume change
    df['volume_change'] = df['volume'].diff()
    
    # Volume-adjusted return
    df['volume_adjusted_return'] = df['daily_return'] * df['volume_change']
    
    # Intraday return
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    
    # 30-day price momentum
    df['30_day_price_momentum'] = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)
    
    # Volume and amount shocks
    df['volume_shock'] = (df['volume'] > 2 * df['volume'].rolling(window=30).mean()).astype(int)
    df['amount_shock'] = (df['amount'] > 2 * df['amount'].rolling(window=30).mean()).astype(int)
    
    # Enhanced volume and price volatility
    df['price_volatility_volume'] = (df['high'] - df['low']) * df['volume']
    df['price_volatility_volume_sum'] = df['price_volatility_volume'].rolling(window=n).sum()
    
    df['open_close_change'] = df['close'] - df['open']
    df['open_close_change_sum'] = df['open_close_change'].rolling(window=n).sum()
    
    df['volume_ma'] = df['volume'].rolling(window=10).mean()
    df['volume_trend'] = (df['volume'] > df['volume_ma']).astype(int) * 2 - 1
    
    # Composite alpha factors
    df['volume_momentum'] = df['volume_adjusted_return'].rolling(window=n).mean()
    df['composite_alpha'] = (
        df['volume_momentum'] * (df['high'] / df['low']) +
        -1 * df['volume_momentum'] +
        (df['high'] - df['low']) * df['volume'] * df['volume_momentum']
    )
    
    # Weighted and integrated alpha factor
    df['weighted_intraday_return'] = 0.2 * df['intraday_return']
    df['weighted_30_day_price_momentum'] = 0.3 * df['30_day_price_momentum']
    df['weighted_volume_amount_shocks'] = 0.1 * df['volume_shock'] * df['amount_shock']
    df['weighted_adjusted_volume_momentum'] = 0.2 * df['volume_adjusted_return']
    df['weighted_inverted_volume_momentum'] = 0.15 * (-1 * df['volume_momentum'])
    df['weighted_composite_alpha'] = 0.1 * df['composite_alpha']
    
    df['alpha_factor'] = (
        df['weighted_intraday_return'] +
        df['weighted_30_day_price_momentum'] +
        df['weighted_volume_amount_shocks'] +
        df['weighted_adjusted_volume_momentum'] +
        df['weighted_inverted_volume_momentum'] +
        df['weighted_composite_alpha']
    )
    
    # Incorporate 30-day volume momentum
    df['30_day_volume_momentum'] = (df['volume'] - df['volume'].shift(30)) / df['volume'].shift(30)
    df['final_alpha'] = df['alpha_factor'] * df['30_day_volume_momentum']
    
    return df['final_alpha'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
