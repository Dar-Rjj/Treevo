```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily VWAP
    df['DollarValue'] = df['volume'] * df['close']
    daily_volume_sum = df['volume'].rolling(window=1).sum()
    daily_dollar_value_sum = df['DollarValue'].rolling(window=1).sum()
    df['VWAP'] = daily_dollar_value_sum / daily_volume_sum

    # Calculate VWAP Deviation
    df['VWAP_Deviation'] = df['close'] - df['VWAP']

    # Calculate Cumulative VWAP Deviation
    df['Cumulative_VWAP_Deviation'] = df['VWAP_Deviation'].cumsum()

    # Integrate Adaptive Short-Term Momentum
    short_term_momentum_period = 5
    df['Short_Term_Momentum'] = df['close'].pct_change(periods=short_term_momentum_period)
    df['Weighted_Short_Term'] = 0.6 * df['Cumulative_VWAP_Deviation'] + 0.4 * df['Short_Term_Momentum']

    # Integrate Adaptive Medium-Term Momentum
    medium_term_momentum_period = 10
    df['Medium_Term_Momentum'] = df['close'].pct_change(periods=medium_term_momentum_period)
    df['Weighted_Medium_Term'] = 0.7 * df['Cumulative_VWAP_Deviation'] + 0.3 * df['Medium_Term_Momentum']

    # Incorporate Volume Momentum
    df['Volume_Change_5_Day'] = df['volume'] - df['volume'].shift(5)
    df['Weighted_Short_Term'] *= df['Volume_Change_5_Day']

    # Incorporate Price Volatility
    df['Price_Volatility'] = df['close'].rolling(window=10).std()
    df['Weighted_Short_Term'] += df['Price_Volatility']

    # Dynamic Weighting Based on Market Conditions
    historical_performance_period = 30
    df['Historical_Performance'] = df['close'].pct_change(periods=historical_performance_period).rolling(window=historical_performance_period).sum()
    df['Market_Volatility'] = df['close'].rolling(window=historical_performance_period).std()

    # Determine Weights Based on Performance and Adjust for Volatility
    df['Dynamic_Weight'] = df['Historical_Performance'] / (df['Market_Volatility'] + 1e-8)
    df['Final_Alpha_Factor'] = df['Weighted_Short_Term'] * df['Dynamic_Weight'] + df['Weighted_Medium_Term'] * (1 - df['Dynamic_Weight'])

    return df['Final_Alpha_Factor']

# Example usage:
# df = pd.read_csv('market_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
