```python
import pandas as pd
import numpy as np

def heuristics_v2(df, ema_period=10, momentum_periods=[5, 10, 20]):
    # Calculate Daily VWAP
    df['Total Volume'] = df['volume'].sum()
    df['Total Dollar Value'] = (df['close'] * df['volume']).sum()
    df['VWAP'] = df['Total Dollar Value'] / df['Total Volume']
    
    # Calculate VWAP Deviation
    df['VWAP Deviation'] = df['close'] - df['VWAP']
    
    # Calculate Cumulative VWAP Deviation
    df['Cumulative VWAP Deviation'] = df['VWAP Deviation'].cumsum()
    
    # Calculate EMA of VWAP
    df['EMA VWAP'] = df['VWAP'].ewm(span=ema_period, adjust=False).mean()
    
    # Calculate EMA Deviation
    df['EMA Deviation'] = df['VWAP'] - df['EMA VWAP']
    
    # Integrate Volume Trends
    df['Volume Change'] = df['volume'] - df['volume'].shift(1)
    df['Volume Trend'] = df['Volume Change'].cumsum()
    
    # Calculate Multi-Period Momentum
    for period in momentum_periods:
        df[f'Momentum {period}D'] = df['close'] - df['close'].shift(period)
    
    # Combine Factors
    df['Alpha Factor'] = (
        df['Cumulative VWAP Deviation'] +
        df['EMA Deviation'] +
        df['Volume Trend'] +
        df[[f'Momentum {p}D' for p in momentum_periods]].sum(axis=1)
    )
    
    # Dynamic Thresholds
    upper_threshold = df['Alpha Factor'].quantile(0.75)
    lower_threshold = df['Alpha Factor'].quantile(0.25)
    
    df['Alpha Factor'] = np.where(
        df['Alpha Factor'] > upper_threshold,
        upper_threshold,
        np.where(df['Alpha Factor'] < lower_threshold, lower_threshold, df['Alpha Factor'])
    )
    
    return df['Alpha Factor']

# Example usage
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
```
