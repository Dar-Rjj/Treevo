```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Weight by 5-Day Average Volume
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    weighted_high_low_spread = high_low_spread * avg_volume_5d
    
    # Incorporate Close-to-Close Momentum (5-Day Return)
    close_return_5d = df['close'].pct_change(periods=5)
    close_momentum = weighted_high_low_spread + close_return_5d
    
    # Incorporate Volume Momentum (5-Day Volume Change)
    volume_change_5d = df['volume'].diff(periods=5)
    volume_momentum = close_momentum * volume_change_5d
    
    # Incorporate 20-Day Price Trend
    moving_avg_20d = df['close'].rolling(window=20).mean()
    price_trend = df['close'] - moving_avg_20d
    alpha_factor = volume_momentum + price_trend
    
    # Incorporate Multi-Period Momentum (10-Day Return)
    close_return_10d = df['close'].pct_change(periods=10)
    multi_period_momentum = alpha_factor + close_return_10d
    
    # Incorporate Volume Volatility (10-Day Volume Standard Deviation)
    vol_volatility_10d = df['volume'].rolling(window=10).std()
    alpha_factor = multi_period_momentum + vol_volatility_10d
    
    # Incorporate Price Volatility (10-Day Close Price Standard Deviation)
    price_volatility_10d = df['close'].rolling(window=10).std()
    alpha_factor = alpha_factor + price_volatility_10d
    
    # Dynamic Weighting Based on Market Conditions
    cumulative_returns_30d = (df['close'] / df['close'].shift(30)).fillna(1.0)
    market_volatility_30d = df['close'].rolling(window=30).std()
    
    # Determine Weights Based on Performance and Market Volatility
    weights = cumulative_returns_30d / (market_volatility_30d + 1e-6)  # Avoid division by zero
    weights = (weights - weights.min()) / (weights.max() - weights.min())  # Normalize weights
    
    # Apply Weights to Final Alpha Factor
    alpha_factor = alpha_factor * weights
    
    return alpha_factor
```
