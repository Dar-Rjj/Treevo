```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Volume-Weighted Average Price (VWAP)
    df['Total_Dollar'] = df['volume'] * df['close']
    daily_total_volume = df.groupby('date')['volume'].sum()
    daily_total_dollar = df.groupby('date')['Total_Dollar'].sum()
    vwap = daily_total_dollar / daily_total_volume
    df['vwap'] = df['date'].map(vwap)

    # Calculate VWAP Deviation
    df['vwap_deviation'] = df['close'] - df['vwap']

    # Calculate Cumulative VWAP Deviation
    df['cum_vwap_deviation'] = df.groupby('stock')['vwap_deviation'].cumsum()

    # Derive Momentum in Volume-Weighted Close Prices
    df['adj_close'] = df['close'] * df['volume']
    df['log_adj_close'] = np.log(df['adj_close'])
    df['5d_log_return'] = df['log_adj_close'].groupby('stock').transform(lambda x: x.rolling(window=5).apply(lambda y: y[-1] - y[0], raw=True))
    mean_5d_log_return = df.groupby('stock')['5d_log_return'].mean()
    std_5d_log_return = df.groupby('stock')['5d_log_return'].std()
    df['scaled_5d_log_return'] = (df['5d_log_return'] - df['stock'].map(mean_5d_log_return)) / df['stock'].map(std_5d_log_return)

    # Incorporate Open-to-High Gap as a Reversal Indicator
    df['open_high_gap'] = (df['high'] - df['open']) / df['open']

    # Combine All Factors into a Composite Alpha Signal
    df['alpha_factor'] = 0.4 * df['cum_vwap_deviation'] + 0.4 * df['scaled_5d_log_return'] - 0.2 * df['open_high_gap']

    return df['alpha_factor']
```
