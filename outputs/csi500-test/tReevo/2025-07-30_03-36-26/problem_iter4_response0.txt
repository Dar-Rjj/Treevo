```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily VWAP
    df['dollar_value'] = df['volume'] * df['close']
    daily_total_dollar_value = df.groupby('date')['dollar_value'].sum()
    daily_total_volume = df.groupby('date')['volume'].sum()
    vwap = (daily_total_dollar_value / daily_total_volume).rename('vwap').reset_index()
    
    # Merge VWAP back to the original dataframe
    df = df.merge(vwap, on='date', how='left')
    
    # Calculate VWAP Deviation
    df['vwap_deviation'] = df['close'] - df['vwap']
    
    # Calculate Cumulative VWAP Deviation
    df['cumulative_vwap_deviation'] = df.groupby('stock')['vwap_deviation'].cumsum()
    
    # Calculate Price Momentum
    window = 5
    df['price_momentum'] = df['close'] - df['close'].rolling(window=window).mean()
    
    # Calculate Volume Trend
    df['volume_trend'] = df['volume'] - df['volume'].ewm(span=window, adjust=False).mean()
    
    # Integrate Factors
    alpha_factor = (
        0.4 * df['vwap_deviation'] +
        0.3 * df['cumulative_vwap_deviation'] +
        0.2 * df['price_momentum'] +
        0.1 * df['volume_trend']
    )
    
    # Final Alpha Factor
    return alpha_factor
```
