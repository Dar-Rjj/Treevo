```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Calculate 5-Day Average Volume
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    
    # Weight by Average Volume
    weighted_high_low_spread = high_low_spread * avg_volume_5d
    
    # Calculate 5-Day Close Price Return
    close_return_5d = df['close'].pct_change(periods=5)
    
    # Incorporate Close-to-Close Momentum
    factor_1 = weighted_high_low_spread + close_return_5d
    
    # Calculate 5-Day Volume Change
    volume_change_5d = df['volume'] - df['volume'].shift(4)
    
    # Incorporate Volume Momentum
    factor_2 = factor_1 * volume_change_5d
    
    # Calculate 20-Day Moving Average
    moving_avg_20d = df['close'].rolling(window=20).mean()
    
    # Incorporate 20-Day Price Trend
    price_trend_20d = df['close'] - moving_avg_20d
    factor_3 = factor_2 + price_trend_20d
    
    # Calculate 10-Day and 30-Day Close Price Returns
    close_return_10d = df['close'].pct_change(periods=10)
    close_return_30d = df['close'].pct_change(periods=30)
    
    # Combine 10-Day and 30-Day Returns
    multi_period_momentum = (close_return_10d + close_return_30d) / 2
    factor_4 = factor_3 + multi_period_momentum
    
    # Calculate 10-Day Volume Standard Deviation
    volume_volatility_10d = df['volume'].rolling(window=10).std()
    
    # Incorporate Volume Volatility
    factor_5 = factor_4 + volume_volatility_10d
    
    # Calculate 10-Day Close Price Standard Deviation
    price_volatility_10d = df['close'].rolling(window=10).std()
    
    # Incorporate Price Volatility
    factor_6 = factor_5 + price_volatility_10d
    
    # Calculate 30-Day Historical Performance
    historical_performance_30d = (df['close'] / df['close'].shift(29)) - 1
    
    # Determine Weights Based on Performance
    performance_weight = historical_performance_30d.rank(pct=True)
    
    # Calculate 30-Day Market Volatility
    market_volatility_30d = df['close'].rolling(window=30).std()
    
    # Adjust Weights Based on Market Volatility
    volatility_weight = 1 - (market_volatility_30d / market_volatility_30d.max())
    final_weight = performance_weight * volatility_weight
    
    # Apply Weights to Final Alpha Factor
    final_factor = factor_6 * final_weight
    
    return final_factor
```
