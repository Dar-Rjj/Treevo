```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily VWAP
    df['TotalVolume'] = df['volume']
    df['TotalDollarValue'] = df['volume'] * df['close']
    df['VWAP'] = df['TotalDollarValue'].cumsum() / df['TotalVolume'].cumsum()
    
    # Calculate VWAP Deviation
    df['VWAPDeviation'] = df['close'] - df['VWAP']
    
    # Calculate Cumulative VWAP Deviation
    df['CumulativeVWAPDeviation'] = df['VWAPDeviation'].cumsum()
    
    # Calculate Adaptive EMA of VWAP
    def adaptive_ema(series, initial_period=20, adjust_factor=1.5):
        ema = series.ewm(span=initial_period, adjust=False).mean()
        for i in range(initial_period, len(series)):
            recent_volatility = series[i-initial_period:i].std()
            period = max(2, int(recent_volatility * adjust_factor))
            ema[i] = (series[i] * (2 / (period + 1)) + ema[i-1] * (1 - (2 / (period + 1))))
        return ema
    
    df['AEMA_VWAP'] = adaptive_ema(df['VWAP'])
    
    # Calculate AEMA Deviation
    df['AEMADeviation'] = df['VWAP'] - df['AEMA_VWAP']
    
    # Integrate Volume Trends
    df['VolumeChange'] = df['volume'] - df['volume'].shift(1)
    df['VolumeTrend'] = df['VolumeChange'].cumsum()
    
    # Calculate Multi-Period Momentum
    periods = [10, 20, 50]
    for period in periods:
        df[f'Momentum_{period}'] = df['close'] - df['close'].shift(period)
    
    # Refined Multi-Period Momentum
    df['RefinedMomentum'] = df[f'Momentum_{periods[0]}']
    for period in periods[1:]:
        df['RefinedMomentum'] += df[f'Momentum_{period}']
    df['RefinedMomentum'] /= len(periods)
    
    # Normalize the momentum score
    df['RefinedMomentum'] = (df['RefinedMomentum'] - df['RefinedMomentum'].mean()) / df['RefinedMomentum'].std()
    
    # Combine Factors
    df['AlphaFactor'] = (df['CumulativeVWAPDeviation'] + 
                         df['AEMADeviation'] + 
                         df['VolumeTrend'] + 
                         df['RefinedMomentum'])
    
    # Dynamic Thresholds
    upper_threshold = df['AlphaFactor'].quantile(0.75)
    lower_threshold = df['AlphaFactor'].quantile(0.25)
    
    df['FinalAlphaFactor'] = np.where(df['AlphaFactor'] > upper_threshold, upper_threshold,
                                      np.where(df['AlphaFactor'] < lower_threshold, lower_threshold,
                                               df['AlphaFactor']))
    
    return df['FinalAlphaFactor']

# Example usage
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
