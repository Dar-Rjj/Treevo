```txt
Volume-Weighted High-to-Low Ratio with Dynamic Momentum Check
├── Calculate Volume-Weighted High-to-Low Ratio
│   ├── Use High price
│   └── Use Low price
│       ├── Subtract Low from High
│       └── Divide by Low
│   ├── Use Volume
│   │   └── Multiply High-to-Low Ratio by Volume
│   └── Sum the results over a specified period (e.g., 5 days)
│       └── Divide by the sum of volumes over the same period
├── Incorporate Short-term and Long-term Price Momentum
│   ├── Use Close prices
│   │   ├── Calculate Short-term Moving Average (e.g., 5 days)
│   │   └── Calculate Long-term Moving Average (e.g., 20 days)
│   └── Determine Momentum
│       ├── Subtract Short-term MA from Long-term MA
│       └── Categorize as Bullish, Neutral, or Bearish
└── Combine Factors
    ├── Volume-Weighted High-to-Low Ratio
    └── Integrate Momentum Direction
        ├── If Momentum is Bullish, Increase Factor
        ├── If Momentum is Neutral, Keep Original Factor
        └── If Momentum is Bearish, Decrease Factor
```
