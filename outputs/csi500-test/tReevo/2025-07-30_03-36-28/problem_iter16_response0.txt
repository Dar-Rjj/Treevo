```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Average (SMA) of Close Prices
    sma_close = df['close'].rolling(window=20).mean()
    
    # Compute Refined Volume-Adjusted Volatility
    high_low_diff = df['high'] - df['low']
    volume_weighted_high_low = high_low_diff * df['volume']
    refined_volatility = volume_weighted_high_low.rolling(window=10).mean()
    
    # Compute Price Momentum
    n_day_avg_close = df['close'].rolling(window=5).mean()
    price_momentum = (df['close'] - sma_close) / n_day_avg_close
    
    # Incorporate Additional Price Change Metrics
    pct_change_close = df['close'].pct_change(1)
    high_low_range = df['high'] - df['low']
    
    # Consider Market Trend Alignment
    long_term_sma = df['close'].rolling(window=100).mean()
    trend_indicator = (sma_close > long_term_sma).astype(int)  # 1 if bullish, 0 if bearish
    
    # Incorporate Dynamic Liquidity Measures
    daily_turnover = df['volume'] * df['close']
    avg_daily_turnover = daily_turnover.rolling(window=30).mean()
    
    # Define the Weights for Each Component
    base_weights = {
        'price_momentum': 0.4,
        'refined_volatility': 0.3,
        'additional_metrics': 0.1,
        'trend_indicator': 0.1,
        'liquidity': 0.1
    }
    
    # Adjust Weights Based on Market Trend
    bull_weights = {
        'price_momentum': 0.5,
        'refined_volatility': 0.25,
        'additional_metrics': 0.15,
        'trend_indicator': 0.05,
        'liquidity': 0.05
    }
    
    bear_weights = {
        'price_momentum': 0.3,
        'refined_volatility': 0.4,
        'additional_metrics': 0.15,
        'trend_indicator': 0.05,
        'liquidity': 0.05
    }
    
    # Adjust Weights Based on Liquidity
    high_liquidity_weights = {
        'price_momentum': 0.5,
        'refined_volatility': 0.25,
        'additional_metrics': 0.15,
        'trend_indicator': 0.05,
        'liquidity': 0.05
    }
    
    low_liquidity_weights = {
        'price_momentum': 0.3,
        'refined_volatility': 0.4,
        'additional_metrics': 0.15,
        'trend_indicator': 0.05,
        'liquidity': 0.05
    }
    
    # Combine the Components into the Final Alpha Factor
    alpha_factor = (
        base_weights['price_momentum'] * price_momentum +
        base_weights['refined_volatility'] * refined_volatility +
        base_weights['additional_metrics'] * (pct_change_close + high_low_range) +
        base_weights['trend_indicator'] * trend_indicator +
        base_weights['liquidity'] * avg_daily_turnover
    )
    
    # Apply the adjusted weights based on market trend and liquidity
    for i in range(len(alpha_factor)):
        if trend_indicator.iloc[i] == 1:  # Bullish
            if avg_daily_turnover.iloc[i] > avg_daily_turnover.median():
                alpha_factor.iloc[i] = (
                    bull_weights['price_momentum'] * price_momentum.iloc[i] +
                    bull_weights['refined_volatility'] * refined_volatility.iloc[i] +
                    bull_weights['additional_metrics'] * (pct_change_close.iloc[i] + high_low_range.iloc[i]) +
                    bull_weights['trend_indicator'] * trend_indicator.iloc[i] +
                    bull_weights['liquidity'] * avg_daily_turnover.iloc[i]
                )
            else:
                alpha_factor.iloc[i] = (
                    bear_weights['price_momentum'] * price_momentum.iloc[i] +
                    bear_weights['refined_volatility'] * refined_volatility.iloc[i] +
                    bear_weights['additional_metrics'] * (pct_change_close.iloc[i] + high_low_range.iloc[i]) +
                    bear_weights['trend_indicator'] * trend_indicator.iloc[i] +
                    bear_weights['liquidity'] * avg_daily_turnover.iloc[i]
                )
        else:  # Bearish
            if avg_daily_turnover.iloc[i] > avg_daily_turnover.median():
                alpha_factor.iloc[i] = (
                    high
