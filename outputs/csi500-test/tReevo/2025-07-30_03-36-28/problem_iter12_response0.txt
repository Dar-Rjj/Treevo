```python
import pandas as pd
import numpy as np

def heuristics_v2(df, short_window=50, long_window=200, momentum_avg_window=10, pct_change_window=10, vola_window=30):
    # Calculate Simple Moving Average (SMA) of Close Prices
    df['SMA'] = df['close'].rolling(window=short_window).mean()
    df['SMA_long'] = df['close'].rolling(window=long_window).mean()
    
    # Compute Volume-Adjusted Volatility
    df['high_low_diff'] = df['high'] - df['low']
    df['volume_weighted_high_low'] = df['high_low_diff'] * df['volume']
    df['vol_adjusted_volatility'] = df['volume_weighted_high_low'].rolling(window=vola_window).mean()
    
    # Compute Price Momentum
    df['price_momentum'] = (df['close'] - df['SMA']) / df['close'].rolling(window=momentum_avg_window).mean()
    
    # Incorporate Additional Price Change Metrics
    df['pct_change_close'] = df['close'].pct_change(periods=pct_change_window)
    df['high_low_range'] = df['high'] - df['low']
    
    # Consider Market Trend Alignment
    df['market_trend'] = np.where(df['SMA'] > df['SMA_long'], 1, -1)  # Bullish: 1, Bearish: -1
    
    # Dynamically Adjust Component Weights Based on Market Trend
    bullish_weights = {'momentum': 0.4, 'volatility': 0.3, 'pct_change': 0.2, 'range': 0.1}
    bearish_weights = {'momentum': 0.2, 'volatility': 0.1, 'pct_change': 0.4, 'range': 0.3}
    
    def get_weights(trend):
        return bullish_weights if trend == 1 else bearish_weights
    
    df['momentum_weight'] = df['market_trend'].apply(lambda x: get_weights(x)['momentum'])
    df['volatility_weight'] = df['market_trend'].apply(lambda x: get_weights(x)['volatility'])
    df['pct_change_weight'] = df['market_trend'].apply(lambda x: get_weights(x)['pct_change'])
    df['range_weight'] = df['market_trend'].apply(lambda x: get_weights(x)['range'])
    
    # Combine components into the final alpha factor
    df['alpha_factor'] = (df['price_momentum'] * df['momentum_weight'] +
                          df['vol_adjusted_volatility'] * df['volatility_weight'] +
                          df['pct_change_close'] * df['pct_change_weight'] +
                          df['high_low_range'] * df['range_weight'])
    
    return df['alpha_factor']
```
