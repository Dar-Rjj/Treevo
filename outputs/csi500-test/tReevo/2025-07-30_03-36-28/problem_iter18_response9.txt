```python
import pandas as pd

def heuristics_v2(df):
    # Define lookback periods
    sma_short = 20
    sma_long = 100
    vol_adjusted_lookback = 20
    price_momentum_n = 20
    pct_change_lookback = 5
    liquidity_lookback = 20
    dollar_volume_lookback = 20

    # Calculate Simple Moving Average (SMA) of Close Prices
    df['SMA_Short'] = df['close'].rolling(window=sma_short).mean()
    df['SMA_Long'] = df['close'].rolling(window=sma_long).mean()

    # Compute Volume-Adjusted Volatility
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Volume_Adjusted_Volatility'] = (df['High_Low_Diff'] * df['volume']).rolling(window=vol_adjusted_lookback).mean()

    # Compute Price Momentum
    df['Price_Momentum'] = (df['close'] - df['SMA_Short']) / df['close'].rolling(window=price_momentum_n).mean()

    # Incorporate Additional Price Change Metrics
    df['Pct_Change_Close'] = df['close'].pct_change(pct_change_lookback)
    df['High_Low_Range'] = df['high'] - df['low']

    # Consider Market Trend Alignment
    df['Market_Trend'] = df.apply(lambda row: 'Bullish' if row['SMA_Short'] > row['SMA_Long'] else 'Bearish', axis=1)

    # Incorporate Dynamic Liquidity Measures
    df['Daily_Turnover'] = df['volume'] * df['close']
    df['Avg_Daily_Turnover'] = df['Daily_Turnover'].rolling(window=liquidity_lookback).mean()
    df['Average_Dollar_Volume'] = (df['volume'] * df['close']).rolling(window=dollar_volume_lookback).mean()

    # Final Alpha Factor
    weights = {
        'Price_Momentum': 0.3,
        'Volume_Adjusted_Volatility': -0.2,  # Negative weight to penalize high volatility
        'Pct_Change_Close': 0.2,
        'High_Low_Range': 0.1,
        'Avg_Daily_Turnover': 0.1,
        'Average_Dollar_Volume': 0.1
    }

    def adjust_weights(row):
        if row['Market_Trend'] == 'Bullish':
            return {k: v * 1.2 for k, v in weights.items()}
        elif row['Market_Trend'] == 'Bearish':
            return {k: v * 0.8 for k, v in weights.items()}
        return weights

    df['Alpha_Factor'] = df.apply(
        lambda row: sum(adjust_weights(row)[k] * row[k] for k in adjust_weights(row).keys()), axis=1)

    return df['Alpha_Factor'].dropna()

# Example usage
# df = pd.read_csv('your_stock_data.csv')
# alpha_factor = heuristics_v2(df)
```
