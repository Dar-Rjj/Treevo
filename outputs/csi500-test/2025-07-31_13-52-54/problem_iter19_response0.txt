```python
import pandas as pd

def heuristics_v2(df):
    # Trend following alpha factor using close prices
    sma_50 = df['close'].rolling(window=50).mean()
    trend_signal = (df['close'] > sma_50).astype(int) - (df['close'] < sma_50).astype(int)
    
    # Momentum in high and low prices
    high_diff = df['high'] - df['high'].shift(1)
    low_diff = df['low'] - df['low'].shift(1)
    momentum_score = high_diff + low_diff
    
    # Threshold to classify strong, neutral, and negative momentum
    strong_positive_momentum = (momentum_score > 0.5 * momentum_score.std())
    strong_negative_momentum = (momentum_score < -0.5 * momentum_score.std())
    momentum_signal = strong_positive_momentum.astype(int) - strong_negative_momentum.astype(int)
    
    # Volume patterns
    volume_change = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    strong_volume_increase = (volume_change > 0.1)
    strong_volume_decrease = (volume_change < -0.1)
    moderate_volume_increase = (volume_change <= 0.1) & (volume_change > 0)
    moderate_volume_decrease = (volume_change >= -0.1) & (volume_change < 0)
    volume_signal = strong_volume_increase.astype(int) - strong_volume_decrease.astype(int)
    
    # Intensity factor
    return_intensity = df['close'].pct_change() * df['volume']
    intensity_ma_20 = return_intensity.rolling(window=20).mean()
    
    # Combine all the factors
    combined_factor = (trend_signal + momentum_signal + volume_signal + intensity_ma_20) / 4
    
    return combined_factor
```
