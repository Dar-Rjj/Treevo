```txt
Volume-Adjusted High-Low Spread with Enhanced Momentum and Trend Integration
├── Calculate Volume-Weighted High-Low Spread
│   ├── Subtract Low from High price
│   ├── Multiply (High - Low) by Volume
│   └── Sum of these values over the lookback period
├── Calculate Volume-Averaged Close Price
│   ├── Sum of (Close price * Volume)
│   └── Total Volume
├── Compute Ratio
│   ├── Divide Volume-Weighted High-Low Spread by Volume-Averaged Close Price
│   └── Output: Volume-Weighted High-Low Spread Ratio

├── Generate Short-Term Trend Signal
│   ├── 20-day Simple Moving Average (SMA) of Closing Prices
│   ├── 1 if the current close is above the 20-day SMA, 0 otherwise
│   └── Output: Short-Term Trend Signal

├── Generate Long-Term Trend Signal
│   ├── 200-day Simple Moving Average (SMA) of Closing Prices
│   ├── 1 if the current close is above the 200-day SMA, 0 otherwise
│   └── Output: Long-Term Trend Signal

├── Calculate Momentum Component
│   ├── Current Day's Volume-Weighted High-Low Spread
│   ├── Average of Past n Days' Volume-Weighted High-Low Spreads
│   └── Subtract past average from current value

├── Calculate Momentum Score
│   ├── Difference between today’s high and the previous day’s high
│   ├── Difference between today’s low and the previous day’s low
│   ├── Sum the differences
│   └── Output: Momentum Score

├── Calculate Daily Volume Percentage Change
│   ├── Calculate the percentage change in volume from the previous day
│   └── Output: Daily Volume Percentage Change

├── Calculate Return Multiplied by Volume
│   ├── Calculate the return (close to open)
│   ├── Multiply the return by the volume traded
│   └── Output: Market Participant Intensity

├── Generate Final Factor
│   ├── Add Volume-Weighted High-Low Spread Ratio
│   ├── Add Short-Term and Long-Term Trend Signals
│   ├── Add Momentum Score
│   ├── Add Market Participant Intensity
│   ├── Multiply by Daily Volume Percentage Change
│   └── Output: Advanced Composite Alpha Factor
```
