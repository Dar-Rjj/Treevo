```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the difference between closing price and opening price
    df['price_diff'] = df['close'] - df['open']
    
    # 5-day moving average of the daily price difference
    df['price_diff_ma_5'] = df['price_diff'].rolling(window=5).mean()
    
    # 20-day standard deviation of the 5-day moving average of the daily price difference
    df['price_diff_ma_5_std_20'] = df['price_diff_ma_5'].rolling(window=20).std()
    
    # Volatility-adjusted trend strength
    df['vol_adj_trend_strength'] = df['price_diff_ma_5'] / df['price_diff_ma_5_std_20']
    
    # 14-day Exponential Moving Average (EMA) of the closing prices
    df['ema_14'] = df['close'].ewm(span=14, adjust=False).mean()
    
    # Difference between the current closing price and the 14-day EMA
    df['close_ema_14_diff'] = df['close'] - df['ema_14']
    
    # Count the number of days in the past month where the closing price was above the opening price
    df['up_days'] = (df['close'] > df['open']).rolling(window=20).sum()
    
    # Ratio of up-days to total days
    df['up_day_ratio'] = df['up_days'] / 20
    
    # Highest high and lowest low over the last 20 days
    df['highest_high_20'] = df['high'].rolling(window=20).max()
    df['lowest_low_20'] = df['low'].rolling(window=20).min()
    
    # Range percentage
    df['range_percentage'] = (df['highest_high_20'] - df['lowest_low_20']) / df['lowest_low_20']
    
    # Sum of volume on days when the closing price is higher than the opening price, divided by the total volume over the same period
    df['volume_up_days'] = (df['close'] > df['open']) * df['volume']
    df['volume_up_days_sum'] = df['volume_up_days'].rolling(window=20).sum()
    df['volume_total'] = df['volume'].rolling(window=20).sum()
    df['buying_pressure_ratio'] = df['volume_up_days_sum'] / df['volume_total']
    
    # Return based on the close-to-close price change
    df['daily_return'] = df['close'].pct_change()
    
    # Cumulative return over the past 30 trading days
    df['cumulative_return_30'] = (1 + df['daily_return']).rolling(window=30).apply(np.prod) - 1
    
    # Rate of change of the amount traded over the past 7 days
    df['amount_roc_7'] = df['amount'].pct_change(periods=7)
    
    # Average true range (ATR) over the past 14 days
    df['true_range'] = df[['high', 'low', 'close']].shift().apply(lambda x: max(x[0], x[1]) - min(x[0], x[1]), axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    df['today_atr_rel_14'] = df['true_range'] / df['atr_14']
    
    # Price gap (difference between today's open and yesterday's close)
    df['price_gap'] = df['open'] - df['close'].shift()
    
    # Categorize the gaps into up, down, or no gap
    df['gap_category'] = np.where(df['price_gap'] > 0, 'up', np.where(df['price_gap'] < 0, 'down', 'no'))
    
    # Ratio of high price to low price for the day
    df['high_low_ratio'] = df['high'] / df['low']
    
    # 20-day moving average of the closing price
    df['ma_20_close'] = df['close'].rolling(window=20).mean()
    
    # Relationship between the day's high and the 20-day moving average of the closing price
    df['high_vs_ma_20'] = df['high'] - df['ma_20_close']
    
    # Select the final alpha factor
    alpha_factor = df['vol_adj_trend_strength'].copy()
    
    return alpha_factor
```
