```python
import pandas as pd

def heuristics_v2(df, lookback_period=20):
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Compute Volume-Weighted High-Low Spread
    volume_weighted_high_low_spread = (high_low_spread * df['volume']).rolling(window=lookback_period).sum()
    
    # Calculate Volume-Averaged Close Price
    volume_averaged_close_price = (df['close'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    
    # Compute Ratio
    volume_weighted_high_low_ratio = volume_weighted_high_low_spread / volume_averaged_close_price
    
    # Calculate 50-day Simple Moving Average (SMA) of Closing Prices
    sma_50 = df['close'].rolling(window=50).mean()
    short_term_trend_signal = (df['close'] > sma_50).astype(int)
    
    # Calculate 200-day Simple Moving Average (SMA) of Closing Prices
    sma_200 = df['close'].rolling(window=200).mean()
    long_term_trend_signal = (df['close'] > sma_200).astype(int)
    
    # Calculate Momentum Component
    momentum_component = volume_weighted_high_low_spread - volume_weighted_high_low_spread.rolling(window=lookback_period).mean()
    
    # Calculate Momentum Score
    momentum_score = (df['high'] - df['high'].shift(1)) + (df['low'] - df['low'].shift(1))
    
    # Calculate Daily Volume Percentage Change
    daily_volume_percentage_change = df['volume'].pct_change()
    
    # Multiply Return by Volume
    market_participant_intensity = (df['close'] / df['close'].shift(1) - 1) * df['volume']
    
    # Generate Final Factor
    final_factor = (
        volume_weighted_high_low_ratio 
        + momentum_component 
        + short_term_trend_signal 
        + long_term_trend_signal 
        + momentum_score 
        + market_participant_intensity
    )
    
    return final_factor
```
