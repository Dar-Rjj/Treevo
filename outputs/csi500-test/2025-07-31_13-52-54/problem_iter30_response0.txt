```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between today's close and open prices
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate (high - low) as a measure of intraday volatility
    df['intraday_volatility'] = df['high'] - df['low']
    
    # Compute (close - low) to assess the upward momentum
    df['upward_momentum'] = df['close'] - df['low']
    
    # Compute (high - close) to evaluate the downward pressure
    df['downward_pressure'] = df['high'] - df['close']
    
    # Sum of (close - open) over the last 5 days
    df['sum_close_open_5d'] = df['close_open_diff'].rolling(window=5).sum()
    
    # Average of (close - open) over the last 5 days
    df['avg_close_open_5d'] = df['close_open_diff'].rolling(window=5).mean()
    
    # Calculate (volume * (close - open)) as a raw factor
    df['volume_price_change'] = df['volume'] * df['close_open_diff']
    
    # Compute (amount / volume) as an average transaction value
    df['avg_transaction_value'] = df['amount'] / df['volume']
    
    # Calculate the change in volume over the last 3 days
    df['volume_change_3d'] = df['volume'].diff(periods=3)
    
    # Compute the ratio of current day volume to the 5-day average volume
    df['volume_ratio_5d'] = df['volume'] / df['volume'].rolling(window=5).mean()
    
    # Create a composite factor by adding (close - open) and (volume * (close - open))
    df['composite_factor'] = df['close_open_diff'] + df['volume_price_change']
    
    # Form a weighted sum of (close - low) and (high - close) with weights based on volume
    df['weighted_sum_momentum_pressure'] = (df['volume'] * df['upward_momentum']) - (df['volume'] * df['downward_pressure'])
    
    # Final alpha factor
    df['alpha_factor'] = df['composite_factor'] + df['weighted_sum_momentum_pressure']
    
    return df['alpha_factor']
```
