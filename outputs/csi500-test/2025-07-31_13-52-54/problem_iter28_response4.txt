```python
import pandas as pd

def heuristics_v2(df):
    # Compute Volume-Weighted High-Low Spread
    df['HL_Spread'] = (df['high'] - df['low']) * df['volume']
    total_volume = df['volume'].rolling(window=20).sum()
    df['Volume_Weighted_HL_Spread'] = df['HL_Spread'].rolling(window=20).sum() / total_volume

    # Calculate Volume-Weighted Price
    df['Volume_Weighted_Price'] = (df['close'] * df['volume']).rolling(window=20).sum() / total_volume

    # Compute Volume-Weighted Volatility
    df['Volume_Weighted_Volatility'] = (df['HL_Spread']).cumsum() / df['Volume_Weighted_Price']

    # Calculate Momentum
    n = 20
    df['Momentum'] = df['HL_Spread'] - (df['HL_Spread'] / df['volume']).rolling(window=n).mean() * df['volume']

    # Incorporate Price Trend
    df['Price_Change'] = df['close'] - df['open']
    df['Trend_Adjusted_Momentum'] = df['Momentum'] + df['Price_Change']

    # Calculate Intraday Range Growth
    df['Today_HL_Range'] = df['high'] - df['low']
    df['Prev_Day_HL_Range'] = df['Today_HL_Range'].shift(1)
    df['Intraday_Range_Growth'] = (df['Today_HL_Range'] - df['Prev_Day_HL_Range']) / df['Prev_Day_HL_Range']

    # Volume Weighted Moving Average
    df['SMA_Close'] = df['close'].rolling(window=20).mean()
    df['Volume_Weighted_Moving_Average'] = (df['close'] * df['volume']).rolling(window=20).sum() / total_volume

    # Combine Intraday Range Growth and Volume Weighted Moving Average
    df['Combined_Intraday_Range_Growth'] = df['Intraday_Range_Growth'] + df['Volume_Weighted_Moving_Average']

    # Calculate Price Momentum
    df['Price_Momentum'] = df['close'].pct_change(periods=20)

    # Adjust for Volume Surge
    N = 5
    M = 10
    df['N_day_Volume_Change'] = df['volume'].pct_change(periods=N)
    df['M_day_Volume_Change'] = df['volume'].pct_change(periods=M)
    df['Volume_Surge'] = df['N_day_Volume_Change'] + df['M_day_Volume_Change']
    df['Adjusted_Volume_Surge'] = df['Volume_Surge'].apply(lambda x: x if x >= 0 else x * 1.5)

    # Final Combined Alpha Factor
    df['Final_Alpha_Factor'] = (
        df['Price_Momentum'] * df['Volume_Weighted_Volatility'] +
        df['Intraday_Range_Growth'] +
        df['Adjusted_Volume_Surge'] +
        df['Trend_Adjusted_Momentum']
    )

    # 50-day SMA Position
    df['50_SMA'] = df['close'].rolling(window=50).mean()
    df['SMA_Position'] = df.apply(lambda row: 1 if row['close'] > row['50_SMA'] else (-1 if row['close'] < row['50_SMA'] else 0), axis=1)

    # High-Low Momentum
    df['High_Momentum'] = df['high'] - df['high'].shift(1)
    df['Low_Momentum'] = df['low'] - df['low'].shift(1)
    df['HL_Momentum'] = df['High_Momentum'] + df['Low_Momentum']
    df['HL_Momentum_Class'] = df['HL_Momentum'].apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0))

    # Analyze Volume Patterns
    df['Volume_Percentage_Change'] = df['volume'].pct_change()
    def classify_volume_intensity(x):
        if x > 0.2:
            return 'Strong'
        elif x > 0.1:
            return 'Moderate'
        else:
            return 'Weak'
    df['Volume_Intensity'] = df['Volume_Percentage_Change'].apply(classify_volume_intensity)

    # Leverage Price and Volume Intensity
    df['Return_Intensity'] = (df['close'] - df['close'].shift(1)) * df['volume
