```txt
Integrated Momentum, Volume-Weighted Returns, and Intraday Volatility with Surge Indicator and High-Low Range Integration
├── Calculate Daily Returns
│   ├── Use Close price of current day
│   └── Use Close price of previous day
├── Long-Term Volume-Weighted Average Return (Momentum Component)
│   ├── Calculate Daily Returns for the last 100 days
│   ├── Sum of Daily Returns
│   │   ├── Loop over all returns in the last 100 days
│   └── Weight by Volume
│       ├── Use Volume for each day
│       └── Multiply Volume by Returns
│           ├── Sum the weighted returns
│           └── Divide by the total volume over the 100 days
├── Short-Term Volume-Weighted Average Return (Reversal Component)
│   ├── Calculate Daily Returns for the last 5 days
│   ├── Sum of Daily Returns
│   │   ├── Loop over all returns in the last 5 days
│   └── Weight by Volume
│       ├── Use Volume for each day
│       └── Multiply Volume by Returns
│           ├── Sum the weighted returns
│           └── Divide by the total volume over the 5 days
├── Integrate High-Low Range into Volume-Weighted Returns
│   ├── Calculate High-Low Range
│   │   ├── Use High and Low prices of the current day
│   │   └── Subtract Low from High
│   ├── Calculate Volume-Weighted High-Low Range
│   │   ├── Use Volume for the current day
│   │   └── Multiply High-Low Range by Volume
│   └── Adjust Volume-Weighted High-Low Range
│       ├── Use Total Volume over the last 5 days
│       └── Divide Volume-Weighted High-Low Range by Total Volume
├── Combine Momentum, Reversal, and High-Low Range Components
│   ├── Subtract Short-Term Volume-Weighted Average Return from Long-Term
│   ├── Add Adjusted Volume-Weighted High-Low Range
│   └── Intermediate Alpha Factor
│       └── Use the result of the addition and subtraction
├── Calculate Price Momentum
│   ├── Determine N-day Close Price Difference
│   │   ├── Use Close price of today
│   │   └── Subtract Close price of N days ago
│   ├── Calculate M-day Close Price Difference
│   │   ├── Use Close price of today
│   │   └── Subtract Close price of M days ago
│   └── Combine Differences
│       ├── Sum N-day and M-day differences
│       └── Output as Price Momentum
├── Calculate Intraday Volatility
│   ├── Compute Daily High-Low Range
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Compute Previous Day's High-Low Range
│   │   ├── Use High price (lagged by 1)
│   │   └── Use Low price (lagged by 1)
│   └── Compute Intraday Volatility
│       ├── Subtract Previous Day's High-Low Range from Today's High-Low Range
│       └── Divide by Previous Day's High-Low Range
├── Calculate Volume Surge
│   ├── Determine N-day Volume Change
│   │   ├── Use Volume of today
│   │   └── Subtract Volume of N days ago
│   ├── Determine M-day Volume Change
│   │   ├── Use Volume of today
│   │   └── Subtract Volume of M days ago
│   └── Combine Changes
│       ├── Sum N-day and M-day volume changes
│       └── Output as Volume Surge
├── Calculate Open-Close Momentum
│   ├── Determine N-day Open-Close Price Difference
│   │   ├── Use Open price of today
│   │   └── Subtract Close price of N days ago
│   ├── Calculate M-day Open-Close Price Difference
│   │   ├── Use Open price of today
│   │   └── Subtract Close price of M days ago
│   └── Combine Differences
│       ├── Sum N-day and M-day open-close differences
│       └── Output as Open-Close Momentum
└── Synthesize Final Alpha Factor
    ├── Multiply Intermediate Alpha Factor by Price Momentum
    ├── Multiply by Intraday Volatility
    ├── If Volume Surge is negative, apply a penalty
    │   └── Multiply by 0.8
    ├── Add Open-Close Momentum
    └── Final Alpha Factor
        └── Use the Adjusted Value
```
