```python
import pandas as pd

def heuristics_v2(df, lookback_period=20, n_days=10, m_days=30):
    # Compute Volume-Weighted High-Low Spread
    df['high_low_vol'] = (df['high'] - df['low']) * df['volume']
    
    # Summarize Over Lookback Period
    total_high_low_vol = df['high_low_vol'].rolling(window=lookback_period).sum()
    total_volume = df['volume'].rolling(window=lookback_period).sum()
    
    # Calculate Momentum
    avg_high_low_vol = total_high_low_vol / total_volume
    current_high_low_vol = df['high_low_vol']
    volume_weighted_momentum = current_high_low_vol - avg_high_low_vol
    
    # Incorporate Price Trend
    price_change = df['close'] - df['open']
    price_trend_factor = price_change + volume_weighted_momentum
    
    # Calculate Intraday Range Growth
    today_range = df['high'] - df['low']
    prev_day_high = df['high'].shift(1)
    prev_day_low = df['low'].shift(1)
    prev_day_range = prev_day_high - prev_day_low
    intraday_range_growth = (today_range - prev_day_range) / prev_day_range
    
    # Volume Weighted Moving Average
    weighted_close = df['close'] * df['volume']
    sum_weighted_close = weighted_close.rolling(window=lookback_period).sum()
    sum_volume = df['volume'].rolling(window=lookback_period).sum()
    volume_weighted_moving_avg = sum_weighted_close / sum_volume
    
    # Combine Intraday Range Growth and Volume Weighted Moving Average
    combined_intraday_and_vol_wma = intraday_range_growth + volume_weighted_moving_avg
    
    # Calculate Price Momentum
    close_n_day_return = df['close'].pct_change(n_days)
    open_n_day_return = df['open'].pct_change(n_days)
    price_momentum = (close_n_day_return + open_n_day_return) / 2
    
    # Adjust for Volume Surge
    n_day_volume_change = df['volume'] - df['volume'].shift(n_days)
    m_day_volume_change = df['volume'] - df['volume'].shift(m_days)
    volume_surge = n_day_volume_change + m_day_volume_change
    volume_surge_adj = volume_surge.apply(lambda x: x * 0.8 if x < 0 else x)
    
    # Final Combined Alpha Factor
    final_alpha_factor = (
        price_momentum * volume_weighted_momentum +
        combined_intraday_and_vol_wma +
        volume_surge_adj
    )
    
    # Calculate the 50-day Simple Moving Average (SMA) of closing prices
    sma_50 = df['close'].rolling(window=50).mean()
    relative_position = (df['close'] > sma_50).astype(int) - (df['close'] < sma_50).astype(int)
    
    # Explore Momentum in High and Low Prices
    high_momentum = df['high'] - df['high'].shift(1)
    low_momentum = df['low'] - df['low'].shift(1)
    combined_momentum_score = high_momentum + low_momentum
    momentum_signal = combined_momentum_score.apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    # Analyze Volume Patterns
    daily_vol_change = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Leverage Price and Volume for an Intensity Factor
    intensity_factor = (df['close'] - df['close'].shift(1)) * df['volume']
    smoothed_intensity_factor = intensity_factor.rolling(window=20).mean()
    
    # Combine all factors into a single alpha factor
    final_alpha_factor = (
        final_alpha_factor +
        relative_position +
        momentum_signal +
        smoothed_intensity_factor
    )
    
    return final_alpha_factor
```
