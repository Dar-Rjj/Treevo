```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Volume-Weighted High-Low Spread
    df['high_low_spread'] = df['high'] - df['low']
    df['volume_weighted_high_low_spread'] = df['high_low_spread'] * df['volume']
    
    # Sum of Volume-Weighted High-Low Spreads
    df['sum_volume_weighted_high_low_spread'] = df['volume_weighted_high_low_spread'].cumsum()
    
    # Calculate Volume-Weighted Close Price
    df['volume_weighted_close_price'] = df['close'] * df['volume']
    df['sum_volume_weighted_close_price'] = df['volume_weighted_close_price'].cumsum()
    
    # Total Volume
    df['total_volume'] = df['volume'].cumsum()
    
    # Compute Volume-Weighted High-Low Spread to Close Price Ratio
    df['volume_weighted_ratio'] = df['sum_volume_weighted_high_low_spread'] / df['sum_volume_weighted_close_price']
    
    # Develop trend following alpha factor using close prices
    df['50_day_SMA'] = df['close'].rolling(window=50).mean()
    df['trend_signal'] = (df['close'] > df['50_day_SMA']).astype(int) * 2 - 1
    
    # Explore momentum in high and low prices
    df['high_momentum'] = df['high'] - df['high'].shift(1)
    df['low_momentum'] = df['low'] - df['low'].shift(1)
    df['combined_momentum_score'] = df['high_momentum'] + df['low_momentum']
    df['momentum_signal'] = df['combined_momentum_score'].apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    # Analyze volume patterns
    df['volume_change'] = df['volume'].pct_change()
    df['volume_classification'] = df['volume_change'].apply(
        lambda x: 1 if x > 0.1 else (-1 if x < -0.1 else 0)
    )
    
    # Leverage price and volume for an intensity factor
    df['return'] = df['close'].pct_change()
    df['intensity_factor'] = df['return'] * df['volume']
    df['smoothed_intensity_factor'] = df['intensity_factor'].rolling(window=20).mean()
    
    # Synthesize Factors
    df['composite_alpha_factor'] = (
        df['volume_weighted_ratio'] +
        df['trend_signal'] +
        df['momentum_signal'] +
        df['smoothed_intensity_factor']
    )
    
    return df['composite_alpha_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# composite_alpha_factor = heuristics_v2(df)
# print(composite_alpha_factor)
```
