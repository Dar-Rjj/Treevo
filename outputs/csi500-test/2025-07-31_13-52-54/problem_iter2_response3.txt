```python
import pandas as pd

def heuristics_v2(df, N=10, M=20):
    # Calculate Intraday Range Growth
    df['High-Low_Range'] = df['high'] - df['low']
    df['Prev_High-Low_Range'] = df['High-Low_Range'].shift(1)
    df['Intraday_Range_Growth'] = (df['High-Low_Range'] - df['Prev_High-Low_Range']) / df['Prev_High-Low_Range']

    # Volume Weighted Moving Average
    df['Volume_Weighted_Close'] = df['close'] * df['volume']
    df['SMA_Close'] = df['close'].rolling(window=N).mean()
    df['Sum_Volume'] = df['volume'].rolling(window=N).sum()
    df['VWMA'] = df['Volume_Weighted_Close'].rolling(window=N).sum() / df['Sum_Volume']

    # Combine Intraday Range Growth and Volume Weighted Moving Average
    df['Combined_Intraday_VWMA'] = df['Intraday_Range_Growth'] + df['VWMA']

    # Calculate Price Momentum
    df['N_day_Price_Momentum'] = df['close'] - df['close'].shift(N)
    df['M_day_Price_Momentum'] = df['close'] - df['close'].shift(M)
    df['Price_Momentum'] = df['N_day_Price_Momentum'] + df['M_day_Price_Momentum']

    # Calculate Volume Surge
    df['N_day_Volume_Surge'] = df['volume'] - df['volume'].shift(N)
    df['M_day_Volume_Surge'] = df['volume'] - df['volume'].shift(M)
    df['Volume_Surge'] = df['N_day_Volume_Surge'] + df['M_day_Volume_Surge']

    # Combine All Factors
    df['Adjusted_Price_Momentum'] = df['Price_Momentum'] * df['Volume_Surge']
    df['Adjusted_Price_Momentum'] = df['Adjusted_Price_Momentum'].apply(lambda x: x * 0.8 if x < 0 else x)

    df['Final_Alpha_Factor'] = df['Combined_Intraday_VWMA'] + df['Adjusted_Price_Momentum']

    return df['Final_Alpha_Factor']

# Example usage:
# df = pd.DataFrame(...)  # Your DataFrame with columns: date, open, high, low, close, amount, volume
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
