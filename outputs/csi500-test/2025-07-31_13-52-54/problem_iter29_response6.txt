```python
import pandas as pd

def heuristics_v2(df, n=20, m=10, o=5):
    # Calculate Combined Momentum
    high_volume = df['high'] * df['volume']
    low_volume = df['low'] * df['volume']
    high_volume_sum = high_volume.rolling(window=n).sum()
    low_volume_sum = low_volume.rolling(window=n).sum()
    combined_momentum = high_volume_sum - low_volume_sum
    
    # Calculate Price-Volume Smoothed Average
    close_volume = df['close'] * df['volume']
    close_volume_sum = close_volume.rolling(window=m).sum()
    total_volume = df['volume'].rolling(window=m).sum()
    price_volume_smoothed_avg = close_volume_sum / total_volume
    
    # Compute Momentum to Smoothed Average Ratio
    momentum_to_smoothed_avg_ratio = combined_momentum / price_volume_smoothed_avg
    
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Calculate Volume-Averaged High-Low Spread
    spread_volume = high_low_spread * df['volume']
    spread_volume_sum = spread_volume.rolling(window=o).sum()
    
    # Compute Final Ratio
    final_ratio = momentum_to_smoothed_avg_ratio / spread_volume_sum
    
    return final_ratio
```
