```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 50-day and 200-day Simple Moving Averages (SMA) of Closing Prices
    df['50_day_SMA'] = df['close'].rolling(window=50).mean()
    df['200_day_SMA'] = df['close'].rolling(window=200).mean()

    # Generate Short-Term and Long-Term Trend Signals
    df['short_term_trend_signal'] = (df['close'] > df['50_day_SMA']).astype(int)
    df['long_term_trend_signal'] = (df['close'] > df['200_day_SMA']).astype(int)

    # Calculate High-Low Spread
    df['high_low_spread'] = df['high'] - df['low']

    # Calculate Volume-Average Price
    df['volume_average_price'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()

    # Compute Volume-Averaged High-Low Spread Ratio
    df['volume_averaged_high_low_ratio'] = df['high_low_spread'] / df['volume_average_price']

    # Calculate Momentum Score
    df['momentum_score'] = (df['high'] - df['high'].shift(1)) + (df['low'] - df['low'].shift(1))

    # Calculate Daily Volume Percentage Change
    df['daily_volume_percentage_change'] = df['volume'].pct_change()

    # Multiply Return by Volume to get Market Participant Intensity
    df['return'] = df['close'].pct_change()
    df['market_participant_intensity'] = df['return'] * df['volume']

    # Combine Factors into a Composite Alpha Factor
    df['composite_alpha_factor'] = (
        0.3 * df['short_term_trend_signal'] +
        0.3 * df['long_term_trend_signal'] +
        0.2 * df['momentum_score'] +
        0.2 * df['market_participant_intensity']
    )

    # Adjust the final alpha factor using Volume-Averaged High-Low Spread Ratio
    df['advanced_composite_alpha_factor'] = df['composite_alpha_factor'] * df['volume_averaged_high_low_ratio']

    return df['advanced_composite_alpha_factor']
```
