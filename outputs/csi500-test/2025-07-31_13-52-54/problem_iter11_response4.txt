```python
import pandas as pd

def heuristics_v2(df):
    # Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['close']
    
    # Intraday Volatility
    df['intraday_volatility'] = (df['high'] - df['low']).abs()
    df['intraday_volatility_20d'] = df['intraday_volatility'].rolling(window=20).sum()
    
    # Intraday Range Growth
    df['today_range'] = df['high'] - df['low']
    df['prev_day_range'] = df['today_range'].shift(1)
    df['intraday_range_growth'] = (df['today_range'] - df['prev_day_range']) / df['prev_day_range']
    
    # Volume-Weighted Intraday Reversal
    df['volume_weighted_intraday_reversal'] = -(df['intraday_return'] * df['volume'])
    df['volume_weighted_intraday_reversal_10d'] = df['volume_weighted_intraday_reversal'].rolling(window=10).sum()
    
    # Price Momentum
    n = 10
    df['close_momentum_n'] = df['close'].pct_change(n)
    df['open_momentum_n'] = df['open'].pct_change(n)
    
    # Volume Adjusted Volatility
    df['std_dev_high_low'] = df['high'] - df['low']
    df['std_dev_high_low_5d'] = df['std_dev_high_low'].rolling(window=5).std()
    df['volume_adjusted_volatility'] = df['std_dev_high_low_5d'] / df['volume']
    
    # Volume Weighted Moving Average
    n = 20
    df['weighted_close'] = df['close'] * df['volume']
    df['total_volume'] = df['volume'].rolling(window=n).sum()
    df['volume_weighted_moving_avg'] = df['weighted_close'].rolling(window=n).sum() / df['total_volume']
    
    # Combined Factor
    df['combined_factor'] = (df['intraday_return'] + df['volume_weighted_intraday_reversal_10d']) * df['close_momentum_n'] / df['volume_adjusted_volatility']
    
    # Volume Surge
    N = 5
    M = 10
    df['volume_change_N'] = df['volume'] - df['volume'].shift(N)
    df['volume_change_M'] = df['volume'] - df['volume'].shift(M)
    df['volume_surge'] = df['volume_change_N'] + df['volume_change_M']
    
    # Adjust for Volume Surge
    df['adjusted_volume_surge'] = df['volume_surge'].apply(lambda x: x * 0.8 if x < 0 else x)
    
    # Trend Following Alpha
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['trend_following_alpha'] = (df['close'] > df['sma_50']).astype(int)
    
    # High and Low Momentum
    df['high_momentum'] = df['high'] - df['high'].shift(1)
    df['low_momentum'] = df['low'] - df['low'].shift(1)
    df['high_low_momentum'] = df['high_momentum'] + df['low_momentum']
    
    # Volume Pattern Analysis
    df['volume_change_percent'] = df['volume'].pct_change()
    df['volume_pattern_analysis'] = df['volume_change_percent'].apply(lambda x: 1 if x > 0 else -1)
    
    # Price and Volume Intensity
    df['price_volume_intensity'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1) * df['volume']
    
    # Final Alpha Factor
    df['final_alpha_factor'] = (df['intraday_range_growth'] + df['volume_weighted_moving_avg'] + df['combined_factor'] + 
                                df['adjusted_volume_surge'] + df['trend_following_alpha'] + df['high_low_momentum'] + 
                                df['price_volume_intensity'])
    
    return df['final_alpha_factor']
```
