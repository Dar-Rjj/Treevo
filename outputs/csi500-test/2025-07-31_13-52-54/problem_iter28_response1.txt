```python
import pandas as pd

def heuristics_v2(df, lookback=20, n_days=5):
    # Calculate Volume-Weighted High-Low Spread
    df['High_Low_Spread'] = df['high'] - df['low']
    df['Volume_Weighted_High_Low_Spread'] = df['High_Low_Spread'] * df['volume']
    df['Volume_Weighted_High_Low_Spread_Sum'] = df['Volume_Weighted_High_Low_Spread'].rolling(window=lookback).sum()
    
    # Calculate Volume-Averaged Close Price
    df['Volume_Averaged_Close'] = (df['close'] * df['volume']).rolling(window=lookback).sum() / df['volume'].rolling(window=lookback).sum()
    
    # Compute Ratio
    df['Volume_Weighted_High_Low_Spread_Ratio'] = df['Volume_Weighted_High_Low_Spread_Sum'] / df['Volume_Averaged_Close']
    
    # Generate Short-Term Trend Signal
    df['50_day_SMA'] = df['close'].rolling(window=50).mean()
    df['Short_Term_Trend_Signal'] = (df['close'] > df['50_day_SMA']).astype(int)
    
    # Generate Long-Term Trend Signal
    df['200_day_SMA'] = df['close'].rolling(window=200).mean()
    df['Long_Term_Trend_Signal'] = (df['close'] > df['200_day_SMA']).astype(int)
    
    # Calculate Momentum Component
    df['Past_Average_Volume_Weighted_High_Low_Spread'] = df['Volume_Weighted_High_Low_Spread'].rolling(window=n_days).mean().shift(1)
    df['Momentum_Component'] = df['Volume_Weighted_High_Low_Spread'] - df['Past_Average_Volume_Weighted_High_Low_Spread']
    
    # Calculate Momentum Score
    df['Diff_High'] = df['high'] - df['high'].shift(1)
    df['Diff_Low'] = df['low'] - df['low'].shift(1)
    df['Momentum_Score'] = df['Diff_High'] + df['Diff_Low']
    
    # Calculate Daily Volume Percentage Change
    df['Daily_Volume_Percentage_Change'] = df['volume'].pct_change()
    
    # Multiply Return by Volume
    df['Return'] = df['close'].pct_change()
    df['Market_Participant_Intensity'] = df['Return'] * df['volume']
    
    # Generate Final Factor
    df['Advanced_Composite_Alpha_Factor'] = (
        df['Volume_Weighted_High_Low_Spread_Ratio'] +
        df['Short_Term_Trend_Signal'] +
        df['Long_Term_Trend_Signal'] +
        df['Momentum_Score'] +
        df['Market_Participant_Intensity']
    )
    
    return df['Advanced_Composite_Alpha_Factor']
```
