```txt
Volume-Weighted High-Low Spread with Enhanced Momentum, Price Trend, and Volume Intensity
├── Calculate High-Low Spread
│   ├── Subtract Low from High price
├── Compute Volume-Weighted High-Low Spread
│   ├── Multiply (High - Low) by Volume
│   └── Sum of these values over the lookback period
├── Calculate Volume-Averaged Close Price
│   ├── Sum of (Close price * Volume)
│   └── Total Volume
├── Compute Ratio
│   ├── Divide Volume-Weighted High-Low Spread by Volume-Averaged Close Price
│   └── Output: Volume-Weighted High-Low Spread Ratio
├── Calculate 50-Day Exponential Moving Average (EMA) of Closing Prices
│   ├── EMA calculation using closing prices
├── Generate Binary Trend Signal
│   ├── 1 if the current close is above the EMA, 0 otherwise
├── Calculate Intraday Momentum Score
│   ├── Difference between today’s high and the previous day's high
│   ├── Difference between today’s low and the previous day's low
│   └── Sum of these differences to get a combined momentum score
├── Classify Momentum
│   ├── Assign a value based on the combined momentum score
│   │   ├── Positive for positive momentum
│   │   └── Negative for negative momentum
├── Calculate Daily Volume Percentage Change
│   ├── Calculate the percentage change in volume from the previous day
│   └── Assign a value indicating strong buying or selling pressure
├── Calculate Momentum Component
│   ├── Current Day's Volume-Weighted High-Low Spread
│   ├── Average of Past n Days' Volume-Weighted High-Low Spreads
│   └── Subtract past average from current value
├── Generate Preliminary Factor
│   ├── Add Volume-Weighted High-Low Spread Ratio and Momentum
├── Incorporate Price Trend
│   ├── Subtract 50-Day EMA from the Current Close Price
│   └── Multiply the result by the generated factor
├── Adjust for Volume Surge
│   ├── Determine N-day Volume Change
│   │   ├── Use Volume of today
│   │   └── Subtract Volume of N days ago
│   ├── Determine M-day Volume Change
│   │   ├── Use Volume of today
│   │   └── Subtract Volume of M days ago
│   ├── Combine Changes
│   │   ├── Sum N-day and M-day volume changes
│   └── If Volume Surge is negative, apply a penalty
│       └── Multiply by 0.8
├── Leverage Price and Volume for an Intensity Factor
│   ├── Multiply the return (close to close) by the volume traded
│   ├── Use a moving average of this intensity factor over the past 20 days to smooth out short-term fluctuations
├── Synthesize Factors
    ├── Combine the Volume-Weighted High-Low Spread Ratio, Preliminary Factor, Intraday Range Growth, Adjusted Volume Surge, and Volume-Intensity Factor
    ├── Weighted sum of trend, momentum, and intensity factors
    ├── Use Volume-Weighted High-Low Spread Ratio as a modifier to adjust the final alpha factor
    └── Output: Composite Alpha Factor
```
