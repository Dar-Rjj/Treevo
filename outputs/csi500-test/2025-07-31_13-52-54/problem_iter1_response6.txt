```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate long-term volume-weighted average return (momentum component)
    df['long_term_weighted_return'] = 0.0
    for i in range(1, 101):
        df['long_term_weighted_return'] += df['daily_return'].shift(i) * df['volume'].shift(i)
    df['long_term_total_volume'] = df['volume'].rolling(window=100).sum()
    df['long_term_weighted_return'] /= df['long_term_total_volume']
    
    # Calculate short-term volume-weighted average return (reversal component)
    df['short_term_weighted_return'] = 0.0
    for i in range(1, 6):
        df['short_term_weighted_return'] += df['daily_return'].shift(i) * df['volume'].shift(i)
    df['short_term_total_volume'] = df['volume'].rolling(window=5).sum()
    df['short_term_weighted_return'] /= df['short_term_total_volume']
    
    # Combine momentum and reversal components
    df['alpha_factor'] = df['long_term_weighted_return'] - df['short_term_weighted_return']
    
    return df['alpha_factor']
```
