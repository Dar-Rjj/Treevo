```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the Exponential Moving Average (EMA) of closing prices
    ema_period = 50
    df['EMA'] = df['close'].ewm(span=ema_period, adjust=False).mean()
    
    # Determine the current stock's position relative to its EMA
    df['position_relative_to_ema'] = np.where(df['close'] > df['EMA'], 1, 
                                             np.where(df['close'] < df['EMA'], -1, 0))
    
    # Explore momentum in high and low prices
    df['high_diff'] = df['high'] - df['high'].shift(1)
    df['low_diff'] = df['low'] - df['low'].shift(1)
    df['momentum_score'] = df['high_diff'] + df['low_diff']
    df['momentum_signal'] = np.where(df['momentum_score'] > 0, 1, -1)
    
    # Analyze volume patterns
    df['volume_change'] = df['volume'].pct_change()
    
    # Leverage price and volume for an intensity factor
    df['return'] = df['close'].pct_change()
    df['intensity_factor'] = df['return'] * np.sqrt(df['volume'])
    
    # Long-Term Volume-Weighted Average Return (Momentum Component)
    long_term_days = 100
    df['long_term_weighted_return'] = (df['return'] * np.sqrt(df['volume'])).rolling(window=long_term_days).sum() / np.sqrt(df['volume']).rolling(window=long_term_days).sum()
    
    # Short-Term Volume-Weighted Average Return (Reversal Component)
    short_term_days = 5
    df['short_term_weighted_return'] = (df['return'] * np.sqrt(df['volume'])).rolling(window=short_term_days).sum() / np.sqrt(df['volume']).rolling(window=short_term_days).sum()
    
    # Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['close']
    
    # Intraday Volatility
    df['intraday_volatility'] = (df['high'] - df['low']).abs().rolling(window=20).sum()
    
    # Intraday Momentum
    df['intraday_momentum'] = df['intraday_return'] * np.sqrt(df['volume'])
    df['intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=short_term_days).sum()
    
    # Volume-Weighted Intraday Reversal
    df['intraday_reversal'] = -df['intraday_return'] * np.sqrt(df['volume'])
    df['intraday_reversal_10d'] = df['intraday_reversal'].rolling(window=10).sum()
    
    # Price Momentum
    n_day_return_close = 20
    n_day_return_open = 20
    df['price_momentum_close'] = df['close'].pct_change(n_day_return_close)
    df['price_momentum_open'] = df['open'].pct_change(n_day_return_open)
    
    # Calculate Weighted High-Low Spread Adjusted for Volume
    avg_sqrt_volume_5d = np.sqrt(df['volume']).rolling(window=short_term_days).mean()
    df['weighted_high_low_spread'] = (df['high'] - df['low']) * (np.sqrt(df['volume']) / avg_sqrt_volume_5d)
    
    # Divide Price Momentum by Weighted High-Low Spread Adjusted for Volume
    df['adjusted_price_momentum'] = (df['price_momentum_close'] + df['price_momentum_open']) / df['weighted_high_low_spread']
    
    # Combined Alpha Factor
    df['combined_alpha_factor'] = (
        (df['long_term_weighted_return'] - df['short_term_weighted_return']) + 
        (df['intraday_momentum_5d'] + df['intraday_reversal_10d']) * 
        (df['price_momentum_close'] + df['price_momentum_open']) + 
        df['adjusted_price_momentum']
    )
    
    # Final Alpha Factor
    df['final_alpha_factor'] = (
        df['position_relative_to_ema'] + 
        df['momentum_signal'] + 
        df['intensity_factor'] + 
        df['combined_alpha_factor']
    )
    
    return df['final_alpha_factor']
```
