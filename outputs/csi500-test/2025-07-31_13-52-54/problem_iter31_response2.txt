```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Daily Log Returns
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Moving Averages of Log Returns
    df['ma_5'] = df['log_return'].rolling(window=5).mean()
    df['ma_20'] = df['log_return'].rolling(window=20).mean()
    
    # Momentum Factor
    df['momentum_factor'] = df['ma_5'] - df['ma_20']
    
    # Historical Volatility
    df['historical_volatility'] = df['log_return'].rolling(window=20).std()
    
    # Price Patterns
    df['bullish_engulfing'] = (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    df['bearish_engulfing'] = (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))
    df['inside_bar'] = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))
    df['hammer_formation'] = (df['close'] > df['open']) & ((df['close'] - df['open']) > 2 * (df['high'] - df['close'])) & ((df['close'] - df['open']) > 2 * (df['open'] - df['low']))
    
    # Volume Data
    df['volume_change'] = (df['volume'] / df['volume'].shift(1)) - 1
    df['vol_ma_5'] = df['volume'].rolling(window=5).mean()
    df['vol_ma_20'] = df['volume'].rolling(window=20).mean()
    df['volume_momentum'] = df['vol_ma_5'] - df['vol_ma_20']
    
    # Volume Patterns
    df['volume_spike'] = df['volume'] > 2 * df['volume'].shift(1)
    df['volume_divergence'] = (df['volume'] > df['volume'].shift(1)) & (df['close'] < df['close'].shift(1))
    df['relative_volume_spike'] = df['volume'] > 3 * df['volume'].rolling(window=10).mean().shift(1)
    
    # Amount Data
    df['dollar_volume'] = df['close'] * df['volume']
    df['dollar_volume_change'] = (df['dollar_volume'] / df['dollar_volume'].shift(1)) - 1
    df['dollar_volume_spike'] = df['dollar_volume'] > 2 * df['dollar_volume'].shift(1)
    df['dollar_volume_divergence'] = (df['dollar_volume'] > df['dollar_volume'].shift(1)) & (df['close'] < df['close'].shift(1))
    df['large_dollar_volume_spike'] = df['dollar_volume'] > 3 * df['dollar_volume'].shift(1)
    
    # Composite Factors
    df['combined_momentum'] = 0.6 * df['momentum_factor'] + 0.3 * df['volume_momentum'] + 0.1 * df['dollar_volume_change']
    
    # Combined Price and Volume Patterns
    df['combined_indicator'] = ((df['bullish_engulfing'] & df['volume_spike']) |
                                (df['bearish_engulfing'] & df['volume_spike']) |
                                (df['inside_bar'] & df['volume_divergence']) |
                                (df['hammer_formation'] & df['volume_spike']) |
                                (df['hammer_formation'] & df['volume_divergence']))
    
    # Combined Price and Dollar Volume Patterns
    df['combined_dollar_indicator'] = ((df['bullish_engulfing'] & df['dollar_volume_spike']) |
                                       (df['bearish_engulfing'] & df['dollar_volume_spike']) |
                                       (df['inside_bar'] & df['dollar_volume_divergence']) |
                                       (df['hammer_formation'] & df['large_dollar_volume_spike']) |
                                       (df['hammer_formation'] & df['dollar_volume_divergence']))
    
    # Final Alpha Factor
    df['alpha_factor'] = (df['combined_momentum'] +
                          df['combined_indicator'].astype(int) +
                          df['combined_dollar_indicator'].astype(int) -
                          df['historical_volatility'])
    
    return df['alpha_factor
