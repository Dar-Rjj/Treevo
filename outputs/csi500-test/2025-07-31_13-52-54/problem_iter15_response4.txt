```python
import pandas as pd

def heuristics_v2(df, lookback_period=10, n_days=5, m_days=3):
    # Calculate Volume-Weighted High-Low Spread
    df['High_Low_Spread'] = (df['high'] - df['low']) * df['volume']
    
    # Compute Cumulative Volume-Weighted High-Low Spread
    df['Cum_VW_High_Low_Spread'] = df['High_Low_Spread'].rolling(window=lookback_period).sum()
    df['Total_Volume'] = df['volume'].rolling(window=lookback_period).sum()
    df['VW_High_Low_Spread'] = df['Cum_VW_High_Low_Spread'] / df['Total_Volume']
    
    # Calculate Momentum Indicator
    df['Avg_VW_High_Low_Spread'] = df['VW_High_Low_Spread'].rolling(window=n_days).mean()
    df['Momentum'] = df['VW_High_Low_Spread'] - df['Avg_VW_High_Low_Spread'].shift(1)
    
    # Calculate Intraday Range Growth
    df['Today_Range'] = df['high'] - df['low']
    df['Prev_Day_Range'] = df['high'].shift(1) - df['low'].shift(1)
    df['Intraday_Range_Growth'] = (df['Today_Range'] - df['Prev_Day_Range']) / df['Prev_Day_Range']
    
    # Volume Weighted Moving Average
    df['Close_Volume_Product'] = df['close'] * df['volume']
    df['Sum_Close_Volume'] = df['Close_Volume_Product'].rolling(window=lookback_period).sum()
    df['Sum_Volumes'] = df['volume'].rolling(window=lookback_period).sum()
    df['VWMA'] = df['Sum_Close_Volume'] / df['Sum_Volumes']
    
    # Combine Intraday Range Growth and Volume Weighted Moving Average
    df['Intraday_VWMA'] = df['Intraday_Range_Growth'] + df['VWMA']
    
    # Calculate Price Momentum
    df['Close_n_day_return'] = df['close'].pct_change(n_days)
    df['Open_n_day_return'] = df['open'].pct_change(n_days)
    df['Price_Momentum'] = (df['Close_n_day_return'] + df['Open_n_day_return']) / 2
    
    # Calculate Volume-Weighted Volatility
    df['Volatility'] = (df['high'] - df['low']).rolling(window=n_days).std()
    df['VW_Volatility'] = df['Volatility'] * df['volume']
    
    # Calculate Amount Adjusted Return
    df['Amount_Adjusted_Return'] = df['amount'].pct_change(n_days)
    
    # Adjust for Volume Surge
    df['N_day_Volume_Change'] = df['volume'] - df['volume'].shift(n_days)
    df['M_day_Volume_Change'] = df['volume'] - df['volume'].shift(m_days)
    df['Volume_Surge'] = df['N_day_Volume_Change'] + df['M_day_Volume_Change']
    df['Volume_Surge_Adjusted'] = df['Volume_Surge'].apply(lambda x: x * 0.8 if x < 0 else x)
    
    # Final Combined Alpha Factor
    df['Final_Alpha'] = (
        df['Price_Momentum'] * df['VW_Volatility'] +
        df['Amount_Adjusted_Return'] +
        df['Momentum'] +
        df['Intraday_Range_Growth'] +
        df['Volume_Surge_Adjusted']
    )
    
    # Calculate the Exponential Moving Average (EMA) of closing prices
    ema_period = 50
    df['EMA'] = df['close'].ewm(span=ema_period, adjust=False).mean()
    
    # Determine the current stock's position relative to its EMA
    df['EMA_Position'] = (df['close'] > df['EMA']).astype(int)
    
    return df['Final_Alpha']

# Example usage:
# df = pd.read_csv('your_stock_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
```
