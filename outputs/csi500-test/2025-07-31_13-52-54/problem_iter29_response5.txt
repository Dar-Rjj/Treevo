```python
import pandas as pd
import numpy as np

def heuristics_v2(df, lookback_period=20, ema_span=50):
    # Calculate High-Low Spread
    df['High_Low_Spread'] = df['high'] - df['low']
    
    # Compute Volume-Weighted High-Low Spread
    df['Volume_Weighted_High_Low_Spread'] = df['High_Low_Spread'] * df['volume']
    df['Volume_Weighted_High_Low_Spread_Sum'] = df['Volume_Weighted_High_Low_Spread'].rolling(window=lookback_period).sum()
    
    # Calculate Volume-Averaged Close Price
    df['Volume_Averaged_Close'] = (df['close'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    
    # Compute Ratio
    df['Volume_Weighted_High_Low_Spread_Ratio'] = df['Volume_Weighted_High_Low_Spread_Sum'] / df['Volume_Averaged_Close']
    
    # Calculate 50-Day Exponential Moving Average (EMA) of Closing Prices
    df['EMA_50'] = df['close'].ewm(span=ema_span, adjust=False).mean()
    
    # Generate Binary Trend Signal
    df['Trend_Signal'] = (df['close'] > df['EMA_50']).astype(int)
    
    # Calculate Intraday Momentum Score
    df['Intraday_Momentum_Score'] = (df['high'] - df['high'].shift(1)) + (df['low'] - df['low'].shift(1))
    
    # Classify Momentum
    df['Momentum_Classification'] = np.sign(df['Intraday_Momentum_Score'])
    
    # Calculate Daily Volume Percentage Change
    df['Volume_Change_Pct'] = df['volume'].pct_change()
    
    # Calculate Momentum Component
    df['Average_Volume_Weighted_High_Low_Spread'] = df['Volume_Weighted_High_Low_Spread'].rolling(window=lookback_period).mean()
    df['Momentum_Component'] = df['Volume_Weighted_High_Low_Spread'] - df['Average_Volume_Weighted_High_Low_Spread']
    
    # Generate Preliminary Factor
    df['Preliminary_Factor'] = df['Volume_Weighted_High_Low_Spread_Ratio'] + df['Momentum_Component']
    
    # Incorporate Price Trend
    df['Price_Trend'] = (df['close'] - df['EMA_50']) * df['Preliminary_Factor']
    
    # Adjust for Volume Surge
    n_days = 5
    m_days = 10
    df['N_Day_Volume_Change'] = df['volume'] - df['volume'].shift(n_days)
    df['M_Day_Volume_Change'] = df['volume'] - df['volume'].shift(m_days)
    df['Combined_Volume_Change'] = df['N_Day_Volume_Change'] + df['M_Day_Volume_Change']
    df['Adjusted_Volume_Surge'] = df['Combined_Volume_Change']
    df['Adjusted_Volume_Surge'] = df['Adjusted_Volume_Surge'].apply(lambda x: x * 0.8 if x < 0 else x)
    
    # Leverage Price and Volume for an Intensity Factor
    df['Return'] = df['close'].pct_change()
    df['Intensity_Factor'] = df['Return'] * df['volume']
    df['Smoothed_Intensity_Factor'] = df['Intensity_Factor'].rolling(window=20).mean()
    
    # Synthesize Factors
    df['Composite_Alpha_Factor'] = (
        0.3 * df['Volume_Weighted_High_Low_Spread_Ratio'] +
        0.4 * df['Preliminary_Factor'] +
        0.2 * df['Intraday_Momentum_Score'] +
        0.1 * df['Adjusted_Volume_Surge'] +
        0.1 * df['Smoothed_Intensity_Factor']
    )
    
    return df['Composite_Alpha_Factor']
```
