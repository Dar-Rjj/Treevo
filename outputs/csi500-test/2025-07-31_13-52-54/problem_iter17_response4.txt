```python
import pandas as pd

def heuristics_v2(df):
    # Sub-Thought: Calculate the 50-day Simple Moving Average (SMA) of closing prices
    df['sma_50'] = df['close'].rolling(window=50).mean()
    
    # Sub-Thought: Generate a binary trend signal; 1 if the current close is above the SMA, 0 otherwise
    df['trend_signal'] = (df['close'] > df['sma_50']).astype(int)
    
    # Sub-Thought: Compute Volume-Weighted High-Low Spread
    df['hlv'] = (df['high'] - df['low']) * df['volume']
    
    # Sub-Thought: Summarize Over Lookback Period
    lookback = 50
    df['cumulative_hlv'] = df['hlv'].rolling(window=lookback).sum()
    df['total_volume'] = df['volume'].rolling(window=lookback).sum()
    
    # Sub-Thought: Calculate Volume-Weighted High-Low Momentum
    n = 5
    avg_hlv_vol = (df['hlv'].shift(1).rolling(window=n).sum() / df['total_volume'])
    df['vw_hl_momentum'] = (df['hlv'] - (avg_hlv_vol * df['volume']))
    
    # Sub-Thought: Incorporate Price Trend
    df['price_change'] = df['close'] - df['open']
    df['momentum_with_trend'] = df['vw_hl_momentum'] + df['price_change']
    
    # Sub-Thought: Calculate Intraday Range Growth
    df['today_range'] = df['high'] - df['low']
    df['prev_day_range'] = df['today_range'].shift(1)
    df['intraday_range_growth'] = (df['today_range'] - df['prev_day_range']) / df['prev_day_range'].replace(0, 1)
    
    # Sub-Thought: Volume Weighted Moving Average
    N = 50
    df['weighted_close'] = df['close'] * df['volume']
    sum_weighted_close = df['weighted_close'].rolling(window=N).sum()
    sum_volume = df['volume'].rolling(window=N).sum()
    df['vwma'] = sum_weighted_close / sum_volume
    
    # Sub-Thought: Combine Intraday Range Growth and Volume Weighted Moving Average
    df['combined_factor'] = df['intraday_range_growth'] + df['vwma']
    
    # Sub-Thought: Calculate Price Momentum
    n_day_return_close = df['close'].pct_change(periods=n)
    n_day_return_open = df['open'].pct_change(periods=n)
    df['price_momentum'] = n_day_return_close + n_day_return_open
    
    # Sub-Thought: Adjust for Volume Surge
    N = 50
    M = 20
    df['n_day_vol_change'] = df['volume'] - df['volume'].shift(N)
    df['m_day_vol_change'] = df['volume'] - df['volume'].shift(M)
    df['volume_surge'] = df['n_day_vol_change'] + df['m_day_vol_change']
    df['adjusted_volume_surge'] = df['volume_surge'].apply(lambda x: x * 0.8 if x < 0 else x)
    
    # Sub-Thought: Final Combined Alpha Factor
    df['composite_alpha'] = (df['price_momentum'] * df['combined_factor']) + \
                            df['intraday_range_growth'] + \
                            df['adjusted_volume_surge'] + \
                            df['momentum_with_trend'] * df['trend_signal']
    
    return df['composite_alpha']
```
