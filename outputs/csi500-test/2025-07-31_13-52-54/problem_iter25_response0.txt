```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily log returns
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Moving Averages of Log Returns
    df['ma_5_log_return'] = df['log_return'].rolling(window=5).mean()
    df['ma_20_log_return'] = df['log_return'].rolling(window=20).mean()
    
    # Momentum Factor
    df['momentum_factor'] = df['ma_5_log_return'] - df['ma_20_log_return']
    
    # Historical Volatility (20-day Standard Deviation)
    df['historical_volatility'] = df['log_return'].rolling(window=20).std()
    
    # Exponential Weighted Moving Average of Log Returns (12-period)
    df['ewma_12_log_return'] = df['log_return'].ewm(span=12, adjust=False).mean()
    
    # Price Patterns
    df['bullish_engulfing'] = (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    df['bearish_engulfing'] = (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))
    df['inside_bar'] = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))
    
    # Volume Data
    df['volume_change'] = df['volume'] / df['volume'].shift(1) - 1
    
    # Volume-Based Momentum
    df['ma_5_volume'] = df['volume'].rolling(window=5).mean()
    df['ma_20_volume'] = df['volume'].rolling(window=20).mean()
    df['volume_momentum'] = df['ma_5_volume'] - df['ma_20_volume']
    
    # Volume Patterns
    df['volume_spike'] = df['volume'] > 2 * df['volume'].shift(1)
    df['volume_divergence'] = (df['volume'] > df['volume'].shift(1)) & (df['close'] < df['close'].shift(1))
    
    # Amount Data
    df['dollar_volume'] = df['close'] * df['volume']
    df['dollar_volume_change'] = df['dollar_volume'] / df['dollar_volume'].shift(1) - 1
    
    # Dollar Volume Patterns
    df['dollar_volume_spike'] = df['dollar_volume'] > 2 * df['dollar_volume'].shift(1)
    df['dollar_volume_divergence'] = (df['dollar_volume'] > df['dollar_volume'].shift(1)) & (df['close'] < df['close'].shift(1))
    
    # Composite Factors
    df['combined_momentum'] = 0.5 * df['momentum_factor'] + 0.3 * df['volume_momentum'] + 0.2 * df['dollar_volume_change']
    
    # Trend Strength (ADX) - Simplified version using ATR
    df['tr'] = df[['high' - 'low', 'high' - 'close'].shift(1), abs('low' - 'close').shift(1)]].max(axis=1)
    df['atr_14'] = df['tr'].rolling(window=14).mean()
    df['adx'] = 100 * (df['atr_14'] / df['atr_14'].shift(1) - 1)
    
    # Relative Strength
    df['relative_strength'] = df['close'] / df['benchmark_close']
    
    # Combined Trend and Momentum
    df['combined_trend_momentum'] = 0.5 * df['adx'] + 0.5 * df['combined_momentum']
    
    # Combined Price and Volume Patterns
    df['combined_price_volume_patterns'] = (df['bullish_engulfing'] & df['volume_spike']) | \
                                           (df['bearish_engulfing'] & df['volume_spike']) | \
                                           (df['inside_bar'] & df['volume_divergence'])
    
    # Combined Price and Dollar Volume Patterns
    df['combined_price_dollar_volume_patterns'] = (df['bullish_engulfing'] & df['dollar_volume_spike']) | \
                                                  (df['bearish_engulfing'] & df['dollar_volume_spike']) | \
                                                  (df['inside_bar'] & df['dollar_volume_divergence'])
    
    # Final Alpha
