```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between today's close and yesterday's close, representing momentum
    momentum = df['close'].diff()
    
    # Calculate the volume weighted average price over the last 5 days
    vwap_5d = (df['close'] * df['volume']).rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    
    # Calculate the percentage change in volume to capture trading activity changes
    volume_pct_change = df['volume'].pct_change()
    
    # Calculate the ratio of high to low price to capture intraday volatility
    high_low_ratio = df['high'] / df['low']
    
    # Factor: Momentum adjusted by the Volume Weighted Average Price over the last 5 days, 
    # and further adjusted by the volume percentage change and high-low ratio
    factor = momentum / (vwap_5d - df['close'] + 1e-7) * volume_pct_change * high_low_ratio
    return factor
```
