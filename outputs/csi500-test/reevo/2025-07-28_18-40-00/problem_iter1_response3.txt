```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the average of (open, high, low, close)
    avg_price = (df['open'] + df['high'] + df['low'] + df['close']) / 4
    
    # Calculate the weighted amount by volume
    weighted_amount = df['amount'] * df['volume']
    
    # Calculate the smoothed average price using a rolling window
    smoothed_avg_price = avg_price.rolling(window=5).mean()
    
    # Calculate the momentum factor
    momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    
    # Combine the factors
    factor = (smoothed_avg_price * momentum) / (weighted_amount + 1e-7)
    
    return factor
```
