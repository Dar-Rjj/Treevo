```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between current close and previous close to get price change
    df['price_change'] = df['close'].diff()
    
    # Calculate the 5-day rolling mean of the volume
    df['volume_mean_5d'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the relative change in volume compared to the mean of last 5 days
    df['volume_change_rel'] = (df['volume'] - df['volume_mean_5d']) / (df['volume_mean_5d'] + 1e-7)
    
    # Calculate the volatility using the standard deviation of returns over the past 5 days
    df['volatility_5d'] = df['price_change'].rolling(window=5).std()
    
    # Calculate the 20-day momentum (difference between current close and close 20 days ago)
    df['momentum_20d'] = df['close'] - df['close'].shift(20)
    
    # Calculate the 20-day rolling mean of the amount
    df['amount_mean_20d'] = df['amount'].rolling(window=20).mean()
    
    # Calculate the relative change in amount compared to the mean of last 20 days
    df['amount_change_rel'] = (df['amount'] - df['amount_mean_20d']) / (df['amount_mean_20d'] + 1e-7)
    
    # Calculate the 20-day moving average of the close price
    df['ma_close_20d'] = df['close'].rolling(window=20).mean()
    
    # Calculate the 20-day moving average of the high-low range
    df['range_20d'] = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Factor: Long-term momentum adjusted by relative volume change, amount change, and volatility
    factor = (df['momentum_20d'] * df['volume_change_rel'] * df['amount_change_rel']) / (df['volatility_5d'] + 1e-7)
    
    return factor
```
