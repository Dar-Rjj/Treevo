```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the volume-weighted average price (VWAP)
    vwap = (df['amount'] / df['volume']).rolling(window=5).mean()
    
    # Calculate the exponential moving average of the VWAP with a window of 7 days
    ema_vwap = vwap.ewm(span=7, adjust=False).mean()
    
    # Calculate the momentum of the close price with a window of 5 days
    momentum = df['close'].pct_change(periods=5)
    
    # Calculate the log return of the close price
    log_return = np.log(df['close'] / df['close'].shift(1))
    
    # Calculate the volatility of the close price with a window of 20 days
    volatility = df['close'].rolling(window=20).std()
    
    # Calculate the simple moving average of the close price with a window of 20 days
    sma_close_20 = df['close'].rolling(window=20).mean()
    
    # Calculate the trend as the difference between the close price and its 20-day SMA
    trend = df['close'] - sma_close_20
    
    # Calculate the factor as the difference between the close price and the EMA of VWAP
    # and multiply it by the momentum, log return, and volatility to incorporate the trend, momentum, and volatility
    # Use dynamic weighting for each component
    weight_trend = 1.0
    weight_momentum = 0.5
    weight_volatility = 0.3
    factor = ((df['close'] - ema_vwap) 
              * (weight_trend * trend) 
              * (weight_momentum * momentum) 
              * (weight_volatility * volatility))

    return factor
```
