```python
import pandas as pd

def heuristics_v2(data):
    # Calculate short-term price momentum
    data['10_day_avg_close'] = data['close'].rolling(window=10).mean()
    data['short_term_momentum'] = data['close'] - data['10_day_avg_close']
    
    # Calculate medium-term price momentum
    data['30_day_avg_close'] = data['close'].rolling(window=30).mean()
    data['medium_term_momentum'] = data['close'] - data['30_day_avg_close']
    
    # Calculate long-term price momentum
    data['50_day_avg_close'] = data['close'].rolling(window=50).mean()
    data['long_term_momentum'] = data['close'] - data['50_day_avg_close']
    
    # Combine multi-period momenta
    data['combined_momentum'] = (data['short_term_momentum'] +
                                 data['medium_term_momentum'] +
                                 data['long_term_momentum'])
    
    # Calculate volume-weighted average return
    data['daily_return'] = (data['close'] - data['open']) / data['open']
    data['volume_weighted_return'] = (data['daily_return'] * data['volume']).rolling(window=50).sum() / data['volume'].rolling(window=50).sum()
    
    # Adjust combined momentum by volume-weighted average return
    data['adjusted_combined_momentum'] = data['combined_momentum'] * data['volume_weighted_return']
    
    # Assess trend following potential
    data['50_day_ma'] = data['close'].rolling(window=50).mean()
    data['trend_following_component'] = 1
    data.loc[data['50_day_ma'] < data['close'], 'trend_following_component'] = 0.5
    
    # Determine final factor value
    data['final_factor_value'] = data['adjusted_combined_momentum'] + data['trend_following_component']
    
    # Additional enhancements
    # Calculate short-term volatility
    data['10_day_range'] = data['high'] - data['low']
    data['short_term_volatility'] = data['10_day_range'].rolling(window=10).mean()
    
    # Calculate medium-term volatility
    data['30_day_range'] = data['high'] - data['low']
    data['medium_term_volatility'] = data['30_day_range'].rolling(window=30).mean()
    
    # Calculate long-term volatility
    data['50_day_range'] = data['high'] - data['low']
    data['long_term_volatility'] = data['50_day_range'].rolling(window=50).mean()
    
    # Combine multi-period volatilities
    data['combined_volatility'] = (data['short_term_volatility'] +
                                   data['medium_term_volatility'] +
                                   data['long_term_volatility'])
    
    # Adjust combined momentum by combined volatility
    data['new_adjusted_combined_momentum'] = data['adjusted_combined_momentum'] / data['combined_volatility']
    
    # Re-evaluate final factor value
    data['revalued_final_factor_value'] = data['new_adjusted_combined_momentum'] + data['trend_following_component']
    
    # Incorporate market signals and microstructure
    # Calculate RSI
    delta = data['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    data['rsi'] = 100 - (100 / (1 + rs))
    
    # Integrate RSI into final factor value
    data['rsi_integrated_factor'] = data['revalued_final_factor_value'] * data['rsi']
    
    # Analyze microstructure
    data['avg_volume_20_days'] = data['volume'].rolling(window=20).mean()
    data['volume_ratio'] = data['volume'] / data['avg_volume_20_days']
    
    # Finalize alpha factor
    data['alpha_factor'] = data['rsi_integrated_factor'] * data['volume_ratio']
    
    return data['alpha_factor']
```
