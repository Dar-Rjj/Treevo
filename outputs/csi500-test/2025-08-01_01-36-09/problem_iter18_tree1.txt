```txt
Enhanced Multi-Period Momentum with Volume, Trend, and Dynamic Weighting
├── Calculate Short-Term Price Momentum
│   ├── Collect Closing prices for the last 10 days
│   └── Compute the average of the last 10 days
│       └── Subtract the current Close price from the 10-day average
├── Calculate Medium-Term Price Momentum
│   ├── Collect Closing prices for the last 30 days
│   └── Compute the average of the last 30 days
│       └── Subtract the current Close price from the 30-day average
├── Calculate Long-Term Price Momentum
│   ├── Collect Closing prices for the last 50 days
│   └── Compute the average of the last 50 days
│       └── Subtract the current Close price from the 50-day average
├── Combine Multi-Period Momenta
│   ├── Add the Short-Term Price Momentum
│   ├── Add the Medium-Term Price Momentum
│   └── Add the Long-Term Price Momentum
├── Calculate Volume-Weighted Average Return
│   ├── Compute daily returns using Close and Open prices
│   │   ├── Use Close price
│   │   └── Use Open price
│   ├── Multiply each daily return by the respective volume
│   │   ├── Use Volume
│   ├── Sum the volume-weighted returns
│   └── Divide by the total volume over the period
├── Adjust Combined Momentum by Volume-Weighted Average Return
│   └── Multiply the combined momentum by the Volume-Weighted Average Return
├── Assess Trend Following Potential
│   ├── Evaluate Long-Term Direction
│   │   ├── Calculate 50-day Moving Average of Close prices
│   │   └── Use Last 50 Close prices
│   └── Apply Weight to Trend Following Component
│       ├── If 50-day Moving Average is above the current Close price, assign weight 1
│       └── Otherwise, assign weight 0.5
├── Incorporate Liquidity
│   ├── Calculate Average Daily Volume
│   │   ├── Sum the volumes over the last 20 days
│   │   └── Divide by 20
│   └── Adjust Final Factor Value by Liquidity
│       └── Multiply the final factor value by the ratio of current volume to average daily volume
├── Consider Market Sentiment
│   ├── Calculate Daily Range
│   │   ├── Use High and Low prices
│   │   └── Compute (High - Low)
│   ├── Calculate 20-Day Average Range
│   │   ├── Sum the daily ranges over the last 20 days
│   │   └── Divide by 20
│   └── Adjust Final Factor Value by Market Sentiment
│       └── Multiply the final factor value by the ratio of current daily range to 20-day average range
├── Incorporate Sector-Specific Trends
│   ├── Identify Stock's Sector
│   │   ├── Use sector classification data
│   ├── Calculate Sector 50-Day Moving Average
│   │   ├── Use Close prices of all stocks in the same sector
│   │   └── Compute the 50-day moving average
│   └── Adjust Final Factor Value by Sector-Specific Trends
│       └── If stock's sector 50-day moving average is above the current Close price, multiply the final factor value by 1.2
│           └── Otherwise, multiply the final factor value by 0.8
├── Determine Final Factor Value
│   └── Aggregate the adjusted combined momentum, trend following component, liquidity adjustment, market sentiment adjustment, and sector-specific trends adjustment
```
```
