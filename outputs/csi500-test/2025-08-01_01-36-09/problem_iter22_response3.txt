```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the rolling mean of the closing price over the last 30 days
    df['rolling_mean_30'] = df['close'].rolling(window=30).mean()
    
    # Calculate the rolling standard deviation of the closing price over the last 30 days
    df['rolling_std_30'] = df['close'].rolling(window=30).std()
    
    # Calculate the z-score of the current closing price relative to the 30-day window
    df['z_score'] = (df['close'] - df['rolling_mean_30']) / df['rolling_std_30']
    
    # Calculate the ratio of the volume to the rolling mean of the volume over the last 30 days
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=30).mean()
    
    # Calculate the factor value as a weighted sum of the z-score and the volume ratio
    df['factor_value'] = (df['z_score'] * 0.7) + (df['volume_ratio'] * 0.3)
    
    return df['factor_value']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date')
# factor_values = heuristics_v2(df)
# print(factor_values)
```
