```python
import pandas as pd

def heuristics_v2(df, n=10):
    # Compute the difference between the current close and the close n periods ago
    df['close_diff'] = df['close'].diff(n)
    
    # Detect instances where the closing price crosses above or below a moving average
    df['sma_close'] = df['close'].rolling(window=n).mean()
    df['cross_above_sma'] = (df['close'] > df['sma_close']) & (df['close'].shift(1) <= df['sma_close'].shift(1))
    df['cross_below_sma'] = (df['close'] < df['sma_close']) & (df['close'].shift(1) >= df['sma_close'].shift(1))
    
    # Calculate the difference between the current volume and the volume n periods ago
    df['volume_diff'] = df['volume'].diff(n)
    
    # Find significant increases in volume compared to the previous period
    df['volume_increase'] = (df['volume'] > df['volume'].shift(1)) & (df['volume'] / df['volume'].shift(1) > 1.5)
    
    # Calculate the range (High - Low)
    df['range'] = df['high'] - df['low']
    
    # Identify bullish or bearish candlestick patterns (e.g., Doji, Hammer, Engulfing)
    df['doji'] = (df['open'] == df['close']).astype(int)
    df['hammer'] = ((df['close'] - df['low']) / df['range'] > 0.6) & ((df['high'] - df['open']) / df['range'] < 0.2)
    df['bullish_engulfing'] = (df['open'].shift(1) > df['close'].shift(1)) & (df['open'] < df['close']) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    df['bearish_engulfing'] = (df['open'].shift(1) < df['close'].shift(1)) & (df['open'] > df['close']) & (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))
    
    # Determine the difference between the current transaction amount and the amount n periods ago
    df['amount_diff'] = df['amount'].diff(n)
    
    # Identify significantly large transactions compared to the historical average
    df['avg_amount'] = df['amount'].rolling(window=n).mean()
    df['large_transaction'] = df['amount'] > 2 * df['avg_amount']
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['close_diff'] + 
                          df['cross_above_sma'].astype(int) - df['cross_below_sma'].astype(int) + 
                          df['volume_diff'] + 
                          df['volume_increase'].astype(int) + 
                          df['range'] + 
                          df['doji'] + 
                          df['hammer'].astype(int) + 
                          df['bullish_engulfing'].astype(int) - df['bearish_engulfing'].astype(int) + 
                          df['amount_diff'] + 
                          df['large_transaction'].astype(int))
    
    return df['alpha_factor']
```
