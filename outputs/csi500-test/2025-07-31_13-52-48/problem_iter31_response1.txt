```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Momentum
    df['high_low_diff'] = df['high'] - df['low']
    df['intraday_momentum_ema'] = df['high_low_diff'].ewm(span=10, adjust=False).mean()

    # Adjust by Volume Volatility
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['volume_volatility'] = df['volume_change'].rolling(window=10).apply(lambda x: np.mean(np.abs(x - x.mean())), raw=True)
    df['intraday_adjustment'] = df['intraday_momentum_ema'] / df['volume_volatility']

    # Calculate Daily Price Change
    df['daily_price_change'] = df['close'] - df['close'].shift(1)

    # Calculate Volume-Weighted Momentum
    df['volume_weighted_momentum'] = df['daily_price_change'] * np.log(df['volume'])

    # Combine and Adjust
    df['intraday_adjusted_volume_weighted_momentum'] = df['volume_weighted_momentum'] * df['intraday_adjustment']
    
    # Incorporate Price Trend
    df['price_trend'] = df['close'] - df['open'].shift(1)
    df['final_factor'] = df['intraday_adjusted_volume_weighted_momentum'] * df['price_trend']

    # Analyze Closing Prices
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['cross_above_sma'] = (df['close'] > df['sma_20']) & (df['close'].shift(1) <= df['sma_20'])
    df['cross_below_sma'] = (df['close'] < df['sma_20']) & (df['close'].shift(1) >= df['sma_20'])

    # Consider OHLC Relationships
    df['is_doji'] = (df['close'] - df['open']).abs() < 0.5 * (df['high'] - df['low'])
    df['is_hammer'] = (df['close'] - df['low']) / (df['high'] - df['low']) > 0.67
    df['is_bullish_engulfing'] = (df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    df['is_bearish_engulfing'] = (df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))

    # Final Adjustment
    df['final_factor'] = df['final_factor'] * (1 + df['is_doji'] + df['is_hammer'] + df['is_bullish_engulfing'] - df['is_bearish_engulfing'])

    return df['final_factor'].dropna()
```
