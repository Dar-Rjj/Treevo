```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate simple moving averages (SMA)
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Calculate price rate of change (ROC)
    df['ROC_5'] = df['close'].pct_change(periods=5)
    df['ROC_20'] = df['close'].pct_change(periods=20)

    # Calculate volume moving average
    df['VMA_5'] = df['volume'].rolling(window=5).mean()
    df['VMA_20'] = df['volume'].rolling(window=20).mean()

    # Calculate historical volatility
    df['HV_20'] = df['close'].pct_change().rolling(window=20).std() * np.sqrt(252)

    # Construct a composite factor using weighted sum of SMA, ROC, and volume
    df['composite_factor'] = (
        0.3 * df['SMA_5'] + 
        0.3 * df['SMA_20'] + 
        0.2 * df['ROC_5'] + 
        0.2 * df['ROC_20'] + 
        0.1 * df['VMA_5'] + 
        0.1 * df['VMA_20']
    )

    return df['composite_factor']
```
