```python
import pandas as pd
import numpy as np

def heuristics(df):
    # Calculate Intraday Momentum
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    intraday_ema_alpha = 0.1
    df['intraday_momentum_ema'] = df['intraday_return'].ewm(alpha=intraday_ema_alpha, adjust=False).mean()

    # Incorporate Volatility Component
    df['intraday_price_range'] = (df['high'] - df['low']) / df['open']
    n_days_volatility = 20
    df['volatility'] = df['intraday_price_range'].rolling(window=n_days_volatility).std()
    df['intraday_momentum_vol_adjusted'] = df['intraday_momentum_ema'] * df['volatility']

    # Introduce Enhanced Volume Impact
    df['volume_weighted_intraday_return'] = (df['close'] - df['open']) * df['volume'] / df['open']
    volume_ema_alpha = 0.05
    df['volume_weighted_intraday_return_ema'] = df['volume_weighted_intraday_return'].ewm(alpha=volume_ema_alpha, adjust=False).mean()

    m_days_volume_trend = 10
    df['volume_rate_of_change'] = (df['volume'] - df['volume'].shift(m_days_volume_trend)) / df['volume'].shift(m_days_volume_trend)
    df['volume_adjusted_intraday_momentum'] = df['volume_weighted_intraday_return_ema'] + df['volume_rate_of_change']

    # Calculate Daily Price Momentum
    daily_momentum_window = 5
    df['daily_log_return'] = np.log(df['close'] / df['close'].shift(1))
    df['daily_momentum'] = df['daily_log_return'].rolling(window=daily_momentum_window).sum()

    # Apply Volume-Adjusted Momentum Filter
    df['volume_adjusted_momentum'] = df['volume'] - df['volume'].shift(1) * df['daily_momentum']
    rolling_sum_days = 20
    df['rolling_volume_adjusted_momentum'] = df['volume_adjusted_momentum'].rolling(window=rolling_sum_days).sum()
    high_volume_threshold = df['volume_adjusted_momentum'].abs().quantile(0.75)
    df['volume_adjusted_momentum_filtered'] = df['volume_adjusted_momentum'].where(df['volume_adjusted_momentum'].abs() < high_volume_threshold, 0)

    # Calculate Intraday Price Movement
    df['pct_high_low'] = (df['high'] - df['low']) / df['open']
    df['pct_close_open'] = (df['close'] - df['open']) / df['open']
    df['avg_pct_movement'] = (df['pct_high_low'] + df['pct_close_open']) / 2
    df['smoothed_avg_pct_movement'] = df['avg_pct_movement'].ewm(span=3, adjust=False).mean()

    # Combine Ratios
    df['close_to_high_ratio'] = df['close'] / df['high']
    df['close_to_low_ratio'] = df['close'] / df['low']
    df['combined_ratios'] = 0.5 * df['close_to_high_ratio'] + 0.5 * df['close_to_low_ratio']

    # Combine Adjusted Momentum, Intraday Movement, and Ratios
    df['final_factor'] = (
        df['volume_adjusted_intraday_momentum'] +
        df['smoothed_avg_pct_movement'] +
        df['combined_ratios']
    )

    # Compute Dynamic Price Momentum Oscillator
    df['momentum_oscillator'] = df['rolling_volume_adjusted_momentum'] - df['rolling_volume_adjusted_momentum'].rolling(window=60).mean()

    # Apply Volume Shock Filter
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)).abs()
    high_volume_shock_threshold = df['volume_change'].quantile(0.75)
    df['final_factor'] = df['final_factor'].where(df['volume_change'] < high_volume_shock_threshold, 0)

    return df['final_factor']
```
