```txt
Volume-Weighted Intraday Momentum and Volatility Factor
├── Calculate Intraday Return
│   ├── Use High price of day t
│   └── Use Low price of day t
│       └── Subtract Low from High
├── Calculate Average Intraday Return
│   ├── Sum Intraday Returns from days 1 to t
│   └── Divide by Number of Days (t)
├── Calculate Intraday Volatility
│   ├── Square Intraday Returns from days 1 to t
│   ├── Sum Squared Intraday Returns
│   └── Take Square Root of Sum
├── Calculate Exponential Moving Average of Intraday Volatility
│   ├── Use Last 20 Days Intraday Volatility (t-19 to t)
│   └── Compute Exponential Moving Average
├── Weight by Volume
│   ├── Use Volume of day t
│   └── Multiply Intraday Volatility by Volume
├── Calculate Volume-Weighted Intraday Momentum
│   ├── Use Intraday Return of day t
│   ├── Use Volume of day t
│   └── Multiply Intraday Return by Volume
├── Calculate Exponential Moving Average of Volume-Weighted Intraday Momentum
│   ├── Use Last 20 Days Volume-Weighted Intraday Momentum (t-19 to t)
│   └── Compute Exponential Moving Average
├── Incorporate Bid-Ask Spread
│   ├── Use Ask price of day t
│   ├── Use Bid price of day t
│   └── Subtract Bid from Ask
├── Calculate Average Bid-Ask Spread
│   ├── Sum Bid-Ask Spreads from days 1 to t
│   └── Divide by Number of Days (t)
└── Combine Factors
    ├── Use Exponential Moving Average of Intraday Volatility (t-19 to t)
    ├── Use Exponential Moving Average of Volume-Weighted Intraday Momentum (t-19 to t)
    ├── Use Average Bid-Ask Spread (t-19 to t)
    └── Add Moving Averages and Average Bid-Ask Spread
```
