```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Daily log return
    df['log_return'] = np.log(df['close'] / df['open'])
    
    # Cumulative log return over the past 5 days
    df['cum_log_return_5d'] = df['log_return'].rolling(window=5).sum()
    
    # Average of the cumulative log return over the past 5 days
    df['avg_cum_log_return_5d'] = df['cum_log_return_5d'].rolling(window=5).mean()
    
    # 10-day moving average of the daily return
    df['ma_10d'] = df['daily_return'].rolling(window=10).mean()
    
    # Difference between the current day's return and its 10-day moving average
    df['return_diff_ma_10d'] = df['daily_return'] - df['ma_10d']
    
    # Acceleration of returns by computing the difference in the 10-day moving average over consecutive days
    df['acceleration_10d'] = df['ma_10d'].diff()
    
    # Change in acceleration over the past 5 days
    df['change_acceleration_5d'] = df['acceleration_10d'].rolling(window=5).mean()
    
    # Standard deviation of the past 20 days' daily returns to measure recent volatility
    df['volatility_20d'] = df['daily_return'].rolling(window=20).std()
    
    # Ratio of the current day's return to the recent volatility
    df['return_vol_ratio'] = df['daily_return'] / df['volatility_20d']
    
    # Rolling correlation between the daily return and the recent volatility
    df['corr_return_vol_20d'] = df['daily_return'].rolling(window=20).corr(df['volatility_20d'])
    
    # Enhance the factor by incorporating the sign of the daily return
    df['enhanced_corr_factor'] = df['corr_return_vol_20d'] * np.sign(df['daily_return'])
    
    # Ratio of todayâ€™s volume over the average volume of the last 20 days, multiplied by the daily return
    df['volume_ratio_20d'] = df['volume'] / df['volume'].rolling(window=20).mean()
    df['volume_impact_factor'] = df['volume_ratio_20d'] * df['daily_return']
    
    # Binary indicator when the volume is significantly higher than the average
    df['high_volume_flag'] = df['volume_ratio_20d'] > 1.5
    
    # Enhance the binary factor by incorporating the direction and magnitude of the daily return on these high-volume days
    df['high_volume_return_impact'] = df['high_volume_flag'] * df['daily_return'] * df['volume_ratio_20d']
    
    # Impact of high-volume days on the 10-day moving average of the daily return
    df['high_volume_impact_on_ma_10d'] = df['high_volume_return_impact'].rolling(window=10).mean()
    
    # Percentage range as (high - low) / close
    df['percentage_range'] = (df['high'] - df['low']) / df['close']
    
    # Combine the percentage range with the daily return to form a new factor
    df['range_return_factor'] = df['percentage_range'] * df['daily_return']
    
    # Interaction between the percentage range and the 10-day moving average of the daily return
    df['range_ma_10d_interaction'] = df['percentage_range'] * df['ma_10d']
    
    # Ratio of the percentage range to the 10-day moving average of the percentage range
    df['range_ma_10d_ratio'] = df['percentage_range'] / df['percentage_range'].rolling(window=10).mean()
    
    # Enhance the factor by incorporating the direction of the daily return
    df['enhanced_range_factor'] = df['range_ma_10d_ratio'] * np.sign(df['daily_return'])
    
    # Identify days where the volume is above the 95th percentile of the past 30 days
    df['volume_95th_percentile'] = df['volume'].rolling(window=30).quantile(0.95)
    df['large_trade_flag'] = df['volume'] > df['volume_95th_percentile']
    
    # Enhance the binary factor by incorporating the direction of the daily return on
