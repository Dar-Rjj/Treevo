```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the relative strength compared to the 3-day moving average
    df['MA_3_close'] = df['close'].rolling(window=3).mean()
    df['RS_3'] = (df['close'] - df['MA_3_close']) / df['MA_3_close']
    
    # Calculate the buying pressure, which is high if the close is closer to the high than the open
    df['buying_pressure'] = (df['high'] - df['close']) / (df['high'] - df['low'])
    
    # Calculate the selling pressure, which is high if the close is closer to the low than the open
    df['selling_pressure'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    
    # Calculate the net buying pressure as a difference between buying and selling pressures
    df['net_buying_pressure'] = df['buying_pressure'] - df['selling_pressure']
    
    # Calculate the volume weighted close price
    df['VW_close'] = df['close'] * df['volume']
    
    # Calculate the sum of the last 3 days' volume weighted close
    df['sum_VW_close'] = df['VW_close'].rolling(window=3).sum()
    
    # Calculate the alpha factor as the sum of the relative strength, net buying pressure, and the ratio of today's VW_close to the sum of last 3 days' VW_close
    df['alpha_factor'] = df['RS_3'] + df['net_buying_pressure'] + (df['VW_close'] / df['sum_VW_close'])
    
    return df['alpha_factor']
```
