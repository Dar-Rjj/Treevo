```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'] / df['close'].shift(1) - 1
    
    # Examine high-low range
    df['daily_range'] = df['high'] - df['low']
    df['range_to_close_ratio'] = df['daily_range'] / df['close']
    
    # Analyze opening and closing gap
    df['gap_open_close'] = df['open'] - df['close'].shift(1)
    df['gap_to_prev_close_ratio'] = df['gap_open_close'] / df['close'].shift(1)
    
    # Calculate daily volume changes
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['volume_change_ratio'] = df['volume_change'] / df['volume'].shift(1)
    
    # Analyze the relationship between volume and price
    df['volume_to_range_ratio'] = df['volume'] / df['daily_range']
    df['volume_to_abs_return_ratio'] = df['volume'] / df['daily_return'].abs()
    
    # Calculate simple moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_5_20_diff'] = df['SMA_5'] - df['SMA_20']
    
    # Analyze moving average crossovers
    df['crossover_signal'] = (df['SMA_5'] > df['SMA_20']).astype(int) - (df['SMA_5'] < df['SMA_20']).astype(int)
    df['close_to_SMA_20_diff'] = df['close'] - df['SMA_20']
    
    # Calculate rate of change
    df['ROC_5'] = (df['close'] / df['close'].shift(5)) - 1
    df['ROC_10'] = (df['close'] / df['close'].shift(10)) - 1
    df['ROC_5_10_diff'] = df['ROC_5'] - df['ROC_10']
    
    # Analyze directional movement
    df['up_days'] = (df['close'] > df['close'].shift(1)).rolling(window=10).sum()
    df['down_days'] = (df['close'] < df['close'].shift(1)).rolling(window=10).sum()
    df['net_directional_movement'] = df['up_days'] - df['down_days']
    
    # Calculate relative strength against a benchmark
    # Assuming 'benchmark' is a column in the DataFrame
    df['return_benchmark'] = df['benchmark'] / df['benchmark'].shift(1) - 1
    df['relative_strength'] = df['daily_return'] / df['return_benchmark']
    
    # Analyze the consistency of outperformance
    df['outperformance'] = (df['daily_return'] > df['return_benchmark']).astype(int)
    df['outperformance_ratio'] = df['outperformance'].rolling(window=10).sum() / 10
    
    # Return the final factor
    return df['SMA_5_20_diff']

# Example usage:
# df = pd.read_csv('stock_data.csv')
# df.set_index('date', inplace=True)
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
