```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the price change from open to close (Intraday Movement)
    df['price_change'] = df['close'] - df['open']
    
    # Calculate the range (High - Low) as a measure of daily volatility
    df['range'] = df['high'] - df['low']
    
    # Calculate True Range
    df['tr1'] = df['high'] - df['low']
    df['tr2'] = (df['high'] - df['close'].shift(1)).abs()
    df['tr3'] = (df['low'] - df['close'].shift(1)).abs()
    df['true_range'] = df[['tr1', 'tr2', 'tr3']].max(axis=1)
    
    # Calculate 10-day and 20-day ATR
    df['atr_10'] = df['true_range'].rolling(window=10).mean()
    df['atr_20'] = df['true_range'].rolling(window=20).mean()
    
    # Calculate the Volume to Price Ratio
    df['vpr'] = df['volume'] / df['price_change']
    
    # Calculate the volume change
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Calculate 5-day and 10-day moving sum of volume change
    df['volume_change_5'] = df['volume_change'].rolling(window=5).sum()
    df['volume_change_10'] = df['volume_change'].rolling(window=10).sum()
    
    # Calculate the Daily VWAP
    total_volume = df['volume'].sum()
    df['vwap'] = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3) / total_volume
    
    # Calculate the Amount to Price Ratio
    df['ap_ratio'] = df['amount'] / df['close']
    
    # Calculate the percentage change in closing price over 5 days
    df['close_pct_change_5'] = df['close'].pct_change(periods=5)
    
    # Calculate the 14-day and 7-day RSI
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    
    rs = avg_gain / avg_loss
    df['rsi_14'] = 100 - (100 / (1 + rs))
    
    avg_gain_7 = gain.rolling(window=7).mean()
    avg_loss_7 = loss.rolling(window=7).mean()
    
    rs_7 = avg_gain_7 / avg_loss_7
    df['rsi_7'] = 100 - (100 / (1 + rs_7))
    
    # Calculate the 10-day and 50-day moving average of the closing price
    df['ma_10'] = df['close'].rolling(window=10).mean()
    df['ma_50'] = df['close'].rolling(window=50).mean()
    
    # Determine the difference between the short-term and long-term moving averages (Trend Factor)
    df['trend_factor'] = df['ma_10'] - df['ma_50']
    
    # Composite alpha factor: weighted sum of selected individual factors
    df['composite_alpha'] = 0.5 * df['price_change'].rolling(window=20).mean() + \
                            0.3 * df['atr_10'] + \
                            0.2 * df['rsi_14']
    
    return df['composite_alpha']
```
