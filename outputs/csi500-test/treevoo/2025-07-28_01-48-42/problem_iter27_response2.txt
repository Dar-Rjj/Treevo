```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Define a factor for daily log return
    df['log_return'] = np.log(df['close'] / df['open'])
    
    # Compute the 5-day moving average of the daily return
    df['ma_5_daily_return'] = df['daily_return'].rolling(window=5).mean()
    
    # Calculate the difference between the current day's return and its 5-day moving average
    df['return_vs_ma_5'] = df['daily_return'] - df['ma_5_daily_return']
    
    # Compute the standard deviation of the past 10 days' daily returns to measure recent volatility
    df['volatility_10'] = df['daily_return'].rolling(window=10).std()
    
    # Create a factor as the ratio of todayâ€™s volume over the average volume of the last 10 days, multiplied by the daily return
    df['volume_ratio_10'] = df['volume'] / df['volume'].rolling(window=10).mean()
    df['volume_impact_factor'] = df['volume_ratio_10'] * df['daily_return']
    
    # Compute the percentage range as (high - low) / close
    df['percentage_range'] = (df['high'] - df['low']) / df['close']
    
    # Combine the percentage range with the daily return to form a new factor
    df['range_return_factor'] = df['percentage_range'] * df['daily_return']
    
    # Identify days where the volume is above the 90th percentile of the past 30 days
    vol_90th_percentile = df['volume'].rolling(window=30).quantile(0.9)
    df['high_volume_flag'] = (df['volume'] > vol_90th_percentile).astype(int)
    
    # Determine if there is a gap up or down (open - previous close)
    df['gap'] = df['open'] - df['close'].shift(1)
    df['gap_magnitude'] = df['gap'] / df['close'].shift(1)
    
    # Create a factor based on the magnitude and direction of these gaps, combined with the next day's return
    df['gap_factor'] = df['gap_magnitude'] * df['daily_return'].shift(-1)
    
    # Final alpha factor: combination of all the sub-factors
    df['alpha_factor'] = (
        df['log_return'] +
        df['return_vs_ma_5'] +
        df['volatility_10'] +
        df['volume_impact_factor'] +
        df['range_return_factor'] +
        df['high_volume_flag'] +
        df['gap_factor']
    )
    
    return df['alpha_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
