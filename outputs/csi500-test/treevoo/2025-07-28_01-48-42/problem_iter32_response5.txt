```python
def heuristics_v2(df):
    """
    Generate an alpha factor based on the given market data.
    
    Parameters:
        df (pd.DataFrame): DataFrame with columns ['open', 'high', 'low', 'close', 'amount', 'volume']
                           and indexed by date.
                           
    Returns:
        pd.Series: The generated alpha factor indexed by date.
    """
    
    # Calculate the average of open and close prices
    avg_price = (df['open'] + df['close']) / 2
    
    # Calculate the money flow by multiplying the average price with volume
    money_flow = avg_price * df['volume']
    
    # Calculate the momentum by looking at the difference in money flow over a 10-day period
    momentum = money_flow - money_flow.shift(10)
    
    # Calculate the volatility as the standard deviation of the log returns over a 10-day window
    log_returns = np.log(df['close'] / df['close'].shift(1))
    volatility = log_returns.rolling(window=10).std()
    
    # The final alpha factor is the ratio of momentum to volatility
    alpha_factor = momentum / volatility
    
    return alpha_factor
```
