```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 5-day and 20-day simple moving average of close price
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    # Momentum indicator as SMA_5 / SMA_20
    df['Momentum'] = df['SMA_5'] / df['SMA_20']
    
    # Volume momentum
    df['SumVol_5'] = df['volume'].rolling(window=5).sum()
    df['SumVol_20'] = df['volume'].rolling(window=20).sum()
    df['Volume_Momentum'] = df['SumVol_5'] / df['SumVol_20']
    
    # Daily return
    df['Daily_Return'] = (df['close'] - df['open']) / df['open']
    df['Ret_Mean_5'] = df['Daily_Return'].rolling(window=5).mean()
    df['Ret_STD_20'] = df['Daily_Return'].rolling(window=20).std()
    
    # True range and ATR
    df['True_Range'] = df[['high', 'low']].apply(lambda x: max(x['high'] - x['low'], 
                                                               abs(x['high'] - df['close'].shift(1)), 
                                                               abs(x['low'] - df['close'].shift(1))), axis=1)
    df['ATR_14'] = df['True_Range'].rolling(window=14).mean()
    df['Relative_Volatility'] = df['ATR_14'] / df['close']
    
    # Amount momentum
    df['SumAmt_5'] = df['amount'].rolling(window=5).sum()
    df['SumAmt_20'] = df['amount'].rolling(window=20).sum()
    df['Amount_Momentum'] = df['SumAmt_5'] / df['SumAmt_20']
    
    # High-Low Range
    df['High_Low_Range'] = df['high'] - df['low']
    df['HL_Range_Momentum'] = df['High_Low_Range'].diff().rolling(window=10).sum()
    df['Avg_Vol_5'] = df['volume'].rolling(window=5).mean()
    df['Scaled_HL_Momentum'] = df['HL_Range_Momentum'] / df['Avg_Vol_5']
    df['Smoothed_Adjusted_Momentum'] = df['Scaled_HL_Momentum'].ewm(span=20, adjust=False).mean()
    
    # Logarithmic daily returns
    df['Log_Returns'] = np.log(df['close'] / df['close'].shift(1))
    
    # Momentum component
    df['EMA_21_Ret'] = df['Log_Returns'].ewm(span=21, adjust=False).mean()
    df['EMA_63_Ret'] = df['Log_Returns'].ewm(span=63, adjust=False).mean()
    df['Final_Momentum'] = df['EMA_21_Ret'] - df['EMA_63_Ret']
    
    # Volatility component
    df['Abs_Log_Returns'] = abs(df['Log_Returns'])
    df['EMA_21_Abs_Ret'] = df['Abs_Log_Returns'].ewm(span=21, adjust=False).mean()
    df['EMA_63_Abs_Ret'] = df['Abs_Log_Returns'].ewm(span=63, adjust=False).mean()
    df['Final_Volatility'] = df['EMA_21_Abs_Ret'] - df['EMA_63_Abs_Ret']
    
    # Volume component
    df['Log_Volume_Changes'] = np.log(df['volume'] / df['volume'].shift(1))
    df['EMA_21_Vol_Chg'] = df['Log_Volume_Changes'].ewm(span=21, adjust=False).mean()
    df['EMA_63_Vol_Chg'] = df['Log_Volume_Changes'].ewm(span=63, adjust=False).mean()
    df['Final_Volume_Momentum'] = df['EMA_21_Vol_Chg'] - df['EMA_63_Vol_Chg']
    
    # Open-Close Spread
    df['Open_Close_Spread'] = df['close'] - df['open']
    df['EMA_21_Open_Close_Spread'] = df['Open_Close_Spread'].ewm(span=21, adjust=False).mean()
    
    # Final Alpha
