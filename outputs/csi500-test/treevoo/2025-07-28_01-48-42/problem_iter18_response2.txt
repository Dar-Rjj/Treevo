```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 5-day and 20-day simple moving averages of close price
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['Momentum_Price'] = df['SMA_5'] / df['SMA_20']
    
    # Calculate 5-day and 20-day moving sum of volumes
    df['SumVol_5'] = df['volume'].rolling(window=5).sum()
    df['SumVol_20'] = df['volume'].rolling(window=20).sum()
    df['Momentum_Volume'] = df['SumVol_5'] / df['SumVol_20']

    # Daily return calculation
    df['Daily_Return'] = (df['close'] - df['open']) / df['open']
    df['Ret_Mean_5'] = df['Daily_Return'].rolling(window=5).mean()
    df['Ret_STD_20'] = df['Daily_Return'].rolling(window=20).std()

    # True range and ATR
    df['Prev_Close'] = df['close'].shift(1)
    df['True_Range'] = df[['high', 'low', 'Prev_Close']].apply(
        lambda x: max(x['high']-x['low'], abs(x['high']-x['Prev_Close']), abs(x['low']-x['Prev_Close'])), axis=1)
    df['ATR_14'] = df['True_Range'].rolling(window=14).mean()
    df['Rel_Volatility'] = df['ATR_14'] / df['close']

    # Moving sum of amount
    df['SumAmt_5'] = df['amount'].rolling(window=5).sum()
    df['SumAmt_20'] = df['amount'].rolling(window=20).sum()
    df['Momentum_Amount'] = df['SumAmt_5'] / df['SumAmt_20']

    # Composite score
    df['Composite_Score'] = (
        0.3 * df['Momentum_Price'] + 
        0.2 * df['Momentum_Volume'] +
        0.1 * df['Ret_Mean_5'] -
        0.1 * df['Ret_STD_20'] +
        0.2 * df['Rel_Volatility'] +
        0.1 * df['Momentum_Amount']
    )

    return df['Composite_Score'].dropna()
```
