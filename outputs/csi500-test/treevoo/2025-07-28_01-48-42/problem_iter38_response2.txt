```python
import pandas as pd
import numpy as np
from scipy.stats import linregress

def heuristics_v2(df):
    # Momentum Indicators
    def sma(series, window):
        return series.rolling(window=window).mean()
    
    def ema(series, window):
        return series.ewm(span=window, adjust=False).mean()
    
    def roc(series, window):
        return series.pct_change(periods=window)
    
    def momentum_slope(series, window):
        slope = lambda x: linregress(range(len(x)), x)[0]
        return series.rolling(window=window).apply(slope, raw=True)
    
    sma_close_10 = sma(df['close'], 10)
    sma_close_50 = sma(df['close'], 50)
    sma_ratio = sma_close_10 / sma_close_50
    
    ema_close_10 = ema(df['close'], 10)
    ema_close_50 = ema(df['close'], 50)
    ema_ratio = ema_close_10 / ema_close_50
    
    roc_close_10 = roc(df['close'], 10)
    roc_high_10 = roc(df['high'], 10)
    roc_low_10 = roc(df['low'], 10)
    
    mom_slope = momentum_slope(df['close'], 10)
    
    # Trend Indicators
    macd_line = ema(df['close'], 12) - ema(df['close'], 26)
    signal_line = ema(macd_line, 9)
    macd_histogram = macd_line - signal_line
    
    pos_di = df['high'].rolling(14).apply(lambda x: (x[-1] - x[:-1].max()).abs())
    neg_di = df['low'].rolling(14).apply(lambda x: (x[:-1].min() - x[-1]).abs())
    pos_di = pos_di.ewm(span=14, adjust=False).mean()
    neg_di = neg_di.ewm(span=14, adjust=False).mean()
    dx = 100 * (pos_di - neg_di).abs() / (pos_di + neg_di)
    adx = dx.ewm(span=14, adjust=False).mean()
    
    trend_strength = adx + macd_histogram
    
    # Volatility Indicators
    tr = df[['high', 'low', 'close']].diff().abs().shift(-1).max(axis=1)
    atr = tr.ewm(span=14, adjust=False).mean()
    
    bb_middle = sma(df['close'], 20)
    bb_upper = bb_middle + 2 * df['close'].rolling(20).std()
    bb_lower = bb_middle - 2 * df['close'].rolling(20).std()
    
    volatility_ratio = (bb_upper - bb_lower) / atr
    
    # Volume-based Indicators
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume']
    obv = obv.cumsum()
    
    cmf = (((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']).rolling(20).sum() / df['volume'].rolling(20).sum()
    
    volume_pressure = (cmf * obv) / (df['volume'] * obv.rolling(20).mean())
    
    # Composite Indicators
    cmi = (sma_ratio + ema_ratio + roc_close_10 + mom_slope) / 4
    cti = (macd_histogram + adx + dx + trend_strength) / 4
    cvi = (atr + (bb_upper - bb_lower) + volatility_ratio) / 3
    cvoi = (obv + cmf + volume_pressure) / 3
    
    # Final Alpha Factor
    final_alpha_factor = (cmi + cti + cvi + cvoi) / 4
    return final_alpha_factor
```
