```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the ratio of high to low prices
    high_low_ratio = df['high'] / df['low']
    
    # Compute the (high - low) / open as a measure of intraday volatility
    intraday_volatility = (df['high'] - df['low']) / df['open']
    
    # Use (close - open) / (high - low) as an indicator of trend strength
    trend_strength = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Calculate the ratio of current day's volume to the average volume over the past 10 days
    avg_volume_10 = df['volume'].rolling(window=10).mean()
    volume_ratio = df['volume'] / avg_volume_10
    
    # When a high volume day occurs, use (close - open) * (volume / avg_volume) to emphasize significant price movements
    high_volume_day_factor = (df['close'] - df['open']) * (volume_ratio.where(volume_ratio > 1, 0))
    
    # Use the product of the daily return and the relative volume as an indicator of price movement intensity
    daily_return = df['close'].pct_change()
    price_movement_intensity = daily_return * volume_ratio
    
    # Consider the difference between the current close and the moving average of closes over the last 20 days
    moving_avg_20 = df['close'].rolling(window=20).mean()
    momentum_factor = df['close'] - moving_avg_20
    
    # Introduce a factor that calculates the sum of positive and negative returns over the last 50 days separately
    returns_50 = daily_return.rolling(window=50)
    sum_positive_returns = returns_50.apply(lambda x: x[x > 0].sum(), raw=True)
    sum_negative_returns = returns_50.apply(lambda x: x[x < 0].sum(), raw=True)
    bullishness_factor = sum_positive_returns / sum_negative_returns.abs()
    
    # Count the number of consecutive days where the close was higher than the open
    consecutive_up_days = (df['close'] > df['open']).astype(int).groupby((df['close'] <= df['open']).cumsum()).cumsum()
    uptrend_signal = (consecutive_up_days > 3).astype(int)
    
    # Similarly, count the number of consecutive days where the close was lower than the open
    consecutive_down_days = (df['close'] < df['open']).astype(int).groupby((df['close'] >= df['open']).cumsum()).cumsum()
    downtrend_signal = (consecutive_down_days > 3).astype(int)
    
    # Identify if today's open is significantly different from yesterday's close
    gap_up = (df['open'] > df['close'].shift(1)).astype(int)
    gap_down = (df['open'] < df['close'].shift(1)).astype(int)
    gap_size = abs(df['open'] - df['close'].shift(1))
    
    # Examine whether high volume days are associated with large price changes
    price_change = df['close'].pct_change()
    price_volume_correlation = price_change.rolling(window=10).corr(df['volume'].pct_change())
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        0.2 * high_low_ratio + 
        0.2 * intraday_volatility + 
        0.2 * trend_strength + 
        0.1 * high_volume_day_factor + 
        0.1 * price_movement_intensity + 
        0.1 * momentum_factor + 
        0.1 * bullishness_factor + 
        0.05 * uptrend_signal + 
        0.05 * downtrend_signal + 
        0.05 * gap_size * (gap_up + gap_down) +
        0.05 * price_volume_correlation
    )
    
    return alpha_factor
```
