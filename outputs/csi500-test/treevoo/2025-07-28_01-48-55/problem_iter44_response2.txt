```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Return
    df['daily_return'] = df['close'].pct_change()
    
    # Compute 5-day and 20-day moving averages of daily returns
    df['5d_return_ma'] = df['daily_return'].rolling(window=5).mean()
    df['20d_return_ma'] = df['daily_return'].rolling(window=20).mean()
    
    # Calculate Exponential Moving Average (EMA) with smoothing factor of 0.2
    df['ema_15'] = df['close'].ewm(span=15, adjust=False).mean()
    
    # Calculate Simple Moving Averages (SMA)
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_30'] = df['close'].rolling(window=30).mean()
    
    # Identify Crossover of 5-day and 30-day SMAs
    df['crossover_signal'] = np.where(df['sma_5'] > df['sma_30'], 1, -1)
    
    # Integrate EMAs into momentum calculations
    df['price_momentum'] = df['close'] - df['ema_15']
    df['integrated_momentum'] = df['price_momentum'] + df['20d_return_ma']
    
    # Intraday range and previous day's close ratio
    df['intraday_range_ratio'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Upper and lower shadow lengths
    df['upper_shadow'] = df['high'] - df[['open', 'close']].max(axis=1)
    df['lower_shadow'] = df[['open', 'close']].min(axis=1) - df['low']
    df['shadow_ratio'] = df['upper_shadow'] / df['lower_shadow']
    
    # 10-day Historical Volatility
    df['log_return'] = np.log(df['close']).diff()
    df['10d_volatility'] = df['log_return'].rolling(window=10).std() * np.sqrt(252)
    
    # True Range and Average True Range (ATR)
    df['true_range'] = df[['high', 'low', 'close']].apply(
        lambda x: max(x['high'] - x['low'], abs(x['high'] - x['close'].shift(1)), abs(x['low'] - x['close'].shift(1))), axis=1)
    df['atr_10'] = df['true_range'].rolling(window=10).mean()
    
    # Volume-Adjusted True Range
    df['volume_adjusted_tr'] = df['true_range'] * np.log(df['volume'])
    
    # Change in volume from the previous day
    df['volume_change'] = df['volume'].diff()
    
    # Ratio of volume to the 20-day moving average of volume
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Integrated log return with volume change
    df['integrated_log_return'] = (df['log_return'] * df['volume_change']).rolling(window=10).sum()
    
    # Enhanced Volume Thrust
    df['upward_thrust'] = np.where(df['close'] > df['open'], df['volume'] * (df['close'] - df['open']), 0)
    df['downward_thrust'] = np.where(df['close'] <= df['open'], df['volume'] * (df['open'] - df['close']), 0)
    df['enhanced_volume_thrust'] = df['upward_thrust'] - df['downward_thrust'] + (df['high'] - df['low']) / df['open']
    
    # 7-day average volume baseline
    df['7d_avg_volume'] = df['volume'].rolling(window=7).mean()
    
    # Flag days when volume exceeds the 7-day average by 20%
    df['volume_spike_flag'] = np.where(df['volume'] > df['7d_avg_volume'] * 1.2, 1, 0)
    
    # Measure Volume Spikes
    df['volume_change_pct'] = df['volume'].pct_change()
    df['volume_spike'] = np.where(df['volume_change_pct'] > 0.4, 1, 0)
    
    # Construct Final Composite Alpha Factor
    df['alpha_factor'] = (
        df['price_momentum'] +
        df['integrated_momentum'] -
        df['volume_adjusted_tr'] -
        (df['
