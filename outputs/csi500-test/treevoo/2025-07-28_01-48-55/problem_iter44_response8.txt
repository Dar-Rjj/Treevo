```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate simple price movements
    df['Daily_Return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['5D_MA_Daily_Return'] = df['Daily_Return'].rolling(window=5).mean()
    df['20D_MA_Daily_Return'] = df['Daily_Return'].rolling(window=20).mean()
    df['Intraday_Return'] = (df['high'] - df['low']) / df['open']
    
    # Examine trading activity
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Amount_Change'] = df['amount'] - df['amount'].shift(1)
    
    # Analyze price patterns
    df['Price_Range'] = df['high'] - df['low']
    df['Price_to_Open_Ratio'] = (df['close'] - df['open']) / df['open']
    
    # Investigate momentum
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_Momentum'] = (df['SMA_20'] - df['SMA_20'].shift(1)) / df['SMA_20'].shift(1)
    df['Relative_Strength'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['Price_Momentum'] = df['close'] - df['EMA_10']
    df['WMA_15'] = df['close'].rolling(window=15).apply(lambda x: np.dot(x, np.arange(1, 16)) / 120.0, raw=True)
    df['Integrated_Momentum'] = df['close'] - df['WMA_15'] + df['20D_MA_Daily_Return']
    
    # Incorporate volatility
    df['Historical_Volatility'] = df['close'].pct_change().rolling(window=10).std() * np.sqrt(252)
    
    # Consider volume-weighted indicators
    df['VWAP'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    df['Volume_Adjusted_Return'] = (df['close'] - df['close'].shift(1)) * df['volume'] / df['volume'].shift(1)
    df['Volume_to_Average_Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    df['Daily_Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    df['Log_Return_with_Volume_Change'] = df['Daily_Log_Return'] * df['Volume_Change']
    df['Accumulated_Log_Return_with_Volume_Change'] = df['Log_Return_with_Volume_Change'].rolling(window=10).sum()
    
    # Enhanced Volume Thrust
    df['Upward_Thrust'] = np.where(df['close'] > df['open'], df['volume'] * (df['close'] - df['open']), 0)
    df['Downward_Thrust'] = np.where(df['close'] <= df['open'], df['volume'] * (df['open'] - df['close']), 0)
    df['Enhanced_Volume_Thrust'] = df['Upward_Thrust'] - df['Downward_Thrust']
    
    # Explore trend-following strategies
    df['5D_EMA'] = df['close'].ewm(span=5, adjust=False).mean()
    df['20D_EMA'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Crossover_Signal'] = np.where(df['5D_EMA'] > df['20D_EMA'], 1, -1)
    df['Crossover_Signal'] *= df['Integrated_Momentum'].abs()
    
    # Combine multiple factors
    df['Composite_Factor'] = (df['Daily_Return'] + df['Intraday_Return'] + df['SMA_Momentum']) / 3
    
    # Construct Final Composite Alpha Factor
    df['Final_Alpha_Factor'] = (
        df['Price_Momentum'] +
        df['Integrated_Momentum'] -
        (df['high'] - df['low']) * df['Volume_Change'] -
        (df['close'] - df['open']) * df['Volume_Change
