```python
import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages (SMA) of closing prices over different periods
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Momentum factor: difference between today's close and SMA of past n days
    df['Momentum_5'] = df['close'] - df['SMA_5']
    df['Momentum_20'] = df['close'] - df['SMA_20']

    # Volume shock factor: deviation from the mean volume
    df['Mean_Volume'] = df['volume'].rolling(window=20).mean()
    df['Volume_Shock'] = (df['volume'] - df['Mean_Volume']) / df['Mean_Volume']

    # Volume trend factor: direction and stability of volume trends
    df['Volume_Trend'] = df['volume'].pct_change()

    # Daily price range: high - low
    df['Daily_Range'] = df['high'] - df['low']
    df['Avg_Daily_Range'] = df['Daily_Range'].rolling(window=20).mean()

    # Breakout indicator: if current high/low is significantly beyond recent highs/lows
    df['Max_High_20'] = df['high'].rolling(window=20).max()
    df['Min_Low_20'] = df['low'].rolling(window=20).min()
    df['Breakout_Up'] = (df['high'] > df['Max_High_20']).astype(int)
    df['Breakout_Down'] = (df['low'] < df['Min_Low_20']).astype(int)

    # Open-Close ratio: directional bias
    df['Open_Close_Ratio'] = df['open'] / df['close']

    # Bullish/Bearish candlestick count
    df['Bullish_Candle'] = (df['close'] > df['open']).astype(int)
    df['Bearish_Candle'] = (df['close'] < df['open']).astype(int)

    # Liquidity measure: total amount traded
    df['Liquidity'] = df['amount']

    # Amount-weighted price movement
    df['Price_Change'] = df['close'] - df['open']
    df['Amount_Weighted_Price_Movement'] = (df['Price_Change'] * df['amount']).cumsum() / df['amount'].cumsum()

    # Composite score: sum of all individual factors, weighted based on historical predictive power
    weights = {
        'Momentum_5': 1.0,
        'Momentum_20': 1.0,
        'Volume_Shock': 1.0,
        'Volume_Trend': 1.0,
        'Avg_Daily_Range': 1.0,
        'Breakout_Up': 1.0,
        'Breakout_Down': 1.0,
        'Open_Close_Ratio': 1.0,
        'Bullish_Candle': 1.0,
        'Bearish_Candle': 1.0,
        'Liquidity': 1.0,
        'Amount_Weighted_Price_Movement': 1.0
    }
    df['Composite_Score'] = (df[list(weights.keys())] * pd.Series(weights)).sum(axis=1)

    # Interday patterns: intraday reversal and opening gap impact
    df['Intraday_Reversal'] = (df['high'] + df['low']) / 2 - df['close']
    df['Opening_Gap'] = df['open'] - df['close'].shift(1)

    # Return the composite score as the alpha factor
    return df['Composite_Score']
```
