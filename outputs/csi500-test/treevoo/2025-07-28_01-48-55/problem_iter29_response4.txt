```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Compute 5-day and 20-day moving averages of daily returns
    df['5d_mom'] = df['daily_return'].rolling(window=5).mean()
    df['20d_mom'] = df['daily_return'].rolling(window=20).mean()
    
    # Calculate Exponential Moving Average (EMA) over a 15-day window
    df['ema_15'] = df['close'].ewm(span=15, adjust=False).mean()
    
    # Determine the intraday range
    df['intraday_range'] = df['high'] - df['low']
    df['range_ratio'] = df['intraday_range'] / df['close'].shift(1)
    df['high_low_range'] = df['high'] - df['low']
    
    # Integrate with Integrated Momentum
    df['integrated_momentum'] = df['high_low_range'] * df['20d_mom']
    
    # Measure the upper and lower shadow lengths
    df['upper_shadow'] = df['high'] - df[['open', 'close']].max(axis=1)
    df['lower_shadow'] = df[['open', 'close']].min(axis=1) - df['low']
    df['shadow_ratio'] = df['upper_shadow'] / df['lower_shadow'].replace(0, 1)  # avoid division by zero
    
    # Assess the change in volume from the previous day
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Compute the ratio of volume to the 20-day moving average of volume
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    df['relative_volume'] = df['volume'] / df['avg_vol_20d']
    
    # Create a composite factor
    df['composite_factor'] = 0.6 * df['20d_mom'] + 0.4 * df['relative_volume']
    
    # Calculate Price Momentum
    df['price_momentum'] = df['close'] - df['ema_15']
    
    # Integrate Log Return with Volume Change
    df['log_return'] = (df['close'] / df['close'].shift(1)).apply(np.log)
    df['vol_adj_log_return'] = df['log_return'] * (df['volume_change'] ** 0.5)
    df['acc_vol_adj_log_return'] = df['vol_adj_log_return'].rolling(window=14).sum()
    
    # Enhance with Moving Average Crossover
    df['ema_7'] = df['close'].ewm(span=7, adjust=False).mean()
    df['ema_28'] = df['close'].ewm(span=28, adjust=False).mean()
    df['crossover_signal'] = 0
    df.loc[df['ema_7'] > df['ema_28'], 'crossover_signal'] = 1
    df.loc[df['ema_7'] < df['ema_28'], 'crossover_signal'] = -1
    
    # Incorporate Enhanced Volume Thrust
    df['upward_thrust'] = 0
    df['downward_thrust'] = 0
    df.loc[df['close'] > df['open'], 'upward_thrust'] = df['volume'] * (df['close'] - df['open'])
    df.loc[df['close'] <= df['open'], 'downward_thrust'] = df['volume'] * (df['open'] - df['close'])
    df['enhanced_volume_thrust'] = (df['upward_thrust'] - df['downward_thrust']) + (df['high'] - df['low']) / df['close']
    
    # Final Integration
    df['final_factor'] = df['integrated_momentum'] + df['intraday_range'] + df['enhanced_volume_thrust']
    df['final_factor'] += df['crossover_signal']
    df['final_factor'] += df['price_momentum']
    df['final_factor'] -= df['high_low_range'] * df['relative_volume']
    df['final_factor'] += df['acc_vol_adj_log_return']
    
    return df['final_factor']
```
