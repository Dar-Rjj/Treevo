```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate simple moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Relative Strength Index (RSI)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Momentum factor
    df['Momentum'] = df['close'] - df['SMA_20']
    
    # Volume shock factor
    df['Volume_Shock'] = (df['volume'] - df['volume'].rolling(window=20).mean()) / df['volume'].rolling(window=20).std()
    
    # Volume trend
    df['Volume_Trend'] = df['volume'].pct_change().rolling(window=20).mean()
    
    # Daily price range and its moving average
    df['Daily_Range'] = df['high'] - df['low']
    df['Avg_Daily_Range'] = df['Daily_Range'].rolling(window=20).mean()
    
    # Breakout indicator
    df['Breakout'] = (df['high'] > df['high'].rolling(window=20).max()).astype(int) - (df['low'] < df['low'].rolling(window=20).min()).astype(int)
    
    # Open-close ratio
    df['Open_Close_Ratio'] = df['open'] / df['close']
    
    # Bullish/bearish candlestick factor
    df['Bullish_Candle'] = (df['close'] > df['open']).astype(int)
    df['Bearish_Candle'] = (df['close'] < df['open']).astype(int)
    df['Bullish_Count'] = df['Bullish_Candle'].rolling(window=10).sum()
    df['Bearish_Count'] = df['Bearish_Candle'].rolling(window=10).sum()
    
    # Liquidity measure
    df['Liquidity'] = df['amount'].rolling(window=20).mean()
    
    # Amount-weighted price movement
    amount_weighted_change = (df['close'].diff() * df['amount']).rolling(window=20).sum() / df['amount'].rolling(window=20).sum()
    df['Amount_Weighted_Change'] = amount_weighted_change
    
    # Composite score
    df['Composite_Score'] = df[['Momentum', 'Volume_Shock', 'Volume_Trend', 'Avg_Daily_Range', 'Breakout', 'Open_Close_Ratio', 'Bullish_Count', 'Bearish_Count', 'Liquidity', 'Amount_Weighted_Change']].mean(axis=1)
    
    # Intraday reversal and opening gap
    df['Intraday_Reversal'] = (df['close'].shift(1) - df['close']) - (df['open'] - df['open'].shift(1))
    df['Opening_Gap'] = (df['open'] - df['close'].shift(1))

    return df['Composite_Score'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv')
# df.set_index('date', inplace=True)
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
