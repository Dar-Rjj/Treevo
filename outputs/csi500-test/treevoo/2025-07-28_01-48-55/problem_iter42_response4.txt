```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate intraday return
    df['intraday_return'] = (df['high'] - df['low']) / df['open']
    
    # Calculate volume change
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate amount change
    df['amount_change'] = df['amount'] - df['amount'].shift(1)
    
    # Calculate price range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate price-to-open ratio
    df['price_to_open_ratio'] = (df['close'] - df['open']) / df['open']
    
    # Calculate moving average difference
    n = 5
    df['sma_close_n'] = df['close'].rolling(window=n).mean()
    df['sma_close_diff'] = (df['sma_close_n'] - df['sma_close_n'].shift(1)) / df['sma_close_n'].shift(1)
    
    # Calculate relative strength
    df['relative_strength'] = (df['close'] - df['close'].shift(n)) / df['close'].shift(n)
    
    # Calculate volatility
    df['volatility'] = df['daily_return'].rolling(window=n).std()
    
    # Calculate VWAP
    vwap_window = 10
    df['vwap'] = (df['close'].rolling(window=vwap_window).sum() * df['volume'].rolling(window=vwap_window).sum()) / df['volume'].rolling(window=vwap_window).sum()
    
    # Calculate volume-adjusted return
    df['volume_adjusted_return'] = (df['close'] - df['close'].shift(1)) * df['volume'] / df['volume'].shift(1)
    
    # Calculate moving average crossover
    n, m = 5, 10
    df['sma_close_n'] = df['close'].rolling(window=n).mean()
    df['sma_close_m'] = df['close'].rolling(window=m).mean()
    df['sma_crossover'] = (df['sma_close_n'] > df['sma_close_m']).astype(int) - (df['sma_close_n'] < df['sma_close_m']).astype(int)
    
    # Calculate EMA slope
    ema_n = 5
    df['ema_close_n'] = df['close'].ewm(span=ema_n, adjust=False).mean()
    df['ema_slope'] = (df['ema_close_n'] - df['ema_close_n'].shift(1)) / df['ema_close_n'].shift(1)
    
    # Composite factor
    df['composite_factor'] = (df['daily_return'] + df['intraday_return'] + df['relative_strength']) / 3
    
    # Return the composite factor
    return df['composite_factor']
```
