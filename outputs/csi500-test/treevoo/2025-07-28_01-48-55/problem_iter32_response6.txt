```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Adjusted Price Momentum
    df['Median_Close'] = df['close'].rolling(window=20, min_periods=1).median()
    df['Sum_Volume'] = df['volume'].rolling(window=20, min_periods=1).sum()
    df['Adjusted_Price_Momentum'] = (df['close'] - df['Median_Close']) * (df['Sum_Volume'] / 20) / df['volume']
    
    # Intraday Reversal
    df['Intraday_Reversal'] = (df['high'] - df['low']) - (df['open'] - df['close'])
    
    # Measure Daily Volume Change
    df['Daily_Volume_Change'] = (df['volume'] / df['volume'].shift(1)) - 1
    
    # Volume Momentum
    df['Volume_Momentum'] = df['volume'] - df['volume'].shift(1)
    
    # Combine Adjusted Momentum, Intraday Reversal, and Volume Changes
    df['Intermediate_Factor'] = 1.5 * df['Adjusted_Price_Momentum'] + \
                                df['Intraday_Reversal'] * (df['Daily_Volume_Change'] + df['Volume_Momentum'])
    
    # Calculate Exponential Moving Average (EMA)
    ema_window = 10
    smoothing_factor = 2 / (ema_window + 1)
    df['EMA'] = df['close'].ewm(alpha=smoothing_factor, adjust=False).mean()
    
    # Calculate Weighted Moving Average (WMA)
    weights = list(range(1, ema_window + 1))
    weights_sum = sum(weights)
    df['WMA'] = df['close'].rolling(window=ema_window, min_periods=1).apply(lambda x: sum(x[-i] * i for i in range(1, len(x) + 1)) / weights_sum, raw=True)
    
    # Calculate Price Momentum
    df['Price_Momentum'] = df['close'] - df['EMA']
    
    # Calculate Additional Price Momentum
    df['Additional_Price_Momentum'] = df['close'] - df['WMA']
    
    # Volume Adjusted Spread
    df['Spread'] = df['high'] - df['low']
    df['Avg_Volume_20D'] = df['volume'].rolling(window=20, min_periods=1).mean()
    df['Relative_Volume'] = df['volume'] / df['Avg_Volume_20D']
    df['Volume_Adjusted_Spread'] = df['Spread'] * (df['Relative_Volume'] ** 0.5)
    
    # Volume Adjusted High-Low Range
    df['High_Low_Range'] = df['high'] - df['low']
    df['Volume_Adjusted_High_Low_Range'] = df['High_Low_Range'] * (pd.np.log(df['volume']) ** 0.5)
    
    # Composite Factor
    df['Composite_Factor'] = df['Intraday_Reversal'] * (df['Daily_Volume_Change'] + df['Volume_Momentum']) + \
                             (df['close'] - df['close'].shift(1))
    
    # Enhanced Momentum Factor
    enhanced_momentum_weights = [i / (ema_window + 1) for i in range(1, ema_window + 1)]
    df['Enhanced_Momentum_Factor'] = df['Volume_Adjusted_High_Low_Range'].rolling(window=5, min_periods=1).apply(lambda x: sum(x[-i] * enhanced_momentum_weights[i-1] for i in range(1, len(x) + 1)), raw=True)
    
    # Final Alpha Factor
    df['Final_Alpha_Factor'] = df['Composite_Factor'] + df['Adjusted_Price_Momentum'] + df['Price_Momentum'] + df['Additional_Price_Momentum'] - df['Volume_Adjusted_Spread'] + df['Enhanced_Momentum_Factor']
    
    return df['Final_Alpha_Factor']
```
