```python
def heuristics_v2(df, N=10, M=30):
    # Calculate the percentage change in closing price from day t-1 to day t
    df['price_change'] = df['close'].pct_change()
    
    # Assign value of 1 if the percentage change is positive, -1 if negative
    df['price_direction'] = df['price_change'].apply(lambda x: 1 if x > 0 else -1)
    
    # Multiply the assigned value by the volume at day t
    df['price_volume_indicator'] = df['price_direction'] * df['volume']
    
    # Calculate a moving average of the price-volume indicator over the past N days
    df[f'N_{N}_ma'] = df['price_volume_indicator'].rolling(window=N).mean()
    
    # Calculate a long-term moving average of the price-volume indicator over the past M days
    df[f'M_{M}_ma'] = df['price_volume_indicator'].rolling(window=M).mean()
    
    # Subtract the long-term moving average (M) from the short-term moving average (N)
    df['alpha_factor'] = df[f'N_{N}_ma'] - df[f'M_{M}_ma']
    
    return df['alpha_factor']
```
