```python
import pandas as pd

def heuristics_v2(df):
    # Momentum indicators from close prices
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['Momentum_5'] = df['close'] - df['SMA_5']
    df['Momentum_10'] = df['close'] - df['SMA_10']
    
    # Volume shock factor
    df['Avg_Volume_20'] = df['volume'].rolling(window=20).mean()
    df['Volume_Shock'] = (df['volume'] - df['Avg_Volume_20']) / df['Avg_Volume_20']
    
    # High and Low price for volatility and range
    df['Daily_Range'] = df['high'] - df['low']
    df['Avg_Daily_Range_20'] = df['Daily_Range'].rolling(window=20).mean()
    
    # Breakout indicator
    df['High_Breakout'] = (df['high'] - df['high'].rolling(window=20).max()).clip(lower=0)
    df['Low_Breakout'] = (df['low'].rolling(window=20).min() - df['low']).clip(lower=0)
    
    # Open-close ratio
    df['Open_Close_Ratio'] = df['open'] / df['close']
    
    # Amount-weighted price movement
    df['Price_Change'] = df['close'] - df['open']
    df['Amount_Weighted_Movement'] = (df['Price_Change'] * df['amount']).cumsum() / df['amount'].cumsum()
    
    # Composite score
    df['Composite_Score'] = 0.2 * df['Momentum_5'] + 0.2 * df['Momentum_10'] + 0.1 * df['Volume_Shock'] + \
                            0.1 * (df['Daily_Range'] - df['Avg_Daily_Range_20']) + 0.1 * df['High_Breakout'] - \
                            0.1 * df['Low_Breakout'] + 0.2 * (df['Open_Close_Ratio'] - 1) + 0.1 * df['Amount_Weighted_Movement']
    
    # Intraday reversal and opening gap
    df['Intraday_Reversal'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    df['Opening_Gap'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Final alpha factor
    df['Alpha_Factor'] = df['Composite_Score'] + 0.2 * df['Intraday_Reversal'] + 0.1 * df['Opening_Gap']

    return df['Alpha_Factor']
```
