```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['return'] = df['close'].pct_change()
    
    # Calculate simple moving averages (SMA) of daily returns
    df['SMA_5'] = df['return'].rolling(window=5).mean()
    df['SMA_10'] = df['return'].rolling(window=10).mean()
    df['SMA_20'] = df['return'].rolling(window=20).mean()
    
    # Calculate the difference between long-term and short-term SMAs
    df['SMA_diff'] = df['SMA_20'] - df['SMA_5']
    
    # Calculate True Range (TR)
    df['TR'] = df[['high', 'low', 'close']].apply(lambda x: max(x[0] - x[1], abs(x[0] - df['close'].shift(1)), abs(x[1] - df['close'].shift(1))), axis=1)
    
    # Calculate Average True Range (ATR) over different periods
    df['ATR_5'] = df['TR'].rolling(window=5).mean()
    df['ATR_14'] = df['TR'].rolling(window=14).mean()
    
    # Calculate On-Balance Volume (OBV)
    obv = (df['close'].diff() > 0).astype(int) * df['volume'] - (df['close'].diff() < 0).astype(int) * df['volume']
    df['OBV'] = obv.cumsum()
    
    # Calculate the rate of change of OBV over different periods
    df['ROC_OBV_5'] = df['OBV'].pct_change(periods=5)
    df['ROC_OBV_10'] = df['OBV'].pct_change(periods=10)
    
    # Combine multiple indicators for a composite factor
    w1, w2, w3 = 1, 1, 1  # These weights can be optimized through backtesting
    df['composite_factor'] = w1 * df['SMA_diff'] + w2 * df['ATR_14'] + w3 * df['ROC_OBV_10']
    
    return df['composite_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
