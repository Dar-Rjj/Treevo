```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate EMA and SMA
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()

    # Calculate Price Momentum and Momentum Strength
    df['Price_Momentum'] = df['close'] - df['EMA_10']
    df['ROC_5'] = df['close'].pct_change(periods=5)

    # Calculate Volume Adjusted High-Low Range and Trading Volume Patterns
    df['Daily_Range'] = df['high'] - df['low']
    df['Avg_Daily_Range_30'] = df['Daily_Range'].rolling(window=30).mean()
    df['Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    df['Volume_Adjusted_Range'] = df['Daily_Range'] * np.sqrt(np.log(df['Volume_Ratio']))

    # Calculate Enhanced Momentum Factor
    weights = np.array([2**i for i in range(7)])
    weights = weights / weights.sum()  # Normalize weights
    df['Enhanced_Momentum_Factor'] = (df['Price_Momentum'].rolling(window=7).apply(lambda x: np.dot(x, weights), raw=True))

    # Analyze Daily Price Action and Volatility
    df['ATR_14'] = df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min()
    df['High_Volatility_Day'] = (df['Daily_Range'] > df['Avg_Daily_Range_30']).astype(int)
    df['Close_Position_Ratio'] = (df['close'] - df['open']) / df['Daily_Range']

    # Evaluate Market Sentiment
    df['Up_Day'] = (df['close'] > df['open']).astype(int)
    df['Down_Day'] = (df['close'] < df['open']).astype(int)
    df['Overnight_Gap'] = df['open'] - df['close'].shift(1)

    # Investigate Financial Flows
    df['Value_Traded'] = df['amount'] / df['volume']
    df['Midpoint'] = (df['high'] + df['low']) / 2
    df['Cumulative_Value_Above_Midpoint'] = (df['Value_Traded'] * (df['Value_Traded'] > df['Midpoint'])).rolling(window=1).sum()
    df['Cumulative_Value_Below_Midpoint'] = (df['Value_Traded'] * (df['Value_Traded'] <= df['Midpoint'])).rolling(window=1).sum()

    # Trend Indicator
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['Trend_Indicator'] = np.where(df['SMA_50'] > df['close'], -1, 1)

    # Final Alpha Factor
    df['Final_Alpha_Factor'] = (
        df['Price_Momentum'] -
        df['Volume_Adjusted_Range'] +
        df['Enhanced_Momentum_Factor']
    ) * df['Trend_Indicator']

    return df['Final_Alpha_Factor']
```
