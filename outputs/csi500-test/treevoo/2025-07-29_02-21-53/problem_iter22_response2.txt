```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute High-Low Difference
    df['high_low_diff'] = df['high'] - df['low']
    
    # Compute Close-Open Difference
    df['close_open_diff'] = df['close'] - df['open']
    
    # Smooth High-Low Range with 20-day EMA
    df['ema_high_low'] = df['high_low_diff'].ewm(span=20, adjust=False).mean()
    
    # Calculate Long-Term High-Low Range over 50 days
    df['long_term_high'] = df['high'].rolling(window=50).max()
    df['long_term_low'] = df['low'].rolling(window=50).min()
    df['long_term_high_low_range'] = df['long_term_high'] - df['long_term_low']
    
    # Sum of High-Low Differences over a Period (e.g., 20 days)
    df['sum_high_low'] = df['high_low_diff'].rolling(window=20).sum()
    
    # Sum of Close-Open Differences over a Period (e.g., 20 days)
    df['sum_close_open'] = df['close_open_diff'].rolling(window=20).sum()
    
    # Apply Moving Average (e.g., 20-day) to High-Low Range
    df['ma_high_low_range'] = df['high_low_diff'].rolling(window=20).mean()
    
    # Compare Aggregate Price Movements and High-Low Ranges
    df['combined_momentum'] = df['sum_close_open'] / df['ma_high_low_range']
    
    # Weight by Recent Price Volatility
    df['price_volatility'] = df['close'].rolling(window=20).std()
    df['weighted_momentum'] = df['combined_momentum'] / df['price_volatility']
    
    # Compute Average Volume
    df['avg_volume'] = df['volume'].rolling(window=20).mean()
    
    # Identify Days with High Volume
    df['high_volume_day'] = (df['volume'] > df['avg_volume']).astype(int)
    
    # Compute Volume Ratio
    df['volume_ratio'] = df['volume'] / df['avg_volume']
    
    # Multiply Combined Momentum Score by Volume Ratio
    df['volume_adjusted_momentum'] = df['weighted_momentum'] * df['volume_ratio']
    
    # Adjust for Market Trends (Assuming market_index_return is provided in the DataFrame)
    df['market_adjusted_alpha'] = df['volume_adjusted_momentum'] + df['market_index_return']
    
    # Increase Factor Value on High Volume Spike Days
    df['volume_spike'] = (df['volume'] > 2 * df['avg_volume']).astype(int)
    df['final_alpha_factor'] = df['market_adjusted_alpha'] * (1 + 0.5 * df['volume_spike'])
    
    return df['final_alpha_factor']
```
