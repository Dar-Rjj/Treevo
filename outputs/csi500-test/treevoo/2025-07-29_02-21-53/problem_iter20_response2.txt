```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 5-Day, 10-Day, and 20-Day Simple Moving Averages (SMA) of Close Prices
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Compute the difference between 10-Day SMA and 20-Day SMA as a Momentum Indicator
    df['SMA_Momentum'] = df['SMA_10'] - df['SMA_20']
    
    # Identify Days Where Close Price Exceeds Highest High or Lowest Low over Last 30 Days
    df['High_30D'] = df['high'].rolling(window=30).max()
    df['Low_30D'] = df['low'].rolling(window=30).min()
    df['Breakout_Score'] = ((df['close'] > df['High_30D']) | (df['close'] < df['Low_30D'])).astype(int)
    
    # Calculate the Percentage Change in Volume from Previous Day
    df['Volume_Change'] = df['volume'].pct_change()
    # Mark Days with Large Volume Increase (>10%) and Associated Price Movement (>2%)
    df['Large_Volume_Price_Move'] = ((df['Volume_Change'] > 0.1) & (df['close'].pct_change() > 0.02)).astype(int)
    
    # Determine if the Stock Opened Higher but Closed Lower (Bearish Signal)
    df['Bearish_Signal'] = ((df['open'] > df['close'].shift(1)) & (df['close'] < df['open'])).astype(int)
    # Determine if the Stock Opened Lower but Closed Higher (Bullish Signal)
    df['Bullish_Signal'] = ((df['open'] < df['close'].shift(1)) & (df['close'] > df['open'])).astype(int)
    
    # Calculate the Ratio of Amount to Volume (Price Weighted Volume)
    df['Amount_Volume_Ratio'] = df['amount'] / df['volume']
    
    # Measure the Difference Between Today’s Open and Yesterday’s Close
    df['Gap_Opening'] = df['open'] - df['close'].shift(1)
    # Categorize Gaps as Up-Gap (Open > Yesterday's Close) or Down-Gap (Open < Yesterday's Close)
    df['Gap_Type'] = (df['Gap_Opening'] > 0).astype(int) - (df['Gap_Opening'] < 0).astype(int)
    
    # Compute the Range (High - Low) for Each Day
    df['Daily_Range'] = df['high'] - df['low']
    # Track Moving Average of Daily Ranges to Assess Volatility Trends
    df['Range_SMA_20'] = df['Daily_Range'].rolling(window=20).mean()
    
    # Calculate Daily High-Low Range
    df['Smoothed_Range'] = df['Daily_Range'].ewm(span=20, adjust=False).mean()
    # Compute Momentum of High-Low Ranges
    df['Range_Momentum'] = df['Smoothed_Range'] - df['Daily_Range']
    # Weight by Volume
    df['Range_Momentum_Volume'] = df['Range_Momentum'] * df['volume']
    
    # Calculate Daily Price Change
    df['Price_Change'] = df['close'] - df['open']
    # Smooth Price Change
    df['Smoothed_Price_Change'] = df['Price_Change'].ewm(span=20, adjust=False).mean()
    # Combine with High-Low Range Momentum
    df['Combined_Factor'] = df['Smoothed_Price_Change'] + df['Range_Momentum_Volume']
    
    # Calculate Long-Term Price Trend
    df['Long_Term_Trend'] = df['close'].rolling(window=100).mean()
    # Smooth Long-Term Price Trend
    df['Smoothed_Long_Term_Trend'] = df['Long_Term_Trend'].ewm(span=100, adjust=False).mean()
    # Compute Price Trend Momentum
    df['Trend_Momentum'] = df['Smoothed_Long_Term_Trend'] - df['Price_Change']
    # Combine with High-Low Range and Volume Momentum
    df['Final_Factor'] = df['Combined_Factor'] + df['Trend_Momentum']
    
    return df['Final_Factor']
```
