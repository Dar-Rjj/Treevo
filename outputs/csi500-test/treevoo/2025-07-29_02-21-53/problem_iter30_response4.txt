```python
import pandas as pd

def heuristics_v2(df, N=10, M=14, L=20, P=10, Q=5, R=7, S=5, threshold=0.05):
    # Compute daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Sum of returns over a lookback window of N days
    df['N_day_return'] = df['daily_return'].rolling(window=N).sum()
    
    # True range and ATR
    df['true_range'] = df[['high', 'close']].max(axis=1) - df[['low', 'close']].min(axis=1)
    df['ATR_M'] = df['true_range'].rolling(window=M).mean()
    df['ATR_2M'] = df['true_range'].rolling(window=2*M).mean()
    df['relative_ATR'] = df['ATR_M'] / df['ATR_2M']
    
    # Volatility-adjusted return
    df['vol_adjusted_return'] = df['N_day_return'] / df['ATR_M']
    
    # Volume intensity
    df['avg_volume_L'] = df['volume'].rolling(window=L).mean()
    df['volume_intensity'] = df['volume'] / df['avg_volume_L']
    
    # Money flow
    df['money_flow'] = df['volume'] * (2*df['close'] - df['high'] - df['low'])
    df['P_day_money_flow'] = df['money_flow'].rolling(window=P).sum()
    df['total_volume_P'] = df['volume'].rolling(window=P).sum()
    df['volume_adjusted_money_flow'] = df['P_day_money_flow'] / df['total_volume_P']
    
    # Composite factor
    df['composite_factor'] = 0.3 * df['N_day_return'] + 0.4 * df['vol_adjusted_return'] + 0.3 * df['volume_intensity']
    
    # Trend strength factor
    df['cum_high_close_diff'] = (df['high'] - df['close']).rolling(window=Q).sum()
    df['cum_low_close_diff'] = (df['close'] - df['low']).rolling(window=Q).sum()
    df['trend_strength'] = df['cum_high_close_diff'] - df['cum_low_close_diff']
    df['normalized_trend_strength'] = df['trend_strength'] / df['ATR_M']
    
    # Divergence factor
    df['volume_change'] = df['volume'].pct_change()
    df['divergence'] = ((df['daily_return'] > 0) & (df['volume_change'] < 0)) | ((df['daily_return'] < 0) & (df['volume_change'] > 0))
    df['R_day_divergence'] = df['divergence'].rolling(window=R).sum()
    df['divergence_adjusted_return'] = df['N_day_return'] - df['R_day_divergence']
    
    # Large move-adjusted return
    df['large_move'] = abs(df['daily_return']) > threshold
    df['S_day_large_move_avg'] = df['daily_return'][df['large_move']].rolling(window=S).mean()
    df['large_move_frequency'] = df['large_move'].rolling(window=S).sum()
    df['large_move_adjusted_return'] = df['N_day_return'] - df['large_move_frequency'] * df['S_day_large_move_avg']
    
    # Final alpha factor
    df['alpha_factor'] = df['composite_factor'] + df['normalized_trend_strength'] + df['divergence_adjusted_return'] + df['large_move_adjusted_return']
    
    return df['alpha_factor']
```
