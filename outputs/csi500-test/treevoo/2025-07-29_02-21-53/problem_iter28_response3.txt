```python
import pandas as pd

def heuristics_v2(df, N=10, M=14, L=20, P=10):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Sum of returns over a lookback window of N days
    df['N_day_returns'] = df['daily_return'].rolling(window=N).sum()
    
    # True range
    df['true_range'] = (df['high'].combine(df['close'].shift(1), max) - df['low'].combine(df['close'].shift(1), min))
    
    # Average true range (ATR) over M days
    df['ATR'] = df['true_range'].rolling(window=M).mean()
    
    # Relative ATR
    df['relative_ATR'] = df['ATR'] / df['ATR'].rolling(window=2*M).mean()
    
    # Volume intensity
    df['avg_volume_L_days'] = df['volume'].rolling(window=L).mean()
    df['volume_intensity'] = df['volume'] / df['avg_volume_L_days']
    
    # Money flow
    df['money_flow'] = df['volume'] * (2*df['close'] - df['high'] - df['low'])
    df['P_day_money_flow'] = df['money_flow'].rolling(window=P).sum() * df['daily_return'].apply(lambda x: 1 if x > 0 else -1)
    
    # Composite factor
    df['composite_factor'] = df['N_day_returns'] + df['relative_ATR'] + df['volume_intensity'] + df['P_day_money_flow']
    
    # Dynamic weighting scheme (simple example: weight by the standard deviation of each factor's returns)
    factors = ['N_day_returns', 'relative_ATR', 'volume_intensity', 'P_day_money_flow']
    for factor in factors:
        df[f'{factor}_returns'] = (df[factor] - df[factor].shift(1)) / df[factor].shift(1)
    
    std_devs = df[[f'{factor}_returns' for factor in factors]].std()
    weights = std_devs / std_devs.sum()
    
    df['weighted_composite_factor'] = sum(weights[factor] * df[factor] for factor in factors)
    
    return df['weighted_composite_factor']

# Example usage
# df = pd.read_csv('your_stock_data.csv')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
