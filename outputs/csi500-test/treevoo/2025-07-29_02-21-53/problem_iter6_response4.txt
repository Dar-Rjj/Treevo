```python
import pandas as pd

def heuristics_v2(df):
    # Compute 10-day and 30-day close price averages
    df['10_day_avg'] = df['close'].rolling(window=10).mean()
    df['30_day_avg'] = df['close'].rolling(window=30).mean()

    # Determine Price Momentum
    df['price_momentum'] = df['10_day_avg'] - df['30_day_avg']

    # Calculate 5-day volume average
    df['5_day_vol_avg'] = df['volume'].rolling(window=5).mean()

    # Detect Volume Spike
    df['volume_spike'] = (df['volume'] > 2 * df['5_day_vol_avg']).astype(int)

    # Calculate 10-day and 5-day high-low ranges
    df['10_day_range'] = df['high'] - df['low']
    df['5_day_range'] = df['high'].rolling(window=5).max() - df['low'].rolling(window=5).min()
    df['10_day_range_avg'] = df['10_day_range'].rolling(window=10).mean()

    # Adjust Momentum Based on Volume and Volatility
    for i in range(len(df)):
        if df.loc[df.index[i], 'volume_spike'] == 1:
            df.loc[df.index[i], 'adjusted_momentum'] = df.loc[df.index[i], 'price_momentum'] * 0.8
        else:
            if df.loc[df.index[i], '5_day_range'] > 1.5 * df.loc[df.index[i], '10_day_range_avg']:
                df.loc[df.index[i], 'adjusted_momentum'] = df.loc[df.index[i], 'price_momentum'] * 1.2
            else:
                df.loc[df.index[i], 'adjusted_momentum'] = df.loc[df.index[i], 'price_momentum']
    
    # Return the adjusted momentum as the factor
    return df['adjusted_momentum']
```
