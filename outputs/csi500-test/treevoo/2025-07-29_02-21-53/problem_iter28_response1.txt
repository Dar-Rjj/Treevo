```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Average (SMA) of Close Prices
    df['SMA_Close'] = df['close'].rolling(window=20).mean()
    
    # Calculate Exponential Moving Average (EMA) of Close Prices
    df['EMA_Close'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Detect Bearish and Bullish Candles
    df['Bearish_Candle'] = (df['open'] > df['close']).astype(int)
    df['Bullish_Candle'] = (df['open'] < df['close']).astype(int)
    
    # Identify Engulfing Patterns
    df['Engulfing_Bullish'] = ((df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))).astype(int)
    df['Engulfing_Bearish'] = ((df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))).astype(int)
    
    # Sum of Volumes over a Period
    df['Sum_Volume_20'] = df['volume'].rolling(window=20).sum()
    
    # Volume Difference Between Up and Down Days
    df['Volume_Up_Down'] = df['volume'] * (df['close'] - df['open']) / abs(df['close'] - df['open'])
    df['Volume_Diff_20'] = df['Volume_Up_Down'].rolling(window=20).sum()
    
    # Volume Spike on Up Days
    df['Volume_Spike_Up'] = (df['volume'] > df['volume'].shift(1) * 2) & (df['close'] > df['open'])
    df['Volume_Spike_Up'] = df['Volume_Spike_Up'].astype(int)
    
    # Volume Spike on Down Days
    df['Volume_Spike_Down'] = (df['volume'] > df['volume'].shift(1) * 2) & (df['close'] < df['open'])
    df['Volume_Spike_Down'] = df['Volume_Spike_Down'].astype(int)
    
    # SMA of Close Prices Adjusted by Volume
    df['SMA_Close_Adjusted'] = df['SMA_Close'] * df['volume']
    
    # EMA of Close Prices Adjusted by Volume
    df['EMA_Close_Adjusted'] = df['EMA_Close'] * df['volume']
    
    # Price Change Momentum
    df['Price_Change_Momentum'] = df['close'] - df['close'].shift(20)
    
    # Volume Change Momentum
    df['Volume_Change_Momentum'] = df['volume'] - df['volume'].shift(20)
    
    # Positive Open-Close Spread
    df['Positive_Open_Close_Spread'] = (df['close'] > df['open']).astype(int)
    
    # Negative Open-Close Spread
    df['Negative_Open_Close_Spread'] = (df['close'] < df['open']).astype(int)
    
    # Large Body Up Candles
    df['Large_Body_Up'] = ((df['close'] - df['open']) > (df['high'] - df['low']) * 0.5).astype(int)
    
    # Large Body Down Candles
    df['Large_Body_Down'] = ((df['open'] - df['close']) > (df['high'] - df['low']) * 0.5).astype(int)
    
    # Combine factors to create the final alpha factor
    df['Alpha_Factor'] = (
        df['SMA_Close_Adjusted'] + 
        df['EMA_Close_Adjusted'] + 
        df['Price_Change_Momentum'] + 
        df['Volume_Change_Momentum'] + 
        df['Positive_Open_Close_Spread'] * 2 - 
        df['Negative_Open_Close_Spread'] * 2 + 
        df['Large_Body_Up'] * 2 - 
        df['Large_Body_Down'] * 2
    )
    
    return df['Alpha_Factor']
```
