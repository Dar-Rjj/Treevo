```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 5-Day, 10-Day, and 20-Day Simple Moving Averages (SMA) of Close Prices
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Compute the difference between 10-Day SMA and 20-Day SMA as a Momentum Indicator
    df['Momentum'] = df['SMA_10'] - df['SMA_20']
    
    # Identify Days Where Close Price Exceeds Highest High or Lowest Low over Last 30 Days
    df['30D_High'] = df['high'].rolling(window=30).max()
    df['30D_Low'] = df['low'].rolling(window=30).min()
    df['Breakout_Score'] = ((df['close'] > df['30D_High']) | (df['close'] < df['30D_Low'])).astype(int)
    
    # Calculate the Percentage Change in Volume from Previous Day
    df['Volume_Change'] = df['volume'].pct_change()
    
    # Mark Days with Large Volume Increase (>10%) and Associated Price Movement (>2%)
    df['Volume_Price_Event'] = ((df['Volume_Change'] > 0.1) & (df['close'].pct_change() > 0.02)).astype(int)
    
    # Determine if the Stock Opened Higher but Closed Lower (Bearish Signal)
    # Determine if the Stock Opened Lower but Closed Higher (Bullish Signal)
    df['Price_Behavior'] = (df['close'] > df['open']).astype(int) - (df['close'] < df['open']).astype(int)
    
    # Calculate the Ratio of Amount to Volume (Price Weighted Volume)
    df['Amount_to_Volume_Ratio'] = df['amount'] / df['volume']
    
    # Measure the Difference Between Today’s Open and Yesterday’s Close
    df['Gap'] = df['open'] - df['close'].shift(1)
    df['Gap_Up'] = (df['Gap'] > 0).astype(int)
    df['Gap_Down'] = (df['Gap'] < 0).astype(int)
    
    # Compute the Range (High - Low) for Each Day
    df['Range'] = df['high'] - df['low']
    df['Range_MA'] = df['Range'].rolling(window=20).mean()
    
    # Compute the Average Directional Index (ADX) to Measure Trend Strength
    df['TR'] = df[['high', 'low']].diff().abs().max(axis=1)
    df['DMp'] = (df['high'].diff().clip(lower=0) - df['low'].diff().clip(upper=0)).clip(lower=0)
    df['DMm'] = (df['low'].diff().clip(lower=0) - df['high'].diff().clip(upper=0)).clip(lower=0)
    df['TR14'] = df['TR'].rolling(window=14).sum()
    df['DMp14'] = df['DMp'].rolling(window=14).sum()
    df['DMm14'] = df['DMm'].rolling(window=14).sum()
    df['PDI'] = (df['DMp14'] / df['TR14']) * 100
    df['MDI'] = (df['DMm14'] / df['TR14']) * 100
    df['ADX'] = 100 * (df['PDI'] - df['MDI']).abs() / (df['PDI'] + df['MDI'])
    
    # Calculate the Volume Weighted Price (VWP) for Each Day
    df['VWP'] = (df['amount'] / df['volume'])
    
    # Calculate the Standard Deviation of Daily Returns Over a 20-Day Period
    df['Daily_Return'] = df['close'].pct_change()
    df['Std_Dev_20'] = df['Daily_Return'].rolling(window=20).std()
    
    # Compute the Money Flow Index (MFI)
    df['TP'] = (df['high'] + df['low'] + df['close']) / 3
    df['MF'] = df['TP'] * df['volume']
    df['PMF'] = df['MF'].where(df['TP'] > df['TP'].shift(
