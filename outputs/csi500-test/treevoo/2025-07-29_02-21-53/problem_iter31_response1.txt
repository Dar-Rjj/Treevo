```python
import pandas as pd

def heuristics_v2(df, N=20):
    # Calculate the absolute daily return
    df['abs_daily_return'] = (df['close'] - df['open']).abs()
    
    # Calculate the average absolute daily return over the past N days
    df['avg_abs_daily_return'] = df['abs_daily_return'].rolling(window=N).mean()
    
    # Calculate the daily return direction
    df['daily_return_direction'] = (df['close'] - df['open']).apply(lambda x: 1 if x > 0 else -1)
    
    # Calculate the high to low range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate the average high to low range over the past N days
    df['avg_high_low_range'] = df['high_low_range'].rolling(window=N).mean()
    
    # Calculate the ratio of the current day's high to low range over the average
    df['high_low_range_ratio'] = df['high_low_range'] / df['avg_high_low_range']
    
    # Calculate the percentage change in trading volume compared to its N-day average
    df['volume_pct_change'] = (df['volume'] - df['volume'].rolling(window=N).mean()) / df['volume'].rolling(window=N).mean()
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['abs_daily_return'] / df['avg_abs_daily_return'] * 
        df['daily_return_direction'] * 
        df['high_low_range_ratio'] * 
        (1 + df['volume_pct_change'])
    )
    
    return df['alpha_factor']
```
