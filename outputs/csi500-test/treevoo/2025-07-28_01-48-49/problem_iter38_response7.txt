```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 50-day SMA of closing prices
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    
    # Calculate 14-day RSI
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Evaluate the difference between the current day's close and the previous day's close
    df['Daily_Price_Movement'] = df['close'] - df['close'].shift(1)
    df['Cumulative_Price_Movement'] = df['Daily_Price_Movement'].rolling(window=22).sum()
    
    # Measure the ratio of the current day's volume to the SMA of volume over a 20-day period
    df['Volume_SMA_20'] = df['volume'].rolling(window=20).mean()
    df['Volume_Ratio'] = df['volume'] / df['Volume_SMA_20']
    
    # Calculate true range and 14-day average true range
    df['True_Range'] = df[['high', 'low', 'close']].max(axis=1) - df[['high', 'low', 'close']].min(axis=1)
    df['Average_True_Range'] = df['True_Range'].rolling(window=14).mean()
    
    # Calculate price gaps
    df['Price_Gap'] = df['open'] - df['close'].shift(1)
    df['Up_Gaps'] = df['Price_Gap'].apply(lambda x: x if x > 0 else 0)
    df['Down_Gaps'] = df['Price_Gap'].apply(lambda x: abs(x) if x < 0 else 0)
    df['Total_Gaps'] = df['Up_Gaps'] + df['Down_Gaps']
    df['Gap_Ratio'] = df['Up_Gaps'] / df['Total_Gaps'].replace(0, np.nan)
    
    # Calculate ROC
    df['ROC'] = (df['close'] - df['close'].shift(10)) / df['close'].shift(10)
    
    # Calculate modified A/D line
    df['Median_Price'] = df[['high', 'low', 'close']].median(axis=1)
    df['A_D_Line'] = ((df['Median_Price'] - df['close'].shift(1)) / (df['high'] - df['low']) * df['volume']).cumsum()
    
    # Intraday Price Movement
    df['IntradayRange'] = df['high'] - df['low']
    
    # Adjust by Volume Change and Price Level
    df['VolumeChange'] = df['volume'] - df['volume'].shift(1)
    df['PriceLevelAdjustment'] = df['close'] / df['open']
    df['AdjustedRange'] = df['IntradayRange'] * df['VolumeChange'] * df['PriceLevelAdjustment']
    
    # IntradayMomentumScore
    df['IntradayMomentumScore'] = df['IntradayRange'] * df['VolumeChange']
    
    # 5-Day Average High-Low Spread
    df['5DayAvgHighLowSpread'] = df['IntradayRange'].rolling(window=5).mean()
    
    # 5-Day Momentum
    df['5DayMomentum'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    
    # HighLowSpreadMomentum
    df['HighLowSpreadMomentum'] = df['5DayAvgHighLowSpread'] * df['5DayMomentum']
    
    # IntegratedMomentumFactor
    df['IntegratedMomentumFactor'] = df['IntradayMomentumScore'] + df['HighLowSpreadMomentum']
    
    # VolumeTrendAdjustedFactor
    df['5DaySumVolume'] = df['volume'].rolling(window=5).sum()
    df['VolumeRatio'] = df['volume'] / df['5DaySumVolume']
    df['VolumeTrendAdjustedFactor'] = df['IntegratedMomentumFactor'] * df['VolumeRatio']
    
    # CompositeAlphaFactor
    df['CompositeAlphaFactor'] = (df['IntegratedMomentumFactor'] * 0.6 + df['VolumeTrendAdjustedFactor'] * 0.4) * (df['RSI']/100) * (df['ROC
