```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Simple Moving Averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()

    # Calculate Exponential Moving Averages
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()

    # SMA Crossovers
    df['SMA_Crossover_5_20'] = np.where(df['SMA_5'] > df['SMA_20'], 1, -1)
    # EMA Crossovers
    df['EMA_Crossover_5_20'] = np.where(df['EMA_5'] > df['EMA_20'], 1, -1)

    # Average True Range (ATR)
    df['H-L'] = df['high'] - df['low']
    df['H-PC'] = abs(df['high'] - df['close'].shift(1))
    df['L-PC'] = abs(df['low'] - df['close'].shift(1))
    df['TR'] = df[['H-L', 'H-PC', 'L-PC']].max(axis=1)
    df['ATR_14'] = df['TR'].rolling(window=14).mean()

    # Standard Deviation of daily returns over 20 days
    df['Daily_Returns'] = df['close'].pct_change()
    df['STD_20'] = df['Daily_Returns'].rolling(window=20).std()

    # Relative Strength Index (RSI)
    delta = df['close'].diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['RSI_14'] = 100 - (100 / (1 + rs))

    # On-Balance Volume (OBV)
    df['OBV'] = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()

    # Money Flow Index (MFI)
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    positive_money_flow = money_flow.where(delta > 0, 0)
    negative_money_flow = money_flow.where(delta < 0, 0)
    positive_mf_sum = positive_money_flow.rolling(window=14).sum()
    negative_mf_sum = negative_money_flow.rolling(window=14).sum()
    money_flow_ratio = positive_mf_sum / negative_mf_sum
    df['MFI_14'] = 100 - (100 / (1 + money_flow_ratio))

    # Composite Trend Indicator
    df['Composite_Trend'] = (df['SMA_Crossover_5_20'] + df['EMA_Crossover_5_20']) / 2
    df['Composite_Trend'] *= 1 if df['ATR_14'].iloc[-1] < df['ATR_14'].mean() else -1

    # Composite Momentum Indicator
    rsi_signal = np.where(df['RSI_14'] > 70, 1, np.where(df['RSI_14'] < 30, -1, 0))
    mfi_signal = np.where(df['MFI_14'] > 80, 1, np.where(df['MFI_14'] < 20, -1, 0))
    df['Composite_Momentum'] = (rsi_signal + mfi_signal) / 2
    df['Composite_Momentum'] *= 1 if df['OBV'].iloc[-1] > df['OBV'].shift(1).iloc[-1] else -1

    # Final Alpha Factor
    df['Alpha_Factor
