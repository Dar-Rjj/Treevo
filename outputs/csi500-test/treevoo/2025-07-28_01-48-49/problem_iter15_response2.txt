```python
import pandas as pd

def heuristics_v2(df):
    # Price Momentum: 20-day and 50-day returns
    df['price_momentum_20'] = df['close'].pct_change(20)
    df['price_momentum_50'] = df['close'].pct_change(50)
    
    # Volume Adjusted Momentum: Combine price momentum with volume change
    df['volume_change_20'] = df['volume'].pct_change(20)
    df['volume_adjusted_momentum_20'] = (df['price_momentum_20'] * df['volume_change_20']).fillna(0)
    
    # Moving Average Crossover: 5-day over 20-day
    df['ma_5'] = df['close'].rolling(window=5).mean()
    df['ma_20'] = df['close'].rolling(window=20).mean()
    df['ma_crossover'] = df['ma_5'] - df['ma_20']
    
    # High-Low Breakout: Check if today's high/low exceeds the highest/lowest of the past 20 days
    df['highest_high_20'] = df['high'].rolling(window=20).max()
    df['lowest_low_20'] = df['low'].rolling(window=20).min()
    df['high_breakout'] = (df['high'] > df['highest_high_20']).astype(int)
    df['low_breakout'] = (df['low'] < df['lowest_low_20']).astype(int)
    
    # Cumulative Return in the Last 20 Days
    df['cumulative_return_20'] = df['close'].pct_change().rolling(window=20).sum()
    
    # Close-to-Open Gap: Measure the gap between the current open and the previous close
    df['close_to_open_gap'] = df['open'] - df['close'].shift(1)
    
    # Volume Surge: Compare the current day's volume against the average volume over the previous 20 days
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    df['volume_surge'] = (df['volume'] / df['avg_volume_20']) - 1
    
    # Volume Oscillator: Use the difference between 5-day and 20-day moving averages of volume
    df['volume_ma_5'] = df['volume'].rolling(window=5).mean()
    df['volume_ma_20'] = df['volume'].rolling(window=20).mean()
    df['volume_oscillator'] = (df['volume_ma_5'] - df['volume_ma_20']) / df['volume_ma_20']
    
    # Bullish/Bearish Engulfing: Identify if today's candlestick fully engulfs the previous day's
    df['engulfing'] = ((df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & 
                       (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))).astype(int) - \
                      ((df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & 
                       (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))).astype(int)
    
    # Doji Star: Detect the presence of a doji star pattern
    df['doji_star'] = (abs(df['open'] - df['close']) <= 0.005 * (df['high'] - df['low'])).astype(int)
    
    # Composite Alpha Factor: Combine multiple factors
    df['composite_alpha'] = (
        df['price_momentum_20'] +
        df['volume_adjusted_momentum_20'] +
        df['ma_crossover'] +
        df['high_breakout'] - df['low_breakout'] +
        df['cumulative_return_20'] +
        df['close_to_open_gap'] +
        df['volume_surge'] +
        df['volume_oscillator'] +
        df['engulfing'] +
        df['doji_star']
    )
    
    return df['composite_alpha']
```
