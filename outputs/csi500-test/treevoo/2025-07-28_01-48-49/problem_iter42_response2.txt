```python
import pandas as pd
import numpy as np

def weighted_moving_average(data, window):
    weights = np.arange(1, window + 1)
    wma = data.rolling(window=window).apply(lambda prices: np.dot(prices, weights) / weights.sum(), raw=True)
    return wma

def rsi(data, window):
    delta = data.diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    average_gain = up.rolling(window=window).mean()
    average_loss = abs(down.rolling(window=window).mean())
    rs = average_gain / average_loss
    rsi = 100 - (100 / (1 + rs))
    return rsi

def true_range(df):
    high = df['high']
    low = df['low']
    close_prev = df['close'].shift(1)
    tr = pd.concat([high - low, abs(high - close_prev), abs(low - close_prev)], axis=1).max(axis=1)
    return tr

def heuristics_v2(df):
    # Weighted Moving Average of closing prices over a 50-day period
    wma_50 = weighted_moving_average(df['close'], 50)
    
    # RSI based on closing prices over a 14-day period
    rsi_14 = rsi(df['close'], 14)
    
    # RSI based on the WMA of closing prices
    rsi_wma_14 = rsi(wma_50, 14)
    
    # Daily price movement
    daily_price_movement = df['close'] - df['close'].shift(1)
    
    # Cumulative sum of daily price movements over the past 20 days
    cumulative_sum_20 = daily_price_movement.rolling(window=20).sum()
    
    # Average daily price movement over the last 20 days
    avg_daily_movement_20 = daily_price_movement.rolling(window=20).mean()
    
    # Volume ratio to the SMA of volume over a 20-day period
    sma_volume_20 = df['volume'].rolling(window=20).mean()
    volume_ratio = df['volume'] / sma_volume_20
    
    # Momentum factor by calculating the rate of change in volume over the last 20 days
    roc_volume_20 = (df['volume'] - df['volume'].shift(20)) / df['volume'].shift(20)
    
    # True range and its 14-day average for short-term volatility
    tr = true_range(df)
    atr_14 = tr.rolling(window=14).mean()
    
    # Price gaps
    price_gaps = df['open'] - df['close'].shift(1)
    up_gaps = price_gaps[price_gaps > 0].rolling(window=20).count()
    down_gaps = price_gaps[price_gaps < 0].rolling(window=20).count()
    avg_up_gap = price_gaps[price_gaps > 0].rolling(window=20).mean()
    avg_down_gap = price_gaps[price_gaps < 0].rolling(window=20).mean()
    
    # Rate of change (ROC) between the current close and the close from 10 and 20 days ago
    roc_10 = (df['close'] - df['close'].shift(10)) / df['close'].shift(10)
    roc_20 = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    
    # Accumulation/distribution line using the median of high, low, and close
    med_price = (df[['high', 'low', 'close']].median(axis=1) - df['close'].shift(1)) * df['volume']
    ad_line = med_price.cumsum()
    roc_ad_20 = (ad_line - ad_line.shift(20)) / ad_line.shift(20)
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        wma_50 +
        rsi_14 +
        rsi_wma_14 +
        cumulative_sum_20 +
        avg_daily_movement_20 +
        volume_ratio +
        roc_volume_20 +
        atr_14 +
        up_gaps +
        down_gaps +
        avg_up_gap +
        avg_down_gap +
        roc_10 +
        roc_20 +
        ad_line +
        roc_ad_20
    )
    
    return alpha_factor
```
