```python
def heuristics_v2(df):
    # Calculate the difference between high and low, and close and open
    df['range'] = df['high'] - df['low']
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate the percentage of the range that the close-open difference represents
    df['range_percentage'] = (df['close_open_diff'] / df['range']).fillna(0)
    
    # Calculate the price momentum as the difference between the current close and the 5-period moving average of the close
    df['price_momentum'] = df['close'] - df['close'].rolling(window=5).mean()
    
    # Calculate the volume momentum as the difference between the current volume and the 5-period moving average of the volume
    df['volume_momentum'] = df['volume'] - df['volume'].rolling(window=5).mean()
    
    # Combine the factors into a single alpha factor
    df['alpha_factor'] = df['range_percentage'] * df['price_momentum'] * df['volume_momentum']
    
    return df['alpha_factor']
```
