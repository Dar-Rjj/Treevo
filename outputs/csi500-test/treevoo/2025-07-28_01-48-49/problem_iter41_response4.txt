```python
import pandas as pd

def heuristics_v2(df):
    """
    Generates an alpha factor based on the given market data.
    
    Parameters:
    df (pd.DataFrame): DataFrame with index as date and columns as open, high, low, close, amount, volume.
    
    Returns:
    pd.Series: Alpha factor values indexed by date.
    """
    # Calculate price change percentage
    df['price_change'] = (df['close'] - df['open']) / df['open']
    
    # Calculate relative volume to the average 5-day volume
    df['avg_5d_volume'] = df['volume'].rolling(window=5).mean()
    df['rel_volume'] = df['volume'] / df['avg_5d_volume']
    
    # Calculate the difference between high and low as a measure of volatility
    df['volatility'] = df['high'] - df['low']
    
    # Calculate the weighted sum of the three components
    df['alpha_factor'] = (df['price_change'] * 0.4) + (df['rel_volume'] * 0.3) + (df['volatility'] * 0.3)
    
    # Return the alpha factor as a Series
    return df['alpha_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=True, index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
