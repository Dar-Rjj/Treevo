```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the intraday range
    intraday_range = df['high'] - df['low']
    
    # Calculate the daily momentum (return from open to close)
    daily_momentum = (df['close'] - df['open']) / df['open']
    
    # Calculate the ratio of closing price to average volume over the last 5 days
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    price_to_avg_vol_ratio = df['close'] / avg_volume_5d
    
    # Calculate the percentage change in volume from the previous day
    vol_change_pct = df['volume'].pct_change()
    
    # Calculate the moving sum of daily returns over a 20-day period
    daily_return = (df['close'] - df['open']) / df['open']
    moving_sum_20d = daily_return.rolling(window=20).sum()
    
    # Calculate the moving average of volume over a 10-day period
    moving_avg_vol_10d = df['volume'].rolling(window=10).mean()
    
    # Combine the factors into a composite alpha factor
    # Assign weights to each factor based on their historical correlation with future returns
    weight_intraday_range = 0.3
    weight_daily_momentum = 0.3
    weight_price_to_avg_vol_ratio = 0.2
    weight_vol_change_pct = 0.1
    weight_moving_sum_20d = 0.1
    
    composite_alpha_factor = (
        weight_intraday_range * intraday_range +
        weight_daily_momentum * daily_momentum +
        weight_price_to_avg_vol_ratio * price_to_avg_vol_ratio +
        weight_vol_change_pct * vol_change_pct +
        weight_moving_sum_20d * moving_sum_20d
    )
    
    return composite_alpha_factor
```
