```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Price Movement
    df['IntradayRange'] = df['high'] - df['low']
    
    # Adjust by Volume Change and Price Level
    df['VolumeChange'] = df['volume'].pct_change()
    df['PriceLevelRatio'] = df['close'] / df['open']
    df['AdjustedRange'] = df['IntradayRange'] * df['VolumeChange'] * df['PriceLevelRatio']

    # Close Price Momentum
    lookback_period = 10
    df['Momentum'] = df['close'].pct_change(lookback_period)

    # Integrate Intraday Price Movement and Volume
    df['IntradayMomentumScore'] = df['IntradayRange'] * df['VolumeChange']

    # Calculate 5-Day Average High-Low Spread
    df['HighLowSpread'] = (df['high'] - df['low']).rolling(window=5).mean()
    
    # Finalize Alpha Factor for Intraday and High-Low Spread Momentum
    df['FiveDayMomentum'] = df['close'].pct_change(5)
    df['HighLowSpreadMomentum'] = df['HighLowSpread'] * df['FiveDayMomentum']
    df['IntegratedMomentumFactor'] = df['IntradayMomentumScore'] + df['HighLowSpreadMomentum']

    # Calculate Volume Weighted Average Price
    df['VWAP'] = (df[['open', 'high', 'low', 'close']].sum(axis=1) * df['volume']) / df['volume']

    # Combine Factors with Volume-Adjusted Price Trend
    df['CloseToCloseReturn'] = df['close'].pct_change()
    df['VolumeAdjustedPriceTrend'] = df['CloseToCloseReturn'] * df['IntradayRange'] / df['VWAP']

    # Filter for Recent Price Trend
    df['FiveDayMA'] = df['close'].rolling(window=5).mean()
    df['RecentPriceTrend'] = df['close'] - df['FiveDayMA']

    # Introduce Volume Trend
    df['FiveDayVolumeSum'] = df['volume'].rolling(window=5).sum()
    df['VolumeRatio'] = df['volume'] / df['FiveDayVolumeSum']
    df['VolumeTrendAdjustedFactor'] = df['VolumeAdjustedPriceTrend'] * df['VolumeRatio']

    # Adjust Momentum by Intraday Volatility
    df['IntradayVolatility'] = df['IntradayRange'].rolling(window=lookback_period).std()
    df['AdjustedMomentum'] = df['IntegratedMomentumFactor'] * df['IntradayVolatility']

    # Calculate Dynamic Adjustment Factor
    n_day_ema_period = 10
    df['DynamicAdjustmentFactor'] = df['volume'].ewm(span=n_day_ema_period, adjust=False).mean()

    # Apply Dynamic Adjustment
    df['DynamicallyAdjustedMomentum'] = df['AdjustedMomentum'] * df['DynamicAdjustmentFactor']

    # Calculate Open Price Impact
    df['OpenPriceImpact'] = (df['open'] / df['open'].shift(1)) - 1

    # Include RSI and MFI
    def calculate_rsi(prices, n=14):
        delta = prices.diff()
        d_up, d_down = delta.copy(), delta.copy()
        d_up[d_up < 0] = 0
        d_down[d_down > 0] = 0
        rs_up = d_up.rolling(n).mean()
        rs_down = d_down.rolling(n).mean().abs()
        rsi = 100 - 100 / (1 + rs_up / rs_down)
        return rsi

    def calculate_mfi(high, low, close, volume, n=14):
        typical_price = (high + low + close) / 3
        raw_money_flow = typical_price * volume
        positive_money_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)
        negative_money_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)
        money_ratio = positive_money_flow.rolling(n).sum() / negative_money_flow.rolling(n).sum()
        mfi = 100 - 100 / (1 + money_ratio)
        return mfi

    df['RSI'] = calculate_rsi(df['close'])
    df['MFI'] = calculate_mfi(df['high'], df['low'], df['close'], df['volume'])

    # Final Alpha Factor
    weights = {
        'AdjustedRange': 0.2,
        '
