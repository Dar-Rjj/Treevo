```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the difference between today's close and the average of the previous 10 days' close
    df['close_momentum'] = df['close'].diff(periods=10)
    
    # Compute the ratio of today's volume to the average of the last 10 days' volume
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=10).mean()
    
    # Calculate the sum of absolute differences in close prices over the past 10 days, then divide it by the same period's total volume
    df['price_change_per_volume'] = (df['close'].diff().abs().rolling(window=10).sum()) / df['volume'].rolling(window=10).sum()
    
    # Measure the correlation between the daily return (close price change) and the corresponding volume change over the past 30 days
    df['return_vol_corr'] = df['close'].pct_change().rolling(window=30).corr(df['volume'].pct_change())
    
    # Determine the frequency of up-gaps (open > close) versus down-gaps (open < close) in the last 20 trading days
    df['up_gap'] = (df['open'] > df['close']).rolling(window=20).sum()
    df['down_gap'] = (df['open'] < df['close']).rolling(window=20).sum()
    df['gap_ratio'] = df['up_gap'] / df['down_gap']
    
    # Find the average true range (high - low) over the last 20 days to gauge recent volatility
    df['average_true_range'] = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Count the number of days with trade amounts exceeding the 90th percentile of the last year's trade amounts
    threshold = df['amount'].quantile(0.90)
    df['heavy_trade_days'] = (df['amount'] > threshold).rolling(window=252).sum()
    
    # Create a composite score from selected factors
    weights = {
        'close_momentum': 0.2,
        'volume_ratio': 0.15,
        'price_change_per_volume': 0.15,
        'return_vol_corr': 0.1,
        'gap_ratio': 0.1,
        'average_true_range': 0.1,
        'heavy_trade_days': 0.2
    }
    
    df['composite_score'] = 0
    for factor, weight in weights.items():
        df['composite_score'] += df[factor] * weight
    
    return df['composite_score']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
```
