```txt
Integrated Intraday and Volume Shock Momentum Factor
├── Calculate Intraday High-Low Movement
│   ├── Use High price on day t
│   └── Use Low price on day t
├── Calculate Intraday Return
│   ├── Use Open price on day t
│   └── Use Close price on day t
├── Calculate Daily Return
│   ├── Use Close price of day t
│   └── Use Close price of day t-1
├── Sum of Recent Returns
│   ├── Collect last 5 days' Close-to-Close Returns
│   └── Sum the collected returns
├── Volume Change
│   ├── Use Current Volume
│   └── Use Previous Day's Volume
├── Amount Change
│   ├── Use Current Amount
│   └── Use Previous Day's Amount
├── Average Volume
│   ├── Collect Volume data for the last 5 days
│   └── Compute the average volume
├── Average Amount
│   ├── Collect Amount data for the last 5 days
│   └── Compute the average amount
├── Volume Ratio
│   ├── Use Volume of day t
│   └── Divide by Average Volume
├── Amount Ratio
│   ├── Use Amount of day t
│   └── Divide by Average Amount
├── Weighted Intraday Return
│   ├── Multiply Intraday Return by Volume Change
├── Weighted Amount Intraday Return
│   ├── Multiply Intraday Return by Amount Change
├── Combined Weighted Momentum
│   ├── Add Weighted Intraday Return to Weighted Amount Intraday Return
│   ├── Add the sum to Sum of Recent Returns
│   ├── Multiply the final sum by Volume Ratio and Amount Ratio
├── Adjusted Logarithmic Returns with Enhanced Volume Shock
    ├── Calculate Logarithmic Returns
    │   ├── Use Close price
    │   └── Compute log(close_t / close_(t-1))
    ├── Smoothing Logarithmic Returns
    │   ├── Apply Simple Moving Average (SMA)
    │   │   ├── Input: Logarithmic Returns
    │   │   └── Window Length: 5 days
    │   └── Store Smoothed Returns
    ├── Volume Shock Indicator
    │   ├── Calculate Daily Volume Change
    │   │   ├── Use Volume
    │   │   └── Compute volume_t - volume_(t-1)
    │   ├── Identify Large Changes
    │   │   ├── If |volume_change| > 2 * standard deviation of 5-day window
    │   │   │   └── Assign 1 (Shock), else 0 (No Shock)
    └── Combine Intraday Weighted Return and Shock Adjusted Return
        ├── When Shock = 1, Adjust the smoothed return using High-Low Movement
        │   ├── Compute adjusted_return = smoothed_return * (high_t - low_t) / close_t
        ├── When Shock = 0, Set to Intraday Weighted Return
        └── Add to the Combined Weighted Momentum
├── Volume and Amount Adjusted Close-to-Open Return
│   ├── Calculate Close-to-Open Return
│   │   ├── Use Close price on day t
│   │   └── Use Open price on day t
│   └── Weight by Volume and Amount
│       ├── Combine Volume and Amount
│       │   ├── Use Volume on day t
│       │   └── Use Amount on day t
│       └── Multiply by Close-to-Open Return
├── Intraday High-Low Movement
│   ├── Calculate Intraday High-Low Movement
│   │   ├── Use High price on day t
│   │   └── Use Low price on day t
│   └── Adjust by Volume Change
│       ├── Calculate Volume Change
│       │   ├── Use Volume on day t
│       │   └── Use Volume on day (t-1)
│       └── Combine with Intraday Return
│           ├── Calculate Intraday Return
│           │   ├── Use Open price on day t
│           │   └── Use Close price on day t
│           └── Add to Volume and Amount Adjusted Close-to-Open Return
├── Adjust for Volume Volatility
│   ├── Calculate Volume Moving Average
│   │   ├── Sum Volume over 20 days
│   │   └── Divide by 20
│   └── Calculate Standard Deviation of Volume
│       ├── Subtract Moving Average from Daily Volumes
│       │   ├── Use Daily Volume
│       │   └── Use Volume Moving Average
│       ├── Square the
