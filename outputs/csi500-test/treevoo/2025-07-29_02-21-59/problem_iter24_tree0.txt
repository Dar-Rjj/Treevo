```txt
Intraday Momentum and Volume Shock Factor with Integrated Amount, Sum of Recent Returns, and Volatility-Adjusted Returns
├── Calculate Intraday High-Low Movement
│   ├── Use High price
│   └── Use Low price
├── Calculate Intraday Return
│   ├── Use Open price
│   └── Use Close price
├── Calculate Daily Return
│   ├── Use Close price of day t
│   └── Use Close price of day t-1
├── Sum of Recent Returns
│   ├── Collect last 5 days' Close-to-Close Returns
│   └── Sum the collected returns
├── Volume Change
│   ├── Use Current Volume
│   └── Use Previous Day's Volume
├── Amount Change
│   ├── Use Current Amount
│   └── Use Previous Day's Amount
├── Average Volume
│   ├── Collect Volume data for the last 5 days
│   └── Compute the average volume
├── Average Amount
│   ├── Collect Amount data for the last 5 days
│   └── Compute the average amount
├── Volume Ratio
│   ├── Use Volume of day t
│   └── Divide by Average Volume
├── Amount Ratio
│   ├── Use Amount of day t
│   └── Divide by Average Amount
├── Weighted Intraday Return
│   ├── Multiply Intraday Return by Volume Change
├── Weighted Amount Intraday Return
│   ├── Multiply Intraday Return by Amount Change
├── Combined Weighted Momentum
│   ├── Add Weighted Intraday Return to Weighted Amount Intraday Return
│   ├── Add the sum to Sum of Recent Returns
│   ├── Multiply the final sum by Volume Ratio and Amount Ratio
├── Adjusted Logarithmic Returns with Enhanced Volume Shock
    ├── Calculate Logarithmic Returns
    │   ├── Use Close price
    │   └── Compute log(close_t / close_(t-1))
    ├── Smoothing Logarithmic Returns
    │   ├── Apply Simple Moving Average (SMA)
    │   │   ├── Input: Logarithmic Returns
    │   │   └── Window Length: 5 days
    │   └── Store Smoothed Returns
    ├── Volume Shock Indicator
    │   ├── Calculate Daily Volume Change
    │   │   ├── Use Volume
    │   │   └── Compute volume_t - volume_(t-1)
    │   ├── Identify Large Changes
    │   │   ├── If |volume_change| > 2 * standard deviation of 5-day window
    │   │   │   └── Assign 1 (Shock), else 0 (No Shock)
    └── Combine Intraday Weighted Return and Shock Adjusted Return
        ├── When Shock = 1, Adjust the smoothed return using High-Low Movement
        │   ├── Compute adjusted_return = smoothed_return * (high_t - low_t) / close_t
        ├── When Shock = 0, Set to Intraday Weighted Return
        ├── Add to the Combined Weighted Momentum
├── Volatility-Adjusted Returns
    ├── Calculate 5-Day Realized Volatility
    │   ├── Use Close prices
    │   └── Compute rolling standard deviation over 5-day window
    ├── Adjust Logarithmic Returns
    │   ├── Divide smoothed logarithmic returns by 5-Day Realized Volatility
    └── Incorporate into Final Factor
        ├── Multiply the final factor by the volatility-adjusted returns
```
