```txt
Combined Volume-Weighted Momentum and Enhanced Intraday Movement
├── Calculate Logarithmic Returns
│   ├── Use Close price
│   └── Compute log(close_t / close_(t-1))
├── Smoothing Logarithmic Returns
│   ├── Apply Exponential Moving Average (EMA)
│   │   ├── Input: Logarithmic Returns
│   │   └── Span: 5 days
│   ├── Store Smoothed Returns
├── Volume Shock Indicator
│   ├── Calculate Daily Volume Change
│   │   ├── Use Volume
│   └── Compute volume_t - volume_(t-1)
│   ├── Identify Large Changes
│       ├── If |volume_change| > 3 * standard deviation of 7-day window
│       │   └── Assign 1 (Shock), else 0 (No Shock)
├── Integrate Intraday High-Low Movement
│   ├── Calculate Intraday High-Low Movement
│   │   ├── Use High price on day t
│   │   └── Use Low price on day t
│   │   └── Compute high_t - low_t
│   ├── Calculate Intraday High-Low Ratio
│   │   ├── Intraday High-Low Movement
│   │   └── Use Close price on day t
│   │   └── Compute (high_t - low_t) / close_t
│   ├── Calculate Intraday Return
│   │   ├── Use Open price on day t
│   │   └── Use Close price on day t
│   │   └── Compute (close_t - open_t) / open_t
│   └── Adjust by Volume Change
│       ├── Calculate Volume Change
│       │   ├── Use Volume on day t
│       │   └── Use Volume on day (t-1)
│       └── Combine with Intraday Return
│           ├── Multiply Intraday Return by Volume Change
│           └── Add to Volume Adjusted Close-to-Open Return
└── Weight by Volume and Price Volatility
    ├── Use Volume
    │   ├── Volume (t)
    │   ├── Volume (t-1)
    │   └── Volume (t-n)
    └── Calculate Price Volatility
        ├── Use High and Low prices
        │   ├── High (t)
        │   ├── Low (t)
        │   ├── High (t-1)
        │   └── Low (t-1)
        └── Average of High-Low Difference
            ├── (High - Low (t) + High - Low (t-1)) / 2
    └── Combine Volume and Volatility
        ├── Multiply by Volume
        └── Multiply by Volatility
    └── Multiply Smoothed Returns by Combined Weight
        ├── When Shock = 1, Keep the weighted return
        └── When Shock = 0, Set to 0
└── Adjust for Volume Volatility
    ├── Calculate Volume Moving Average
    │   ├── Sum Volume over 20 days
    │   └── Divide by 20
    └── Calculate Standard Deviation of Volume
        ├── Subtract Moving Average from Daily Volumes
        │   ├── Use Daily Volume
        │   └── Use Volume Moving Average
        ├── Square the Differences
        ├── Sum the Squared Differences over 20 days
        └── Take the Square Root of the Sum
```
