```txt
Volume, Momentum, and Volatility Enhanced Alpha Factor
├── Calculate Logarithmic Returns
│   ├── Use Close price
│   └── Compute log(close_t / close_(t-1))
├── Smoothing Logarithmic Returns
│   ├── Apply Exponential Moving Average (EMA)
│   │   ├── Input: Logarithmic Returns
│   │   └── Span: 5 days
│   ├── Store Smoothed Returns
├── Volume Shock Indicator
│   ├── Calculate Daily Volume Change
│   │   ├── Use Volume
│   │   └── Compute volume_t - volume_(t-1)
│   ├── Identify Large Changes
│       ├── If |volume_change| > 3 * standard deviation of 7-day window
│       │   └── Assign 1 (Shock), else 0 (No Shock)
├── Weight by Volume and Price Volatility
    ├── Use Volume
    │   ├── Volume (t)
    │   ├── Volume (t-1)
    │   └── Volume (t-n)
    └── Calculate Price Volatility
        ├── Use High and Low prices
        │   ├── High (t)
        │   ├── Low (t)
        │   ├── High (t-1)
        │   └── Low (t-1)
        └── Average of High-Low Difference
            ├── (High - Low (t) + High - Low (t-1)) / 2
    └── Combine Volume and Volatility
        ├── Multiply by Volume
        └── Multiply by Volatility
    └── Multiply Smoothed Returns by Combined Weight
        ├── When Shock = 1, Keep the weighted return
        └── When Shock = 0, Set to 0
├── Volume Weighted Close-to-Open Return
│   ├── Calculate Close-to-Open Return
│   │   ├── Use Close price
│   │   └── Use Open price
│   └── Multiply by Volume
└── Intraday Movement Adjustment
    ├── Calculate Intraday High-Low Movement
    │   ├── Use High price
    │   └── Use Low price
    ├── Calculate Intraday Return
    │   ├── Use Open price
    │   └── Use Close price
    └── Adjust by Volume Change
        ├── Calculate Volume Change
        │   ├── Use Current Volume
        │   └── Use Previous Day's Volume
        └── Combine Adjustments
            ├── Multiply Intraday Return by Volume Change
            └── Add to Volume Weighted Close-to-Open Return
```
