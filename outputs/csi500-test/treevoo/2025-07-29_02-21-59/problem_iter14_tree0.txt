```txt
Integrated and Enhanced Alpha Factor with Volume-Weighted and Volatility Adjustments
├── Calculate Daily Price Change
│   ├── Use Close price
│   └── Use Previous Day's Close price
├── Sum of Daily Price Changes
│   ├── Aggregate Daily Price Changes over 20 days
├── Calculate Volume Weighted Average Price (VWAP)
│   ├── Use High, Low, and Close prices
│   └── Use Volume
├── PMI Score
│   ├── Multiply Sum of Daily Price Changes by VWAP
├── Calculate Intraday High-Low Movement
│   ├── Use High price
│   └── Use Low price
├── Calculate Intraday High-Low Ratio
│   ├── Intraday High-Low Movement
│   └── Use Close price
├── Calculate Intraday Return
│   ├── Use Open price
│   └── Use Close price
├── Calculate Intraday Volatility
│   ├── Use High price
│   ├── Use Low price
│   └── Use Close price
├── Weight by Volume and Amount Change
│   ├── Calculate Volume Change
│   │   ├── Use Current Volume
│   │   └── Use Previous Day's Volume
│   └── Calculate Amount Change
│       ├── Use Current Amount
│       └── Use Previous Day's Amount
├── Adjust Intraday Return
│   ├── Multiply Intraday Return by (Volume Change + Amount Change + Intraday Volatility)
├── Calculate Volume Weighted Close-to-Open Return
│   ├── Calculate Close-to-Open Return
│   │   ├── Use Close price
│   │   └── Use Open price
│   └── Weight by Volume
│       ├── Use Volume
│       └── Multiply by Return
├── Integrate Intraday High-Low Movement
│   ├── Calculate Intraday High-Low Movement
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Calculate Intraday High-Low Ratio
│   │   ├── Intraday High-Low Movement
│   │   └── Use Close price
│   ├── Adjust by Volume Change
│   │   ├── Calculate Volume Change
│   │   │   ├── Use Current Volume
│   │   │   └── Use Previous Day's Volume
│   │   └── Combine with Intraday Return
│   │       ├── Multiply Intraday Return by Volume Change
│   │       └── Add to Volume Weighted Close-to-Open Return
├── Calculate Daily Log Return
│   ├── Use Close price
│   └── Use Previous Day's Close price
├── Smoothing Logarithmic Returns
│   ├── Apply Exponential Moving Average (EMA)
│   │   ├── Input: Daily Log Return
│   │   └── Span: 5 days
│   └── Store Smoothed Returns
├── Volume Shock Indicator
│   ├── Calculate Daily Volume Change
│   │   └── Compute (volume_t - volume_(t-1)) / volume_(t-1)
│   └── Identify Large Changes
│       ├── If |volume_change| > 2 * standard deviation of 7-day window
│       │   └── Assign 1 (Shock), else 0 (No Shock)
├── Calculate Price Volatility
│   └── Average of True Range
│       ├── True Range (t) = max(High (t) - Low (t), abs(High (t) - Close (t-1)), abs(Low (t) - Close (t-1)))
│       └── Average True Range (ATR) over 7 days
├── Combine Volume and Volatility
│   ├── Multiply by Volume
│   └── Multiply by ATR
├── Weighted Smoothed Returns
│   ├── Multiply Smoothed Returns by Combined Weight
│   │   ├── When Shock = 1, Keep the weighted return
│   │   └── When Shock = 0, Set to 0
├── Cumulative Sum of Daily Log Returns
│   ├── Aggregate Log Returns over 20 days
│   └── No Absolute Value
├── Calculate 20-Day Moving Average VWAP
│   ├── Aggregate VWAP over 20 days
│   └── Use Simple Moving Average
└── Final Alpha Factor
    ├── Multiply PMI Score by Cumulative Sum of Daily Log Returns
    ├── Add to Adjusted Intraday Return
    ├── Add to Volume Weighted Close-to-Open Return
    └── Add to Weighted Smoothed Returns
```
