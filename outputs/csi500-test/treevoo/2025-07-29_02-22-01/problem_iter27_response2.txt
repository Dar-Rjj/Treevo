```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Compute the 5-day moving average of daily returns for momentum
    df['momentum_5day'] = df['daily_return'].rolling(window=5).mean()
    
    # Calculate the deviation of the current day's return from the 5-day moving average for reversal signals
    df['reversal_signal'] = df['daily_return'] - df['momentum_5day']
    
    # Compute the gap up/down ratio and its 10-day moving average
    df['gap_ratio'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    df['gap_trend'] = df['gap_ratio'].rolling(window=10).mean()
    
    # Determine the intraday momentum and its 10-day moving average
    df['intraday_momentum'] = (df['close'] - df['open']) / df['open']
    df['intraday_momentum_smoothed'] = df['intraday_momentum'].rolling(window=10).mean()
    
    # Calculate the true range and its 20-day moving average for volatility
    df['true_range'] = df[['high', 'low', 'close']].apply(lambda x: max(x[0] - x[1], abs(x[0] - df['close'].shift(1)), abs(x[1] - df['close'].shift(1))), axis=1)
    df['volatility_20day'] = df['true_range'].rolling(window=20).mean()
    
    # Measure the volume change and evaluate the volume-price relationship with a 5-day moving average
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['volume_price_relationship'] = df['daily_return'] * df['volume_change']
    df['sustained_volume_price_trend'] = df['volume_price_relationship'].rolling(window=5).mean()
    
    # Estimate the money flow and integrate the 30-day sum of money flow
    df['money_flow'] = (df['close'] - df['close'].shift(1)) * df['amount']
    df['money_flow_30day_sum'] = df['money_flow'].rolling(window=30).sum()
    
    # Combine all factors to form the alpha factor
    df['alpha_factor'] = (
        df['momentum_5day'] 
        + df['reversal_signal'] 
        + df['gap_trend'] 
        + df['intraday_momentum_smoothed'] 
        + df['volatility_20day'] 
        + df['sustained_volume_price_trend'] 
        + df['money_flow_30day_sum']
    )
    
    return df['alpha_factor']
```
