```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate EMAs
    df['ema_short'] = df['close'].ewm(span=5, adjust=False).mean()
    df['ema_long'] = df['close'].ewm(span=20, adjust=False).mean()

    # Intraday Metrics
    df['intraday_range'] = df['high'] - df['low']
    df['intraday_return'] = df['close'] - df['open']

    # Volume-Adjusted Intraday Return
    df['volume_adjusted_return'] = df['volume'] * df['intraday_return']

    # Proportional Movement Index
    df['proportional_movement_index'] = (df['intraday_range'] / df['close']) * df['intraday_return']

    # Combine Factors
    df['price_momentum'] = df['ema_short'] - df['ema_long']
    df['intraday_momentum'] = df['proportional_movement_index']
    df['weighted_intraday_adjustment'] = df['volume_adjusted_return'] * np.log(df['volume'])

    # Cumulative Price Change
    df['cumulative_price_change'] = df['close'].pct_change().rolling(window=14).sum()

    # Average Volume
    df['average_volume'] = df['volume'].rolling(window=14).mean()

    # Weighted Cumulative Momentum
    df['weighted_cumulative_momentum'] = df['cumulative_price_change'] * df['average_volume']

    # Volume-Adjusted High-Low Spread
    df['volume_adjusted_high_low_spread'] = (df['high'] - df['low']) * df['volume']

    # 10-Day Moving Sum of Volume-Adjusted High-Low Spread
    df['moving_sum_volume_adjusted_high_low_spread'] = df['volume_adjusted_high_low_spread'].rolling(window=10).sum()

    # Combine Volume-Adjusted High-Low Spread and Price Momentum
    df['combined_high_low_and_momentum'] = df['moving_sum_volume_adjusted_high_low_spread'] * df['price_momentum']

    # Calculate Simple Moving Averages (SMA)
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()

    # Momentum Component
    df['momentum_component'] = df['sma_5'] - df['sma_20']

    # Volatility
    df['daily_log_returns'] = np.log(df['close'] / df['close'].shift(1))
    df['volatility'] = df['daily_log_returns'].rolling(window=22).std()

    # Enhance with Volume-Weighted Price
    df['vwap'] = ((df['high'] + df['low'] + df['close']) / 3) * df['volume']
    df['vwap'] = df['vwap'].rolling(window=1).sum() / df['volume'].rolling(window=1).sum()

    # Incorporate Volume Reversal Indicator
    df['volume_rate_of_change'] = df['volume'] / df['volume'].shift(10) - 1
    df['smoothed_volume_rate_of_change'] = df['volume_rate_of_change'].rolling(window=5).mean()
    df['inverse_smoothed_volume_rate_of_change'] = 1 / (1 + df['smoothed_volume_rate_of_change'])

    # Final Alpha Factor
    df['alpha_factor'] = (
        df['price_momentum'] +
        df['intraday_momentum'] +
        df['weighted_cumulative_momentum'] +
        df['combined_high_low_and_momentum'] +
        df['momentum_component'] +
        df['vwap'] +
        (df['close'] - df['close'].shift(1)) * (df['volume'] / df['volume'].shift(1)) +
        df['inverse_smoothed_volume_rate_of_change']
    )

    # Volume Confirmation
    df['daily_volume_change'] = df['volume'] - df['volume'].shift(1)
    positive_volume_days = df[df['daily_volume_change'] > 0]
    df['average_volume_increase'] = positive_volume_days['daily_volume_change'].rolling(window=10).sum() / positive_volume_days['daily_volume_change'].rolling(window=10).count()
    df['volume_confirmation'] = df['volume'] > df['volume'].shift(1)

    df['final_alpha_factor'] = df['alpha_factor'] * df['volume_confirmation']

    return df['final_alpha_factor']
```
