```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=10):
    # Calculate Price Momentum
    daily_price_change = df['close'].diff()
    momentum = daily_price_change.rolling(window=N).sum()

    # Volume Confirmation
    daily_volume_change = df['volume'].diff()
    positive_volume_diff = (daily_volume_change[daily_volume_change > 0]).rolling(window=M).sum()
    count_positive_volume = (daily_volume_change > 0).rolling(window=M).sum()
    average_volume_increase = positive_volume_diff / count_positive_volume

    # Calculate Cumulative Daily Price Change
    cumulative_daily_price_change = daily_price_change.rolling(window=N).sum()

    # Calculate Average Volume
    average_volume = df['volume'].rolling(window=N).mean()

    # Weighted Cumulative Daily Price Change
    weighted_cumulative_momentum = cumulative_daily_price_change * average_volume

    # Incorporate High-Low Range
    daily_high_low_range = df['high'] - df['low']
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    scaled_high_low_range = daily_high_low_range / typical_price
    high_low_enhanced_alpha = weighted_cumulative_momentum * scaled_high_low_range

    # Incorporate Open-Close Spread
    open_close_spread = abs(df['open'] - df['close'])
    open_close_enhanced_alpha = high_low_enhanced_alpha + open_close_spread

    # Calculate Intraday Price Movement
    intraday_price_movement = (df['high'] - df['low']) / df['open']

    # Calculate Daily Return
    daily_return = df['close'].pct_change()

    # Compute Weighted Volume Trend
    volume_ma = df['volume'].rolling(window=N).mean()
    weighted_volume_trend = (df['volume'] - volume_ma).abs()

    # Assess Intraday Volume Impact
    volume_weight = df['volume'] / df['volume'].rolling(window=10).mean()

    # Combine Metrics for Volatility
    combined_metric = (df['high'] - df['low']) * weighted_volume_trend + daily_return
    sma_combined_metric = combined_metric.rolling(window=5).mean()

    # Integrate Intraday and Historical Effects
    integrated_effect = intraday_price_movement * volume_weight * sma_combined_metric

    # Measure Sequential Momentum
    sequential_momentum = integrated_effect.rolling(window=5).sum()
    smoothed_sequential_momentum = sequential_momentum.ewm(span=3).mean()

    # Final Alpha Factor
    final_alpha_factor = smoothed_sequential_momentum * open_close_enhanced_alpha
    final_alpha_factor = final_alpha_factor.where(average_volume_increase > 0, final_alpha_factor * 0.9)

    return final_alpha_factor
```
