```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Momentum: 5-day average of daily returns
    df['momentum_5d'] = df['daily_return'].rolling(window=5).mean()
    
    # Reversal: difference between current day's return and 5-day average
    df['reversal_signal'] = df['daily_return'] - df['momentum_5d']
    
    # Gap up/down ratio
    df['gap_ratio'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # 10-day summary of gap trend
    df['gap_trend_10d'] = df['gap_ratio'].rolling(window=10).sum()
    
    # Intraday momentum
    df['intraday_momentum'] = (df['close'] - df['open']) / df['open']
    
    # 10-day moving average of intraday momentum
    df['intraday_momentum_10d'] = df['intraday_momentum'].rolling(window=10).mean()
    
    # True range
    df['true_range'] = df[['high' - 'low', ('high' - df['close'].shift(1)).abs(), 
                           ('low' - df['close'].shift(1)).abs()]].max(axis=1)
    
    # 20-day moving average of true range for volatility
    df['volatility_20d'] = df['true_range'].rolling(window=20).mean()
    
    # Volume change
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Volume-price relationship
    df['volume_price_relationship'] = df['daily_return'] * df['volume_change']
    
    # 5-day moving average of volume-price relationship
    df['volume_price_rel_5d'] = df['volume_price_relationship'].rolling(window=5).mean()
    
    # Money flow using amount
    df['money_flow'] = (df['close'] - df['close'].shift(1)) * df['amount']
    
    # 30-day sum of money flow
    df['money_flow_30d'] = df['money_flow'].rolling(window=30).sum()
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['momentum_5d'] + df['reversal_signal'] + df['gap_trend_10d'] + 
                          df['intraday_momentum_10d'] - df['volatility_20d'] + 
                          df['volume_price_rel_5d'] + df['money_flow_30d'])
    
    # Return the alpha factor as a pandas Series
    return df['alpha_factor']
```
