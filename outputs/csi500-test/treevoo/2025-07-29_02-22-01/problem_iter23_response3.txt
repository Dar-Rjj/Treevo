```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate EMAs
    short_ema_span = 10
    long_ema_span = 30
    df['short_ema'] = df['close'].ewm(span=short_ema_span, adjust=False).mean()
    df['long_ema'] = df['close'].ewm(span=long_ema_span, adjust=False).mean()

    # Intraday Metrics
    df['intraday_range'] = df['high'] - df['low']
    df['intraday_return'] = df['close'] - df['open']

    # Volume-Adjusted Intraday Return
    df['volume_adjusted_intraday_return'] = df['volume'] * df['intraday_return']

    # Proportional Movement Index
    df['proportional_movement_index'] = (df['intraday_range'] / df['close']) * df['intraday_return']

    # Combine Factors
    df['price_momentum'] = df['short_ema'] - df['long_ema']
    df['intraday_momentum'] = df['proportional_movement_index']
    df['weighted_intraday_adjustment'] = df['volume_adjusted_intraday_return'] * np.log(df['volume'])

    # Cumulative Price Change
    n_days = 22
    df['cumulative_price_change'] = df['close'].pct_change().rolling(window=n_days).sum()

    # Average Volume
    df['average_volume'] = df['volume'].rolling(window=n_days).mean()

    # Weighted Cumulative Momentum
    df['weighted_cumulative_momentum'] = df['cumulative_price_change'] * df['average_volume']

    # Volume-Adjusted High-Low Spread
    df['volume_adjusted_high_low_spread'] = (df['high'] - df['low']) * df['volume']

    # 10-Day Moving Sum of Volume-Adjusted High-Low Spread
    df['10_day_sum_high_low_spread'] = df['volume_adjusted_high_low_spread'].rolling(window=10).sum()

    # Combine Volume-Adjusted High-Low Spread and Price Momentum
    df['combined_high_low_momentum'] = df['10_day_sum_high_low_spread'] * df['price_momentum']

    # Calculate Simple Moving Averages (SMA)
    df['5_day_sma'] = df['close'].rolling(window=5).mean()
    df['20_day_sma'] = df['close'].rolling(window=20).mean()

    # Momentum Component
    df['momentum_component'] = df['5_day_sma'] - df['20_day_sma']

    # Volatility
    df['daily_log_returns'] = np.log(df['close'] / df['close'].shift(1))
    df['volatility'] = df['daily_log_returns'].rolling(window=22).std()

    # Enhance with Volume-Weighted Price
    df['vwap'] = ((df['high'] + df['low'] + df['close']) / 3) * df['volume'] / df['volume'].expanding().sum()

    # Incorporate Volume Reversal Indicator
    df['volume_rate_of_change'] = df['volume'] / df['volume'].shift(1) - 1
    df['smoothed_volume_roc'] = df['volume_rate_of_change'].rolling(window=5).mean()
    
    # Final Alpha Factor
    df['final_alpha_factor'] = (
        df['price_momentum'] +
        df['intraday_momentum'] +
        df['weighted_cumulative_momentum'] +
        df['combined_high_low_momentum'] +
        df['momentum_component'] +
        df['vwap']
    ) / (1 + df['smoothed_volume_roc'])

    return df['final_alpha_factor']
```
