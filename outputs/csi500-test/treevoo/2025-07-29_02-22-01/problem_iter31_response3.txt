```python
import pandas as pd

def heuristics_v2(df):
    # Momentum factor based on the close price
    df['1_day_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['5_day_momentum'] = df['1_day_return'].rolling(window=5).sum()

    # Volatility factor using high and low prices
    df['daily_range'] = (df['high'] - df['low']) / df['close']
    df['10_day_avg_range'] = df['daily_range'].rolling(window=10).mean()

    # Volume-based factor
    df['1_day_volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['20_day_avg_volume_change'] = df['1_day_volume_change'].rolling(window=20).mean()

    # Gap factor using open and close prices
    df['gap'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    df['30_day_sum_gap'] = df['gap'].rolling(window=30).sum()

    # Combine the factors into a single alpha factor
    df['alpha_factor'] = df['5_day_momentum'] + df['10_day_avg_range'] + df['20_day_avg_volume_change'] + df['30_day_sum_gap']

    return df['alpha_factor']
```
