```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Momentum: 5-day average of daily return
    df['momentum_5d'] = df['daily_return'].rolling(window=5).mean()
    
    # Reversal signal: difference between current day's return and 5-day average
    df['reversal_signal'] = df['daily_return'] - df['momentum_5d']
    
    # Gap up/down ratio
    df['gap_ratio'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Trend of gap over past 10 days
    df['gap_trend_10d'] = df['gap_ratio'].rolling(window=10).mean()
    
    # Intraday momentum
    df['intraday_momentum'] = (df['close'] - df['open']) / df['open']
    
    # 10-day moving average of intraday momentum
    df['intraday_momentum_smoothed'] = df['intraday_momentum'].rolling(window=10).mean()
    
    # True range
    df['true_range'] = df[['high' - 'low', abs('high' - 'close').shift(1), abs('low' - 'close').shift(1)]].max(axis=1)
    
    # Volatility: 20-day moving average of true range
    df['volatility'] = df['true_range'].rolling(window=20).mean()
    
    # Volume change
    df['volume_change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Volume-price relationship
    df['volume_price_relationship'] = df['daily_return'] * df['volume_change']
    
    # 5-day moving average of volume-price relationship
    df['volume_price_trend'] = df['volume_price_relationship'].rolling(window=5).mean()
    
    # Money flow
    df['money_flow'] = (df['close'] - df['close'].shift(1)) * df['amount']
    
    # 30-day sum of money flow
    df['money_flow_sum'] = df['money_flow'].rolling(window=30).sum()
    
    # Alpha factor: combining various signals
    df['alpha_factor'] = (df['momentum_5d'] + df['reversal_signal'] + 
                          df['gap_trend_10d'] + df['intraday_momentum_smoothed'] + 
                          df['volatility'] + df['volume_price_trend'] + 
                          df['money_flow_sum'])
    
    return df['alpha_factor'].dropna()
```
