```python
def heuristics_v2(df):
    # Calculate the weighted average of high and low prices
    weighted_avg = (df['high'] * df['volume'] + df['low'] * df['volume']) / (2 * df['volume'])
    
    # Calculate the difference between the close price and the weighted average
    diff_close_weighted_avg = df['close'] - weighted_avg
    
    # Calculate the factor as the ratio of the difference to the amount
    factor = diff_close_weighted_avg / df['amount']
    
    return factor
```
