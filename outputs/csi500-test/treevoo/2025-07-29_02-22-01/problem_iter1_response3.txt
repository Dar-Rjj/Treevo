```python
import pandas as pd

def heuristics_v2(df, N=10, M=5):
    # Calculate Daily Price Change
    df['price_change'] = df['close'].diff()
    
    # Calculate Momentum
    df['momentum'] = df['price_change'].rolling(window=N).sum()
    
    # Calculate Daily Volume Change
    df['volume_change'] = df['volume'].diff()
    
    # Filter positive volume changes
    df_pos_vol_change = df[df['volume_change'] > 0]
    
    # Sum of Positive Volume Differences over the last M days
    df['positive_volume_sum'] = df_pos_vol_change['volume_change'].rolling(window=M).sum()
    
    # Count of Days with Positive Volume
    df['positive_volume_count'] = df['volume_change'].apply(lambda x: 1 if x > 0 else 0)
    df['positive_volume_count'] = df['positive_volume_count'].rolling(window=M).sum()
    
    # Volume Confirmation
    df['volume_confirmation'] = df['positive_volume_sum'] / df['positive_volume_count']
    
    # Final Alpha Factor
    df['alpha_factor'] = df['momentum'] * df['volume_confirmation']
    
    return df['alpha_factor']

# Example usage:
# df = pd.DataFrame({
#     'open': [...],
#     'high': [...],
#     'low': [...],
#     'close': [...],
#     'amount': [...],
#     'volume': [...]
# }, index=pd.to_datetime([...]))
# alpha_factor = heuristics_v2(df)
```
