```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 5-day Weighted Moving Average (WMA) of Closing Prices
    weights = np.array([1, 2, 3, 4, 5]) / 15
    df['WMA_5'] = df['close'].rolling(window=5).apply(lambda x: (x * weights).sum(), raw=True)
    
    # Generate Buy/Sell Signal from WMA
    df['WMA_Signal'] = np.where(df['close'] > df['WMA_5'], 1, -1)
    
    # Compute Combined Percentage Change in Closing Prices
    df['Combined_Pct_Change'] = df['close'].pct_change(10) + df['close'].pct_change(20)
    
    # Explore Opening and Closing Price Relationship
    df['Open_Close_Diff_CumSum'] = (df['close'] - df['open']).rolling(window=20).sum()
    
    # Analyze Volume Data for Unusual Trading Activity
    df['Avg_Volume_20'] = df['volume'].rolling(window=20).mean()
    df['Volume_Z_Score'] = (df['volume'] - df['Avg_Volume_20']) / df['volume'].rolling(window=20).std()
    df['Volume_Spike'] = np.where(df['Volume_Z_Score'] > 3, 1, 0)
    
    # Investigate Volatility Using High and Low Prices
    df['Range'] = df['high'] - df['low']
    df['Range_MA_10'] = df['Range'].rolling(window=10).mean()
    df['Relative_Volatility'] = df['Range'] / df['Range_MA_10']
    
    # Calculate Short-Term Return
    df['Short_Term_Return'] = (df['close'] / df['close'].shift(5)) - 1
    
    # Calculate Long-Term Return
    df['Long_Term_Return'] = (df['close'] / df['close'].shift(20)) - 1
    
    # Daily Log Return
    df['Daily_Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    
    # 20-Day Momentum
    df['Momentum_20'] = df['Daily_Log_Return'].rolling(window=20).sum()
    
    # Intraday Momentum Component
    df['Intraday_Momentum'] = ((df['close'] - df['open']) / df['open']) * df['volume']
    
    # Historical Momentum Component
    df['Historical_Momentum'] = df['close'] - df['close'].shift(10)
    
    # Sum of Momentum Components
    df['Total_Momentum'] = df['Intraday_Momentum'] + df['Historical_Momentum']
    
    # Smooth Combined Momentum
    df['Smoothed_Momentum'] = df['Total_Momentum'].rolling(window=5).mean()
    
    # 20-Day Volume Volatility
    df['Volume_Volatility'] = df['volume'].pct_change().rolling(window=20).std()
    
    # Average Volume
    df['Avg_Volume_10'] = df['volume'].rolling(window=10).mean()
    
    # Average Daily Range
    df['Avg_Range_10'] = df['Range'].rolling(window=10).mean()
    
    # Volatility Multiplier
    df['Volatility_Multiplier'] = 1 / (df['Avg_Range_10'] + 1)
    
    # Adjusted Smoothed Momentum
    df['Adjusted_Smoothed_Momentum'] = (df['Smoothed_Momentum'] / df['Volume_Volatility'] * df['Avg_Volume_10']) * df['Volatility_Multiplier']
    
    # Volume-Price Indicator
    df['Volume_Diff'] = df['volume'] - df['volume'].shift(1)
    df['Volume_Price_Indicator'] = 0.5 * df['Volume_Diff'] + 0.3 * df['Avg_Range_10'] + (df['close'] - df['close'].shift(1))
    
    # Relative Strength
    df['Relative_Strength'] = df['Short_Term_Return'] - df['Long_Term_Return']
    
    # Multiply Relative Strength by Volume Spike Indicator
    df['RS_VS_Indicator'] = df['Relative_Strength'] * df['Volume_Spike']
    
    # High-Low Range Over Average
    df['High_Low_Range_Over_Avg'] = df['Range'] / df['Avg_Range_10']
    

