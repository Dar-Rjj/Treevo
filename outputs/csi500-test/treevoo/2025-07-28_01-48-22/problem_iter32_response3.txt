```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 5-day weighted moving average (WMA)
    weights = np.array([1, 2, 3, 4, 5])
    wma = df['close'].rolling(window=5).apply(lambda x: np.sum(weights * x) / np.sum(weights), raw=True)
    
    # Generate a signal based on today's close and 5-day WMA
    signal = (df['close'] > wma).astype(int) * 2 - 1
    
    # Calculate short-term and long-term returns
    short_term_return = (df['close'] / df['close'].shift(5)) - 1
    long_term_return = (df['close'] / df['close'].shift(20)) - 1
    momentum_score = short_term_return + long_term_return
    
    # Compute intraday and historical momentum components
    intraday_momentum = (df['close'] - df['open']) / df['open'] * df['volume']
    historical_momentum = df['close'] - df['close'].shift(10)
    combined_momentum = intraday_momentum + historical_momentum
    ema_momentum = combined_momentum.ewm(span=5, adjust=False).mean()
    
    # Calculate 20-day volume volatility and average volume
    volume_volatility = df['volume'].rolling(window=20).std()
    avg_volume = df['volume'].rolling(window=10).mean()
    
    # Adjust momentum score by volume and volatility
    adjusted_momentum = momentum_score / volume_volatility * avg_volume
    
    # Calculate relative strength
    relative_strength = short_term_return - long_term_return
    
    # Calculate daily high-low range and 5-day average high-low range
    daily_range = df['high'] - df['low']
    avg_daily_range = daily_range.rolling(window=5).mean()
    relative_range = daily_range / avg_daily_range
    
    # Combine intraday and open-to-close returns
    intraday_return = df['high'] - df['low']
    open_to_close_return = df['close'] - df['open']
    combined_return = intraday_return + open_to_close_return
    
    # Identify significant volume spikes
    volume_std = df['volume'].rolling(window=20).std()
    volume_spike = (df['volume'] > df['volume'].rolling(window=20).mean() + 2 * volume_std).astype(int)
    combined_return_with_spike = combined_return * volume_spike
    
    # Integrate volume and price information
    volume_difference = df['volume'] - df['volume'].shift(1)
    vwap = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    volume_to_vwap_ratio = volume_difference / vwap
    integrated_factor = 0.6 * volume_difference + 0.4 * avg_daily_range + (df['close'] - df['close'].shift(1))
    
    # Combine all indicators to form the final alpha factor
    intermediate_result = relative_range * volume_difference * volume_to_vwap_ratio * (df['close'] - df['close'].shift(1))
    final_factor = intermediate_result * combined_return_with_spike * integrated_factor
    
    # Weight the final factor by volume and volatility
    volume_average = df['volume'].rolling(window=5).mean()
    volatility = df['close'].pct_change().rolling(window=20).std()
    final_factor_weighted = final_factor * (relative_strength * (volume_average * volatility))
    
    return final_factor_weighted
```
