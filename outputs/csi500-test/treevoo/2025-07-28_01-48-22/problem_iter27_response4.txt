```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Averages
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()

    # Momentum-based factors
    df['Price_Return_10D'] = (df['close'] / df['close'].shift(10)) - 1
    df['Price_Return_50D'] = (df['close'] / df['close'].shift(50)) - 1

    # Volume Weighted Average Price (VWAP)
    df['VWAP'] = (df['amount'] / df['volume']).cumsum() / (df['volume']).cumsum()

    # Relative volume changes
    df['Avg_Volume_30D'] = df['volume'].rolling(window=30).mean()
    df['Volume_Ratio'] = df['volume'] / df['Avg_Volume_30D']

    # Volatility measures
    df['Daily_Range'] = df['high'] - df['low']
    df['Std_Dev_20D'] = df['close'].pct_change().rolling(window=20).std()

    # Composite factors
    df['SMA_Crossover'] = (df['SMA_50'] > df['SMA_200']).astype(int) - (df['SMA_50'] < df['SMA_200']).astype(int)

    # Combine momentum, volume, and volatility
    df['Composite_Factor'] = df['Price_Return_50D'] + (df['Volume_Ratio'] - 1) * df['Std_Dev_20D']

    # Return the composite factor
    return df['Composite_Factor']
```
