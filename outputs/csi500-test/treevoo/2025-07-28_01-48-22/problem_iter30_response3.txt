```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 5-day weighted moving average of closing prices
    weights = np.arange(1, 6)
    wma_5 = df['close'].rolling(window=5).apply(lambda x: (x * weights).sum() / weights.sum(), raw=True)
    
    # Generate a signal based on today's close price compared to the 5-day WMA
    close_wma_signal = np.where(df['close'] > wma_5, 1, -1)
    
    # Calculate the percentage change in closing prices from 10 and 20 days ago
    pct_change_10 = df['close'].pct_change(periods=10)
    pct_change_20 = df['close'].pct_change(periods=20)
    
    # Combine the momentum indicators
    combined_momentum = pct_change_10 + pct_change_20
    
    # Compute the difference between daily close and open prices
    daily_diff = df['close'] - df['open']
    
    # Create a cumulative sum of these differences over the past 20 trading days
    cum_sum_diff = daily_diff.rolling(window=20).sum()
    
    # Introduce a smoothing factor to the cumulative sum
    smooth_factor = 0.9
    smoothed_cum_sum = cum_sum_diff.ewm(alpha=smooth_factor, adjust=False).mean()
    
    # Calculate the 20-day average trading volume
    avg_vol_20 = df['volume'].rolling(window=20).mean()
    
    # Flag volume anomalies (3 standard deviations above the mean)
    vol_std_20 = df['volume'].rolling(window=20).std()
    vol_anomaly = np.where(df['volume'] > (avg_vol_20 + 3 * vol_std_20), 1, 0)
    
    # Combine volume anomaly with the sign of the day's return and the direction of the 5-day WMA
    day_return_sign = np.sign(df['close'] - df['open'])
    vol_signal = vol_anomaly * day_return_sign * np.sign(wma_5 - wma_5.shift(1))
    
    # Calculate the range (high minus low) for each day
    daily_range = df['high'] - df['low']
    
    # Compute the 10-day moving average of these ranges
    avg_range_10 = daily_range.rolling(window=10).mean()
    
    # Relative range calculation
    relative_range = daily_range / avg_range_10
    
    # Incorporate the 5-day WMA into the relative range calculation
    adj_relative_range = relative_range * (df['close'] / wma_5)
    
    # Combine all signals into a final alpha factor
    alpha_factor = (
        0.3 * close_wma_signal +
        0.2 * combined_momentum +
        0.2 * smoothed_cum_sum +
        0.1 * vol_signal +
        0.2 * adj_relative_range
    )
    
    return pd.Series(alpha_factor, index=df.index, name='alpha_factor')
```
