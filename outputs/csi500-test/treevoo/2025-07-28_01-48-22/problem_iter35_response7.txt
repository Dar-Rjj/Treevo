```python
import pandas as pd

def heuristics_v2(df):
    # Momentum Indicator
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['Crossover_Signal'] = (df['SMA_5'] > df['SMA_20']).astype(int)
    
    df['Short_Term_Return'] = (df['close'] / df['close'].shift(5)) - 1
    df['Long_Term_Return'] = (df['close'] / df['close'].shift(20)) - 1
    
    df['Log_Return'] = df['close'].pct_change().apply(lambda x: np.log(1 + x))
    df['Momentum_20'] = df['Log_Return'].rolling(window=20).sum()
    
    df['Intraday_Momentum'] = (df['close'] - df['open']) / df['open'] * df['volume']
    df['Historical_Momentum'] = df['close'] - df['close'].shift(10)
    df['Combined_Momentum'] = df['Intraday_Momentum'] + df['Historical_Momentum']
    df['Smoothed_Combined_Momentum'] = df['Combined_Momentum'].rolling(window=5).mean()
    
    df['Avg_Daily_Range'] = (df['high'] - df['low']).rolling(window=10).mean()
    df['Volatility_Multiplier'] = 1 / (df['Avg_Daily_Range'] + 1)
    df['Adjusted_Smoothed_Momentum'] = df['Smoothed_Combined_Momentum'] * df['Volatility_Multiplier']
    
    # Volume Analysis Factors
    df['Cum_Vol_Price'] = (df['volume'] * df['close']).cumsum()
    df['Total_Cum_Volume'] = df['volume'].cumsum()
    df['VWAP'] = df['Cum_Vol_Price'] / df['Total_Cum_Volume']
    
    df['Volume_Price_Indicator'] = 0.5 * (df['volume'] - df['volume'].shift(1)) + 0.3 * (df['high'] - df['low']).rolling(window=5).mean() + (df['close'] - df['close'].shift(1))
    
    df['Volume_Std'] = df['volume'].rolling(window=10).std()
    df['Mean_Volume'] = df['volume'].rolling(window=10).mean()
    df['Volume_Spike'] = (df['volume'] > (df['Mean_Volume'] + 2 * df['Volume_Std'])).astype(int)
    
    # Market Strength and Sentiment
    df['Up_Periods'] = df['close'].diff().apply(lambda x: max(x, 0))
    df['Down_Periods'] = df['close'].diff().apply(lambda x: abs(min(x, 0)))
    df['Average_Gain'] = df['Up_Periods'].rolling(window=14).mean()
    df['Average_Loss'] = df['Down_Periods'].rolling(window=14).mean()
    df['RS'] = df['Average_Gain'] / df['Average_Loss']
    df['RSI'] = 100 - (100 / (1 + df['RS']))
    
    df['Typical_Price'] = (df['high'] + df['low'] + df['close']) / 3
    df['Raw_Money_Flow'] = df['Typical_Price'] * df['volume']
    df['Positive_Money_Flow'] = df['Raw_Money_Flow'] * (df['close'] > df['close'].shift(1)).astype(int)
    df['Negative_Money_Flow'] = df['Raw_Money_Flow'] * (df['close'] < df['close'].shift(1)).astype(int)
    df['Money_Flow_Ratio'] = df['Positive_Money_Flow'].rolling(window=14).sum() / df['Negative_Money_Flow'].rolling(window=14).sum()
    df['MFI'] = 100 - (100 / (1 + df['Money_Flow_Ratio']))
    
    df['Relative_Strength'] = df['Short_Term_Return'] - df['Long_Term_Return']
    df['RS_Volume_Spike'] = df['Relative_Strength'] * df['Volume_Spike']
    
    # Volatility Measure
    df['True_Range'] = pd.concat([df['high'] - df['low'], 
                                  abs(df['high'] - df['
