```txt
Improved Momentum and Volume Spike Factor
├── Calculate Short-Term Return
│   └── Compute (Close_t / Close_{t-5}) - 1
├── Calculate Long-Term Return
│   └── Compute (Close_t / Close_{t-20}) - 1
├── Calculate Relative Strength
│   └── Subtract Long-Term Return from Short-Term Return
├── Calculate Intraday Return
│   └── Compute (High_t - Low_t) / Low_t
├── Calculate Open-to-Close Return
│   └── Compute (Close_t - Open_t) / Open_t
├── Combine Intraday and Open-to-Close Returns
│   └── Add Intraday Return and Open-to-Close Return
├── Identify Volume Spikes
│   ├── Calculate Median Volume over N Days
│   └── If Current Volume > (Median Volume * K), set Indicator to 1, else 0
├── Multiply Combined Return by Volume Spike Indicator
│   └── Multiply Combined Return by Volume Spike Indicator
└── Weight by Volume and Volatility
    ├── Compute Volume Average
    │   └── Sum Volume from t-4 to t and divide by 5
    ├── Compute Volatility
    │   └── Standard Deviation of (Close - Open) / Open over past 20 days
    └── Multiply Relative Strength by (Volume Average * Volatility)
```
