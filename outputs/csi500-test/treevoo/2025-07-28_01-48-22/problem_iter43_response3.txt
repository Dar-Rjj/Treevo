```python
def heuristics_v2(df):
    # Calculate the range (High - Low)
    df['range'] = df['high'] - df['low']
    
    # Develop a factor using the absolute value of (Close - Open)
    df['gap'] = abs(df['close'] - df['open'])
    
    # Generate a factor by calculating the log return (ln(Close/Prev_Close))
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Formulate a factor from the ratio of (Close - Open) / Volume
    df['price_volume_ratio'] = (df['close'] - df['open']) / df['volume']
    
    # Compute a rolling sum of (Close - Prev_Close) over n-days, here n=5
    df['rolling_sum'] = (df['close'] - df['close'].shift(1)).rolling(window=5).sum()
    
    # Design a factor indicating if (Close > Open) is true or false
    df['direction'] = (df['close'] > df['open']).astype(int)
    
    # Combine all factors into one composite factor
    df['composite_factor'] = (
        df['range'] + 
        df['gap'] + 
        df['log_return'] + 
        df['price_volume_ratio'] + 
        df['rolling_sum'] + 
        df['direction']
    )
    
    return df['composite_factor']
```
