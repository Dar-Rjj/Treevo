```python
import pandas as pd

def heuristics_v2(df):
    # Momentum Factors
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()
    df['SMA_Crossover'] = df['SMA_50'] / df['SMA_200']
    
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    df['EMA_200'] = df['close'].ewm(span=200, adjust=False).mean()
    df['EMA_Crossover'] = df['EMA_50'] / df['EMA_200']
    
    # Volume Indicators
    df['OBV'] = 0
    for i in range(1, len(df)):
        if df['close'].iloc[i] > df['close'].iloc[i-1]:
            df['OBV'].iloc[i] = df['OBV'].iloc[i-1] + df['volume'].iloc[i]
        elif df['close'].iloc[i] < df['close'].iloc[i-1]:
            df['OBV'].iloc[i] = df['OBV'].iloc[i-1] - df['volume'].iloc[i]
        else:
            df['OBV'].iloc[i] = df['OBV'].iloc[i-1]
    df['Volume_Avg_30'] = df['volume'].rolling(window=30).mean()
    df['OBV_Factor'] = df['OBV'] / df['Volume_Avg_30']
    
    df['VWAP_Daily'] = (df['close'] * df['volume']) / df['volume']
    df['VWAP_30'] = df['VWAP_Daily'].rolling(window=30).sum() / df['volume'].rolling(window=30).sum()
    df['VWAP_Factor'] = (df['close'] - df['VWAP_30']) / df['VWAP_30']
    
    # Volatility Factors
    df['TR'] = df[['high', 'low']].apply(lambda x: max(x[0] - x[1], 
                                                        abs(x[0] - df['close'].shift(1)), 
                                                        abs(x[1] - df['close'].shift(1))), axis=1)
    df['ATR_14'] = df['TR'].rolling(window=14).mean()
    df['ATR_Factor'] = df['ATR_14'] / df['close'].rolling(window=14).mean()
    
    # Price Patterns
    df['Inside_Bar'] = ((df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))).astype(int)
    
    df['Engulfing'] = ((df['open'] < df['close']) & (df['open'].shift(1) > df['close'].shift(1)) & 
                       (df['high'] > df['high'].shift(1)) & (df['low'] < df['low'].shift(1))).astype(int)
    
    # Market Sentiment
    df['High_Low_Ratio'] = (df['high'] - df['low']) / (df['high'] + df['low'])
    df['Close_Open_Spread'] = (df['close'] - df['open']) / df['open']
    
    # Combine all factors into a single alpha factor
    df['Alpha_Factor'] = (df['SMA_Crossover'] + 
                          df['EMA_Crossover'] + 
                          df['OBV_Factor'] + 
                          df['VWAP_Factor'] + 
                          df['ATR_Factor'] + 
                          df['Inside_Bar'] + 
                          df['Engulfing'] + 
                          df['High_Low_Ratio'] + 
                          df['Close_Open_Spread']) / 9
    
    return df['Alpha_Factor']
```
