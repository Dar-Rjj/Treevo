```txt
Volume-Weighted Intraday Momentum with Reversal and Volume Surge Indicator
├── Calculate Volume-Weighted Close Price
│   ├── Use Close price
│   └── Use Volume
├── Calculate 5-Day and 20-Day Volume-Weighted Close Price Moving Averages
│   ├── Calculate 5-Day Volume-Weighted Close Price Moving Average
│   │   ├── Use Volume-Weighted Close Price
│   │   └── Use last 5 days
│   └── Calculate 20-Day Volume-Weighted Close Price Moving Average
│       ├── Use Volume-Weighted Close Price
│       └── Use last 20 days
├── Calculate Momentum
│   ├── Use 5-Day Moving Average
│   └── Subtract 20-Day Moving Average
├── Calculate Volume Surge Indicator
│   ├── Use Volume
│   ├── Calculate 5-Day Volume Moving Average
│   │   ├── Use Volume
│   │   └── Use last 5 days
│   ├── Compare Current Volume with 5-Day Volume Moving Average
│   └── If Current Volume > 1.5 * 5-Day Volume Moving Average, set Indicator to 1, else 0
├── Calculate Intraday High-Low Spread
│   ├── Use High price
│   └── Use Low price
│       └── Subtract Low from High
├── Calculate Previous Day's High-Low Spread
│   ├── Use High price (previous day)
│   └── Use Low price (previous day)
│       └── Subtract Low from High
├── Compare Intraday and Previous Day Spreads
│   ├── If Intraday Spread > Previous Day Spread
│   │   └── Signal: Strong Intraday Momentum
│   ├── If Intraday Spread < Previous Day Spread
│   │   └── Signal: Weak Intraday Momentum
│   └── Calculate Intraday Spread Ratio
│       ├── Divide Intraday Spread by Previous Day Spread
├── Calculate Close-to-Open Return
│   ├── Use Close price
│   └── Use Open price
│       └── Subtract Open from Close
├── Combine Signals for Alpha Factor
│   ├── Use Intraday Spread Ratio
│   ├── Use Close-to-Open Return
│   └── Weighted Sum of Intraday Spread Ratio and Close-to-Open Return
│       ├── Assign weights to each component
│       ├── Add the weighted components
│       └── Combined Momentum Score
└── Final Alpha Factor
    ├── Multiply Combined Momentum Score by Volume Surge Indicator
    └── Output the result as the Alpha Factor
```
