```python
import pandas as pd

def heuristics_v2(df):
    # Compute log returns
    df['log_returns'] = (df['close'] / df['close'].shift(1)).apply(lambda x: 0 if x == 0 else np.log(x))
    
    # Compute simple returns
    df['simple_returns'] = (df['close'] / df['close'].shift(1)) - 1
    
    # Calculate moving averages
    df['5_day_MA'] = df['close'].rolling(window=5).mean()
    df['20_day_MA'] = df['close'].rolling(window=20).mean()
    df['60_day_MA'] = df['close'].rolling(window=60).mean()
    
    # Determine price momentum
    df['price_momentum_5_20'] = df['5_day_MA'] - df['20_day_MA']
    df['price_momentum_20_60'] = df['20_day_MA'] - df['60_day_MA']
    
    # Calculate rolling standard deviation of log returns
    df['5_day_log_std'] = df['log_returns'].rolling(window=5).std()
    df['20_day_log_std'] = df['log_returns'].rolling(window=20).std()
    df['60_day_log_std'] = df['log_returns'].rolling(window=60).std()
    
    # Calculate daily volume change
    df['volume_change'] = (df['volume'] / df['volume'].shift(1)) - 1
    
    # Calculate moving averages of volume
    df['5_day_vol_MA'] = df['volume'].rolling(window=5).mean()
    df['20_day_vol_MA'] = df['volume'].rolling(window=20).mean()
    df['60_day_vol_MA'] = df['volume'].rolling(window=60).mean()
    
    # Calculate true range
    df['true_range'] = df[['high', 'low']].apply(lambda x: max(x['high'] - x['low'], abs(x['high'] - df['close'].shift(1)), abs(x['low'] - df['close'].shift(1))), axis=1)
    
    # Calculate average true range
    df['5_day_ATR'] = df['true_range'].rolling(window=5).mean()
    df['20_day_ATR'] = df['true_range'].rolling(window=20).mean()
    df['60_day_ATR'] = df['true_range'].rolling(window=60).mean()
    
    # Calculate open to close difference
    df['open_close_diff'] = df['close'] - df['open']
    
    # Calculate open to close percentage change
    df['open_close_pct_change'] = ((df['close'] - df['open']) / df['open']) * 100
    
    # Calculate intraday price range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate intraday price range percentage
    df['intraday_range_pct'] = ((df['high'] - df['low']) / df['low']) * 100
    
    # Calculate volume-weighted average price
    df['vwap'] = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    
    # Calculate cumulative vwap
    df['5_day_cum_vwap'] = df['vwap'].rolling(window=5).sum()
    df['20_day_cum_vwap'] = df['vwap'].rolling(window=20).sum()
    df['60_day_cum_vwap'] = df['vwap'].rolling(window=60).sum()
    
    # Calculate daily amount change
    df['amount_change'] = (df['amount'] / df['amount'].shift(1)) - 1
    
    # Calculate moving averages of amount
    df['5_day_amount_MA'] = df['amount'].rolling(window=5).mean()
    df['20_day_amount_MA'] = df['amount'].rolling(window=20).mean()
    df['60_day_amount_MA'] = df['amount'].rolling(window=60).mean()
    
    # Create a composite score
    df['composite_score'] = (
        0.3 * df['price_momentum_5_20'] +
        0.2 * df['price_momentum_20_60'] +
        0.1 * df['5_day_log_std'] +
        0.1 * df['20_day_log_std'] +
        0.1 * df['60_day_log_std'] +
        0.1 * df['volume_change'] +
        0.1 * df['open_close_pct_change']
   
