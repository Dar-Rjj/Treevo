```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 5-day weighted moving average of closing prices
    weights = [1, 2, 3, 4, 5]
    df['wma'] = df['close'].rolling(window=5).apply(lambda x: (x * weights).sum() / sum(weights), raw=True)
    
    # Signal based on today's close price vs. 5-day WMA
    df['signal_wma'] = df.apply(lambda row: 1 if row['close'] > row['wma'] else -1, axis=1)

    # Calculate percentage change in closing prices over 10 and 20 days
    df['pct_change_10'] = df['close'].pct_change(10)
    df['pct_change_20'] = df['close'].pct_change(20)
    df['momentum_signal'] = df['pct_change_10'] + df['pct_change_20']

    # Explore the relationship between opening and closing prices
    df['daily_diff'] = df['close'] - df['open']
    df['cumulative_sum'] = df['daily_diff'].rolling(window=20).sum()
    df['smoothed_trend'] = df['cumulative_sum'].ewm(span=5, adjust=False).mean()

    # Utilize volume data to identify unusual trading activity
    df['avg_volume'] = df['volume'].rolling(window=20).mean()
    df['std_volume'] = df['volume'].rolling(window=20).std()
    df['volume_anomaly'] = (df['volume'] - df['avg_volume']) / df['std_volume']
    df['vol_signal'] = df.apply(lambda row: 1 if row['volume_anomaly'] > 3 else (-1 if row['volume_anomaly'] < -3 else 0), axis=1)
    df['combined_vol_signal'] = df['vol_signal'] * df['signal_wma'] * df['return_sign']

    # Investigate volatility using high and low prices
    df['range'] = df['high'] - df['low']
    df['avg_range'] = df['range'].rolling(window=10).mean()
    df['relative_volatility'] = df['range'] / df['avg_range']

    # Generate the final alpha factor
    df['alpha_factor'] = (0.3 * df['signal_wma'] 
                          + 0.3 * df['momentum_signal'] 
                          + 0.2 * df['smoothed_trend'] 
                          + 0.2 * df['combined_vol_signal'] 
                          + 0.1 * df['relative_volatility'])

    return df['alpha_factor']
```
