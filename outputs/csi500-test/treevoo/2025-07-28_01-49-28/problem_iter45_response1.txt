```python
import pandas as pd

def heuristics_v2(df):
    # Calculate raw volatility factor
    df['volatility'] = df['high'] - df['low']
    
    # Calculate raw price movement factor
    df['price_movement'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Calculate raw upper gap factor
    df['upper_gap'] = df['high'] - df['close'].shift(1)
    
    # Calculate raw lower gap factor
    df['lower_gap'] = df['low'] - df['close'].shift(1)
    
    # Calculate raw volume change factor
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate raw volume-price interaction factor
    df['volume_price_interaction'] = df['volume'] * (df['close'] - df['open'])
    
    # Calculate raw volume ratio factor
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    df['volume_ratio'] = df['volume'] / df['avg_volume_20']
    
    # Calculate raw price-volume composite factor
    df['price_volume_composite'] = (df['close'] - df['open']) * df['volume']
    df['price_volume_composite_5'] = df['price_volume_composite'].rolling(window=5).sum()
    
    # Calculate raw gap factor
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Calculate raw dynamic price-volume factor
    df['dynamic_price_volume'] = (df['close'] - df['open']) * df['volume_ratio']
    
    # Define positive money flow
    df['positive_money_flow'] = (df['close'] - df['open']).apply(lambda x: x if x > 0 else 0) * df['volume']
    
    # Define total money flow
    df['total_money_flow'] = (df['close'] - df['open']) * df['volume']
    
    # Calculate raw money flow index
    df['money_flow_index'] = df['positive_money_flow'] / df['total_money_flow']
    
    # Calculate raw amount-price interaction factor
    df['amount_price_interaction'] = df['amount'] * (df['close'] - df['open'])
    
    # Calculate raw transaction size factor
    df['transaction_size'] = df['amount'] / df['volume']
    
    # Calculate raw liquidity factor
    df['liquidity'] = df['amount'] / (df['high'] - df['low'])
    
    # Calculate raw momentum factor
    df['momentum'] = (df['close'] - df['open']) * df['volume_ratio']
    
    # Calculate the average amount over a certain period (e.g., 20 days)
    df['avg_amount_20'] = df['amount'].rolling(window=20).mean()
    
    # Calculate raw amount-based momentum factor
    df['amount_momentum'] = (df['close'] - df['open']) * (df['amount'] / df['avg_amount_20'])
    
    # Select the final alpha factor
    alpha_factor = df['momentum']
    
    return alpha_factor
```
