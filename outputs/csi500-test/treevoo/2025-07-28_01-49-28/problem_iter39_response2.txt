```python
import pandas as pd

def heuristics_v2(df):
    # Calculate raw volatility factor
    df['volatility'] = df['high'] - df['low']
    
    # Calculate raw price movement factor
    df['price_movement'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Calculate raw volume change factor
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate raw volume-price interaction factor
    df['volume_price_interaction'] = df['volume'] * (df['close'] - df['open'])
    
    # Summarize the (close - open) * volume over the last 5 days
    df['price_volume_composite'] = (df['close'] - df['open']) * df['volume']
    df['price_volume_5d'] = df['price_volume_composite'].rolling(window=5).sum()
    
    # Calculate raw gap factor
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Define positive and total money flow
    df['positive_money_flow'] = ((df['close'] > df['open']) * (df['close'] - df['open']) * df['volume']).fillna(0)
    df['total_money_flow'] = (df['close'] - df['open']) * df['volume']
    
    # Calculate raw money flow index
    df['money_flow_index'] = df['positive_money_flow'] / df['total_money_flow']
    
    # Calculate raw transaction size factor
    df['transaction_size'] = df['amount'] / df['volume']
    
    # Calculate raw momentum factor
    avg_volume = df['volume'].rolling(window=20).mean()
    df['momentum'] = (df['close'] - df['open']) * (df['volume'] / avg_volume)
    
    # Calculate percentage change in closing prices over a 20-day period
    df['20d_return'] = df['close'].pct_change(periods=20)
    
    # Calculate 10-day rate of change (ROC) of closing prices
    df['10d_roc'] = df['close'].pct_change(periods=10)
    
    # Calculate 30-day standard deviation of log-returns
    df['log_returns'] = np.log(df['close'] / df['close'].shift(1))
    df['30d_std'] = df['log_returns'].rolling(window=30).std()
    
    # Calculate 14-day relative strength index (RSI)
    df['gain'] = df['close'].diff().clip(lower=0)
    df['loss'] = -df['close'].diff().clip(upper=0)
    df['avg_gain'] = df['gain'].rolling(window=14).mean()
    df['avg_loss'] = df['loss'].rolling(window=14).mean()
    df['rsi'] = 100 - (100 / (1 + df['avg_gain'] / df['avg_loss']))
    
    # Calculate 10-day high and low
    df['10d_high'] = df['high'].rolling(window=10).max()
    df['10d_low'] = df['low'].rolling(window=10).min()
    
    # Calculate proximity to 10-day range
    df['proximity_high'] = (df['close'] - df['10d_high']) / (df['10d_high'] - df['10d_low'])
    df['proximity_low'] = (df['close'] - df['10d_low']) / (df['10d_high'] - df['10d_low'])
    
    # Invert minimum proximity
    df['min_proximity_inv'] = 1 / (df[['proximity_high', 'proximity_low']].abs().min(axis=1))
    
    # Adjust for 20-day volatility
    df['20d_volatility'] = df['close'].rolling(window=20).std()
    df['adjusted_proximity'] = df['min_proximity_inv'] / df['20d_volatility']
    
    # Calculate open-high and open-low differences
    df['open_high_diff'] = df['high'] - df['open']
    df['open_low_diff'] = df['open'] - df['low']
    
    # Weighted average by volume
    df['weighted_avg'] = (df['open_high_diff'] * df['volume'] + df['open_low_diff'] * df['volume']) / (2 * df['volume'])
    
    # Amount per unit close price rate of change with volume-weighted adjustments
    df['amount_per_close
