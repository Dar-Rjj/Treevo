```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the change in close price
    df['close_change'] = df['close'].diff()
    
    # Calculate the average of high and low
    df['avg_high_low'] = (df['high'] + df['low']) / 2
    
    # Calculate the percentage difference between close and the average of high and low
    df['close_avg_diff_percent'] = (df['close'] - df['avg_high_low']) / df['avg_high_low']
    
    # Calculate the ratio of volume to amount
    df['volume_amount_ratio'] = df['volume'] / df['amount']
    
    # Calculate the factor as a weighted sum of the above metrics
    df['factor'] = 0.4 * df['close_change'] + 0.3 * df['close_avg_diff_percent'] + 0.3 * df['volume_amount_ratio']
    
    # Return the factor as a pandas Series
    return df['factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date')
# factor_values = heuristics_v2(df)
```
