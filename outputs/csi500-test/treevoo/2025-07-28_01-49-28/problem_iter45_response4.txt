```python
import pandas as pd

def heuristics_v2(df):
    # Momentum-Based Alpha Factors
    def simple_moving_average(df, period, column='close'):
        return df[column].rolling(window=period).mean()
    
    def exponential_moving_average(df, period, column='close'):
        return df[column].ewm(span=period, adjust=False).mean()
    
    def rate_of_change(df, period, column='close'):
        return (df[column] / df[column].shift(period) - 1) * 100
    
    sma_5 = simple_moving_average(df, 5)
    sma_10 = simple_moving_average(df, 10)
    sma_20 = simple_moving_average(df, 20)
    
    ema_5 = exponential_moving_average(df, 5)
    ema_10 = exponential_moving_average(df, 10)
    ema_20 = exponential_moving_average(df, 20)
    
    roc_5 = rate_of_change(df, 5)
    roc_10 = rate_of_change(df, 10)
    roc_20 = rate_of_change(df, 20)
    
    # Volume-Based Alpha Factors
    def on_balance_volume(df):
        obv = df['volume'].copy()
        obv[0] = 0
        for i in range(1, len(df)):
            if df.close.iloc[i] > df.close.iloc[i-1]:
                obv[i] = obv[i-1] + df.volume.iloc[i]
            elif df.close.iloc[i] < df.close.iloc[i-1]:
                obv[i] = obv[i-1] - df.volume.iloc[i]
            else:
                obv[i] = obv[i-1]
        return obv
    
    def vpin(df):
        vup = df[df['close'] > df['close'].shift(1)]['volume']
        vdown = df[df['close'] < df['close'].shift(1)]['volume']
        return (vup.rolling(window=10).sum() - vdown.rolling(window=10).sum()) / df['volume'].rolling(window=10).sum()
    
    def volume_weighted_average_price(df):
        return (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    
    obv = on_balance_volume(df)
    vpin_factor = vpin(df)
    vwap = volume_weighted_average_price(df)
    
    # Price Pattern-Based Alpha Factors
    def donchian_channels(df, period=20):
        upper_band = df['high'].rolling(window=period).max()
        lower_band = df['low'].rolling(window=period).min()
        mid_point = (upper_band + lower_band) / 2
        return upper_band, lower_band, mid_point
    
    def bollinger_bands(df, period=20, std_dev=2):
        middle_band = df['close'].rolling(window=period).mean()
        std_deviation = df['close'].rolling(window=period).std()
        upper_band = middle_band + (std_dev * std_deviation)
        lower_band = middle_band - (std_dev * std_deviation)
        return upper_band, lower_band, std_deviation
    
    upper_dc, lower_dc, mid_dc = donchian_channels(df)
    upper_bb, lower_bb, std_dev_bb = bollinger_bands(df)
    
    # Volatility-Based Alpha Factors
    def historical_volatility(df, period):
        returns = df['close'].pct_change()
        return returns.rolling(window=period).std() * (252 ** 0.5)
    
    def average_true_range(df, period=14):
        tr = df[['high', 'low']].diff().abs().max(axis=1)
        tr['close'] = (df['close'].shift(-1) - df['open']).abs()
        true_range = tr.max(axis=1)
        return true_range.rolling(window=period).mean()
    
    hv_20 = historical_volatility(df, 20)
    hv_50 = historical_volatility(df, 50)
    
    atr_14 = average_true_range(df, 14)
    atr_28 = average_true_range(df, 28)
    
    # Relative Strength-Based Alpha Factors
    def relative_strength_index(df, period=14):
        delta = df['close'].diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
        rs = gain / loss
        rsi = 100 - (
