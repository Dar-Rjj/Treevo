```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the average of high and low prices
    avg_price = (df['high'] + df['low']) / 2
    
    # Calculate the signed volume, which is the volume multiplied by the sign of the price change
    signed_volume = df['volume'] * ((df['close'] - df['open']).apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0))
    
    # Calculate the weighted amount, which is the amount multiplied by the ratio of close to open
    weighted_amount = df['amount'] * (df['close'] / df['open'])
    
    # Combine the above metrics into a single factor
    # The factor is based on the hypothesis that the combination of average price, signed volume, and weighted amount
    # can capture both the momentum and the trading activity around the stock.
    factor = avg_price * signed_volume + weighted_amount
    
    return factor
```
