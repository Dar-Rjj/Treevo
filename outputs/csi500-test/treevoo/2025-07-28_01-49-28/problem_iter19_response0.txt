```python
import pandas as pd

def heuristics_v2(df):
    # Calculate short-term and long-term simple moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Compute the difference between short-term and long-term SMAs
    df['SMA_diff'] = df['SMA_5'] - df['SMA_20']
    
    # Calculate daily, weekly, and monthly returns
    df['daily_return'] = df['close'].pct_change()
    df['weekly_return'] = df['close'].pct_change(periods=5)
    df['monthly_return'] = df['close'].pct_change(periods=20)
    
    # Generate a weighted sum of returns over different periods
    df['weighted_returns'] = (df['daily_return'] * 0.3 + 
                              df['weekly_return'] * 0.5 + 
                              df['monthly_return'] * 0.2)
    
    # Measure the gap up or down (open - close of the previous day)
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Calculate On-Balance Volume (OBV)
    obv = [0]
    for i in range(1, len(df)):
        if df['close'][i] > df['close'][i-1]:
            obv.append(obv[-1] + df['volume'][i])
        elif df['close'][i] < df['close'][i-1]:
            obv.append(obv[-1] - df['volume'][i])
        else:
            obv.append(obv[-1])
    df['OBV'] = obv
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['SMA_diff'] + 
                          df['weighted_returns'] + 
                          df['gap'] + 
                          df['OBV'])
    
    return df['alpha_factor']
```
