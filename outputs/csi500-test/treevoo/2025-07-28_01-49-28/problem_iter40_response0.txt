```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the percentage change from open to close
    pct_change_open_close = df['close'] / df['open'] - 1
    
    # Measure the range (high - low) as a factor of stock volatility
    daily_range = df['high'] - df['low']
    
    # Identify days with significantly higher or lower volume compared to a moving average
    avg_volume = df['volume'].rolling(window=20).mean()
    volume_deviation = (df['volume'] - avg_volume) / avg_volume
    
    # Create a factor based on the momentum using close prices over the last N days
    momentum = df['close'].pct_change(periods=5)
    
    # Incorporate the rate of change in closing prices as a signal
    rate_of_change_close = df['close'].pct_change(periods=1)
    
    # Consider the ratio of trading amount to average trading amount over a period
    avg_amount = df['amount'].rolling(window=20).mean()
    amount_ratio = df['amount'] / avg_amount
    
    # Create a factor that measures the correlation between the percentage change from open to close and the volume change
    corr_open_close_volume = pct_change_open_close.rolling(window=20).corr(volume_deviation)
    
    # Calculate the standard deviation of the percentage change from open to close over a rolling window
    std_pct_change_open_close = pct_change_open_close.rolling(window=20).std()
    
    # Construct a factor that evaluates the gap between the closing price and the average of the high and low prices
    gap_close_avg_high_low = df['close'] - (df['high'] + df['low']) / 2
    
    # Determine if stocks that close near their high or low tend to have different future returns
    close_near_high = (df['close'] - df['high']).abs() < (df['high'] - df['low']) * 0.1
    close_near_low = (df['close'] - df['low']).abs() < (df['high'] - df['low']) * 0.1
    
    # Create a factor that captures the direction and magnitude of intraday price trends
    intraday_trend = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Develop a factor based on the frequency and magnitude of intraday price reversals
    reversal_magnitude = (df['high'] - df['close']) / (df['high'] - df['low'])
    
    # Create a factor that identifies days with significant volume spikes and their subsequent price movement
    volume_spike = (df['volume'] > avg_volume * 2).astype(int)
    
    # Combine the most promising individual factors into a composite alpha factor
    composite_factor = (
        pct_change_open_close + 
        daily_range + 
        volume_deviation + 
        momentum + 
        rate_of_change_close + 
        amount_ratio + 
        corr_open_close_volume + 
        std_pct_change_open_close + 
        gap_close_avg_high_low + 
        (close_near_high - close_near_low) + 
        intraday_trend + 
        reversal_magnitude + 
        volume_spike
    )
    
    return composite_factor
```
