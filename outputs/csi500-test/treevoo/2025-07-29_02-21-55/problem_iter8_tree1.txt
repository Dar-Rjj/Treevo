```txt
Improved Momentum and Volume Indicator with Price Oscillation and Long-Term Trend Integration
├── Calculate Intraday High-to-Low Percentage Change
│   ├── Use High price
│   └── Use Low price
├── Incorporate Volume Spike
│   ├── Calculate Volume Change Ratio
│   │   ├── Use Current Day's Volume
│   │   └── Use Previous Day's Volume
│   └── Compute Combined Indicator
│       ├── Multiply Intraday High-to-Low % by Volume Ratio
│       └── Apply Threshold to Identify Significant Movements
│           ├── Set a Fixed Threshold
│           └── Adjust for Market Volatility (Use Moving Standard Deviation of Daily Returns)
│               ├── Calculate 20-Day Moving Standard Deviation
│               │   ├── Use Close Prices
├── Confirm with Price Momentum
    ├── Calculate Price Momentum
    │   ├── Determine the Lookback Period (e.g., 20 days)
    │   │   ├── Use Close prices
    │   │   └── Compute the Simple Moving Average (SMA) of Close prices
    │   └── Calculate the Momentum Score
    │       ├── Use Current Close price
    │       └── Subtract the SMA from the Current Close price
├── Apply Moving Averages to Intraday Momentum
│   ├── Fast Exponential Moving Average
│   │   ├── Use Intraday High-to-Low Momentum
│   │   └── Set Shorter Period
│   └── Slow Exponential Moving Average
│       ├── Use Intraday High-to-Low Momentum
│       └── Set Longer Period
├── Calculate 20-day Moving Average of Daily Log Returns
│   ├── Use Close price from day t-20 to day t
│   └── Compute Log Returns
│       └── Sum the Log Returns
│           └── Divide by 20
├── Calculate 20-day Exponential Moving Average of Volume
│   ├── Use Volume from day t-20 to day t
│   └── Apply Exponential Weighting
│       └── Use Smoothing Factor (e.g., 0.1)
├── Adjust Intraday Momentum by Volume and Long-Term Price Trend
│   ├── Multiply Fast Exponential Moving Average of Intraday Momentum by 20-day Moving Average of Daily Log Returns
│   ├── Divide by 20-day Exponential Moving Average of Volume
│   └── Subtract Slow Exponential Moving Average of Intraday Momentum
├── Smooth the Adjusted Intraday Momentum
│   ├── Apply a 5-day Simple Moving Average
│   │   └── Use Adjusted Intraday Momentum from day t-5 to day t
├── Incorporate Price Oscillation and Volume Confirmation
    ├── Calculate Volume Confirmation
    │   ├── Use Volume
    │   │   ├── Day t Volume
    │   │   └── Day t-1 to t-20 Average Volume
    │   └── Compute Volume Ratio
    │       ├── Compare with 1
    │       │   ├── Volume Ratio > 1
    │       │   └── Set to 1
    │       ├── Compare with < 1
    │       │   ├── Volume Ratio < 1
    │       │   └── Set to -1
    │       └── Otherwise
    │           └── Set to 0
    ├── Incorporate Price Oscillation
    │   ├── Use High and Low prices
    │   │   ├── Day t High price
    │   │   ├── Day t Low price
    │   │   ├── Day t-19 High price
    │   │   └── Day t-19 Low price
    │   └── Compute 20-day Price Range Difference
    │       ├── Compute 20-day Maximum Range
    │       │   ├── Max of (Day t to t-19 High price)
    │       │   └── Min of (Day t to t-19 Low price)
    │       ├── Compute 20-day Actual Range
    │       │   ├── Day t High price - Day t-19 Low price
    │       │   └── Subtract 20-day Maximum Range
    │       └── Determine Oscillation Score
    │           ├── Compare 20-day Actual Range with 20-day Maximum Range
    │           │   ├── If 20-day Actual Range > 50% of 220-day Maximum Range
    │           │   │   └── Set to 1
    │           │   ├── If 20-day Actual Range < 20% of 20-day Maximum
