```txt
Integrated Intraday and Long-Term Momentum Adjusted by Volume and MACD
├── Calculate 20-day Return
│   ├── Day t Close price
│   └── Day t-20 Close price
├── Compute Intraday High-to-Low Momentum
│   ├── Use High price
│   └── Use Low price
├── Adjust by Intraday Volume Change
│   ├── Use Volume at Day t
│   └── Use Volume at Day (t-1)
├── Apply Moving Averages to Volume-Adjusted Intraday Momentum
│   ├── Fast Exponential Moving Average
│   │   ├── Use Volume-Adjusted Intraday Momentum
│   │   └── Set Shorter Period
│   └── Slow Exponential Moving Average
│       ├── Use Volume-Adjusted Intraday Momentum
│       └── Set Longer Period
├── Calculate 20-day Moving Average of Daily Log Returns
│   ├── Use Close price from day t-20 to day t
│   └── Compute Log Returns
│       └── Sum the Log Returns
│           └── Divide by 20
├── Calculate 5-day Moving Average of Daily Close Price
│   ├── Use Close price from day t-5 to day t
│   └── Compute Simple Moving Average
├── Calculate 20-day Exponential Moving Average of Amount
│   ├── Use Amount from day t-20 to day t
│   └── Apply Exponential Weighting
│       └── Use Smoothing Factor (e.g., 0.1)
├── Volume Confirmation and Long-Term Volume Trend
│   ├── Day t Volume
│   ├── Day t-1 to t-20 Average Volume
│   │   └── Volumes from day t-20 to day t
│   ├── Volume Ratio
│   │   ├── Compare with 1
│   │   ├── Compare with < 1
│   │   └── Set to 0 if not 1 or -1
│   └── 20-day Exponential Moving Average of Volume
│       └── Use Smoothing Factor (e.g., 0.1)
├── Adjust Fast and Slow Exponential Moving Averages by Amount, Long-Term Price Trend, and Volume Trends
│   ├── Multiply Fast Exponential Moving Average of Volume-Adjusted Intraday Momentum by 20-day Moving Average of Daily Log Returns
│   ├── Divide by 20-day Exponential Moving Average of Amount
│   ├── Subtract Slow Exponential Moving Average of Volume-Adjusted Intraday Momentum
│   └── Add 5-day Moving Average of Daily Close Price
└── Smooth the Adjusted Combined Momentum
    ├── Apply a 5-day Simple Moving Average
    │   └── Use Adjusted Intraday Momentum from day t-5 to day t
    ├── Combine Momentum Indicators with MACD
    │   ├── Calculate Daily Range
    │   │   ├── Use High price
    │   │   └── Subtract Low price
    │   ├── Calculate Long-Term Momentum
    │   │   ├── Use Close price
    │   │   ├── Subtract Close price 21 days ago
    │   │   └── Divide by Daily Range average over 21 days
    │   ├── Calculate Short-Term Momentum
    │   │   ├── Use Close price
    │   │   ├── Subtract Close price 6 days ago
    │   │   └── Divide by Daily Range average over 7 days
    │   ├── Weighted Momentum Sum
    │   │   ├── Multiply Long-Term Momentum by 0.55
    │   │   ├── Multiply Short-Term Momentum by 0.45
    │   │   └── Sum the weighted momentums
    │   ├── Calculate MACD
    │   │   ├── Subtract Slow EMA from Fast EMA
    │   └── Final Indicator
    │       ├── Add MACD difference to the weighted momentum sum
    │       ├── Incorporate Volume Spike
    │       │   ├── Calculate Volume Change Ratio
    │       │   │   ├── Use Current Day's Volume
    │       │   │   └── Use Previous Day's Volume
    │       │   └── Adjust for Market Volatility (Use Moving Standard Deviation of Daily Returns)
    │       │       ├── Calculate 21-Day Moving Standard Deviation
    │       │       │   ├── Use Close Prices
    └── Output the Final Alpha Factor
```
