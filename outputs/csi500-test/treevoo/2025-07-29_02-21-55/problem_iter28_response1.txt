```python
import pandas as pd

def heuristics_v2(df):
    # Compute the daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Simple moving average of the 5-day smoothed returns over a 20-day period
    df['sma_5d_smoothed'] = df['daily_return'].rolling(window=5).mean().rolling(window=20).mean()
    
    # Factor comparing today's 20-day SMA with the SMA from 10 days ago
    df['trend_strength'] = df['sma_5d_smoothed'] - df['sma_5d_smoothed'].shift(10)
    
    # Adjust the factor by subtracting the 50-day SMA of the 20-day SMA
    df['adjusted_trend_strength'] = df['trend_strength'] - df['sma_5d_smoothed'].rolling(window=50).mean()

    # Calculate the volume ratio
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Construct a factor by multiplying the adjusted price trend factor with the volume ratio
    df['price_trend_volume_factor'] = df['adjusted_trend_strength'] * df['volume_ratio']

    # Factor by taking the difference between the upper and lower shadow lengths
    df['shadow_length_diff'] = (df['high'] - df[['open', 'close']].max(axis=1)) - (df[['open', 'close']].min(axis=1) - df['low'])

    # Generate a factor by dividing the current day's trading amount by the 14-day Average True Amount
    df['average_true_amount'] = df['amount'].rolling(window=14).mean()
    df['amount_factor'] = df['amount'] / df['average_true_amount']

    # Combine all factors
    df['final_factor'] = df['price_trend_volume_factor'] + df['shadow_length_diff'] + df['amount_factor']
    
    return df['final_factor']
```
