```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily price change
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Compute 5-day smoothed returns
    df['smoothed_5day_return'] = df['daily_return'].rolling(window=5).mean()
    
    # Compute 20-day SMA of 5-day smoothed returns
    df['sma_20day_smoothed_return'] = df['smoothed_5day_return'].rolling(window=20).mean()
    
    # Compute 10-day lagged 20-day SMA
    df['sma_20day_smoothed_return_lag10'] = df['sma_20day_smoothed_return'].shift(10)
    
    # Compute 50-day SMA of the 20-day SMA
    df['sma_50day_20day_sma'] = df['sma_20day_smoothed_return'].rolling(window=50).mean()
    
    # Compute 10-day SMA of 5-day smoothed returns
    df['sma_10day_smoothed_return'] = df['smoothed_5day_return'].rolling(window=10).mean()
    
    # Adjusted price trend factor
    df['price_trend_factor'] = (df['sma_20day_smoothed_return'] - df['sma_20day_smoothed_return_lag10']) - (df['sma_20day_smoothed_return'] - df['sma_50day_20day_sma'])
    
    # Momentum adjustment
    df['momentum_adjustment'] = df['sma_20day_smoothed_return'] - df['sma_10day_smoothed_return']
    df['price_trend_factor'] += df['momentum_adjustment']
    
    # Volume ratio
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Volume surge factor using 5-day EMA
    df['volume_surge_factor'] = df['volume_ratio'].ewm(span=5, adjust=False).mean()
    
    # Price and volume combined factor
    df['price_volume_factor'] = df['price_trend_factor'] * df['volume_ratio']
    
    # Intraday price movements
    df['upper_shadow'] = df['high'] - df[['open', 'close']].max(axis=1)
    df['lower_shadow'] = df[['open', 'close']].min(axis=1) - df['low']
    df['shadow_difference'] = df['upper_shadow'] - df['lower_shadow']
    
    # Untraded range factor
    df['untraded_range'] = (df['high'] - df['low'] - abs(df['open'] - df['close'])) / (df['high'] - df['low'])
    
    # Trading amount factor
    df['average_true_amount'] = df['amount'].rolling(window=14).mean()
    df['amount_ratio'] = df['amount'] / df['average_true_amount']
    df['amount_ema_14'] = df['amount'].ewm(span=14, adjust=False).mean()
    
    # Final alpha factor
    df['alpha_factor'] = df['price_volume_factor'] + df['volume_surge_factor'] + df['shadow_difference'] * df['untraded_range'] + df['amount_ratio'] - df['amount_ema_14']
    
    return df['alpha_factor']
```
