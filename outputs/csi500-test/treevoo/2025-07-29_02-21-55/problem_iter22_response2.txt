```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the rate of change (ROC) for the close price over the last 21 days
    df['ROC_21'] = df['close'].pct_change(periods=21)
    
    # Calculate the volume ratio: current day's volume divided by the average volume of the past 20 days
    df['Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Calculate the historical volatility as the standard deviation of daily returns over the last 30 days
    df['Daily_Returns'] = df['close'].pct_change()
    df['Historical_Volatility'] = df['Daily_Returns'].rolling(window=30).std()
    
    # Calculate the Average True Range (ATR) over the past 14 days
    df['True_Range'] = df[['high', 'low', 'close']].diff(axis=1).max(axis=1)
    df['ATR_14'] = df['True_Range'].rolling(window=14).mean()
    
    # Calculate the RSI based on a 14-day period
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI_14'] = 100 - (100 / (1 + rs))
    
    # Calculate the MACD and signal line
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = ema_12 - ema_26
    df['Signal_Line'] = df['MACD'].ewm(span=9, adjust=False).mean()
    
    # Identify bullish and bearish engulfing patterns
    df['Bullish_Engulfing'] = (df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1))
    df['Bearish_Engulfing'] = (df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1))
    
    # Calculate days since the last new 52-week high or low
    df['Days_Since_52_High'] = (df['close'] == df['close'].rolling(window=252).max()).astype(int).cumsum()
    df['Days_Since_52_Low'] = (df['close'] == df['close'].rolling(window=252).min()).astype(int).cumsum()
    
    # Calculate the distance from the 52-week high or low expressed as a percentage of the current price
    df['Pct_Distance_52_High'] = (df['close'].rolling(window=252).max() - df['close']) / df['close']
    df['Pct_Distance_52_Low'] = (df['close'] - df['close'].rolling(window=252).min()) / df['close']
    
    # Calculate Net Tick Volume (NTV): difference between the current day's amount and the previous day's, normalized by the current day's volume
    df['NTV'] = (df['amount'] - df['amount'].shift(1)) / df['volume']
    
    # Count the frequency of touches to the daily high or low within a 14-day window
    df['Touch_High'] = (df['high'] == df['close']).rolling(window=14).sum()
    df['Touch_Low'] = (df['low'] == df['close']).rolling(window=14).sum()
    
    # Calculate the return on the same calendar day across years
    df['Date'] = df.index
    df['Year'] = df['Date'].dt.year
    df['Month'] = df['Date'].dt.month
    df['Day'] = df['Date'].dt.day
    df['Calendar_Return'] = df.groupby(['Month', 'Day'])['Daily_Returns'].transform('mean')
    
    # Calculate the monthly return effect
    df['Monthly_Return'] = df.groupby('Month')['Daily_Returns'].transform('mean')
    
    # Generate the final alpha factor as a weighted sum of selected features
    alpha_factor = (
        0.2 * df['ROC_21'] +
        0.1 * df
