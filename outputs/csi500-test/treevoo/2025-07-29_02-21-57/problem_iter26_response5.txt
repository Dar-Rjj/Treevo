```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Averages (SMA)
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate Exponential Moving Averages (EMA)
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Calculate On-Balance Volume (OBV)
    df['OBV'] = (df['close'] > df['close'].shift(1)).astype(int) * df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    # Calculate Volume Weighted Average Price (VWAP)
    df['VWAP'] = (df['amount'] / df['volume']).cumsum() / (df['volume']).cumsum()
    
    # Detect crossovers between short and long-term moving averages
    df['SMA_5_10_Crossover'] = (df['SMA_5'] > df['SMA_10']).astype(int)
    df['EMA_10_20_Crossover'] = (df['EMA_10'] > df['EMA_20']).astype(int)
    
    # Calculate RSI
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Identify overbought and oversold conditions
    df['Overbought'] = (df['RSI'] > 70).astype(int)
    df['Oversold'] = (df['RSI'] < 30).astype(int)
    
    # Detect bullish and bearish engulfing patterns
    df['Bullish_Engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['close'] > df['high'].shift(1)) & (df['open'] < df['low'].shift(1))).astype(int)
    df['Bearish_Engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] < df['open'].shift(1)) & (df['close'] < df['low'].shift(1)) & (df['open'] > df['high'].shift(1))).astype(int)
    
    # Identify doji, hammer, and shooting star formations
    df['Doji'] = (abs(df['close'] - df['open']) / (df['high'] - df['low']) < 0.1).astype(int)
    df['Hammer'] = ((df['close'] - df['low']) / (df['high'] - df['low']) > 0.6) & ((df['open'] - df['low']) / (df['high'] - df['low']) > 0.6) & (df['close'] > df['open'])
    df['Shooting_Star'] = ((df['high'] - df['close']) / (df['high'] - df['low']) > 0.6) & ((df['high'] - df['open']) / (df['high'] - df['low']) > 0.6) & (df['open'] > df['close'])
    
    # Measure the size of gaps
    df['Gap_Size'] = df['open'] - df['close'].shift(1)
    df['Up_Gap'] = (df['Gap_Size'] > 0).astype(int)
    df['Down_Gap'] = (df['Gap_Size'] < 0).astype(int)
    
    # Create a trend strength factor by combining SMA, EMA, and OBV
    df['Trend_Strength'] = (df['SMA_5_10_Crossover'] + df['EMA_10_20_Crossover'] + (df['OBV'] > df['OBV'].
