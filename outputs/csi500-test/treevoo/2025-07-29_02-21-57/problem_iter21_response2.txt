```python
import pandas as pd

def heuristics_v2(df):
    # Price-Based Features
    df['MA5'] = df['close'].rolling(window=5).mean()
    df['MA20'] = df['close'].rolling(window=20).mean()
    df['MA60'] = df['close'].rolling(window=60).mean()
    
    df['EMA10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA30'] = df['close'].ewm(span=30, adjust=False).mean()
    df['EMA90'] = df['close'].ewm(span=90, adjust=False).mean()
    
    df['DailyRange'] = df['high'] - df['low']
    df['DailyReturn'] = (df['close'] - df['open']) / df['open']

    # Volume-Based Features
    df['VolumeMA5'] = df['volume'].rolling(window=5).mean()
    df['VolumeMA20'] = df['volume'].rolling(window=20).mean()
    df['VolumeMA60'] = df['volume'].rolling(window=60).mean()
    df['VolumeRatio'] = df['volume'] / df['VolumeMA20']

    # Momentum and Reversal Indicators
    df['ROC10'] = df['close'].pct_change(periods=10)
    df['ROC30'] = df['close'].pct_change(periods=30)
    df['ROC90'] = df['close'].pct_change(periods=90)

    def rsi(series, period):
        delta = series.diff(1)
        gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    df['RSI14'] = rsi(df['close'], 14)
    df['RSI21'] = rsi(df['close'], 21)
    df['RSI50'] = rsi(df['close'], 50)

    # Volatility-Based Features
    df['StdDev10'] = df['DailyReturn'].rolling(window=10).std()
    df['StdDev30'] = df['DailyReturn'].rolling(window=30).std()
    df['StdDev90'] = df['DailyReturn'].rolling(window=90).std()

    df['UpperBand'] = df['MA20'] + 2 * df['StdDev10']
    df['LowerBand'] = df['MA20'] - 2 * df['StdDev10']

    # Advanced Features
    df['OBV'] = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0)) * df['volume']
    df['OBV'] = df['OBV'].cumsum()

    def money_flow_index(high, low, close, volume, n):
        typical_price = (high + low + close) / 3
        money_flow = typical_price * volume
        positive_money_flow = money_flow.where(typical_price > typical_price.shift(1), 0)
        negative_money_flow = money_flow.where(typical_price < typical_price.shift(1), 0)
        mf_ratio = positive_money_flow.rolling(window=n).sum() / negative_money_flow.rolling(window=n).sum()
        mfi = 100 - (100 / (1 + mf_ratio))
        return mfi

    df['MFI14'] = money_flow_index(df['high'], df['low'], df['close'], df['volume'], 14)
    df['MFI21'] = money_flow_index(df['high'], df['low'], df['close'], df['volume'], 21)
    df['MFI50'] = money_flow_index(df['high'], df['low'], df['close'], df['volume'], 50)

    # Combine all features into a single alpha factor
    alpha_factor = (
        df['MA5'] + 
        df['MA20'] + 
        df['MA60'] + 
        df['EMA10'] + 
        df['EMA30'] + 
        df['EMA90'] + 
        df['DailyRange'] + 
        df['DailyReturn'] + 
        df['VolumeMA5'] + 
        df['VolumeMA20'] + 
        df['VolumeMA60'] + 
        df['
