```python
import pandas as pd

def heuristics_v2(df, n_days=20, alpha=0.3):
    # Calculate Raw Momentum
    df['raw_momentum'] = df['close'] - df['close'].shift(n_days)
    
    # Volume Weighted Momentum
    total_volume_n_days = df['volume'].rolling(window=n_days).sum()
    df['volume_weighted_momentum'] = (df['raw_momentum'] * df['volume']) / total_volume_n_days
    
    # EMA Smoothing
    ema = [df['volume_weighted_momentum'].iloc[n_days-1]]  # Initialize with the first value
    for i in range(n_days, len(df)):
        ema_today = (df['volume_weighted_momentum'].iloc[i] * alpha) + (ema[-1] * (1 - alpha))
        ema.append(ema_today)
    
    # Assign EMA values to the DataFrame
    df['factor_value'] = pd.Series(ema, index=df.index[n_days-1:])
    
    return df['factor_value']
```
