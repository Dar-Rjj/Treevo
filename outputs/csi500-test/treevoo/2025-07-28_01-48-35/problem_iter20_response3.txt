```python
def heuristics_v2(df):
    # Calculate the price range and the real body
    price_range = df['high'] - df['low']
    real_body = abs(df['close'] - df['open'])
    
    # Calculate the upper and lower shadow
    upper_shadow = df['high'] - df[['close', 'open']].max(axis=1)
    lower_shadow = df[['close', 'open']].min(axis=1) - df['low']

    # Calculate a factor based on the ratio of the real body to the price range
    factor1 = real_body / price_range
    
    # Calculate a factor based on the ratio of the upper shadow to the lower shadow
    factor2 = upper_shadow / lower_shadow
    
    # Combine the two factors using a weighted sum
    alpha_factor = 0.7 * factor1 + 0.3 * factor2

    return alpha_factor
```
