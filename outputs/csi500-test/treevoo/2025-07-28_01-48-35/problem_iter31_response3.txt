```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Change as (Close - Open)
    df['price_change'] = df['close'] - df['open']
    
    # Generate Factor: Sum of Daily Price Changes over a 10-day Window
    df['sum_10d_price_change'] = df['price_change'].rolling(window=10).sum()
    
    # Generate Factor: Average of Daily Price Changes over a 20-day Window
    df['avg_20d_price_change'] = df['price_change'].rolling(window=20).mean()
    
    # Evaluate Momentum by Considering High and Low Prices
    # Generate Factor: Difference between 10-day Moving Averages of Highs and Lows
    df['ma_10d_high'] = df['high'].rolling(window=10).mean()
    df['ma_10d_low'] = df['low'].rolling(window=10).mean()
    df['diff_ma_10d_high_low'] = df['ma_10d_high'] - df['ma_10d_low']
    
    # Generate Factor: Ratio of Current Day's High to 30-day Average High
    df['ma_30d_high'] = df['high'].rolling(window=30).mean()
    df['ratio_curr_to_30d_avg_high'] = df['high'] / df['ma_30d_high']
    
    # Explore Volume Patterns and Its Impact on Market Sentiment
    # Generate Factor: Cumulative Volume Change over a 5-day Period
    df['volume_change'] = df['volume'].pct_change()
    df['cum_vol_change_5d'] = df['volume_change'].rolling(window=5).sum()
    
    # Generate Factor: Count of Consecutive Days with Increasing Volume
    df['vol_increasing'] = (df['volume'] > df['volume'].shift(1)).astype(int)
    df['consecutive_vol_increase'] = df['vol_increasing'].groupby(
        (df['vol_increasing'] != df['vol_increasing'].shift()).cumsum()).cumsum()
    
    # Generate Factor: Difference in Volume when Price is Up vs. Down over 20 days
    df['up_day'] = ((df['close'] > df['open']).astype(int) * df['volume'])
    df['down_day'] = ((df['close'] < df['open']).astype(int) * df['volume'])
    df['volume_diff_up_down_20d'] = df['up_day'].rolling(window=20).sum() - df['down_day'].rolling(window=20).sum()
    
    # Generate Factor: Maximum Volume over the Past 10 Days Relative to 100-Day Average
    df['max_vol_10d'] = df['volume'].rolling(window=10).max()
    df['ma_100d_volume'] = df['volume'].rolling(window=100).mean()
    df['rel_max_vol_10d_100d_ma'] = df['max_vol_10d'] / df['ma_100d_volume']
    
    # Combine Price and Volume Indicators for Enhanced Signals
    # Generate Factor: Volume-Weighted Average Price (VWAP) over Last 10 Days
    df['vwap_10d'] = (df['close'] * df['volume']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    
    # Generate Factor: Deviation of Close from VWAP over a 30-day Period
    df['dev_close_from_vwap_30d'] = df['close'] - df['vwap_10d'].rolling(window=30).mean()
    
    # Generate Factor: Average Close Price on Days with Volume > 2 * 30-day Average Volume
    df['thirty_d_avg_vol'] = df['volume'].rolling(window=30).mean()
    df['close_on_high_vol_days'] = (df['volume'] > 2 * df['thirty_d_avg_vol']) * df['close']
    df['avg_close_high_vol'] = df['close_on_high_vol_days'].rolling(window=30).mean()
    
    # Generate Factor: Frequency of Days with Volume > 1.5 * 30-day Average Volume within a Month
    df['freq_high_vol_30d'] = (df['volume'] > 1.5 * df['thirty_d_avg_vol']).rolling(window=30).mean()
    
    # Selecting the final alpha factor
    return df[['sum_10d_price_change', 'avg_20d_price_change', 'diff_ma_
