```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Change
    df['price_change'] = df['close'] - df['open']
    
    # Generate Factor: Sum of Daily Price Changes over a 10-day Window
    df['sum_price_change_10d'] = df['price_change'].rolling(window=10).sum()
    
    # Generate Factor: Average of Daily Price Changes over a 20-day Window
    df['avg_price_change_20d'] = df['price_change'].rolling(window=20).mean()
    
    # Generate Factor: Difference between 10-day Moving Average of Highs and Lows
    df['ma_high_10d'] = df['high'].rolling(window=10).mean()
    df['ma_low_10d'] = df['low'].rolling(window=10).mean()
    df['diff_ma_high_low_10d'] = df['ma_high_10d'] - df['ma_low_10d']
    
    # Generate Factor: Ratio of Current Day's High to 30-day Average High
    df['avg_high_30d'] = df['high'].rolling(window=30).mean()
    df['ratio_high_30d'] = df['high'] / df['avg_high_30d']
    
    # Analyze Daily Volume Change
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Generate Factor: Cumulative Volume Change over a 5-day Period
    df['cum_volume_change_5d'] = df['volume_change'].rolling(window=5).sum()
    
    # Generate Factor: Count of Consecutive Days with Increasing Volume
    df['consecutive_increasing_vol'] = (df['volume'] > df['volume'].shift(1)).rolling(window=5).sum()
    
    # Generate Factor: Difference in Volume when Price is Up vs. Down over 20 days
    df['volume_up'] = df[df['price_change'] > 0]['volume']
    df['volume_down'] = df[df['price_change'] < 0]['volume']
    df['volume_diff_20d'] = df['volume_up'].rolling(window=20).sum() - df['volume_down'].rolling(window=20).sum()
    
    # Generate Factor: Maximum Volume over the Past 10 Days Relative to 100-Day Average
    df['max_volume_10d'] = df['volume'].rolling(window=10).max()
    df['avg_volume_100d'] = df['volume'].rolling(window=100).mean()
    df['max_volume_ratio_10_100d'] = df['max_volume_10d'] / df['avg_volume_100d']
    
    # Generate Factor: Volume-Weighted Average Price (VWAP) over Last 10 Days
    df['vwap_10d'] = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    
    # Generate Factor: Deviation of Close from VWAP over a 30-day Period
    df['dev_close_vwap_30d'] = df['close'] - df['vwap_10d'].rolling(window=30).mean()
    
    # Generate Factor: Average Close Price on Days with Volume > 2 * 30-day Average Volume
    high_volume_days = df['volume'] > 2 * df['volume'].rolling(window=30).mean()
    df['avg_close_high_vol'] = df[high_volume_days]['close'].rolling(window=30, min_periods=1).mean()
    
    # Generate Factor: Frequency of Days with Volume > 1.5 * 30-day Average Volume within a Month
    above_avg_vol_days = df['volume'] > 1.5 * df['volume'].rolling(window=30).mean()
    df['freq_above_avg_vol_30d'] = above_avg_vol_days.rolling(window=30).sum()
    
    return df[['sum_price_change_10d', 'avg_price_change_20d', 'diff_ma_high_low_10d', 'ratio_high_30d',
               'cum_volume_change_5d', 'consecutive_increasing_vol', 'volume_diff_20d', 'max_volume_ratio_10_100d',
               'vwap_10d', 'dev_close_vwap_30d', 'avg_close_high_vol', 'freq_above_avg_vol_30d']]

