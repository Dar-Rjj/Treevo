```python
import pandas as pd

def heuristics_v2(df):
    # Simple Moving Averages
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()
    df['SMA_Crossover'] = (df['SMA_50'] > df['SMA_200']).astype(int)
    
    # Relative Strength Index (RSI)
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI'] = 100 - (100 / (1 + rs))
    df['RSI_Signal'] = ((df['RSI'] < 30) | (df['RSI'] > 70)).astype(int)
    
    # On-Balance Volume (OBV)
    df['OBV'] = ((df['close'] > df['close'].shift(1)) * df['volume'] - (df['close'] < df['close'].shift(1)) * df['volume']).cumsum()
    df['OBV_Signal'] = (df['OBV'] - df['OBV'].shift(1)).abs() > 1.5 * df['OBV'].std()
    
    # Volume Price Trend (VPT)
    df['VPT'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1) * df['volume']
    df['VPT_Sum'] = df['VPT'].cumsum()
    df['VPT_Signal'] = (df['VPT_Sum'] - df['VPT_Sum'].shift(1)).abs() > 1.5 * df['VPT_Sum'].std()
    
    # Average True Range (ATR)
    df['TR'] = df[['high', 'low']].sub(df['close'].shift(1), axis=0).abs().max(axis=1)
    df['ATR'] = df['TR'].rolling(window=14).mean()
    df['ATR_Signal'] = (df['ATR'] > df['ATR'].mean() + 2 * df['ATR'].std()).astype(int)
    
    # High-Low Ratio
    df['High_Low_Ratio'] = df['high'] / df['low'].shift(1)
    df['High_Low_Signal'] = (df['High_Low_Ratio'] > 1.05).astype(int)
    
    # Opening Gap
    df['Opening_Gap'] = df['open'] - df['close'].shift(1)
    df['Opening_Gap_Signal'] = (df['Opening_Gap'].abs() > 0.05 * df['close'].shift(1)).astype(int)
    
    # Intraday Gap
    df['Intraday_Gap'] = df['high'] - df['low'].shift(1)
    df['Intraday_Gap_Signal'] = (df['Intraday_Gap'].abs() > 0.05 * df['close'].shift(1)).astype(int)
    
    # Correlation between Amount and Volume
    df['Correlation'] = df['amount'].rolling(window=20).corr(df['volume'])
    df['Correlation_Signal'] = (df['Correlation'].abs() > 0.5).astype(int)
    
    # Composite Signal
    df['Composite_Signal'] = (df['SMA_Crossover'] + df['RSI_Signal'] + df['OBV_Signal'] + df['VPT_Signal'] + 
                              df['ATR_Signal'] + df['High_Low_Signal'] + df['Opening_Gap_Signal'] + 
                              df['Intraday_Gap_Signal'] + df['Correlation_Signal']) / 9
    
    return df['Composite_Signal']
```
