```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Price Momentum
    def price_momentum(close, open_, high):
        ema_20 = close.ewm(span=20, adjust=False).mean()
        modified_momentum = (close - ema_20) / (open_ - high)
        return modified_momentum
    
    # Volume-Weighted Price Trend
    def volume_weighted_price_trend(close, volume):
        vwcp = (close * volume).rolling(window=20).sum()
        total_volume = volume.rolling(window=20).sum()
        vwpt = vwcp / total_volume
        return vwpt
    
    # Range Expansion
    def range_expansion(high, low, close):
        tr = high.combine(first=close.shift(1), second=low, func=np.maximum) - high.combine(first=close.shift(1), second=low, func=np.minimum)
        atr_10 = tr.rolling(window=10).mean()
        range_exp = tr / atr_10
        return range_exp
    
    # Combine factors
    def composite_factor(price_mom, vwpt, range_expan):
        combined = (price_mom + vwpt + range_expan) / 3
        smoothed = combined.rolling(window=5).mean()
        return smoothed
    
    # Calculate individual factors
    price_mom = price_momentum(df['close'], df['open'], df['high'])
    vwpt = volume_weighted_price_trend(df['close'], df['volume'])
    range_expan = range_expansion(df['high'], df['low'], df['close'])

    # Calculate composite factor
    composite = composite_factor(price_mom, vwpt, range_expan)

    return composite
```
