```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Range Ratio
    df['close_to_range_ratio'] = df['close'] / df['intraday_range']
    
    # Calculate Intraday Return
    df['intraday_return'] = df['close'] - df['open']
    
    # Calculate True Range
    df['true_range'] = df[['high', 'low']].diff(axis=1).abs().max(axis=1).fillna(0)
    
    # Short-term, Medium-term, and Long-term Momentum
    df['momentum_short_term'] = (df['close'] - df['close'].shift(7)) / df['close'].shift(7)
    df['momentum_medium_term'] = (df['close'] - df['close'].shift(21)) / df['close'].shift(21)
    df['momentum_long_term'] = (df['close'] - df['close'].shift(63)) / df['close'].shift(63)
    
    # Average True Range (ATR)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    # Relative Strength (RS)
    df['relative_strength'] = df['close'] / df['close'].shift(21)
    
    # Money Flow Analysis
    df['money_flow_multiplier'] = (df['close'] - (df['high'] + df['low']) / 2) / (df['high'] - df['low'])
    df['money_flow_volume'] = df['money_flow_multiplier'] * df['volume']
    df['mfi_14'] = df['money_flow_volume'].rolling(window=14).sum() / df['volume'].rolling(window=14).sum()
    
    # Directional Movement and Trend Indicators
    df['positive_dm'] = np.where((df['high'] > df['high'].shift(1)) & (df['high'] - df['high'].shift(1) > df['low'].shift(1) - df['low']), df['high'] - df['high'].shift(1), 0)
    df['negative_dm'] = np.where((df['low'].shift(1) > df['low']) & (df['low'].shift(1) - df['low'] > df['high'] - df['high'].shift(1)), df['low'].shift(1) - df['low'], 0)
    df['di_pos_14'] = (df['positive_dm'].rolling(window=14).sum() / df['atr_14']).fillna(0)
    df['di_neg_14'] = (df['negative_dm'].rolling(window=14).sum() / df['atr_14']).fillna(0)
    
    # Volume Adjusted Spread
    df['volume_adjusted_spread'] = df['intraday_range'] * df['volume']
    
    # Volume Trend Score
    df['average_volume_10'] = df['volume'].rolling(window=10).mean()
    df['volume_change_rate'] = df['volume'] / df['average_volume_10']
    df['volume_trend_score'] = np.where(df['volume_change_rate'] > 1, df['volume_change_rate'] * 1.5, df['volume_change_rate'] * -1.2)
    
    # Composite Alpha Factor
    df['composite_alpha_factor'] = (df['momentum_short_term'] + df['momentum_medium_term'] + df['momentum_long_term'] + df['relative_strength'] + df['mfi_14'] + df['di_pos_14'] + df['di_neg_14']) / 6
    
    # Volume Trend Indicator
    df['average_volume_20'] = df['volume'].rolling(window=20).mean().shift(1)
    df['short_term_volume_change'] = df['volume'] - df['volume'].shift(5)
    df['volume_trend_indicator'] = np.where(df['short_term_volume_change'] > 0, 1, -1)
    
    # Final Alpha Factor
    df['final_alpha_factor'] = (df['composite_alpha_factor'] * df['volume_trend_indicator'] * df['volume_trend_score']) / df['average_volume_20']
    
    return df['final_alpha_factor']
```
