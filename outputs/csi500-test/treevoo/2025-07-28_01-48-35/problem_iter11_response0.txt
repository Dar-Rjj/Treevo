```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the body size and upper and lower shadows
    body_size = df['close'] - df['open']
    upper_shadow = df['high'] - df[['open', 'close']].max(axis=1)
    lower_shadow = df[['open', 'close']].min(axis=1) - df['low']

    # Calculate a factor based on the relationship between shadows and body size
    factor = (upper_shadow - lower_shadow) / (body_size + 1e-8)

    # Add in the effect of volume, which is normalized by the rolling mean of volume
    rolling_volume_mean = df['volume'].rolling(window=30).mean()
    volume_effect = df['volume'] / rolling_volume_mean

    # Combine the shadow factor with the volume effect
    combined_factor = factor * volume_effect

    return combined_factor
```
