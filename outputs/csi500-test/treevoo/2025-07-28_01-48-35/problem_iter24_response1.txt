```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between close and open prices (Day's Range)
    df['day_range'] = df['close'] - df['open']

    # Create a factor based on the relationship between high, low, and close prices
    df['close_position'] = (df['high'] - df['close']) / (df['high'] - df['low'])

    # Volume-weighted price calculations
    df['vwap'] = (df['volume'] * (df[['open', 'high', 'low', 'close']].sum(axis=1) / 4)).cumsum() / df['volume'].cumsum()

    # Price change over multi-day periods
    df['5d_return'] = df['close'].pct_change(5)
    df['10d_return'] = df['close'].pct_change(10)
    df['20d_return'] = df['close'].pct_change(20)

    # Volume trend analysis
    df['volume_change'] = df['volume'].diff()

    # High-low price spread
    df['5d_high_low_spread'] = df['high'].rolling(window=5).max() - df['low'].rolling(window=5).min()
    df['10d_high_low_spread'] = df['high'].rolling(window=10).max() - df['low'].rolling(window=10).min()

    # Price volatility
    df['30d_volatility'] = df['close'].pct_change().rolling(window=30).std()

    # Accumulation/Distribution Line
    adl = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    df['adl'] = adl * df['volume']
    df['adl'] = df['adl'].cumsum()

    # Money flow index
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    positive_flow = money_flow.where(typical_price > typical_price.shift(), 0)
    negative_flow = money_flow.where(typical_price < typical_price.shift(), 0)
    positive_flow_sum = positive_flow.rolling(window=14).sum()
    negative_flow_sum = negative_flow.rolling(window=14).sum()
    df['mfi'] = 100 - (100 / (1 + (positive_flow_sum / negative_flow_sum)))

    # Relative strength index (RSI) without normalization
    gain = df['close'].diff().where(df['close'].diff() > 0, 0)
    loss = -df['close'].diff().where(df['close'].diff() < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['rsi'] = 100 - (100 / (1 + rs))

    # Moving averages
    df['5d_sma'] = df['close'].rolling(window=5).mean()
    df['10d_sma'] = df['close'].rolling(window=10).mean()
    df['20d_sma'] = df['close'].rolling(window=20).mean()
    df['5d_ema'] = df['close'].ewm(span=5, adjust=False).mean()
    df['10d_ema'] = df['close'].ewm(span=10, adjust=False).mean()
    df['20d_ema'] = df['close'].ewm(span=20, adjust=False).mean()

    # Crossover signals
    df['sma_crossover'] = (df['5d_sma'] > df['20d_sma']).astype(int)
    df['ema_crossover'] = (df['5d_ema'] > df['20d_ema']).astype(int)

    # Daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']

    # Volume return
    df['average_volume'] = df['volume'].rolling(window=20).mean()
    df['volume_return'] = df['volume'] / df['average_volume']

    # Open-close reversal
    df['open_close_reversal'] = (df['open'] - df['close'].shift()).abs()

    # Close-to-open gap
    df['close_to_open_gap'] = df['open'].shift(-1) - df['close']

    # Average true range (ATR)
    tr1 = df['high'] -
