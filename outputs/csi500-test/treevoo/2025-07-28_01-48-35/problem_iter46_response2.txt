```python
import pandas as pd

def heuristics_v2(df):
    # Compute Close-to-Close return (Close_t / Close_{t-1} - 1)
    close_to_close_return = df['close'] / df['close'].shift(1) - 1
    
    # Compute Open-to-Close return (Close_t / Open_t - 1)
    open_to_close_return = df['close'] / df['open'] - 1
    
    # Measure High-Low Range (High_t - Low_t)
    high_low_range = df['high'] - df['low']
    
    # Compute True Range (Max(High_t - Low_t, Abs(High_t - Close_{t-1}), Abs(Low_t - Close_{t-1})))
    true_range = pd.concat([high_low_range, (df['high'] - df['close'].shift(1)).abs(), (df['low'] - df['close'].shift(1)).abs()], axis=1).max(axis=1)
    
    # Calculate positive candle body size (Close_t > Open_t ? Close_t - Open_t : 0)
    positive_candle_body = (df['close'] - df['open']).where(df['close'] > df['open'], 0)
    
    # Calculate negative candle body size (Close_t < Open_t ? Open_t - Close_t : 0)
    negative_candle_body = (df['open'] - df['close']).where(df['close'] < df['open'], 0)
    
    # Compute Volume-to-Price change ratio (Volume_t / (Close_t - Close_{t-1}))
    volume_to_price_change_ratio = df['volume'] / (df['close'] - df['close'].shift(1))
    
    # Calculate Volume Weighted Average Price (VWAP) up to day t
    vwap = (df['amount'] / df['volume']).cumsum() / (1 / df['volume']).cumsum()
    
    # Compute 3-day momentum (Close_t - Close_{t-3})
    three_day_momentum = df['close'] - df['close'].shift(3)
    
    # Calculate 5-day moving average of Close prices
    five_day_ma = df['close'].rolling(window=5).mean()
    
    # Identify upward gap (Open_t - Close_{t-1} > 0)
    upward_gap = (df['open'] - df['close'].shift(1)) > 0
    
    # Identify downward gap (Open_t - Close_{t-1} < 0)
    downward_gap = (df['open'] - df['close'].shift(1)) < 0
    
    # Calculate Daily Trading Activity (Volume_t * Close_t)
    daily_trading_activity = df['volume'] * df['close']
    
    # Measure Volume Change (Volume_t - Volume_{t-1})
    volume_change = df['volume'] - df['volume'].shift(1)
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        close_to_close_return + 
        open_to_close_return + 
        high_low_range + 
        true_range + 
        positive_candle_body - 
        negative_candle_body + 
        volume_to_price_change_ratio + 
        vwap + 
        three_day_momentum + 
        five_day_ma + 
        upward_gap.astype(int) - 
        downward_gap.astype(int) + 
        daily_trading_activity + 
        volume_change
    )
    
    return alpha_factor
```
