```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Compute Close to Intraday Range Ratio
    close_to_intraday_range_ratio = df['close'] / intraday_range
    
    # Calculate Volume Adjusted Momentum
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    volume_factor = df['volume'] / avg_volume_5d
    volume_adjusted_momentum = close_to_intraday_range_ratio * volume_factor
    
    # Cumulative Sum of Volume Adjusted Momentum
    cum_sum_volume_adjusted_momentum = volume_adjusted_momentum.rolling(window=10).sum()
    
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Volume Adjusted High-Low Spread
    volume_adjusted_high_low_spread = high_low_spread * (df['volume'] / avg_volume_5d)
    
    # Calculate Price Momentum
    ema_close_10d = df['close'].ewm(span=10, adjust=False).mean()
    price_momentum = df['close'] - ema_close_10d
    
    # Calculate Volume Trend
    sum_volume_20d = df['volume'].rolling(window=20).sum()
    volume_trend = df['volume'] / sum_volume_20d
    
    # Calculate Range Expansion
    true_range = df[['high', 'low', 'close']].diff().abs().max(axis=1)
    atr_10d = true_range.rolling(window=10).mean()
    range_expansion = true_range / atr_10d
    
    # Calculate On-Balance Volume (OBV)
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    obv = obv.cumsum()
    
    # Composite Factor
    composite_factor = (
        cum_sum_volume_adjusted_momentum +
        volume_adjusted_high_low_spread +
        price_momentum +
        volume_trend +
        range_expansion +
        obv
    )
    
    # Smooth the Composite Factor
    smoothed_composite_factor = composite_factor.rolling(window=5).mean()
    
    return smoothed_composite_factor
```
