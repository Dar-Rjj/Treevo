```txt
Volume-Weighted Price Momentum with Enhanced Trend Integration
├── Calculate Intraday High-Low Range
│   ├── Use High price
│   └── Use Low price
├── Compute Close to Intraday Range Ratio
│   ├── Use Close price
│   └── Use Intraday High-Low Range
├── Calculate Volume-Weighted Momentum
│   ├── Use Volume
│   └── Multiply by Close to Intraday Range Ratio
├── Integrate Price Trend
│   ├── Calculate Exponential Moving Average of Close Price
│   │   └── Over a defined window
│   └── Subtract Exponential Moving Average from Close Price
├── Adjust Momentum with Price Trend
│   ├── Sum Volume-Weighted Momentum and Price Trend
└── Weighted Cumulative Sum
    ├── Apply a decay factor to past values
    └── Sum over a rolling window of past days
```
