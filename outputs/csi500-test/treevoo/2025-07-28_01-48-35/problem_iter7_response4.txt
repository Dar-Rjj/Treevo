```python
import pandas as pd

def heuristics_v2(df):
    # Price Momentum
    df['10DayEMA'] = df['close'].ewm(span=10, adjust=False).mean()
    df['PriceMomentum'] = df['close'] - df['10DayEMA']

    # Volume Trend
    df['20DayVolSum'] = df['volume'].rolling(window=20).sum()
    df['VolumeTrend'] = df['volume'] / df['20DayVolSum']

    # Range Expansion
    df['TrueRange'] = df[['high', 'low']].apply(lambda x: max(x) - min(x), axis=1)
    df['10DayATR'] = df['TrueRange'].rolling(window=10).mean()
    df['RangeExpansion'] = df['TrueRange'] / df['10DayATR']

    # Composite Factor
    df['CompositeFactor'] = (df['PriceMomentum'] + df['VolumeTrend'] + df['RangeExpansion']) / 3

    # 5-Day SMA of Combined Factor
    df['FinalAlphaFactor'] = df['CompositeFactor'].rolling(window=5).mean()

    return df['FinalAlphaFactor']
```
