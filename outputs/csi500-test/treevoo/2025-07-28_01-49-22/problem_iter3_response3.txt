```python
import pandas as pd

def heuristics_v2(df, n_days=30):
    # Compute daily price change using close price
    df['daily_price_change'] = df['close'].pct_change()
    
    # Calculate cumulative price change over N days
    df['cumulative_momentum'] = df['daily_price_change'].rolling(window=n_days).sum()
    
    # Determine median volume and median amount over the last N days
    median_volume = df['volume'].rolling(window=n_days).median()
    median_amount = df['amount'].rolling(window=n_days).median()
    
    # Apply combined volume and amount filter
    df['valid_day'] = (df['volume'] >= median_volume) & (df['amount'] >= median_amount)
    
    # Only include days with above both median volume and median amount in the cumulative momentum
    df['filtered_cumulative_momentum'] = df[df['valid_day']]['cumulative_momentum']
    
    # Return the filtered cumulative momentum as the factor values
    return df['filtered_cumulative_momentum']
```
