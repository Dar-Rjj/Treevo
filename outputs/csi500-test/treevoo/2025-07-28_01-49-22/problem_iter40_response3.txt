```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the 5-day rate of change in closing prices
    df['close_roc_5'] = df['close'].pct_change(5)
    
    # Calculate the 5-day average volume
    df['avg_vol_5'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the volume deviation from the 5-day average
    df['vol_deviation'] = df['volume'] / df['avg_vol_5']
    
    # Construct a momentum-based indicator using the combination of short-term price change and volume deviations
    df['momentum_factor'] = df['close_roc_5'] * df['vol_deviation']
    
    # Construct a factor based on the difference between high and low prices as a measure of intraday volatility
    df['intraday_volatility'] = df['high'] - df['low']
    
    # Create a sentiment factor by comparing opening and closing prices
    df['sentiment_factor'] = (df['close'] > df['open']).astype(int)
    
    # Generate a factor that captures the frequency and magnitude of large transaction amounts
    df['large_transactions'] = (df['amount'] > df['amount'].quantile(0.9)).astype(int) * df['close_roc_5']
    
    # Combine all factors into a single composite factor
    df['composite_factor'] = df['momentum_factor'] + df['intraday_volatility'] + df['sentiment_factor'] + df['large_transactions']
    
    return df['composite_factor']
```
