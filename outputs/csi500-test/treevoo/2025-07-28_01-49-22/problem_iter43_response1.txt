```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_returns'] = df['close'].diff()
    
    # Calculate short-term and long-term moving averages of daily returns
    short_term_window = 5
    long_term_window = 30
    df['short_term_ma'] = df['daily_returns'].rolling(window=short_term_window).mean()
    df['long_term_ma'] = df['daily_returns'].rolling(window=long_term_window).mean()
    df['ma_diff'] = df['short_term_ma'] - df['long_term_ma']
    
    # Calculate high-low range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate absolute close-to-close return
    df['abs_close_return'] = df['daily_returns'].abs()
    
    # Combine high-low range and absolute close-to-close return
    df['combined_range'] = df['high_low_range'] + df['abs_close_return']
    
    # Generate alpha factor from momentum
    df['high_low_ratio'] = df['high_low_range'] / df['high_low_range'].shift(1)
    ema_window = 10
    df['smoothed_high_low_ratio'] = df['high_low_ratio'].ewm(span=ema_window, adjust=False).mean()
    df['dynamic_threshold'] = (df['high_low_range'] / (df['high'] + df['low'])).rolling(window=ema_window).mean()
    df['signal'] = df['smoothed_high_low_ratio'] > df['dynamic_threshold']
    df['alpha_factor_momentum'] = df['volume'] * (df['signal'].astype(int) * 2 - 1)
    
    # Adjust alpha factor based on intraday range ratio
    df['intraday_range_ratio'] = df['high_low_range'] / (df['high'] + df['low'])
    df['alpha_factor_momentum'] = df['alpha_factor_momentum'] * (
        1.4 * (df['intraday_range_ratio'] > 0.7) + 
        0.6 * (df['intraday_range_ratio'] < 0.4) + 
        1 * ((df['intraday_range_ratio'] <= 0.7) & (df['intraday_range_ratio'] >= 0.4))
    )
    
    # Introduce volume momentum
    df['volume_momentum'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Calculate volume-adjusted close price momentum
    df['volume_adjusted_momentum'] = df['daily_returns'] * (df['volume'] / df['volume'].shift(1))
    
    # Incorporate close-open difference
    df['close_open_diff'] = df['close'] - df['open']
    fixed_weight = 0.5  # Example fixed weight
    df['weighted_close_open'] = fixed_weight * df['close_open_diff']
    df['intermediate_alpha_factor'] = df['alpha_factor_momentum'] + df['volume_adjusted_momentum'] + df['volume_momentum'] + df['weighted_close_open']
    
    # Enhance alpha factor with volume-adjusted high-low range
    n_period = 10
    df['average_volume'] = df['volume'].rolling(window=n_period).mean()
    df['volume_adjusted_high_low_range'] = df['high_low_range'] * (df['volume'] / df['average_volume'])
    df['enhanced_alpha_factor'] = df['intermediate_alpha_factor'] + df['volume_adjusted_high_low_range']
    
    # Generate final alpha factor
    df['final_alpha_factor'] = df['ma_diff'] * df['enhanced_alpha_factor'] * (df['volume'] / df['volume'].rolling(window=10).mean())
    
    return df['final_alpha_factor']
```
