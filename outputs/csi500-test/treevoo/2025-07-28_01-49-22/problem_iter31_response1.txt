```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Range (t)
    high_low_range = df['high'] - df['low']

    # Calculate Absolute Close-to-Close Return
    close_to_close_return = abs(df['close'].diff())

    # Combine High-Low Range and Absolute Close-to-Close Return
    combined_value = high_low_range + close_to_close_return

    # Calculate Volume-Weighted High-Low Range
    volume_weighted_high_low_range = high_low_range * df['volume']
    volume_weighted_high_low_range_ema = volume_weighted_high_low_range.ewm(span=10).mean()

    # Adjust for Volatility
    volatility = df['close'].rolling(window=20).std()
    adjusted_volume_weighted_high_low_range = volume_weighted_high_low_range_ema / volatility

    # Calculate Intraday Volatility
    intraday_volatility = high_low_range.rolling(window=15).mean()

    # Calculate Close Price Momentum
    close_momentum = ((df['close'] / df['close'].shift(1)) - 1).rolling(window=20).sum()

    # Generate Intermediate Alpha Factor
    intermediate_alpha_factor = (
        adjusted_volume_weighted_high_low_range +
        combined_value +
        (high_low_range / (df['high'] + df['low'])) -
        abs(df['open'] - df['close'].shift(1))
    )

    # Compare with Baseline (Intraday Range Ratio's Median)
    median_intraday_ratio = (high_low_range / (df['high'] + df['low'])).median()
    
    positive_signal = (high_low_range / (df['high'] + df['low'])) > median_intraday_ratio
    negative_signal = (high_low_range / (df['high'] + df['low'])) < median_intraday_ratio

    # Adjust Intermediate Alpha Factor
    intermediate_alpha_factor[positive_signal] *= 1.7
    intermediate_alpha_factor[negative_signal] *= 0.3

    # Generate Final Alpha Factor
    final_alpha_factor = intraday_volatility * (intermediate_alpha_factor + close_momentum)

    # Adjust Final Alpha Factor by Volume
    ema_volume = df['volume'].ewm(span=10).mean()
    final_alpha_factor_adjusted = final_alpha_factor * ema_volume

    return final_alpha_factor_adjusted
```
