```python
import pandas as pd

def heuristics_v2(df):
    # Calculate momentum based on close prices
    df['5_day_SMA'] = df['close'].rolling(window=5).mean()
    df['10_day_SMA'] = df['close'].rolling(window=10).mean()
    df['momentum'] = df['5_day_SMA'] - df['10_day_SMA']
    
    # Analyze volume trends
    df['20_day_volume_sum'] = df['volume'].rolling(window=20).sum()
    df['10_day_volume_sum'] = df['volume'].rolling(window=10).sum()
    df['volume_flow'] = df['10_day_volume_sum'] / df['20_day_volume_sum']
    
    # Incorporate volatility using high and low prices
    df['daily_range'] = df['high'] - df['low']
    df['30_day_avg_range'] = df['daily_range'].rolling(window=30).mean()
    df['volatility_factor'] = df['daily_range'] / df['30_day_avg_range']
    
    # Explore patterns in open and close prices
    df['close_gt_open'] = (df['close'] > df['open']).astype(int)
    df['bullish_days'] = df['close_gt_open'].rolling(window=5).sum()
    df['trend_following'] = df['bullish_days'] / 5
    
    # Investigate the relationship between amount and volume
    df['10_day_amount_sum'] = df['amount'].rolling(window=10).sum()
    df['10_day_volume_sum'] = df['volume'].rolling(window=10).sum()
    df['liquidity_factor'] = df['10_day_amount_sum'] / df['10_day_volume_sum']
    
    # Combine multiple factors for a composite alpha
    weight_momentum = 0.4
    weight_volume_flow = 0.3
    weight_volatility = 0.2
    weight_trend_following = 0.1
    df['composite_alpha'] = (weight_momentum * df['momentum'] +
                            weight_volume_flow * df['volume_flow'] +
                            weight_volatility * df['volatility_factor'] +
                            weight_trend_following * df['trend_following'])
    
    return df['composite_alpha']
```
