```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n_days=20, alpha=0.2):
    # Calculate Adjusted Momentum Component
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(n_days))
    df['volume_ratio'] = df['volume'] / df['volume'].shift(n_days)
    df['vol_adj_log_return'] = df['log_return'] * df['volume_ratio']
    
    # Smoothing Momentum with EMA
    df['adj_momentum_ema'] = df['vol_adj_log_return'].ewm(alpha=alpha, adjust=False).mean()
    df['adjusted_momentum_score'] = df['adj_momentum_ema'] * df['volume']

    # Calculate Volatility Component
    df['abs_daily_return'] = abs(np.log(df['close']) - np.log(df['close'].shift(1)))
    df['sum_abs_returns'] = df['abs_daily_return'].rolling(window=n_days).sum()
    df['average_volatility'] = df['sum_abs_returns'] / n_days
    df['weighted_volatility'] = df['average_volatility'] / df['volume']

    # Combine Components
    df['final_alpha_factor'] = df['adjusted_momentum_score'] - df['weighted_volatility']

    return df['final_alpha_factor'].dropna()
```
