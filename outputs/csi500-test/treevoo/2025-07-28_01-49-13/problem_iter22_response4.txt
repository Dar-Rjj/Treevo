```python
import pandas as pd

def heuristics_v2(df):
    # Momentum-based alpha factors
    df['1d_momentum'] = df['close'] - df['close'].shift(1)
    df['5d_momentum'] = df['close'] - df['close'].shift(5)
    df['20d_momentum'] = df['close'] - df['close'].shift(20)
    
    df['5_20_SMA_crossover'] = df['close'].rolling(window=5).mean() - df['close'].rolling(window=20).mean()
    df['20_50_SMA_crossover'] = df['close'].rolling(window=20).mean() - df['close'].rolling(window=50).mean()

    # Volatility-based alpha factors
    df['daily_log_returns'] = df['close'].pct_change().apply(lambda x: np.log(1 + x))
    df['20d_volatility'] = df['daily_log_returns'].rolling(window=20).std()
    df['weekly_log_returns'] = (df['close'].resample('W').ffill().pct_change().apply(lambda x: np.log(1 + x))).reindex(df.index, method='bfill')
    df['52w_volatility'] = df['weekly_log_returns'].rolling(window=52).std()

    df['true_range'] = df[['high'-'low', 'high'-'close'].shift(1), 'close'].shift(1)-'low']].max(axis=1)
    df['ATR_14'] = df['true_range'].rolling(window=14).mean()

    # Volume-based alpha factors
    df['OBV'] = ((df['close'] > df['close'].shift(1)).astype(int) - (df['close'] < df['close'].shift(1)).astype(int)) * df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    df['1d_VROC'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['21d_VROC'] = (df['volume'] - df['volume'].shift(21)) / df['volume'].shift(21)

    # Pattern recognition alpha factors
    df['Bullish_Engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1))).astype(int)
    df['Bearish_Engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1))).astype(int)
    df['Doji'] = (abs(df['close'] - df['open']) < 0.005 * df['close']).astype(int)  # 0.005 is a threshold for approximate equality

    # Support and resistance levels are more complex and require additional logic to identify historical support/resistance points
    # For simplicity, we will not include it in this function

    # Construct the final alpha factor by combining all the individual factors
    df['alpha_factor'] = (df['1d_momentum'] + df['5d_momentum'] + df['20d_momentum'] 
                          + df['5_20_SMA_crossover'] + df['20_50_SMA_crossover'] 
                          + df['20d_volatility'] + df['52w_volatility'] + df['ATR_14'] 
                          + df['OBV'] + df['1d_VROC'] + df['21d_VROC'] 
                          + df['Bullish_Engulfing'] - df['Bearish_Engulfing'] + df['Doji'])

    return df['alpha_factor']
```
