```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate cumulative returns over different periods
    df['cumulative_return_5d'] = df['daily_return'].rolling(window=5).sum()
    df['cumulative_return_20d'] = df['daily_return'].rolling(window=20).sum()
    df['cumulative_return_60d'] = df['daily_return'].rolling(window=60).sum()
    
    # Calculate moving averages
    df['sma_5d'] = df['close'].rolling(window=5).mean()
    df['sma_20d'] = df['close'].rolling(window=20).mean()
    df['sma_60d'] = df['close'].rolling(window=60).mean()
    
    # Calculate the distance between high and low
    df['high_low_distance'] = df['high'] - df['low']
    
    # Calculate standard deviation of daily returns
    df['std_5d'] = df['daily_return'].rolling(window=5).std()
    df['std_20d'] = df['daily_return'].rolling(window=20).std()
    df['std_60d'] = df['daily_return'].rolling(window=60).std()
    
    # Calculate change in volume
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate relative volume
    df['average_volume_20d'] = df['volume'].rolling(window=20).mean()
    df['relative_volume'] = df['volume'] / df['average_volume_20d']
    
    # Calculate on-balance volume
    df['obv'] = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0)) * df['volume']
    df['obv'] = df['obv'].cumsum()
    
    # Calculate volume-weighted average price
    df['total_volume'] = df['volume'].rolling(window=20, min_periods=1).sum()
    df['vwap'] = ((df['high'] + df['low'] + df['close']) / 3 * df['volume']).rolling(window=20, min_periods=1).sum() / df['total_volume']
    
    # Calculate average true range
    df['true_range'] = df[['high', 'low']].sub(df['close'].shift(), axis=0).abs().max(axis=1)
    df['atr_14d'] = df['true_range'].rolling(window=14).mean()
    
    # Calculate percentage price oscillator
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['ppo'] = (df['ema_12'] - df['ema_26']) / df['ema_26']
    
    # Calculate intraday range
    df['intraday_range'] = (df['high'] - df['low']) / df['open']
    
    # Calculate opening gap
    df['opening_gap'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate relative strength index
    gain = df['daily_return'].apply(lambda x: max(x, 0))
    loss = df['daily_return'].apply(lambda x: abs(min(x, 0)))
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    df['rsi'] = 100 - (100 / (1 + (avg_gain / avg_loss)))
    
    # Calculate money flow index
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df[df['typical_price'] > df['typical_price'].shift(1)]['money_flow']
    df['negative_money_flow'] = df[df['typical_price'] < df['typical_price'].shift(1)]['money_flow']
    df['positive_money_flow_sum'] = df['positive_money_flow'].rolling(window=14).sum()
    df['negative_money_flow_sum'] = df['negative_money_flow'].rolling(window=1
