```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Calculate Intraday Midpoint to Open Ratio
    intraday_midpoint = (df['high'] + df['low']) / 2
    midpoint_to_open_ratio = intraday_midpoint / df['open']
    
    # Calculate Volume Weighted Average Price (VWAP)
    vwap = df['amount'] / df['volume']
    
    # Calculate Close-to-Next Day Open Return
    close_to_next_open_return = vwap.shift(-1) / df['open'].shift(-1)
    
    # Calculate Daily Return
    daily_return = (df['close'] - df['open']) / df['open']
    
    # Calculate the average volume over a short period (e.g., 5 days)
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    
    # Calculate the ratio of current day's volume to the average volume
    volume_ratio = df['volume'] / avg_volume_5d
    
    # Weighted Sum of Returns by Volume
    weighted_sum_returns = (close_to_next_open_return * df['volume']).rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    
    # Calculate the number of up and down days in a window (e.g., 5 days)
    up_days = (df['close'] > df['open']).rolling(window=5).sum()
    total_days = 5
    up_day_ratio = up_days / total_days
    
    # Calculate the range of the day (high - low)
    range_of_day = df['high'] - df['low']
    
    # Calculate the ratio of the range to the close price
    range_to_close_ratio = range_of_day / df['close']
    
    # Calculate the average amount traded over a short period (e.g., 5 days)
    avg_amount_5d = df['amount'].rolling(window=5).mean()
    
    # Calculate the ratio of current day's amount to the average amount
    amount_ratio = df['amount'] / avg_amount_5d
    
    # Calculate Close-to-Open Envelope
    max_close = df['close'].rolling(window=5).max()
    min_open = df['open'].rolling(window=5).min()
    
    # Calculate Adjusted Close-to-Open Envelope
    max_adj_close = (df['close'] * df['volume']).rolling(window=5).max() / df['volume'].rolling(window=5).max()
    min_open_envelope = df['open'].rolling(window=5).min()
    
    # Calculate Daily Volatility
    daily_volatility = (df['high'] - df['low']) / df['close']
    
    # Smooth Volatility
    smoothed_volatility = daily_volatility.ewm(span=5, adjust=False).mean()
    
    # Combine Factors
    factor = (midpoint_to_open_ratio * weighted_sum_returns) * (max_close / min_open) * (max_adj_close / min_open_envelope) * (daily_volatility / smoothed_volatility)
    
    return factor
```
