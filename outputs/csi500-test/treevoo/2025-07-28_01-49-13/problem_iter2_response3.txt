```python
import pandas as pd

def heuristics_v2(df, N=10, M=20, K=1.5, lookback=60):
    # Calculate Price Momentum with Intraday Volatility
    close_t = df['close']
    close_n_days_ago = df['close'].shift(N)
    n_day_return = (close_t - close_n_days_ago) / close_n_days_ago
    
    high_low_range = df['high'] - df['low']
    close_open_return = (df['close'] - df['open']) / df['open']
    
    intraday_volatility = high_low_range + close_open_return
    adjusted_return = n_day_return * intraday_volatility
    
    # Identify Volume Spike
    volume_t = df['volume']
    volume_moving_avg = df['volume'].rolling(window=M).mean()
    volume_std = df['volume'].rolling(window=M).std()
    
    volume_spike = volume_t > (volume_moving_avg + 2 * volume_std)
    
    # Combine Price Momentum, Intraday Volatility, and Volume Spike
    combined_return = adjusted_return.where(~volume_spike, K * adjusted_return)
    
    # Calculate Volume Weighted Adjusted Return
    volume_weighted_return = combined_return * df['volume']
    
    # Calculate Moving Average of Adjusted Return
    moving_avg = volume_weighted_return.rolling(window=lookback).mean()
    
    # Calculate Factor as Ratio of Adjusted Return to Moving Average
    factor = volume_weighted_return / moving_avg
    
    return factor
```
