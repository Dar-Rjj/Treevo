```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the 7-day simple moving average (SMA) of close prices
    df['7_day_SMA'] = df['close'].rolling(window=7).mean()
    
    # Compare the current close price with the 7-day SMA
    df['close_above_7day_SMA'] = df['close'] > df['7_day_SMA']
    
    # Calculate the 21-day SMA of close prices
    df['21_day_SMA'] = df['close'].rolling(window=21).mean()
    
    # Determine if the 7-day SMA is rising or falling compared to the 21-day SMA
    df['7day_SMA_rising'] = df['7_day_SMA'] > df['21_day_SMA']
    
    # Calculate the percentage change in volume from the previous day
    df['volume_change_pct'] = df['volume'].pct_change()
    
    # Calculate the percentage change in close price from the previous day
    df['price_change_pct'] = df['close'].pct_change()
    
    # Determine if high volume accompanies significant price changes
    df['high_volume_price_change'] = (df['volume_change_pct'] > 0.2) & (abs(df['price_change_pct']) > 0.05)
    
    # Calculate the difference between the current day's open price and the previous day's close price
    df['open_minus_prev_close'] = df['open'] - df['close'].shift(1)
    
    # Categorize the gap as up, down, or no gap
    df['gap_type'] = 'no_gap'
    df.loc[df['open_minus_prev_close'] > 0.05 * df['close'].shift(1), 'gap_type'] = 'up_gap'
    df.loc[df['open_minus_prev_close'] < -0.05 * df['close'].shift(1), 'gap_type'] = 'down_gap'
    
    # Analyze the significance of the gap
    df['gap_significance'] = 0
    df.loc[df['gap_type'] == 'up_gap', 'gap_significance'] = 1
    df.loc[df['gap_type'] == 'down_gap', 'gap_significance'] = -1
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['close_above_7day_SMA'].astype(int) +
        df['7day_SMA_rising'].astype(int) +
        df['high_volume_price_change'].astype(int) +
        df['gap_significance']
    )
    
    return df['alpha_factor']
```
