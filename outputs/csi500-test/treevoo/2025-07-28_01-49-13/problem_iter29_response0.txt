```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Momentum factor over 30 days
    df['momentum_30'] = df['daily_return'].rolling(window=30).sum()
    
    # Mean reversion factor over 30 days
    df['mean_reversion_30'] = (df['close'] - df['close'].rolling(window=30).mean()) / df['close'].rolling(window=30).std()
    
    # Risk-adjusted return over 30 days
    df['risk_adjusted_return_30'] = df['daily_return'].rolling(window=30).sum() / df['daily_return'].rolling(window=30).std()
    
    # Daily price range
    df['price_range'] = df['high'] - df['low']
    
    # Close to open returns
    df['close_to_open_return'] = (df['close'] - df['open']) / df['open']
    
    # Average volume over N days
    df['average_volume_30'] = df['volume'].rolling(window=30).mean()
    
    # Daily volume change
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Identify significant volume spikes
    df['significant_volume_spike'] = df['volume'] > 2 * df['average_volume_30']
    df['volume_spike_impact'] = df['daily_return'] * df['significant_volume_spike']
    
    # Volume Price Trend (VPT)
    vpt = (df['volume'] * ((df['close'] - df['close'].shift(1)) / df['close'].shift(1))).cumsum()
    df['vpt'] = vpt
    
    # Daily transaction amount
    df['transaction_amount'] = df['close'] * df['volume']
    
    # Change in transaction amount
    df['transaction_amount_change'] = (df['transaction_amount'] - df['transaction_amount'].shift(1)) / df['transaction_amount'].shift(1)
    
    # Composite alpha factor
    df['price_signal'] = (df['momentum_30'] + df['mean_reversion_30'] + df['risk_adjusted_return_30']) / 3
    df['volume_signal'] = (df['vpt'] + df['volume_change'] + df['volume_spike_impact']) / 3
    df['composite_alpha_factor'] = df['price_signal'] * df['volume_signal']
    
    return df['composite_alpha_factor'].dropna()
```
