```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    close_to_open_return = df['close'] - df['open']
    
    # Adjust Close-to-Open Return by Intraday Range
    adjusted_return = close_to_open_return * intraday_range
    
    # Calculate Volume-Weighted Volatility
    avg_volume = df['volume'].rolling(window=20).mean()
    volume_weighted_volatility = intraday_range / avg_volume
    
    # Combine Adjusted Return and Volume-Weighted Volatility
    combined_return = adjusted_return * volume_weighted_volatility
    
    # Calculate Volume-Weighted High-Low Spread
    weighted_high_low_spread = (df['high'] - df['low']) * df['volume']
    
    # Exponential Moving Average (EMA) of Weighted High-Low Spread
    ema_window = 10
    ema_weighted_high_low_spread = weighted_high_low_spread.ewm(span=ema_window, adjust=False).mean()
    ema_change = ema_weighted_high_low_spread - ema_weighted_high_low_spread.shift(5)
    
    # Identify Volume Spike
    vol_spike_threshold = df['volume'].rolling(window=20).mean() + 2 * df['volume'].rolling(window=20).std()
    is_volume_spike = df['volume'] > vol_spike_threshold
    
    # Calculate N-day Price Momentum
    n_day_momentum = df['close'] / df['close'].shift(20) - 1
    
    # Amplify N-day Return for Days with Volume Spike
    k = 1.5  # Constant to amplify the return
    amplified_momentum = n_day_momentum * np.where(is_volume_spike, k, 1)
    
    # Combine Price Momentum, Volume Spike, and Intraday Volatility
    combined_momentum = amplified_momentum * intraday_range * (df['close'] / df['open'])
    
    # Calculate High-Low Range Ratio and Close-Open Return Ratio
    high_low_range_ratio = (df['high'] - df['low']) / df['close']
    close_open_return_ratio = (df['close'] - df['open']) / df['open']
    
    # Combine Intraday High-Low Range and Close-Open Return
    combined_ratio = high_low_range_ratio * close_open_return_ratio
    
    # Calculate Volume-Weighted Adjusted Return
    volume_weighted_adjusted_return = combined_momentum * df['volume']
    
    # Calculate Exponential Moving Average of Volume-Weighted Adjusted Return
    ema_volume_weighted_adjusted_return = volume_weighted_adjusted_return.ewm(span=20, adjust=False).mean()
    
    # Calculate Final Alpha Factor
    final_alpha_factor = volume_weighted_adjusted_return / ema_volume_weighted_adjusted_return
    
    return final_alpha_factor
```
