```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between today's closing price and the average of the previous 5 days' closing prices
    df['close_5d_avg'] = df['close'].rolling(window=5).mean()
    df['momentum'] = df['close'] - df['close_5d_avg']
    
    # Calculate the standard deviation of the past 5 days' closing prices and adjust momentum by volatility
    df['volatility'] = df['close'].rolling(window=5).std()
    df['adjusted_momentum'] = df['momentum'] / df['volatility']
    
    # Compute the ratio of todayâ€™s volume to the average volume over the past 5 days
    df['volume_5d_avg'] = df['volume'].rolling(window=5).mean()
    df['volume_ratio'] = df['volume'] / df['volume_5d_avg']
    df['weighted_momentum'] = df['adjusted_momentum'] * df['volume_ratio']
    
    # Consider the directional movement by comparing today's high and low with yesterday's
    df['directional_movement'] = ((df['high'] > df['high'].shift(1)) & (df['low'] > df['low'].shift(1))).astype(int)
    df['final_momentum'] = df['weighted_momentum'] + df['directional_movement']
    
    # Short-term (2 days) price change
    df['short_term_momentum'] = df['close'] - df['close'].shift(2)
    
    # Medium-term (10 days) price change
    df['medium_term_momentum'] = df['close'] - df['close'].shift(10)
    
    # Long-term (30 days) price change
    df['long_term_momentum'] = df['close'] - df['close'].shift(30)
    
    # Weighted sum of short, medium, and long-term price changes
    df['multi_period_momentum'] = 0.4 * df['short_term_momentum'] + 0.3 * df['medium_term_momentum'] + 0.3 * df['long_term_momentum']
    
    # Short-term (7 days) and medium-term (25 days) moving averages
    df['sma_7'] = df['close'].rolling(window=7).mean()
    df['sma_25'] = df['close'].rolling(window=25).mean()
    df['sma_7_25_crossover'] = df['sma_7'] - df['sma_25']
    
    # Medium-term (25 days) and long-term (60 days) moving averages
    df['sma_60'] = df['close'].rolling(window=60).mean()
    df['sma_25_60_crossover'] = df['sma_25'] - df['sma_60']
    
    # Short-term (7 days) and long-term (60 days) moving averages
    df['sma_7_60_crossover'] = df['sma_7'] - df['sma_60']
    
    # Daily log returns
    df['log_returns'] = df['close'].pct_change().apply(lambda x: np.log(1 + x))
    df['historical_volatility'] = df['log_returns'].rolling(window=30).std()
    
    # Average true range (ATR) over 21 days
    df['true_range'] = df[['high', 'close']].max(axis=1) - df[['low', 'close']].min(axis=1)
    df['atr_21'] = df['true_range'].rolling(window=21).mean()
    
    # Ratio of today's high-low range to the average high-low range
    df['avg_high_low_range'] = (df['high'] - df['low']).rolling(window=30).mean()
    df['high_low_range_ratio'] = (df['high'] - df['low']) / df['avg_high_low_range']
    
    # On-balance volume (OBV)
    obv = [0]
    for i in range(1, len(df)):
        if df['close'].iloc[i] > df['close'].iloc[i-1]:
            obv.append(obv[-1] + df['volume'].iloc[i])
        elif df['close'].iloc[i] < df['close'].iloc[i-1]:
            obv.append(obv[-1] - df['volume'].iloc[i])
        else:
            obv.append(obv[-1])
    df['obv'] = obv
    
    # Volume rate of change (VROC) over different periods
    df['v
