```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    high_low_range = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    close_open_return = df['close'] / df['open'] - 1
    
    # Combine High-Low Range and Close-Open Return
    combined_return = (high_low_range + close_open_return) / 2
    
    # Calculate Volume-Weighted High-Low Spread
    volume_weighted_spread = (df['high'] - df['low']) * df['volume']
    
    # Exponential Moving Average (EMA) of Weighted High-Low Spread
    ema_window = 10
    ema_spread = df['volume'] * (df['high'] - df['low'])
    ema_spread = ema_spread.ewm(span=ema_window, adjust=False).mean()
    
    # Identify Volume Spike
    M = 30  # Moving average window
    std_dev = df['volume'].rolling(window=M).std()
    moving_avg_volume = df['volume'].rolling(window=M).mean()
    volume_spike = (df['volume'] > moving_avg_volume + 2 * std_dev).astype(int)
    
    # Calculate N-day Price Momentum
    N = 20
    n_day_return = df['close'].pct_change(periods=N)
    
    # Calculate Volume Weighted Adjusted Return
    adjusted_return = combined_return * df['volume']
    
    # Calculate Moving Average of Adjusted Return
    lookback_period = 50
    ma_adjusted_return = adjusted_return.rolling(window=lookback_period).mean()
    
    # Calculate Intraday Range to Open Ratio
    intraday_range_to_open = high_low_range / df['open']
    
    # Introduce Trend Strength Indicator
    trend_lookback = 60
    slope = df['close'].rolling(window=trend_lookback).apply(lambda x: np.polyfit(range(len(x)), x, 1)[0], raw=False)
    
    # Introduce Price Envelope Breakout Indicator
    envelope_lookback = 20
    upper_band = df['high'].rolling(window=envelope_lookback).max()
    lower_band = df['low'].rolling(window=envelope_lookback).min()
    bullish_breakout = (df['close'] > upper_band).astype(int)
    bearish_breakout = (df['close'] < lower_band).astype(int)
    
    # Constants for amplification and dampening
    K = 1.5  # Amplify return on volume spike days
    L = 1.2  # Amplify return on bullish breakout
    M = 0.8  # Dampen return on bearish breakout
    
    # Combine Factors
    factor = adjusted_return / ma_adjusted_return
    factor = factor * (1 + slope)
    
    # For Days with Volume Spike, Multiply N-day Return by a Factor K
    factor[volume_spike == 1] *= K * n_day_return[volume_spike == 1]
    
    # For Days without Volume Spike, Use Original N-day Return
    factor[volume_spike == 0] *= n_day_return[volume_spike == 0]
    
    # Incorporate Combined Return and Intraday Range to Open Ratio
    factor *= combined_return * intraday_range_to_open
    
    # Incorporate Price Envelope Breakout Indicator
    factor[bullish_breakout == 1] *= L
    factor[bearish_breakout == 1] *= M
    
    return factor
```
