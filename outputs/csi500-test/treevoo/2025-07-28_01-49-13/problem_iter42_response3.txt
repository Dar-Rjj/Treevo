```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = df['close'] - df['open']
    
    # Calculate the percentage change from open to close
    df['pct_change'] = (df['close'] - df['open']) / df['open'] * 100
    
    # Calculate the average volume over a short period (e.g., 5 days)
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the ratio of current day's volume to the average volume
    df['volume_ratio'] = df['volume'] / df['avg_volume_5d']
    
    # Calculate the number of up and down days in a window (e.g., 5 days)
    df['up_days'] = (df['daily_return'] > 0).rolling(window=5).sum()
    df['down_days'] = (df['daily_return'] < 0).rolling(window=5).sum()
    
    # Calculate the ratio of up days to total days in the window
    df['up_down_ratio'] = df['up_days'] / (df['up_days'] + df['down_days'])
    
    # Calculate the range of the day (high - low)
    df['range'] = df['high'] - df['low']
    
    # Calculate the ratio of the range to the close price
    df['range_close_ratio'] = df['range'] / df['close']
    
    # Calculate the average amount traded over a short period (e.g., 5 days)
    df['avg_amount_5d'] = df['amount'].rolling(window=5).mean()
    
    # Calculate the ratio of current day's amount to the average amount
    df['amount_ratio'] = df['amount'] / df['avg_amount_5d']
    
    # Create a composite factor by summing or averaging the above factors
    df['composite_factor'] = (
        df['daily_return'] +
        df['pct_change'] +
        df['volume_ratio'] +
        df['up_down_ratio'] +
        df['range_close_ratio'] +
        df['amount_ratio']
    ) / 6.0  # Average of the factors
    
    return df['composite_factor']
```
