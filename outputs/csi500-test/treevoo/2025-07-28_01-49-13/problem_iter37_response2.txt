```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 7-day and 21-day simple moving averages of close prices
    df['SMA_7'] = df['close'].rolling(window=7).mean()
    df['SMA_21'] = df['close'].rolling(window=21).mean()
    
    # Compare the current close price with the 7-day SMA
    df['Trend_Signal'] = (df['close'] > df['SMA_7']).astype(int) - (df['close'] < df['SMA_7']).astype(int)
    
    # Determine if the 7-day SMA is rising or falling compared to the 21-day SMA
    df['SMA_7_Rising'] = (df['SMA_7'] > df['SMA_21']).astype(int) - (df['SMA_7'] < df['SMA_21']).astype(int)
    
    # Combine the trend signals
    df['Combined_Trend'] = df['Trend_Signal'] + df['SMA_7_Rising']
    
    # Calculate the percentage change in volume and close price from the previous day
    df['Volume_Change'] = df['volume'].pct_change()
    df['Price_Change'] = df['close'].pct_change()
    
    # Determine if high volume accompanies significant price changes
    df['High_Volume_Price_Change'] = (df['Volume_Change'] > 0.5) & (df['Price_Change'].abs() > 0.05)
    
    # Detect gaps between consecutive days' prices
    df['Gap'] = df['open'] - df['close'].shift(1)
    df['Gap_Type'] = 'No Gap'
    df.loc[df['Gap'] > 0.05 * df['close'].shift(1), 'Gap_Type'] = 'Up Gap'
    df.loc[df['Gap'] < -0.05 * df['close'].shift(1), 'Gap_Type'] = 'Down Gap'
    
    # Convert Gap_Type to numerical representation
    gap_mapping = {'No Gap': 0, 'Up Gap': 1, 'Down Gap': -1}
    df['Gap_Type'] = df['Gap_Type'].map(gap_mapping)
    
    # Combine all signals into a final alpha factor
    df['Alpha_Factor'] = df['Combined_Trend'] + df['High_Volume_Price_Change'].astype(int) + df['Gap_Type']
    
    return df['Alpha_Factor']
```
