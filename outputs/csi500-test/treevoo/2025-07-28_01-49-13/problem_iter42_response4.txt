```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=14, w1=0.3, w2=-0.2, w3=-0.2, w4=0.3, threshold=0.5):
    # Calculate daily log return
    df['Daily_Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Calculate Williams %R
    df['HH'] = df['high'].rolling(window=N).max()
    df['LL'] = df['low'].rolling(window=N).min()
    df['Williams_%R'] = (df['HH'] - df['close']) / (df['HH'] - df['LL'])
    
    # Calculate True Range and ATR
    df['Truerange'] = df[['high', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['ATR'] = df['Truerange'].rolling(window=N).mean()
    
    # Calculate Volume Weighted Moving Average (VWMA)
    df['Volume_Price'] = df['volume'] * df['close']
    df['Cum_Volume'] = df['volume'].rolling(window=N).sum()
    df['Cum_Volume_Price'] = df['Volume_Price'].rolling(window=N).sum()
    df['VWMA'] = df['Cum_Volume_Price'] / df['Cum_Volume']
    
    # Calculate Money Flow Index (MFI)
    df['Money_Flow'] = df['volume'] * (2*df['close'] - df['high'] - df['low']) / (df['high'] - df['low'])
    df['Positive_Money_Flow'] = df['Money_Flow'].apply(lambda x: x if x > 0 else 0)
    df['Negative_Money_Flow'] = df['Money_Flow'].apply(lambda x: -x if x < 0 else 0)
    df['Pos_MF'] = df['Positive_Money_Flow'].rolling(window=N).sum()
    df['Neg_MF'] = df['Negative_Money_Flow'].rolling(window=N).sum()
    df['MFI'] = 100 - (100 / (1 + (df['Pos_MF'] / df['Neg_MF'])))
    
    # Composite Alpha
    df['Composite_Alpha'] = (w1 * df['Daily_Log_Return'] +
                             w2 * df['Williams_%R'] +
                             w3 * df['ATR'] +
                             w4 * df['MFI'])
    
    # Generate trade signals based on the composite alpha and threshold
    df['Signal'] = df['Composite_Alpha'].apply(lambda x: 1 if x > threshold else (-1 if x < -threshold else 0))
    
    return df['Signal'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# signals = heuristics_v2(df)
```
