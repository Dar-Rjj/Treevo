```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Returns
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Compute Moving Averages
    df['ma_5'] = df['close'].rolling(window=5).mean()
    df['ma_20'] = df['close'].rolling(window=20).mean()
    df['ma_50'] = df['close'].rolling(window=50).mean()
    
    # Determine Trend Direction
    df['trend_5_20'] = df['ma_5'] > df['ma_20']
    df['trend_20_50'] = df['ma_20'] > df['ma_50']
    
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Adjusted Close-to-Open Return
    df['adj_close_to_open'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Compute the ratio of the close to the high
    df['close_to_high_ratio'] = df['close'] / df['high']
    
    # Compute the ratio of the close to the low
    df['close_to_low_ratio'] = df['close'] / df['low']
    
    # Calculate Volume Changes
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Measure Volume Relative to Price Movements
    df['vol_relative_to_price'] = df['volume'] / df['intraday_range']
    
    # Compute Daily Dollar Volume
    df['dollar_volume'] = df['close'] * df['volume']
    
    # Use standard deviation over past 20 days as volatility
    df['volatility'] = df['close'].rolling(window=20).std()
    
    # Calculate Open-Close Spread
    df['open_close_spread'] = df['open'] - df['close']
    
    # Measure Open-High and Low-Close Gaps
    df['open_high_gap'] = df['open'] - df['high'].shift(1)
    df['low_close_gap'] = df['low'] - df['close'].shift(1)
    
    # Calculate RSI (Relative Strength Index)
    df['rsi'] = compute_rsi(df['close'], 14)
    
    # Measure MACD (Moving Average Convergence Divergence)
    df['macd_line'], df['signal_line'], df['macd_hist'] = compute_macd(df['close'], 12, 26, 9)
    
    # Calculate Daily Price Change
    df['daily_price_change'] = df['close'] - df['close'].shift(1)
    
    # Compute Cumulative Price Change
    df['cumulative_price_change'] = df['daily_price_change'].cumsum()
    
    # Final Factor Adjustment
    df['final_factor'] = (df['close'] - df['open']) / (df['high'] - df['low']) * (df['close'] - df['open'].shift(-1)) * df['volume']
    
    # Apply Exponential Moving Average on Daily Price Change
    df['ema_daily_price_change'] = df['daily_price_change'].ewm(span=20, adjust=False).mean()
    
    return df['final_factor']

def compute_rsi(series, period):
    delta = series.diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=period).mean()
    avg_loss = loss.rolling(window=period).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    return rsi

def compute_macd(series, fast, slow, signal):
    ema_fast = series.ewm(span=fast, adjust=False).mean()
    ema_slow = series.ewm(span=slow, adjust=False).mean()
    macd_line = ema_fast - ema_slow
    signal_line = macd_line.ewm(span=signal, adjust=False).mean()
    macd_hist = macd_line - signal_line
    return macd_line, signal_line, macd_hist
```
