```python
import pandas as pd

def heuristics_v2(df):
    # Momentum, volatility, and volume-based factor
    df['momentum_5d'] = df['close'] - df['close'].rolling(window=5).mean()
    df['volatility_5d'] = df['close'].rolling(window=5).std()
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=5).mean()
    df['adjusted_momentum'] = df['momentum_5d'] / df['volatility_5d']
    df['vol_adjusted_mom_vol'] = df['adjusted_momentum'] * df['volume_ratio']
    
    # Binary momentum signal
    df['binary_signal'] = ((df['high'] > df['high'].shift(1)) & (df['low'] > df['low'].shift(1))).astype(int)
    df['final_momentum_vol_factor'] = df['vol_adjusted_mom_vol'] + df['binary_signal']
    
    # Multi-period momentum factors
    df['short_mom'] = df['close'] - df['close'].shift(2)
    df['medium_mom'] = df['close'] - df['close'].shift(10)
    df['long_mom'] = df['close'] - df['close'].shift(30)
    df['multi_mom'] = 0.4 * df['short_mom'] + 0.3 * df['medium_mom'] + 0.3 * df['long_mom']
    
    # Moving average crossovers
    df['7_sma'] = df['close'].rolling(window=7).mean()
    df['25_sma'] = df['close'].rolling(window=25).mean()
    df['60_sma'] = df['close'].rolling(window=60).mean()
    df['crossover_7_25'] = df['7_sma'] - df['25_sma']
    df['crossover_25_60'] = df['25_sma'] - df['60_sma']
    df['crossover_7_60'] = df['7_sma'] - df['60_sma']
    
    # Volatility-based alpha factors
    df['daily_log_returns'] = np.log(df['close']) - np.log(df['close'].shift(1))
    df['std_30d'] = df['daily_log_returns'].rolling(window=30).std()
    df['atr_21d'] = df[['high', 'low']].apply(lambda x: (x['high'] - x['low']), axis=1).rolling(window=21).mean()
    df['range_avg_30d'] = (df['high'] - df['low']).rolling(window=30).mean()
    df['range_ratio_30d'] = (df['high'] - df['low']) / df['range_avg_30d']
    
    # Volume-based alpha factors
    df['obv'] = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0) * df['volume']
    df['vroc_2d'] = (df['volume'] - df['volume'].shift(2)) / df['volume'].shift(2)
    df['vroc_21d'] = (df['volume'] - df['volume'].shift(21)) / df['volume'].shift(21)
    df['vroc_50d'] = (df['volume'] - df['volume'].shift(50)) / df['volume'].shift(50)
    
    # Pattern recognition alpha factors
    df['bullish_engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] > df['open']) & 
                               (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))).astype(int)
    df['bearish_engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] < df['open']) & 
                               (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1))).astype(int)
    df['doji'] = ((df['high'] - df['low']) > 0) & ((df['high'] - df['low']) < 0.01 * df['close'])
    df['hammer'] = (df['low'] - df['close'].shift(1)) > 2 * (df['open
