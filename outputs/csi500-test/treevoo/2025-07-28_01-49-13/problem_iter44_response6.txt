```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    short_window = 10
    long_window = 30
    window = 20
    
    # Calculate Simple Moving Average (SMA)
    df['SMA_short'] = df['close'].rolling(window=short_window).mean()
    df['SMA_long'] = df['close'].rolling(window=long_window).mean()
    
    # Calculate Exponential Moving Average (EMA)
    df['EMA_short'] = df['close'].ewm(span=short_window, adjust=False).mean()
    
    # Slope of SMA_short
    df['Slope_SMA_short'] = df['SMA_short'].diff() / df['SMA_short'].shift(1)
    
    # Rate of change in EMA_short
    df['RateOfChange_EMA_short'] = df['EMA_short'].pct_change()
    
    # Difference between EMA and SMA
    df['EMA_SMA_diff'] = df['EMA_short'] - df['SMA_long']
    
    # High-Low spread
    df['High_Low_spread'] = df['high'] - df['low']
    df['Mean_High_Low_spread'] = df['High_Low_spread'].rolling(window=window).mean()
    
    # Open-Close price change
    df['Open_Close_change'] = df['close'] - df['open']
    
    # Consecutive up or down days
    df['Consecutive_days'] = (df['Open_Close_change'] > 0).astype(int) * 2 - 1
    df['Consecutive_days'] = df['Consecutive_days'].cumsum()
    
    # Volume trends
    df['Volume_ratio'] = df['volume'] / df['volume'].rolling(window=window).mean()
    
    # Daily Price Momentum
    df['Daily_Price_Momentum'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Intraday Return Adjusted by High-Low Range
    df['Intraday_Return_Adjusted'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Volume Change
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    
    # Dollar Volume
    df['Dollar_Volume'] = df['amount'] * df['close']
    
    # VWAP
    df['VWAP'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    df['VWAP_Momentum'] = (df['VWAP'] - df['open']) / df['VWAP']
    
    # Moving Averages Crossover
    df['SMA_Crossover'] = df['SMA_short'] - df['SMA_long']
    
    # RSI
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=window).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=window).mean()
    RS = gain / loss
    df['RSI'] = 100 - (100 / (1 + RS))
    
    # MACD
    df['MACD'] = df['EMA_short'] - df['close'].ewm(span=long_window, adjust=False).mean()
    
    # On-Balance Volume (OBV)
    df['OBV'] = df['volume'] * (df['close'] > df['close'].shift(1)).astype(int) - df['volume'] * (df['close'] < df['close'].shift(1)).astype(int)
    df['OBV'] = df['OBV'].cumsum()
    
    # Intraday Reversal
    df['Intraday_Reversal'] = (df['high'] - df['open']) / (df['high'] - df['low'])
    df['Intraday_Reversal_Adjustment'] = np.where(df['Intraday_Reversal'] > 0.5, 0.8, 1.0)
    
    # Final Alpha Factor
    df['Final_Alpha_Factor'] = (
        df['Daily_Price_Momentum'] *
        df['Open_Close_change'] *
        df['SMA_Crossover'] *
        df['RSI'] *
        df['MACD'] *
        df['OBV'] *
        df['Intraday_Reversal_Adjustment']
    )
    
    return df['Final_Alpha_Factor']
```
