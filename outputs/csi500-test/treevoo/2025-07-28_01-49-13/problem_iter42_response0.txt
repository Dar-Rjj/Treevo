```python
import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages (SMA) of close prices
    sma_5 = df['close'].rolling(window=5).mean()
    sma_10 = df['close'].rolling(window=10).mean()
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Calculate exponential moving averages (EMA) of close prices
    ema_5 = df['close'].ewm(span=5, adjust=False).mean()
    ema_10 = df['close'].ewm(span=10, adjust=False).mean()
    ema_20 = df['close'].ewm(span=20, adjust=False).mean()
    
    # Determine the difference between EMA and SMA
    diff_ema_sma_5 = ema_5 - sma_5
    diff_ema_sma_10 = ema_10 - sma_10
    diff_ema_sma_20 = ema_20 - sma_20
    
    # Analyze the high-low spread
    high_low_spread = df['high'] - df['low']
    avg_high_low_spread_5 = high_low_spread.rolling(window=5).mean()
    
    # Evaluate the open-close price change
    open_close_change = df['close'] - df['open']
    pct_open_close_change = open_close_change / df['open']
    
    # Measure trading volume trends
    volume_ma_5 = df['volume'].rolling(window=5).mean()
    volume_ma_10 = df['volume'].rolling(window=10).mean()
    volume_ma_20 = df['volume'].rolling(window=20).mean()
    
    # Combine multiple indicators
    composite_factor = (
        (diff_ema_sma_20 * 0.3) + 
        (avg_high_low_spread_5 * 0.2) + 
        (pct_open_close_change * 0.2) + 
        ((df['volume'] - volume_ma_20) / volume_ma_20 * 0.3)
    )
    
    # Explore the relationship between amount and volume
    avg_transaction_size = df['amount'] / df['volume']
    avg_transaction_size_trend = avg_transaction_size.rolling(window=5).mean()
    
    # Integrate the average transaction size trend into the composite factor
    composite_factor_with_transaction_size = composite_factor + (avg_transaction_size_trend - avg_transaction_size_trend.mean())
    
    return composite_factor_with_transaction_size
```
