```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate N-day Price Momentum
    n = 10
    df['N-day Return'] = df['close'].pct_change(n)
    
    # Identify Volume Spike
    m = 20
    df['Volume Moving Average'] = df['volume'].rolling(m).mean()
    df['Volume Standard Deviation'] = df['volume'].rolling(m).std()
    df['Volume Spike'] = (df['volume'] > (df['Volume Moving Average'] + 2 * df['Volume Standard Deviation'])).astype(int)
    
    # Combine Price Momentum and Volume Spike
    k = 2.0
    df['Enhanced N-day Return'] = df['N-day Return'] * (1 + (k - 1) * df['Volume Spike'])
    
    # Calculate Intraday Range
    df['Intraday Range'] = df['high'] - df['low']
    
    # Calculate Intraday Midpoint to Open Ratio
    df['Intraday Midpoint'] = (df['high'] + df['low']) / 2
    df['Intraday Midpoint to Open Ratio'] = df['Intraday Midpoint'] / df['open']
    
    # Calculate Close-to-Open Return
    df['Close-to-Open Return'] = df['close'] - df['open']
    
    # Adjust Close-to-Open Return by Intraday Range
    df['Adjusted Close-to-Open Return'] = df['Close-to-Open Return'] * df['Intraday Range']
    
    # Calculate Volume-Weighted Volatility
    avg_volume_20 = df['volume'].rolling(20).mean()
    df['Volume-Weighted Volatility'] = df['Intraday Range'] / avg_volume_20
    
    # Calculate Volume Weighted Average Price (VWAP)
    df['VWAP'] = df['amount'] / df['volume']
    
    # Calculate Close-to-Next Day Open Return over a period
    df['Close-to-Next Day Open Return'] = df['VWAP'] - df['open'].shift(-1)
    
    # Calculate Close-to-Open Envelope
    envelope_period = 5
    df['Max Close'] = df['close'].rolling(envelope_period).max()
    df['Min Open'] = df['open'].rolling(envelope_period).min()
    
    # Calculate Adjusted Close-to-Open Envelope
    df['Max Adjusted Close'] = df['close'].rolling(envelope_period).max()
    df['Min Open'] = df['open'].rolling(envelope_period).min()
    
    # Combine Metrics
    df['Weighted Intraday Range'] = df['Intraday Range'] * df['Volume Spike']
    df['Combined Metrics'] = df['Weighted Intraday Range'] + df['Adjusted Close-to-Open Return']
    
    # Enhance Combined Metrics
    df['Enhanced Combined Metrics'] = df['Combined Metrics'] * (1 + (k - 1) * df['Volume Spike'])
    df['Enhanced Combined Metrics'] = df['Enhanced Combined Metrics'] * df['Intraday Range'] * df['Adjusted Close-to-Open Return']
    
    # Calculate Daily Price Momentum
    df['Daily Price Momentum'] = df['close'] - df['close'].shift(1)
    
    # Compute Cumulative Sum of Price Momentum
    df['Cumulative Price Momentum'] = df['Daily Price Momentum'].cumsum()
    
    # Compute Cumulative Sum of Volume Change
    df['Volume Change'] = df['volume'] - df['volume'].shift(1)
    df['Cumulative Volume Change'] = df['Volume Change'].cumsum()
    
    # Combine Cumulative Sums
    df['Combined Cumulative Sums'] = df['Cumulative Price Momentum'] * df['Cumulative Volume Change']
    
    # Calculate Volume Weighted Adjusted Return
    df['Volume Weighted Adjusted Return'] = df['volume'] * df['Enhanced Combined Metrics']
    
    # Calculate Exponential Moving Average of Volume Weighted Adjusted Return
    lookback_period = 20
    df['Exponential Moving Average'] = df['Volume Weighted Adjusted Return'].ewm(span=lookback_period).mean()
    
    # Final Combination
    df['Final Factor'] = df['Enhanced Combined Metrics'] + df['Combined Cumulative Sums']
    df['Final Factor'] = df['Final Factor'] * df['Volume-Weighted Volatility'] * df['Volume Change'] * (df['Volume Weighted Adjusted Return'] / df['Exponential Moving Average'])
    
    return df['Final Factor']
```
