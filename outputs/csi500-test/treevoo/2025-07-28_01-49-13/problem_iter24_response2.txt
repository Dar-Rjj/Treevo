```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Compute the sum of positive and negative daily returns over the past 20 days
    positive_returns_sum = df['daily_return'].rolling(window=20).apply(lambda x: x[x > 0].sum(), raw=False)
    negative_returns_sum = df['daily_return'].rolling(window=20).apply(lambda x: x[x < 0].sum(), raw=False)
    
    # Generate the first two factors
    factor1 = positive_returns_sum / 20
    factor2 = negative_returns_sum / 20
    
    # Calculate the average trading volume over the last 10 days
    avg_volume_10d = df['volume'].rolling(window=10).mean()
    
    # Compare today's volume with the 10-day average
    factor3 = (df['volume'] > avg_volume_10d).astype(int) * 2 - 1
    
    # Analyze the relationship between the highest and lowest prices over the past 5 days
    avg_high_5d = df['high'].rolling(window=5).mean()
    avg_low_5d = df['low'].rolling(window=5).mean()
    
    # Calculate the ratio of the average high price to the average low price
    factor4 = avg_high_5d / avg_low_5d
    
    # Combine all factors into a DataFrame
    factors = pd.DataFrame({
        'factor1': factor1,
        'factor2': factor2,
        'factor3': factor3,
        'factor4': factor4
    })
    
    return factors
```
