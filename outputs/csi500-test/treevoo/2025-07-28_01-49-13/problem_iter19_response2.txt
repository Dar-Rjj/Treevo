```python
import pandas as pd
import numpy as np
from scipy.stats import linregress

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    intraday_range = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    close_open_return = df['close'] / df['open'] - 1
    
    # Combine High-Low Range and Close-Open Return
    combined_return = (intraday_range + close_open_return) / 2
    
    # Calculate Volume-Weighted High-Low Spread
    volume_weighted_spread = (df['high'] - df['low']) * df['volume']
    
    # Exponential Moving Average (EMA) of Weighted High-Low Spread
    ema_window = 10
    weighted_spread_ema = df['volume'] * (df['high'] - df['low'])
    weighted_spread_ema = weighted_spread_ema.ewm(span=ema_window).mean()
    
    # Identify Volume Spike
    M = 20  # Lookback period for moving average
    volume_ma = df['volume'].rolling(window=M).mean()
    volume_std = df['volume'].rolling(window=M).std()
    volume_spike = df['volume'] > (volume_ma + 2 * volume_std)
    
    # Calculate N-day Price Momentum
    N = 10  # N days for momentum
    n_day_return = df['close'].pct_change(periods=N)
    
    # Calculate Intraday Range to Open Ratio
    intraday_range_to_open_ratio = intraday_range / df['open']
    
    # Introduce Trend Strength Indicator
    trend_lookback = 30  # Lookback period for trend strength
    trend_strength = []
    for i in range(len(df)):
        if i < trend_lookback:
            trend_strength.append(0)
        else:
            slope, _, _, _, _ = linregress(np.arange(trend_lookback), df['close'].iloc[i-trend_lookback+1:i+1])
            trend_strength.append(slope)
    trend_strength = pd.Series(trend_strength, index=df.index)
    
    # Introduce Price Envelope Breakout Indicator
    envelope_lookback = 20  # Lookback period for price envelope
    upper_band = df['high'].rolling(window=envelope_lookback).max()
    lower_band = df['low'].rolling(window=envelope_lookback).min()
    bullish_breakout = df['close'] > upper_band
    bearish_breakout = df['close'] < lower_band
    
    # Combine Factors
    K = 1.5  # Amplification factor for volume spike
    L = 1.2  # Amplification factor for bullish breakout
    M = 0.8  # Dampening factor for bearish breakout
    
    # Adjust combined return by intraday range to open ratio
    combined_return = combined_return * intraday_range_to_open_ratio
    
    # For days with volume spike, multiply N-day return by a factor K
    n_day_return_with_spike = n_day_return.where(~volume_spike, n_day_return * K)
    
    # For days without volume spike, use original N-day return
    final_return = n_day_return_with_spike * trend_strength
    
    # Incorporate price envelope breakout indicator
    final_return = final_return.where(~bullish_breakout, final_return * L)
    final_return = final_return.where(~bearish_breakout, final_return * M)
    
    return final_return
```
