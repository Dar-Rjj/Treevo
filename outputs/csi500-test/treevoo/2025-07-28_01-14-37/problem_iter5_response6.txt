```python
import pandas as pd
import numpy as np
from scipy.stats import skew, kurtosis

def heuristics_v2(df):
    # Calculate Intraday Return
    df['intraday_return'] = df['close'] / df['open'] - 1
    
    # Calculate Logarithmic Return
    df['log_return'] = np.log(1 + df['intraday_return'] + 1e-8)
    
    # Winsorize to handle outliers
    df['log_return'] = df['log_return'].clip(lower=df['log_return'].quantile(0.01), upper=df['log_return'].quantile(0.99))
    
    # Calculate High-to-Low Range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate Close Price Change
    df['close_change'] = df['close'] - df['close'].shift(1)
    
    # Calculate Volume-Weighted Price (VWP)
    df['vwp'] = ((df['high'] + df['low'] + df['close']) / 3) * df['volume']
    
    # Compute Weighted Momentum
    df['weighted_momentum'] = df['close_change'] / df['vwp']
    
    # Adjust for Volatility
    df['vol_adj_momentum'] = df['weighted_momentum'] / df['high_low_range']
    
    # Combine Intraday and Volatility-Adjusted Momentum
    log_return_weight = df['volume'].ewm(alpha=0.1).mean()
    vol_adj_momentum_weight = df['volume'].ewm(alpha=0.1).mean()
    df['combined_momentum'] = (df['log_return'] * log_return_weight + df['vol_adj_momentum'] * vol_adj_momentum_weight) / 2
    
    # Determine Trend Direction
    short_term_ma = df['close'].rolling(window=5).mean()
    long_term_ma = df['close'].rolling(window=20).mean()
    df['trend_direction'] = np.where(short_term_ma > long_term_ma, 1, -1)
    
    # Confirm with Volume
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['adjusted_momentum'] = df['trend_direction'] * df['volume_change']
    df['final_factor'] = (df['combined_momentum'] + df['adjusted_momentum']) / 2
    
    # Adjust for Skewness and Kurtosis
    df['skewness'] = skew(df['final_factor'])
    df['kurtosis'] = kurtosis(df['final_factor'])
    df['final_factor'] = (df['final_factor'] - df['skewness']) / (df['kurtosis'] * df['high_low_range'])
    
    return df['final_factor']

# Example usage
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor = heuristics_v2(df)
```
