```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=14):
    # Momentum Factors
    df['Simple_Price_Momentum'] = df['close'].diff(n)
    
    up = df['close'].diff(1).clip(lower=0)
    down = -df['close'].diff(1).clip(upper=0)
    df['Avg_Up'] = up.rolling(window=n, min_periods=1).mean()
    df['Avg_Down'] = down.rolling(window=n, min_periods=1).mean()
    df['RSI'] = 100 - (100 / (1 + df['Avg_Up'] / df['Avg_Down']))
    
    # Volume Factors
    df['Volume_MA'] = df['volume'].rolling(window=n, min_periods=1).mean()
    df['Volume_Trend'] = df['volume'] - df['Volume_MA']
    
    df['Volume_Volatility'] = df['volume'].rolling(window=n, min_periods=1).std()
    
    # Volatility Factors
    df['True_Range'] = np.maximum(np.maximum(df['high'] - df['low'], abs(df['high'] - df['close'].shift(1))), abs(df['low'] - df['close'].shift(1)))
    df['ATR'] = df['True_Range'].rolling(window=n, min_periods=1).mean()
    
    # Trend Following Factors
    short_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_ema = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD_Line'] = short_ema - long_ema
    df['Signal_Line'] = df['MACD_Line'].ewm(span=9, adjust=False).mean()
    
    # Pattern Recognition Factors
    df['Price_Oscillator'] = df['close'] - df['close'].rolling(window=n, min_periods=1).mean()
    
    df['SMA_20'] = df['close'].rolling(window=20, min_periods=1).mean()
    df['Std_20'] = df['close'].rolling(window=20, min_periods=1).std()
    df['Upper_BB'] = df['SMA_20'] + 2 * df['Std_20']
    df['Lower_BB'] = df['SMA_20'] - 2 * df['Std_20']
    
    # Combined Factors
    df['Momentum_and_Volume'] = df['Simple_Price_Momentum'] * df['Volume_Trend']
    df['Volatility_and_Trend'] = df['ATR'] * df['MACD_Line']
    df['Pattern_and_Trend'] = df['Price_Oscillator'] * (df['close'] - df['SMA_20'])
    
    return df['Momentum_and_Volume'] + df['Volatility_and_Trend'] + df['Pattern_and_Trend']
```
