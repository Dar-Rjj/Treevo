```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n_days=5, rsi_period=14):
    # Calculate Intraday Volatility
    intraday_volatility = (df['high'] - df['low']).rolling(window=n_days).mean()

    # Calculate Price Changes and High-to-Low Range
    daily_price_change = df['close'].diff()
    high_low_range = df['high'] - df['low']

    # Separate Positive and Negative Gains
    positive_gains = daily_price_change[daily_price_change > 0].fillna(0)
    negative_gains = -daily_price_change[daily_price_change < 0].fillna(0)

    # Sum of Positive and Negative Gains Over a Period
    sum_positive_gains = positive_gains.rolling(window=rsi_period).sum()
    sum_negative_gains = negative_gains.rolling(window=rsi_period).sum()

    # Adjust for Volume and Amount
    volume_weighted_positive_gain = (positive_gains * df['volume']).rolling(window=rsi_period).sum() + (positive_gains * df['amount']).rolling(window=rsi_period).sum()
    volume_weighted_negative_gain = (negative_gains * df['volume']).rolling(window=rsi_period).sum() + (negative_gains * df['amount']).rolling(window=rsi_period).sum()

    # Calculate RSI
    rs = volume_weighted_positive_gain / volume_weighted_negative_gain
    rsi = 100 - (100 / (1 + rs))

    # Calculate Intraday Return
    intraday_return = df['close'] / df['open'] - 1

    # Calculate Logarithmic Return
    log_return = np.log(intraday_return + 1e-6)  # Small constant to avoid log(0)

    # Winsorize to Remove Extreme Values
    upper_bound = np.percentile(log_return, 99)
    lower_bound = np.percentile(log_return, 1)
    log_return = np.clip(log_return, lower_bound, upper_bound)

    # Adjusted Momentum
    adjusted_momentum = intraday_volatility * log_return

    # Weighted Sum of Adjusted Momentum and RSI
    momentum_weighted = adjusted_momentum * df['volume']
    rsi_weighted = rsi * df['volume']

    final_factor = momentum_weighted + rsi_weighted

    # Adjust for Skewness and Kurtosis
    skewness = final_factor.skew()
    kurtosis = final_factor.kurtosis()

    # Rescale
    final_factor = (final_factor - final_factor.mean()) / final_factor.std()
    final_factor = final_factor * (1 - skewness) * (1 - kurtosis)

    return final_factor
```
