```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between the closing price and the opening price
    df['close_open_diff'] = df['close'] - df['open']
    
    # Determine if the close price is higher than the open
    df['positive_day'] = (df['close'] > df['open']).astype(int)
    
    # Count the number of consecutive days where the close is higher than the open
    df['upward_momentum'] = df['positive_day'].groupby((df['positive_day'] != df['positive_day'].shift()).cumsum()).cumsum()
    
    # Calculate the Average True Range (ATR) over N days
    N = 14
    df['high_low'] = df['high'] - df['low']
    df['high_close_prev'] = abs(df['high'] - df['close'].shift())
    df['low_close_prev'] = abs(df['low'] - df['close'].shift())
    df['true_range'] = df[['high_low', 'high_close_prev', 'low_close_prev']].max(axis=1)
    df['atr_14'] = df['true_range'].rolling(window=N).mean()
    
    # Weight the importance of each day's close-open difference within a window using ATR
    df['weighted_momentum'] = df['close_open_diff'] / df['atr_14']
    
    # Examine the ratio of the highest price to the lowest price on a given day
    df['high_low_ratio'] = df['high'] / df['low']
    
    # Compute the average of this daily high-low ratio over a recent period
    P = 5
    df['avg_high_low_ratio'] = df['high_low_ratio'].rolling(window=P).mean()
    
    # Integrate trading volume into this smoothed high-low ratio
    df['weighted_volatility_score'] = df['avg_high_low_ratio'] * df['volume']
    
    # Explore the relationship between the closing price and the average of the high and low prices (typical price)
    df['typical_price'] = (df['high'] + df['low']) / 2
    df['close_typical_diff'] = df['close'] - df['typical_price']
    
    # Accumulate these differences over a fixed period to create a trend-following metric
    M = 10
    df['trend_following_metric'] = df['close_typical_diff'].rolling(window=M).sum()
    
    # Dynamic adjustment factor based on the recent rate of change in the typical price
    R = 3
    df['recent_typical_roc'] = df['typical_price'].pct_change(periods=R)
    df['dynamic_adjustment_factor'] = 1 + df['recent_typical_roc']
    df['enhanced_trend_metric'] = df['trend_following_metric'] * df['dynamic_adjustment_factor']
    
    # Final Alpha Factor
    alpha_factor = df['weighted_momentum'] + df['weighted_volatility_score'] + df['enhanced_trend_metric']
    
    return alpha_factor
```
