```python
import pandas as pd
import numpy as np
from scipy.stats import linregress

def heuristics_v2(df):
    # Momentum factor
    df['return_20d'] = df['close'].pct_change(20)
    df['avg_return_60d'] = df['close'].pct_change(60).rolling(window=60).mean()
    momentum_factor = df['return_20d'] - df['avg_return_60d']

    # Volatility factor
    daily_returns = df['close'].pct_change()
    volatility_factor = daily_returns.rolling(window=30).std()

    # Amplitude factor
    amplitude_daily = df['high'] - df['low']
    amplitude_factor = amplitude_daily.rolling(window=10).sum()

    # Volume acceleration factor
    volume_change_pct = df['volume'].pct_change()
    volume_acceleration_factor = volume_change_pct.rolling(window=5).mean()

    # Price-volume relationship factor
    price_return = df['close'].pct_change()
    weighted_price_volume = (price_return * df['volume']).rolling(window=10).apply(lambda x: np.average(x, weights=np.arange(1, 11)), raw=False)

    # Liquidity factor
    liquidity_ratio = df['volume'] / (df['high'] - df['low'])
    liquidity_factor = liquidity_ratio.rolling(window=20).mean()

    # Price reversal factor
    price_direction = np.sign(df['close'] - df['open'])
    price_reversal_daily = price_direction * (df['high'] - df['low'])
    price_reversal_factor = price_reversal_daily.rolling(window=7).sum()

    # Gap analysis factor
    gap_size = (df['open'] - df['close'].shift(1)).abs()
    gap_score = gap_size * np.sign(df['open'] - df['close'].shift(1))
    gap_analysis_factor = gap_score.rolling(window=30).sum()

    # Trade intensity factor
    avg_price_per_share = df['amount'] / df['volume']
    trade_intensity_factor = avg_price_per_share.pct_change().rolling(window=5).sum()

    # Trend strength factor
    trend_strength = df['close'].rolling(window=60).apply(lambda x: linregress(np.arange(len(x)), x)[0], raw=False)

    # Price action factor
    def candlestick_score(row):
        if row['close'] > row['open']:
            return 1  # Bullish
        elif row['close'] < row['open']:
            return -1  # Bearish
        else:
            return 0  # Neutral
    df['candlestick_score'] = df.apply(candlestick_score, axis=1)
    price_action_factor = df['candlestick_score'].rolling(window=10).sum()

    # Support and resistance factor
    min_prices = df['low'].rolling(window=30, center=True).min()
    max_prices = df['high'].rolling(window=30, center=True).max()
    support_resistance_score = (df['close'] - min_prices) / (max_prices - min_prices)
    support_resistance_factor = support_resistance_score.rolling(window=30).mean()

    # Composite sentiment factor
    composite_sentiment_factor = (momentum_factor + volatility_factor + price_action_factor) / 3

    return composite_sentiment_factor.dropna()
```
