```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Movement Range
    df['daily_range'] = df['high'] - df['low']
    
    # Calculate Volume Weighted Average Price (VWAP)
    df['vwap'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Determine Daily Return Deviation from VWAP
    df['deviation_from_vwap'] = df['close'] - df['vwap']
    
    # Identify Trend Reversal Potential
    df['trend_reversal_potential'] = df['deviation_from_vwap'] > df['deviation_from_vwap'].shift(1)
    
    # Check for Volume Increase
    df['volume_increase'] = df['volume'] > df['volume'].rolling(window=14).mean()
    
    # Calculate High-Low Range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate Price Breakout Ratio
    df['price_breakout_ratio'] = (df['high'] - df['open']) / df['high_low_range']
    
    # Calculate Volume Breakout Indicator
    df['volume_breakout_indicator'] = (df['close'] - df['open']) * df['volume']
    
    # Aggregate Volume-Weighted Breakout Ratios
    df['volume_weighted_breakout_ratio'] = df['price_breakout_ratio'] * df['volume']
    df['volume_weighted_breakout_sum'] = df['volume_weighted_breakout_ratio'].rolling(window=14).sum()
    
    # Smooth with Exponential Moving Average
    smoothing_factor = 0.2
    df['smoothed_breakout_ratio'] = df['volume_weighted_breakout_sum'].ewm(alpha=smoothing_factor, adjust=False).mean()
    
    # Final Score Calculation
    df['final_score'] = 0
    df.loc[df['trend_reversal_potential'] & df['volume_increase'] & (df['smoothed_breakout_ratio'] > df['smoothed_breakout_ratio'].median()), 'final_score'] = 1
    
    return df['final_score']

# Example usage:
# df = pd.DataFrame({
#     'date': pd.date_range(start='1/1/2023', periods=30),
#     'open': [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129],
#     'high': [102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131],
#     'low': [98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127],
#     'close': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 1
