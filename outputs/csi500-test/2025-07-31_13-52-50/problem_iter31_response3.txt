```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = df['close'] - df['open']
    
    # Sum of the last three days' daily returns
    df['sum_last_3_days_return'] = df['daily_return'].rolling(window=3).sum()
    
    # Ratio of the highest price to the lowest price over the past week
    df['high_low_ratio'] = df['high'].rolling(window=7).max() / df['low'].rolling(window=7).min()
    
    # Volume-adjusted return
    df['volume_adjusted_return'] = df['daily_return'] * df['volume']
    
    # Change in volume from the previous day to the current one
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Short-term moving average (5-day SMA)
    df['5_day_sma'] = df['close'].rolling(window=5).mean()
    
    # Longer-term moving average (20-day SMA)
    df['20_day_sma'] = df['close'].rolling(window=20).mean()
    
    # Distance between the closing price and the 5-day SMA
    df['distance_5_day_sma'] = df['close'] - df['5_day_sma']
    
    # Relationship between the 5-day and 20-day moving averages
    df['sma_crossover'] = (df['5_day_sma'] > df['20_day_sma']).astype(int) - (df['5_day_sma'] < df['20_day_sma']).astype(int)
    
    # Average gap between high and low over the past 10 days
    df['avg_gap_10_days'] = (df['high'] - df['low']).rolling(window=10).mean()
    
    # Current day's gap
    df['current_gap'] = df['high'] - df['low']
    
    # Cumulative amount traded over the past 10 days
    df['cumulative_amount_10_days'] = df['amount'].rolling(window=10).sum()
    
    # Total trade value over the past 10 days
    df['total_trade_value_10_days'] = (df['close'] * df['volume']).rolling(window=10).sum()
    
    # Average price per unit traded over the past 10 days
    df['avg_price_per_unit'] = df['total_trade_value_10_days'] / df['cumulative_amount_10_days']
    
    # Deviation of the current dayâ€™s close from the average price per unit traded
    df['deviation_from_avg_price'] = df['close'] - df['avg_price_per_unit']
    
    # Combine all the sub-thoughts into a single alpha factor
    df['alpha_factor'] = (
        df['daily_return'] + 
        df['sum_last_3_days_return'] + 
        df['high_low_ratio'] + 
        df['volume_adjusted_return'] + 
        df['volume_change'] + 
        df['distance_5_day_sma'] + 
        df['sma_crossover'] + 
        df['current_gap'] - df['avg_gap_10_days'] + 
        df['deviation_from_avg_price']
    )
    
    return df['alpha_factor']
```
