import pandas as pd

def heuristics_v2(df):
    lookback_period = 20
    log_return = (df['close'].pct_change(lookback_period) + 1).apply(np.log)
    avg_volume = df['volume'].rolling(window=lookback_period).mean()
    volume_ratio = df['volume'] / avg_volume
    amount_change = df['amount'].pct_change(lookback_period)
    
    # Weights
    w_log_return = 0.6
    w_volume_ratio = 0.3
    w_amount_change = 0.1
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_log_return * log_return) + (w_volume_ratio * volume_ratio) + (w_amount_change * amount_change)
    return heuristics_matrix
