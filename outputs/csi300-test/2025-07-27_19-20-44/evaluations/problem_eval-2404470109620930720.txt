def heuristics_v2(df):
    lookback_period = 20
    close_change = df['close'].diff()
    gain = close_change.where(close_change > 0, 0).rolling(window=lookback_period).mean()
    loss = -close_change.where(close_change < 0, 0).rolling(window=lookback_period).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    high_low_diff = df['high'] - df['low']
    vol_change = df['volume'].pct_change(lookback_period)
    vol_volatility = df['volume'].rolling(window=lookback_period).std() / df['volume'].rolling(window=lookback_period).mean()
    
    # Adjusting weights dynamically
    w_rsi = 1 / (1 + vol_volatility)
    w_high_low = 1 - w_rsi
    w_vol_change = 1 - (w_rsi + w_high_low)

    # Calculate the heuristic factor
    heuristics_matrix = (w_rsi * rsi) + (w_high_low * high_low_diff) + (w_vol_change * vol_change)
    return heuristics_matrix
