def heuristics_v2(df):
    lookback_period = 20
    log_returns = (df['close'] / df['close'].shift(1)).apply(np.log)
    volume_ratio = df['volume'] / df['volume'].rolling(window=lookback_period).mean()
    return_std = df['close'].pct_change().rolling(window=lookback_period).std()
    
    # Fixed weights
    w_log_returns = 0.4
    w_volume_ratio = 0.3
    w_return_std = 0.3
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_log_returns * log_returns) + (w_volume_ratio * volume_ratio) - (w_return_std * return_std)
    return heuristics_matrix
