def heuristics_v2(df):
    lookback_period = 20
    price_momentum = (df['close'] - df['high'].shift(lookback_period)) / df['high'].shift(lookback_period)
    amount_change = df['amount'].pct_change(lookback_period)
    volume_change = df['volume'].pct_change(lookback_period)

    # Dynamic weights based on the standard deviation of each component
    w_price = price_momentum.std() / (price_momentum.std() + amount_change.std() + volume_change.std())
    w_amount = amount_change.std() / (price_momentum.std() + amount_change.std() + volume_change.std())
    w_volume = volume_change.std() / (price_momentum.std() + amount_change.std() + volume_change.std())

    # Calculate the heuristic factor
    heuristics_matrix = (w_price * price_momentum) + (w_amount * amount_change) + (w_volume * volume_change)
    return heuristics_matrix
