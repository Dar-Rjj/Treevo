def heuristics_v2(df):
    lookback_period = 20
    moving_avg = df['close'].rolling(window=lookback_period).mean()
    price_strength = (df['close'] - moving_avg) / moving_avg
    volume_volatility = df['volume'].rolling(window=lookback_period).std()
    amount_change = df['amount'].pct_change(lookback_period)
    
    # Adaptive weights
    w_price = abs(price_strength) / (abs(price_strength) + volume_volatility + abs(amount_change))
    w_volume = volume_volatility / (abs(price_strength) + volume_volatility + abs(amount_change))
    w_amount = abs(amount_change) / (abs(price_strength) + volume_volatility + abs(amount_change))
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_price * price_strength) + (w_volume * volume_volatility) + (w_amount * amount_change)
    return heuristics_matrix
