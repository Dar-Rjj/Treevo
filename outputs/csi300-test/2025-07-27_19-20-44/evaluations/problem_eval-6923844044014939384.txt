import pandas as pd

def heuristics_v2(df):
    lookback_period = 20
    price_change = df['close'].pct_change(lookback_period).apply(lambda x: np.log1p(x))
    volume_change = df['volume'].pct_change(lookback_period)
    amount_change = df['amount'].pct_change(lookback_period)
    
    # Calculate recent mean to use as dynamic weights
    price_mean = df['close'].rolling(window=lookback_period).mean()
    volume_mean = df['volume'].rolling(window=lookback_period).mean()
    amount_mean = df['amount'].rolling(window=lookback_period).mean()
    
    # Inverting the mean for weight calculation, adding 1e-6 to avoid division by zero
    w_price = 1 / (price_mean + 1e-6)
    w_volume = 1 / (volume_mean + 1e-6)
    w_amount = 1 / (amount_mean + 1e-6)
    
    # Calculate the heuristic factor
    heuristics_matrix = w_price * price_change + w_volume * volume_change + w_amount * amount_change
    return heuristics_matrix
