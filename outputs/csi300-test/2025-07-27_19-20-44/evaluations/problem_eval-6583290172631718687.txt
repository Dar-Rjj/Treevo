def heuristics_v2(df):
    lookback_period = 20
    close_momentum = df['close'].pct_change(lookback_period)
    high_low_ratio = df['high'] / df['low']
    w_high_low = high_low_ratio.rolling(window=lookback_period).std()
    w_volume = (1 - w_high_low) * df['volume'].pct_change(lookback_period)
    
    # Calculate the heuristic factor
    heuristics_matrix = close_momentum + w_high_low * high_low_ratio + w_volume
    return heuristics_matrix
