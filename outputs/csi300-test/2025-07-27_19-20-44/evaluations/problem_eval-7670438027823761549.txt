import pandas as pd

def heuristics_v2(df):
    lookback_period = 20
    price_momentum = (df['close'] - df['open'].shift(lookback_period)) / df['open'].shift(lookback_period)
    avg_price = (df['high'] + df['low']) / 2
    amount_volatility = df['amount'].rolling(window=lookback_period).std()
    volume_volatility = df['volume'].rolling(window=lookback_period).std()
    
    # Adaptive weights based on the standard deviation of the series
    w_amount = 1 / (1 + amount_volatility)
    w_volume = 1 / (1 + volume_volatility)
    w_price = 1 - (w_amount + w_volume)  # Ensuring the sum of weights is 1
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_price * price_momentum) + (w_amount * amount_volatility) + (w_volume * volume_volatility)
    return heuristics_matrix
