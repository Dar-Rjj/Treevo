def heuristics_v2(df):
    def momentum(df, window=20):
        return df['close'].pct_change(window)

    def volatility(df, window=20):
        return df['close'].pct_change().rolling(window).std()

    def volume_trend(df, window=20):
        return df['volume'].pct_change(window)

    factor1 = momentum(df)
    factor2 = volatility(df)
    factor3 = volume_trend(df)
    
    heuristics_matrix = (factor1 - factor2 + factor3) / 3
    return heuristics_matrix
