def heuristics_v2(df):
    short_term_volatility = df['close'].rolling(window=5).std()
    long_term_average = df['close'].rolling(window=20).mean()
    volatility_adjustment = short_term_volatility / long_term_average
    amount_direction = df['amount'].diff() > 0
    heuristics_matrix = volatility_adjustment * (1 if amount_direction.any() else -1)
    return heuristics_matrix
