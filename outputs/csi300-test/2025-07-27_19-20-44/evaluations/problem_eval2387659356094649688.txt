def heuristics_v2(df):
    def calc_heuristic(row):
        if (row['close'] > row['open']) and (row['volume'] > df['volume'].mean()):
            return 1
        elif (row['close'] < row['open']) and (row['volume'] < df['volume'].mean()):
            return -1
        else:
            return 0
    
    heuristics_matrix = df.apply(calc_heuristic, axis=1)
    return heuristics_matrix
