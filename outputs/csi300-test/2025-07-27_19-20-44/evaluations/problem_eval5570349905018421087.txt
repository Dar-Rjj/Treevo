def heuristics_v2(df):
    lookback_period = 30
    close_change = df['close'].pct_change()
    avg_volume = df['volume'].rolling(window=lookback_period).mean()
    vol_ratio = df['volume'] / avg_volume
    log_ret_high = np.log(df['high']).diff()
    log_ret_low = np.log(df['low']).diff()
    log_diff = log_ret_high - log_ret_low
    vol = df['close'].rolling(window=lookback_period).std()
    w_close = (1 / (vol + 1e-6))
    w_vol = (1 - w_close) * 0.5
    w_log = (1 - w_close) * 0.5
    heuristics_matrix = (w_close * close_change) + (w_vol * vol_ratio) + (w_log * log_diff)
    return heuristics_matrix
