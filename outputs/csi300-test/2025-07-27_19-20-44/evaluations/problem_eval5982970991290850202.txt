def heuristics_v2(df):
    lookback_period = 20
    price_momentum = (df['close'] - df['open'].shift(lookback_period)) / df['open'].shift(lookback_period)
    high_low_ratio = df['high'] / df['low']
    amount_change = df['amount'].pct_change(lookback_period)
    volume_change = df['volume'].pct_change(lookback_period)
    
    # Calculate the heuristic factor using geometric mean
    heuristics_matrix = (price_momentum * high_low_ratio * (1 + amount_change) * (1 + volume_change)) ** (1/4)
    return heuristics_matrix
