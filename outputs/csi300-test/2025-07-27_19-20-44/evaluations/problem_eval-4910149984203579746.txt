def heuristics_v2(df):
    # Calculate the momentum as the difference between the current close and the 30-day moving average of the close
    momentum = df['close'] - df['close'].rolling(window=30).mean()
    
    # Calculate the 30-day standard deviation of daily returns as a measure of volatility
    daily_returns = (df['close'] / df.shift(1)['close']) - 1
    volatility = daily_returns.rolling(window=30).std()
    
    # Calculate the change in trading volume compared to the 30-day moving average of volume
    volume_change = df['volume'] - df['volume'].rolling(window=30).mean()
    
    # Combine the factors into a single heuristics score
    heuristics_matrix = 0.5 * momentum + 0.3 * volatility + 0.2 * volume_change
    
    return heuristics_matrix
