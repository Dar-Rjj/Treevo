import pandas as pd

def heuristics_v2(df):
    lookback_period = 20
    price_to_volume_ratio = df['close'] / df['volume']
    ema_price_to_volume = price_to_volume_ratio.ewm(span=lookback_period, adjust=False).mean()
    close_sma_30 = df['close'].rolling(window=30).mean()
    
    heuristics_matrix = ema_price_to_volume - close_sma_30
    return heuristics_matrix
