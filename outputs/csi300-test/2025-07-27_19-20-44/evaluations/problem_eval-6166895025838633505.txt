def heuristics_v2(df):
    moving_avg = df['close'].rolling(window=20).mean()
    close_to_moving_avg_ratio = df['close'] / moving_avg
    volume_change = df['volume'].pct_change()
    rsi_amount = 100 - (100 / (1 + (df['amount'].diff(1).mask(df['amount'].diff(1) < 0, 0).rolling(window=14).mean() / df['amount'].diff(1).mask(df['amount'].diff(1) > 0, -df['amount'].diff(1)).rolling(window=14).mean())))
    
    heuristics_matrix = close_to_moving_avg_ratio * (1 + volume_change) * (1 + (rsi_amount - 50) / 50)
    return heuristics_matrix
