import pandas as pd

def heuristics_v2(df):
    lookback_period = 20
    price_return = df['close'].pct_change()
    volume_roc = df['volume'].pct_change()
    
    # Calculate EMA of price return
    ema_price_return = price_return.ewm(span=lookback_period, adjust=False).mean()
    
    # Calculate ADL
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    adl = (money_flow_multiplier * df['volume']).cumsum()
    
    # Calculate RSI for weighting
    rsi_ema = (1 - 1 / (1 + ema_price_return)).rolling(window=lookback_period).mean()
    rsi_volume = (1 - 1 / (1 + volume_roc)).rolling(window=lookback_period).mean()
    rsi_adl = (1 - 1 / (1 + adl.pct_change())).rolling(window=lookback_period).mean()

    # Compute weights based on RSI
    total_rsi = rsi_ema + rsi_volume + rsi_adl
    w_ema = rsi_ema / total_rsi
    w_volume = rsi_volume / total_rsi
    w_adl = rsi_adl / total_rsi
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_ema * ema_price_return) + (w_volume * volume_roc) + (w_adl * adl.pct_change())
    return heuristics_matrix
