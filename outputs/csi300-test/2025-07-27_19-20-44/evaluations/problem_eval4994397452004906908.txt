def heuristics_v2(df):
    momentum = df['close'].pct_change(periods=20)
    volatility = df['close'].rolling(window=20).std()
    price_diff = (df['high'] - df['low']).rolling(window=20).mean()
    volume_trend = df['volume'].rolling(window=20).mean().pct_change(periods=20)
    heuristics_matrix = 0.5 * momentum + 0.2 * volatility + 0.1 * price_diff - 0.2 * volume_trend
    return heuristics_matrix
