def heuristics_v2(df):
    # Calculate the 30-day moving average of the 'volume' and 'close' columns
    volume_ma = df['volume'].rolling(window=30).mean()
    close_ma = df['close'].rolling(window=30).mean()

    # Compute the heuristic: (today's volume / 30-day average volume) - 30-day average close
    heuristics_matrix = (df['volume'] / volume_ma) - close_ma

    return heuristics_matrix
