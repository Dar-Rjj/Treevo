def heuristics_v2(df):
    lookback_period = 20
    price_momentum = (df['close'] - df['open'].shift(lookback_period)) / df['open'].shift(lookback_period)
    high_low_ratio = df['high'] / df['low']
    amount_change = df['amount'].pct_change(lookback_period)
    volume_change = df['volume'].pct_change(lookback_period)
    volatility = df['close'].rolling(window=lookback_period).std()
    
    # Dynamically adjust weights based on historical performance
    w_price = (price_momentum.shift(lookback_period) * price_momentum).mean() ** 2
    w_amount = (amount_change.shift(lookback_period) * amount_change).mean() ** 2
    w_volume = (volume_change.shift(lookback_period) * volume_change).mean() ** 2
    w_volatility = (volatility.shift(lookback_period) * volatility).mean() ** 2
    
    # Normalize weights
    total_weight = w_price + w_amount + w_volume + w_volatility
    w_price /= total_weight
    w_amount /= total_weight
    w_volume /= total_weight
    w_volatility /= total_weight
    
    # Calculate the heuristic factor
    heuristics_matrix = (w_price * price_momentum) + (w_amount * amount_change) + (w_volume * volume_change) + (w_volatility * volatility)
    return heuristics_matrix
