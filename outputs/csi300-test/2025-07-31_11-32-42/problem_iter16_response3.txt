```python
import pandas as pd

def heuristics_v2(df):
    # Integrated Momentum
    df['20DayAvgClose'] = df['close'].rolling(window=20).mean()
    df['IntegratedMomentum'] = df['close'] - df['20DayAvgClose']
    
    # High-Low Momentum
    df['5DayAvgHigh'] = df['high'].rolling(window=5).mean()
    df['5DayAvgLow'] = df['low'].rolling(window=5).mean()
    df['HighMomentum'] = df['high'] - df['5DayAvgHigh']
    df['LowMomentum'] = df['low'] - df['5DayAvgLow']
    df['HighLowMomentum'] = df['HighMomentum'] + df['LowMomentum']
    
    # Intraday Volatility
    df['HighLowDiff'] = df['high'] - df['low']
    df['5DayAvgHighLowDiff'] = df['HighLowDiff'].rolling(window=5).mean()
    df['IntradayVolatility'] = df['HighLowDiff'] - df['5DayAvgHighLowDiff']
    
    # Volume Trend
    df['3DayAvgVolume'] = df['volume'].rolling(window=3).mean()
    df['7DayAvgVolume'] = df['volume'].rolling(window=7).mean()
    df['VolumeTrend'] = df['3DayAvgVolume'] - df['7DayAvgVolume']
    
    # Price Returns
    df['5DayPriceReturn'] = (df['close'] / df['close'].shift(5)) - 1
    df['10DayPriceReturn'] = (df['close'] / df['close'].shift(10)) - 1
    df['20DayPriceReturn'] = (df['close'] / df['close'].shift(20)) - 1
    df['50DayPriceReturn'] = (df['close'] / df['close'].shift(50)) - 1
    
    df['ShortTermPriceMomentum'] = df['5DayPriceReturn'] - df['10DayPriceReturn']
    df['LongTermPriceMomentum'] = df['20DayPriceReturn'] - df['50DayPriceReturn']
    
    # Average Volumes
    df['5DayAvgVolume'] = df['volume'].rolling(window=5).mean()
    df['10DayAvgVolume'] = df['volume'].rolling(window=10).mean()
    df['VolumeSurgeDifference'] = df['5DayAvgVolume'] - df['10DayAvgVolume']
    
    # Combine Factors
    df['CombinedFactor'] = (
        (df['IntegratedMomentum'] + df['HighLowMomentum']) * 
        df['IntradayVolatility'] * 
        df['VolumeTrend'] * 
        df['ShortTermPriceMomentum'] * 
        df['LongTermPriceMomentum'] * 
        df['VolumeSurgeDifference']
    )
    
    return df['CombinedFactor']
```
