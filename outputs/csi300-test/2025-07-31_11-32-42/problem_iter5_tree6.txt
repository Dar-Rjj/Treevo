```txt
Price and Volume Composite Factors with Enhanced Momentum and Envelopment
├── Calculate Price Momentum Factors
│   ├── 1-day Price Momentum
│   │   ├── Use Close price (t)
│   │   └── Use Close price (t-1)
│   ├── 5-day Price Momentum
│   │   ├── Use Close price (t)
│   │   └── Use Close price (t-5)
│   └── 20-day Price Momentum
│       ├── Use Close price (t)
│       └── Use Close price (t-20)
├── Calculate Volume Activity Indicators
│   ├── 1-day Volume Difference
│   │   ├── Use Volume (t)
│   │   └── Use Volume (t-1)
│   ├── 5-day Average Volume
│   │   ├── Sum Volume (t-4 to t)
│   │   └── Divide by 5
│   └── 20-day Average Volume
│       ├── Sum Volume (t-19 to t)
│       └── Divide by 20
├── Calculate Daily Momentum
│   ├── Calculate 20-Day Average Close
│   │   └── Use Close Prices (t-19, t-18, ..., t)
│   └── Subtract 20-Day Average Close from Today's Close
│       ├── Use Close Price of Day t
│       └── Use 20-Day Average Close
├── Calculate Intraday Volatility
│   ├── Calculate High-Low Difference
│   │   ├── Use High Price of Day t
│   │   └── Use Low Price of Day t
│   └── Calculate 5-Day Moving Average of High-Low Differences
│       ├── Use High-Low Differences (t-4, t-3, ..., t)
│       └── Compute 5-Day Average
├── Combine Momentum and Volume Activities
│   ├── Multiply 1-day Price Momentum by 1-day Volume Difference
│   ├── Multiply 5-day Price Momentum by 5-day Average Volume
│   └── Multiply 20-day Price Momentum by 20-day Average Volume
├── Calculate Daily Price Movement
│   ├── Use High price
│   └── Use Low price
│       ├── Subtract Low from High for daily range
│       └── Add High and Low, then divide by 2 to get Midpoint
├── Calculate Multi-Day Average Midpoint
│   ├── Choose a window (e.g., 5 days)
│   ├── Calculate Midpoints for each day in the window
│   └── Take the arithmetic mean of these midpoints
├── Compute Volume Adjusted Momentum
│   ├── Calculate Close-to-Close Return
│   │   ├── Use Close price
│   │   └── Use previous Close price
│   └── Multiply Close-to-Close Return by Volume
├── Calculate Enhanced Price Envelopment
│   ├── Calculate Multi-Day Range
│   │   ├── Sum of Daily Ranges over the same window
│   ├── Calculate Multi-Day Volume
│   │   ├── Sum of Volumes over the same window
│   ├── Divide Multi-Day Range by Multi-Day Volume to get Base Envelopment
│   └── Adjust Base Envelopment by adding a weighted sum of High and Low prices
│       ├── Weighted Sum = (High + Low) / 2
│       └── Final Envelopment = Base Envelopment + Weighted Sum
├── Combine All Momentum and Volume Factors
│   ├── Add Combined Momentum and Volume Activities
│   ├── Multiply Daily Momentum by -1
│   └── Add Intraday Volatility
└── Generate Final Alpha Factor
    ├── Multiply Combined Momentum and Volume Factors by Volume Adjusted Momentum
    └── Multiply the result by Enhanced Price Envelopment
```
