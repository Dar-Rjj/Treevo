```python
import pandas as pd

def heuristics_v2(df):
    # Calculate moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()

    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()

    # Evaluate price momentum
    df['Price_Change_1D'] = df['close'].pct_change(periods=1)
    df['Price_Change_5D'] = df['close'].pct_change(periods=5)

    df['ROC_1D'] = df['close'].pct_change(periods=1)
    df['ROC_5D'] = df['close'].pct_change(periods=5)

    # Measure volume trends
    df['Avg_Volume_5D'] = df['volume'].rolling(window=5).mean()
    df['Avg_Volume_10D'] = df['volume'].rolling(window=10).mean()
    df['Volume_Spike'] = (df['volume'] > 2 * df['Avg_Volume_5D']).astype(int)

    # Assess the relationship between volume and price
    df['Money_Flow_Ratio'] = (df['amount'] / df['volume'])
    df['MFI'] = df['Money_Flow_Ratio'].rolling(window=14).sum() / df['volume'].rolling(window=14).sum()
    
    # Determine on-balance volume (OBV)
    df['OBV'] = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x >= 0 else -1) * df['volume']
    df['OBV'] = df['OBV'].cumsum()

    # Calculate daily range and ATR
    df['Daily_Range'] = df['high'] - df['low']
    df['ATR_14'] = df['Daily_Range'].rolling(window=14).mean()

    # Analyze opening and closing prices
    df['Open_Close_Diff'] = df['open'] - df['close']
    df['Percentage_Gap'] = (df['open'] - df['close']) / df['open']

    # Combine multiple factors
    df['Factor_Score'] = (
        0.3 * df['SMA_5'] + 
        0.2 * df['EMA_10'] + 
        0.1 * df['Price_Change_1D'] + 
        0.1 * df['ROC_5D'] + 
        0.1 * df['OBV'] + 
        0.1 * (df['ATR_14'] - df['Daily_Range'])
    )

    return df['Factor_Score']
```
