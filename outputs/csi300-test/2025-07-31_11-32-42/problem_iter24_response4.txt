```python
import pandas as pd

def heuristics_v2(df):
    # Calculate moving averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    
    # Compute the difference between SMA and EMA
    df['SMA_EMA_diff_5'] = df['SMA_5'] - df['EMA_5']
    df['SMA_EMA_diff_10'] = df['SMA_10'] - df['EMA_10']
    df['SMA_EMA_diff_20'] = df['SMA_20'] - df['EMA_20']
    df['SMA_EMA_diff_50'] = df['SMA_50'] - df['EMA_50']
    
    # Evaluate price momentum
    df['price_change_1'] = df['close'].pct_change(periods=1)
    df['price_change_5'] = df['close'].pct_change(periods=5)
    df['price_change_10'] = df['close'].pct_change(periods=10)
    
    df['ROC_1'] = df['close'].pct_change(periods=1)
    df['ROC_5'] = df['close'].pct_change(periods=5)
    df['ROC_10'] = df['close'].pct_change(periods=10)
    
    # Determine the momentum crossover
    df['momentum_crossover_1_5'] = df['ROC_1'] - df['ROC_5']
    df['momentum_crossover_1_10'] = df['ROC_1'] - df['ROC_10']
    df['momentum_crossover_5_10'] = df['ROC_5'] - df['ROC_10']
    
    # Measure volume trends
    df['avg_volume_5'] = df['volume'].rolling(window=5).mean()
    df['avg_volume_10'] = df['volume'].rolling(window=10).mean()
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    
    df['volume_spike_5'] = (df['volume'] / df['avg_volume_5']) - 1
    df['volume_spike_10'] = (df['volume'] / df['avg_volume_10']) - 1
    df['volume_spike_20'] = (df['volume'] / df['avg_volume_20']) - 1
    
    # Determine on-balance volume (OBV)
    df['obv'] = (df['close'].diff() > 0).astype(int) * df['volume'] - (df['close'].diff() < 0).astype(int) * df['volume']
    df['obv_change_1'] = df['obv'].diff(periods=1)
    df['obv_change_5'] = df['obv'].diff(periods=5)
    
    # Incorporate high and low prices for volatility and range analysis
    df['daily_range'] = df['high'] - df['low']
    df['ATR_14'] = df['daily_range'].rolling(window=14).mean()
    df['range_to_atr_ratio'] = df['daily_range'] / df['ATR_14']
    
    # Analyze opening and closing prices
    df['open_close_diff'] = df['open'] - df['close']
    df['gap_percentage'] = (df['open'] - df['close']) / df['open']
    df['positive_gap_count_10'] = ((df['open'] > df['close']).rolling(window=10).sum())
    df['negative_gap_count_10'] = ((df['open'] < df['close']).rolling(window=10).sum())
    
    # Volume-weighted average price (VWAP)
    df['VWAP_1'] = (df['
