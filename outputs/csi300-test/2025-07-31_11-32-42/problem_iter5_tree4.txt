```txt
Integrated Momentum, Intraday Volatility, Volume Trend, and Price Envelopment Alpha Factor
├── Calculate Integrated Momentum
│   ├── Calculate 20-Day Average Close
│   │   └── Use Close Prices (t-19, t-18, ..., t)
│   ├── Subtract 20-Day Average Close from Today's Close
│   │   ├── Use Close Price of Day t
│   │   └── Use 20-Day Average Close
│   └── Calculate High-Low Momentum
│       ├── Subtract the 5-day moving average of High price from today's High price
│       │   └── Use High Price of Day t
│       └── Subtract the 5-day moving average of Low price from today's Low price
│           └── Add the two differences to measure overall momentum
├── Calculate Intraday Volatility
│   ├── Calculate High-Low Difference
│   │   ├── Use High Price of Day t
│   │   └── Use Low Price of Day t
│   └── Calculate 5-Day Moving Average of High-Low Differences
│       ├── Use High-Low Differences (t-4, t-3, ..., t)
│       └── Compute 5-Day Average
├── Measure Volume Trend
│   ├── Compute the 3-day and 7-day moving averages of Volume
│   │   ├── For 3-day: Average volume over the past 3 days
│   │   └── For 7-day: Average volume over the past 7 days
│   └── Calculate the difference between 3-day and 7-day moving averages
│       └── If difference is positive, it indicates increasing volume trend; if negative, decreasing
├── Calculate Daily Price Movement
│   ├── Use High price
│   └── Use Low price
│       ├── Subtract Low from High for daily range
│       └── Add High and Low, then divide by 2 to get Midpoint
├── Calculate Multi-Day Average Midpoint
│   ├── Choose a window (e.g., 5 days)
│   ├── Calculate Midpoints for each day in the window
│   └── Take the arithmetic mean of these midpoints
├── Compute Volume Adjusted Momentum
│   ├── Calculate Close-to-Close Return
│   │   ├── Use Close price
│   │   └── Use previous Close price
│   └── Multiply Close-to-Close Return by Volume
├── Calculate Short-Term and Long-Term Price Momentum
│   ├── Compute 5-day Price Return
│   │   ├── Use Close price on day t
│   │   └── Use Close price on day t-5
│   ├── Compute 10-day Price Return
│   │   ├── Use Close price on day t
│   │   └── Use Close price on day t-10
│   ├── Compute 20-day Price Return
│   │   ├── Use Close price on day t
│   │   └── Use Close price on day t-20
│   └── Compute 50-day Price Return
│       ├── Use Close price on day t
│       └── Use Close price on day t-50
├── Calculate Volume Surge
│   ├── Compute 5-day Average Volume
│   │   ├── Sum Volume from day t-4 to day t
│   │   └── Divide by 5
│   └── Compute 10-day Average Volume
│       ├── Sum Volume from day t-9 to day t
│       └── Divide by 10
├── Calculate Price Envelopment
│   ├── Calculate Multi-Day Range
│   │   ├── Sum of Daily Ranges over the same window
│   └── Calculate Multi-Day Volume
│       ├── Sum of Volumes over the same window
│       └── Divide Multi-Day Range by Multi-Day Volume
└── Combine Factors
    ├── Multiply Daily Momentum by -1
    ├── Add Intraday Volatility
    ├── Multiply the resulting value by the Volume Trend
    ├── Subtract 10-day Price Return from 5-day Price Return
    ├── Subtract 50-day Price Return from 20-day Price Return
    ├── Subtract 10-day Average Volume from 5-day Average Volume
    ├── Multiply the short-term and long-term price momentum differences
    └── Multiply the result with the volume surge difference and the Volume Adjusted Momentum
        └── Multiply the final result by the Price Envelopment
```
