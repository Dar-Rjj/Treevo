```python
import pandas as pd

def heuristics_v2(df, period=20):
    # Calculate the number of up days (close > open) in a given period
    up_days = (df['close'] > df['open']).rolling(window=period).sum()
    
    # Calculate the number of down days (close < open) in a given period
    down_days = (df['close'] < df['open']).rolling(window=period).sum()
    
    # Subtract the number of down days from the number of up days to get the trend score
    trend_score = up_days - down_days
    
    # Calculate the high - low for each day
    daily_range = df['high'] - df['low']
    
    # Sum of daily price ranges over a period
    sum_daily_range = daily_range.rolling(window=period).sum()
    
    # Count the number of bullish candles (close > open) in a given period
    bullish_candles = (df['close'] > df['open']).rolling(window=period).sum()
    
    # Count the number of bearish candles (close < open) in a given period
    bearish_candles = (df['close'] < df['open']).rolling(window=period).sum()
    
    # Subtract the number of bearish candles from the number of bullish candles to get the candle score
    candle_score = bullish_candles - bearish_candles
    
    # Calculate the difference between today's volume and yesterday's volume
    volume_diff = df['volume'].diff()
    
    # Sum of volume differences over a period
    sum_volume_diff = volume_diff.rolling(window=period).sum()
    
    # Calculate the sum of volume on up days (close > open)
    volume_up_days = (df['volume'] * (df['close'] > df['open'])).rolling(window=period).sum()
    
    # Calculate the sum of volume on down days (close < open)
    volume_down_days = (df['volume'] * (df['close'] < df['open'])).rolling(window=period).sum()
    
    # Subtract the sum of volume on down days from the sum of volume on up days to get the volume trend
    volume_trend = volume_up_days - volume_down_days
    
    # Calculate the amount per unit volume for each day
    amount_per_unit_volume = df['amount'] / df['volume']
    
    # Average amount per unit volume over a period
    avg_amount_per_unit_volume = amount_per_unit_volume.rolling(window=period).mean()
    
    # Calculate the sum of amount on up days (close > open)
    amount_up_days = (df['amount'] * (df['close'] > df['open'])).rolling(window=period).sum()
    
    # Calculate the sum of amount on down days (close < open)
    amount_down_days = (df['amount'] * (df['close'] < df['open'])).rolling(window=period).sum()
    
    # Subtract the sum of amount on down days from the sum of amount on up days to get the amount trend
    amount_trend = amount_up_days - amount_down_days
    
    # Combine all the factors into a single alpha factor
    alpha_factor = (trend_score + sum_daily_range + candle_score + sum_volume_diff + volume_trend + avg_amount_per_unit_volume + amount_trend) / 7.0
    
    return alpha_factor
```
