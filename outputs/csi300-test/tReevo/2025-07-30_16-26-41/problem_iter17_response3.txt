```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Volume-Weighted Moving Averages (VWMA)
    short_term = 5
    long_term = 20
    df['close_vol'] = df['close'] * df['volume']
    df['VWMA_short'] = df['close_vol'].rolling(window=short_term).sum() / df['volume'].rolling(window=short_term).sum()
    df['VWMA_long'] = df['close_vol'].rolling(window=long_term).sum() / df['volume'].rolling(window=long_term).sum()
    df['VWMA_momentum'] = df['VWMA_long'] - df['VWMA_short']

    # Calculate Exponential Moving Averages (EMA)
    df['EMA_short'] = df['close'].ewm(span=short_term, adjust=False).mean()
    df['EMA_long'] = df['close'].ewm(span=long_term, adjust=False).mean()
    df['EMA_momentum'] = df['EMA_long'] - df['EMA_short']

    # Calculate Volume-Weighted Price Change (VWPC)
    df['price_change'] = df['close'].diff()
    df['VWPC'] = (df['price_change'] * df['volume']).rolling(window=short_term).sum()

    # Calculate Volume-Weighted Volatility (VWV)
    df['daily_return'] = df['close'].pct_change()
    df['VWV'] = (df['daily_return'] * df['volume']).rolling(window=10).std()

    # Calculate Exponentially Smoothed Volume-Weighted Momentum (ESVWM)
    alpha = 0.2  # Smoothing factor
    df['ESVWM'] = df['VWPC'].ewm(alpha=alpha, adjust=False).mean()

    # Combine Factors
    df['combined_momentum'] = (df['VWMA_momentum'] + df['EMA_momentum'] + df['VWPC'] + df['ESVWM']) / 4
    df['final_alpha_factor'] = df['combined_momentum'] / (df['VWV'] + 1e-6)  # Add a small constant to avoid division by zero

    return df['final_alpha_factor']
```
