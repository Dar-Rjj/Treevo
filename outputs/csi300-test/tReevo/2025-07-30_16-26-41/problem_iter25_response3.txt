```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily returns
    df['returns'] = df['close'].pct_change()
    
    # Adaptive Volatility
    def calculate_atr(high, low, close, n=14):
        tr1 = abs(high - low)
        tr2 = abs(high - close.shift())
        tr3 = abs(low - close.shift())
        tr = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
        atr = tr.rolling(window=n).mean()
        return atr
    
    df['atr_20'] = calculate_atr(df['high'], df['low'], df['close'], 20)
    df['atr_50'] = calculate_atr(df['high'], df['low'], df['close'], 50)
    df['atr_200'] = calculate_atr(df['high'], df['low'], df['close'], 200)
    
    df['volatility_20'] = df['returns'].rolling(window=20).std()
    df['volatility_50'] = df['returns'].rolling(window=50).std()
    df['volatility_200'] = df['returns'].rolling(window=200).std()
    
    # Dynamic Weights
    df['momentum_score'] = df['close'].pct_change(periods=252)  # 12-month returns
    df['momentum_ema'] = df['momentum_score'].ewm(span=12).mean()
    
    # Liquidity
    df['turnover_ratio'] = df['volume'] / 1e6  # Assuming 1M outstanding shares for simplicity
    df['dollar_volume'] = df['close'] * df['volume']
    
    # Multi-Period Momentum
    df['mom_1m'] = df['close'].pct_change(periods=21)  # 1-month
    df['mom_3m'] = df['close'].pct_change(periods=63)  # 3-month
    df['mom_6m'] = df['close'].pct_change(periods=126)  # 6-month
    df['mom_12m'] = df['close'].pct_change(periods=252)  # 12-month
    df['multi_period_momentum'] = (df['mom_1m'] + df['mom_3m'] + df['mom_6m'] + df['mom_12m']) / 4
    
    # Volume-Weighted Trend and Momentum Patterns
    df['vw_price_trend_20'] = ((df['close'] - df['open']) * df['volume']).rolling(window=20).sum()
    df['vw_price_trend_50'] = ((df['close'] - df['open']) * df['volume']).rolling(window=50).sum()
    
    df['ma_50'] = df['close'].rolling(window=50).mean()
    df['ma_200'] = df['close'].rolling(window=200).mean()
    
    def calculate_rsi(close, n=14):
        delta = close.diff()
        gain = (delta.where(delta > 0, 0)).fillna(0)
        loss = (-delta.where(delta < 0, 0)).fillna(0)
        avg_gain = gain.rolling(window=n).mean()
        avg_loss = loss.rolling(window=n).mean()
        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))
        return rsi
    
    df['rsi_14'] = calculate_rsi(df['close'])
    
    # Machine Learning for Weight Adjustments
    from sklearn.linear_model import LinearRegression
    from sklearn.model_selection import train_test_split
    from sklearn.metrics import mean_squared_error
    
    X = df[['atr_20', 'atr_50', 'atr_200', 'volatility_20', 'volatility_50', 'volatility_200', 
            'momentum_ema', 'turnover_ratio', 'dollar_volume', 'multi_period_momentum', 
            'vw_price_trend_20', 'vw_price_trend_50', 'ma_50', 'ma_200', 'rsi_14']].dropna()
    y = df['returns'].loc[X.index]
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
    model = LinearRegression
