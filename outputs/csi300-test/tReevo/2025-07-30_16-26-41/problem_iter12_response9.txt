```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 10-day and 5-day exponential weights
    def exp_weights(n):
        return np.exp(np.linspace(0, -1, n)) / np.sum(np.exp(np.linspace(0, -1, n)))
    
    # Dynamic Long-Term (10-day) Metrics
    df['high_low_vol_10'] = (df['high'] - df['low']) * df['volume']
    df['weighted_price_diff_10'] = df['high_low_vol_10'].rolling(window=10).sum()
    df['total_volume_10'] = df['volume'].rolling(window=10).sum()
    df['cumulative_weighted_avg_10'] = df['weighted_price_diff_10'] / df['total_volume_10']
    df['intraday_momentum_10'] = df['close'] - df['open'].shift(10)
    df['avg_daily_return_10'] = df['close'].pct_change().rolling(window=10).sum() / 10
    df['volatility_10'] = df['close'].pct_change().rolling(window=10).std()
    
    # Apply exponential weighting to 10-day metrics
    ew_10 = exp_weights(10)
    df['exp_cumulative_weighted_avg_10'] = df['high_low_vol_10'].rolling(window=10).apply(lambda x: np.sum(x * ew_10), raw=True) / df['total_volume_10']
    df['exp_intraday_momentum_10'] = df['intraday_momentum_10'].rolling(window=10).apply(lambda x: np.sum(x * ew_10), raw=True)
    df['exp_avg_daily_return_10'] = df['avg_daily_return_10'].rolling(window=10).apply(lambda x: np.sum(x * ew_10), raw=True)
    df['exp_volatility_10'] = df['volatility_10'].rolling(window=10).apply(lambda x: np.sum(x * ew_10), raw=True)
    
    # Final 10-Day Alpha Factor
    df['alpha_factor_10'] = (df['exp_cumulative_weighted_avg_10'] - df['exp_avg_daily_return_10']) / df['exp_volatility_10']
    
    # Dynamic Short-Term (5-day) Metrics
    df['high_low_vol_5'] = (df['high'] - df['low']) * df['volume']
    df['weighted_price_diff_5'] = df['high_low_vol_5'].rolling(window=5).sum()
    df['total_volume_5'] = df['volume'].rolling(window=5).sum()
    df['cumulative_weighted_avg_5'] = df['weighted_price_diff_5'] / df['total_volume_5']
    df['intraday_momentum_5'] = df['close'] - df['open'].shift(5)
    df['avg_daily_return_5'] = df['close'].pct_change().rolling(window=5).sum() / 5
    df['volatility_5'] = df['close'].pct_change().rolling(window=5).std()
    
    # Apply exponential weighting to 5-day metrics
    ew_5 = exp_weights(5)
    df['exp_cumulative_weighted_avg_5'] = df['high_low_vol_5'].rolling(window=5).apply(lambda x: np.sum(x * ew_5), raw=True) / df['total_volume_5']
    df['exp_intraday_momentum_5'] = df['intraday_momentum_5'].rolling(window=5).apply(lambda x: np.sum(x * ew_5), raw=True)
    df['exp_avg_daily_return_5'] = df['avg_daily_return_5'].rolling(window=5).apply(lambda x: np.sum(x * ew_5), raw=True)
    df['exp_volatility_5'] = df['volatility_5'].rolling(window=5).apply(lambda x: np.sum(x * ew_5), raw=True)
    
    # Final 5-Day Alpha Factor
    df['alpha_factor_5'] = (df['exp_cumulative_weighted_avg_5'] - df['exp_avg_daily_return_5']) / df['exp_volatility_5']
    
    # Combine 10-Day and 5-Day Metrics
    df['combined_alpha_factor'] = 0.6 * df['alpha_factor_10'] + 0.4 * df['alpha_factor_5']
    
    # Integrate Trading
