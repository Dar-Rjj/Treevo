```python
import pandas as pd
import numpy as np
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split

def heuristics_v2(df):
    # Calculate daily returns
    df['returns'] = df['close'].pct_change()
    
    # Adaptive Volatility Factor
    df['volatility'] = df['returns'].rolling(window=30).std()
    df['ema_volatility'] = df['volatility'].ewm(span=10, adjust=False).mean()
    
    # Dynamic Weight-Adjusted Momentum
    df['short_momentum'] = df['returns'].rolling(window=10).mean()
    df['long_momentum'] = df['returns'].rolling(window=50).mean()
    
    # Train a machine learning model to predict future returns
    X = df[['short_momentum', 'long_momentum']].dropna()
    y = df['returns'].shift(-1).loc[X.index]
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
    model = RandomForestRegressor(n_estimators=100, random_state=42)
    model.fit(X_train, y_train)
    predictions = model.predict(X)
    
    # Adjust weights using the model's predictions
    df['predicted_returns'] = np.nan
    df.loc[X.index, 'predicted_returns'] = predictions
    df['weight_short'] = (df['predicted_returns'] - df['predicted_returns'].min()) / (df['predicted_returns'].max() - df['predicted_returns'].min())
    df['weight_long'] = 1 - df['weight_short']
    df['dynamic_momentum'] = df['weight_short'] * df['short_momentum'] + df['weight_long'] * df['long_momentum']
    
    # Liquidity Indicator
    df['vwp'] = ((df['high'] + df['low'] + df['close']) / 3) * df['volume']
    df['liquidity'] = df['vwp'].rolling(window=30).mean()
    
    # Multi-Period Momentum
    df['momentum_10'] = df['returns'].rolling(window=10).mean()
    df['momentum_20'] = df['returns'].rolling(window=20).mean()
    df['momentum_50'] = df['returns'].rolling(window=50).mean()
    df['multi_period_momentum'] = (df['momentum_10'] + df['momentum_20'] + df['momentum_50']) / 3
    
    # Sector Rotation (Assuming sector data is available in the DataFrame)
    df['sector_performance'] = df.groupby('sector')['returns'].transform('mean')
    df['sector_adjusted_factor'] = df['dynamic_momentum'] * df['sector_performance']
    
    # Macroeconomic Indicators (Assuming macro data is available in the DataFrame)
    df['macro_adjusted_factor'] = df['dynamic_momentum'] * (1 + 0.05 * df['gdp_growth'])
    
    # Combine all factors
    df['combined_factor'] = (
        0.3 * df['ema_volatility'] +
        0.3 * df['dynamic_momentum'] +
        0.2 * df['liquidity'] +
        0.1 * df['multi_period_momentum'] +
        0.1 * df['sector_adjusted_factor'] +
        0.1 * df['macro_adjusted_factor']
    )
    
    return df['combined_factor'].dropna()
```
