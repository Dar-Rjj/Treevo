```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Base Factors
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_60'] = df['close'].rolling(window=60).mean()
    
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_60'] = df['close'].ewm(span=60, adjust=False).mean()
    
    df['ROC_Daily'] = df['close'].pct_change()
    df['ROC_Weekly'] = df['close'].pct_change(periods=5)
    df['ROC_Monthly'] = df['close'].pct_change(periods=21)
    
    df['VWAP'] = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3).cumsum() / df['volume'].cumsum()
    df['OBV'] = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    df['VM'] = df['volume'].pct_change()
    
    df['BAS'] = df['high'] - df['low']
    df['VT'] = df['volume'].pct_change()
    df['DV'] = df['close'] * df['volume']
    
    df['HV'] = df['close'].rolling(window=20).std()
    df['ATR'] = df[['high' - 'low', abs('high' - df['close'].shift()), abs('low' - df['close'].shift())]].max(axis=1).rolling(window=14).mean()
    df['BB_Upper'] = df['SMA_20'] + 2 * df['close'].rolling(window=20).std()
    df['BB_Lower'] = df['SMA_20'] - 2 * df['close'].rolling(window=20).std()
    
    # Composite Indicators
    df['Momentum_Volatility_Factor'] = df['ROC_Daily'] / df['HV']
    df['Volume_Momentum_Factor'] = df['VM'] * df['OBV']
    df['Liquidity_Momentum_Factor'] = df['BAS'] * df['ROC_Daily']
    
    # Adaptive Lookback Periods
    def variable_lookback_factor(series, short_window, medium_window, long_window):
        return series.ewm(span=short_window, adjust=False).mean() + series.ewm(span=medium_window, adjust=False).mean() + series.ewm(span=long_window, adjust=False).mean()
    
    df['VLF_SMA'] = variable_lookback_factor(df['close'], 5, 20, 60)
    df['VLF_EMA'] = variable_lookback_factor(df['close'], 5, 20, 60)
    df['VLF_ATR'] = variable_lookback_factor(df['ATR'], 5, 20, 60)
    
    # Market Sentiment
    # This is a placeholder for more complex sentiment analysis
    df['Sentiment_Index'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Simplification
    from sklearn.decomposition import PCA
    pca = PCA(n_components=1)
    factors = ['SMA_5', 'SMA_20', 'SMA_60', 'EMA_5', 'EMA_20', 'EMA_60', 
               'ROC_Daily', 'ROC_Weekly', 'ROC_Monthly', 'VWAP', 'OBV', 'VM',
               'BAS', 'VT', 'DV', 'HV', 'ATR', 'BB_Upper', 'BB_Lower',
               'Momentum_Volatility_Factor', 'Volume_Momentum_Factor', 'Liquidity_Momentum_Factor',
               'VLF_SMA', 'VLF_EMA', 'VLF_ATR', 'Sentiment_Index']
    df['PCA_Factor'] = pca.fit_transform(df[factors])
    
    # Machine Learning Integration
    # This is a placeholder for more complex ML models
    df['Ensemble_Factor'] = (df['ROC_Daily'] + df['HV'] + df['PCA_Factor']) / 3
    
    return df['Ensemble_Factor']

# Example usage:
# df = pd
