```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # 10-day calculations
    df['wt_price_diff_10'] = (df['high'] - df['low']) * df['volume']
    total_volume_10 = df['volume'].rolling(window=10).sum()
    long_term_weighted_price_diff_10 = df['wt_price_diff_10'].rolling(window=10).sum() / total_volume_10
    long_term_momentum_10 = df['close'] - df['open'].shift(10)
    long_term_avg_daily_return_10 = df['close'].diff().rolling(window=10).sum() / 10
    daily_returns_10 = df['close'].pct_change()
    ewm_std_10 = daily_returns_10.ewm(span=10, adjust=False).std()
    alpha_factor_10 = (long_term_weighted_price_diff_10 + long_term_momentum_10 - long_term_avg_daily_return_10) / ewm_std_10

    # 5-day calculations
    df['wt_price_diff_5'] = (df['high'] - df['low']) * df['volume']
    total_volume_5 = df['volume'].rolling(window=5).sum()
    short_term_weighted_price_diff_5 = df['wt_price_diff_5'].rolling(window=5).sum() / total_volume_5
    short_term_momentum_5 = df['close'] - df['open'].shift(5)
    short_term_avg_daily_return_5 = df['close'].diff().rolling(window=5).sum() / 5
    daily_returns_5 = df['close'].pct_change()
    ewm_std_5 = daily_returns_5.ewm(span=5, adjust=False).std()
    alpha_factor_5 = (short_term_weighted_price_diff_5 + short_term_momentum_5 - short_term_avg_daily_return_5) / ewm_std_5

    # Dynamic weights based on recent volatility
    relative_volatility_ratio = ewm_std_5 / ewm_std_10
    weight_10 = 1 / (1 + relative_volatility_ratio)
    weight_5 = relative_volatility_ratio / (1 + relative_volatility_ratio)

    # Integrate trading volume effectively
    avg_volume_5 = df['volume'].rolling(window=5).mean()

    # Final Alpha Factor
    combined_alpha_factor = (weight_10 * alpha_factor_10 + weight_5 * alpha_factor_5) * avg_volume_5
    
    return combined_alpha_factor
```
