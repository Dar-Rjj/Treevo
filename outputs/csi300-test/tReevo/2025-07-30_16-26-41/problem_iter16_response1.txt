```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the relative difference between close and open prices
    df['rel_diff_close_open'] = (df['close'] - df['open']) / df['open']
    
    # Calculate the relative range (high - low) / open
    df['rel_range'] = (df['high'] - df['low']) / df['open']
    
    # Calculate the volume weighted amount per share
    df['vol_weighted_amount_per_share'] = df['amount'] / df['volume']
    
    # Factor 1: Relative strength of close over open, adjusted by volume
    factor_1 = df['rel_diff_close_open'] * (df['volume'] / df['volume'].rolling(window=30).mean())
    
    # Factor 2: Relative range adjusted by volume
    factor_2 = df['rel_range'] * (df['volume'] / df['volume'].rolling(window=30).mean())
    
    # Factor 3: Volume weighted amount per share adjusted by its mean
    factor_3 = df['vol_weighted_amount_per_share'] / df['vol_weighted_amount_per_share'].rolling(window=30).mean()
    
    # Combine all factors
    alpha_factor = (factor_1 + factor_2 + factor_3) / 3
    
    return alpha_factor
```
