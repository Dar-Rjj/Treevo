```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Close-to-Open Return
    df['Close_to_Open_Return'] = df['open'].shift(-1) - df['close']

    # Volume Weighting
    df['Volume_Weighted_Return'] = df['Close_to_Open_Return'] * df['volume']

    # Determine Volatility using High, Low, and Close prices
    df['HL_Centered'] = (df['high'] + df['low'] + df['close']) / 3
    initial_window = 20  # Initial window size for volatility calculation
    df['Volatility'] = df['HL_Centered'].rolling(window=initial_window).std()

    # Adaptive Window Calculation
    def adjust_window(volatility, high_vol_threshold, low_vol_threshold, default_window):
        if volatility > high_vol_threshold:
            return max(default_window - 5, 5)  # Decrease window size, but not below 5
        elif volatility < low_vol_threshold:
            return default_window + 5  # Increase window size
        else:
            return default_window

    high_vol_threshold = df['Volatility'].quantile(0.75)
    low_vol_threshold = df['Volatility'].quantile(0.25)
    
    adaptive_windows = [adjust_window(v, high_vol_threshold, low_vol_threshold, initial_window) for v in df['Volatility']]
    df['Adaptive_Window'] = adaptive_windows

    # Calculate Rolling Statistics with Adaptive Window
    mean_list = []
    std_list = []
    for i in range(len(df)):
        window = int(df['Adaptive_Window'].iloc[i])
        subset = df.iloc[max(0, i - window):i]['Volume_Weighted_Return']
        mean_list.append(subset.mean())
        std_list.append(subset.std())
        
    df['Rolling_Mean'] = mean_list
    df['Rolling_Std'] = std_list

    # The final alpha factor is the ratio of rolling mean to rolling standard deviation
    df['Alpha_Factor'] = df['Rolling_Mean'] / df['Rolling_Std']

    return df['Alpha_Factor']
```
