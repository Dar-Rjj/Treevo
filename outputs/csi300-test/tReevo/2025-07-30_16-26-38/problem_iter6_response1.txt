```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = df['open'].shift(-1) - df['close']
    
    # Calculate Rolling Volatility
    df['hlc_avg'] = (df['high'] + df['low'] + df['close']) / 3
    df['rolling_volatility'] = df['hlc_avg'].rolling(window=20).std()
    
    # Adaptive Volume Smoothing
    df['smoothed_volume'] = df['volume'].rolling(window=5).mean()
    df['volume_weighted_return'] = df['close_to_open_return'] * df['smoothed_volume']
    
    # Calculate Adaptive Cumulative Volume-Weighted Close-to-Open Return
    def adaptive_cumulative_return(row, window_size):
        return df.loc[:row.name, 'volume_weighted_return'].rolling(window=window_size).sum().iloc[-1]
    
    # Define the adaptive window sizes
    windows = [5, 10, 20]
    for window in windows:
        df[f'cumulative_return_{window}'] = df.apply(lambda row: adaptive_cumulative_return(row, window), axis=1)
    
    # Volatility Adjustment
    for window in windows:
        df[f'adjusted_cumulative_return_{window}'] = df[f'cumulative_return_{window}'] / df['rolling_volatility']
    
    # Signal Generation
    df['signal'] = df[f'adjusted_cumulative_return_{windows[0]}'].apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    return df['signal']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# signal = heuristics_v2(df)
```
