```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=10, P=20, Q=10, R=5, S=5):
    # Calculate Price Momentum
    df['log_ret'] = np.log(df['close']).diff()
    df['price_momentum'] = df['log_ret'].rolling(window=N).sum()

    # Calculate Volume Acceleration
    df['volume_change'] = df['volume'].pct_change()
    df['volume_acceleration'] = df['volume_change'].rolling(window=M).sum()

    # Integrate Volatility
    df['daily_log_ret'] = df['log_ret']
    df['volatility'] = df['daily_log_ret'].rolling(window=P).std()
    df['adjusted_price_momentum'] = df['price_momentum'] / df['volatility']

    # Incorporate Weighted Moving Averages (WMA)
    weights = np.arange(1, Q+1)
    df['wma_close'] = df['close'].rolling(window=Q).apply(lambda x: np.dot(x, weights/weights.sum()), raw=True)
    df['trend_indicator'] = (df['close'] > df['wma_close']).astype(int) * 2 - 1

    # Consider Market Sentiment
    df['high_low_spread'] = df['high'] - df['low']
    df['avg_high_low_spread'] = df['high_low_spread'].rolling(window=R).mean()
    df['normalized_high_low_spread'] = df['avg_high_low_spread'] / df['high_low_spread'].median()
    df['adjusted_volume_acceleration'] = df['volume_acceleration'] * df['normalized_high_low_spread']

    # Incorporate Trading Volume Ratio
    df['trading_volume_ratio'] = df['volume'] / df['volume'].shift(1)
    df['final_volume_acceleration'] = df['adjusted_volume_acceleration'] * df['trading_volume_ratio']

    # Consider Open-Close Spread
    df['open_close_spread'] = df['close'] - df['open']
    df['avg_open_close_spread'] = df['open_close_spread'].rolling(window=S).mean()
    df['normalized_open_close_spread'] = df['avg_open_close_spread'] / df['open_close_spread'].median()
    df['final_price_momentum'] = df['adjusted_price_momentum'] * df['normalized_open_close_spread']

    # Combine Factors
    df['alpha_factor'] = df['final_price_momentum'] * df['final_volume_acceleration'] + df['trend_indicator']

    return df['alpha_factor']
```
