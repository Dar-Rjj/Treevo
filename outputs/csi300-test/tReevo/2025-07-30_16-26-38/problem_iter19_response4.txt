```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = df['open'].shift(-1) - df['close']
    
    # Volume Weighting
    df['volume_weighted_return'] = df['close_to_open_return'] * df['volume']
    
    # Determine Volatility
    df['volatility'] = df[['high', 'low', 'close']].rolling(window=5).std().mean(axis=1)
    
    # Adjust Window Size Based on Volatility
    df['window_size'] = np.where(df['volatility'] > df['volatility'].mean(), 5, 20)
    
    # Rolling Statistics with Adaptive Window
    def rolling_stats(group):
        window = group['window_size'].iloc[0]
        return (group['volume_weighted_return'].rolling(window=window).mean(),
                group['volume_weighted_return'].rolling(window=window).std())
    
    df['rolling_mean'] = df.groupby(df.index.floor('D'))['volume_weighted_return'].transform(lambda x: rolling_stats(x)[0])
    df['rolling_std'] = df.groupby(df.index.floor('D'))['volume_weighted_return'].transform(lambda x: rolling_stats(x)[1])
    
    # Generate the final alpha factor
    df['alpha_factor'] = (df['rolling_mean'] / (df['rolling_std'] + 1e-6))
    
    return df['alpha_factor']
```
