```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Close-to-Open Return
    df['Close_to_Open_Return'] = df['open'].shift(-1) - df['close']

    # Volume Weighting
    df['Volume_20_EMA'] = df['volume'].ewm(span=20, adjust=False).mean()
    volume_weight = np.where(df['volume'] > df['Volume_20_EMA'], 1.5, 0.5)
    df['Volume_Weighted_Return'] = df['Close_to_Open_Return'] * df['volume'] * volume_weight

    # Trade Amount Weighting
    df['Amount_20_EMA'] = df['amount'].ewm(span=20, adjust=False).mean()
    amount_weight = np.where(df['amount'] > df['Amount_20_EMA'], 1.5, 0.5)
    df['Trade_Amount_Weighted_Return'] = df['Volume_Weighted_Return'] * df['amount'] * amount_weight

    # Adaptive Window Calculation
    df['Volatility'] = df[['high', 'low', 'close']].std(axis=1).rolling(window=20).mean()
    df['Amount_Volatility'] = df['amount'].rolling(window=20).std()
    df['Combined_Volatility'] = df['Volatility'] + df['Amount_Volatility']
    window_size = np.where(df['Combined_Volatility'] > df['Combined_Volatility'].median(), 10, 30)

    # Rolling Statistics with Adaptive Window
    rolling_mean = df['Trade_Amount_Weighted_Return'].rolling(window=window_size, min_periods=1).mean()
    rolling_std = df['Trade_Amount_Weighted_Return'].rolling(window=window_size, min_periods=1).std()

    # Final Factor
    df['Alpha_Factor'] = (df['Trade_Amount_Weighted_Return'] - rolling_mean) / rolling_std

    return df['Alpha_Factor']
```
