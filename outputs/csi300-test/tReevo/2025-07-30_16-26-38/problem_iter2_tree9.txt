```txt
Volume-Weighted Price Momentum Alpha
├── Calculate Daily Close-to-Close Return
│   ├── Use Close price of day t
│   └── Use Close price of day t-1
│       └── Subtract Close price of day t-1 from Close price of day t
├── Calculate Volume Trend (VT)
│   ├── Initialize VT to 0
│   ├── For each of the past N days
│   │   ├── If today's volume is greater than yesterday's volume
│   │   │   └── Add difference to VT
│   │   └── Else
│   │       └── Subtract difference from VT
├── Calculate Volume-Weighted Average of Open and Close Prices
│   ├── Use Open price of day t
│   ├── Use Close price of day t
│   ├── Add Open and Close prices
│   └── Divide by 2
│       └── Multiply result by Volume of day t
├── Combine Close-to-Close Return and Volume-Weighted Average
│   ├── Multiply Close-to-Close Return by Volume-Weighted Average
│   └── Output as final alpha factor
└── Conditionally Adjust Alpha Factor Based on Volume Trend
    ├── If VT > 0
    │   └── Positive trend, more weight on momentum
    │       └── Multiply final alpha factor by a positive multiplier
    └── If VT < 0
        └── Negative trend, less weight on momentum
            └── Multiply final alpha factor by a negative multiplier
```
