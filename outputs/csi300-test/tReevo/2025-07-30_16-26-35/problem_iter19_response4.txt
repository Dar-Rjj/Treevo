```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df['open']) / df['open']
    
    # Compute the weighted combination
    recent_days = 30  # Define the number of recent days
    df['factor'] = 0.0
    
    # For recent days
    df.loc[df.index[-recent_days:], 'factor'] = (
        0.7 * df['intraday_range'] + 0.3 * df['close_to_open_return']
    )
    
    # For older days
    df.loc[df.index[:-recent_days], 'factor'] = (
        0.5 * df['intraday_range'] + 0.5 * df['close_to_open_return']
    )
    
    return df['factor']
```
