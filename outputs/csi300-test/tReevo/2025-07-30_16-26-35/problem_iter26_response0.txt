```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'].shift(-1) - df['open']) / df['open']
    
    # Calculate Volume-Weighted Average Price (VWAP)
    df['vwap'] = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    
    # Calculate Long-Term Momentum
    df['long_term_momentum'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    
    # Calculate Medium-Term Momentum
    df['medium_term_momentum'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    
    # Calculate Volume Impact
    df['average_volume_20d'] = df['volume'].rolling(window=20).mean()
    df['volume_impact'] = df['volume'] / df['average_volume_20d']
    
    # Define dynamic weights
    recent_weights = [0.4, 0.2, 0.2, 0.2, 0.2, 0.2]
    older_weights = [0.3, 0.2, 0.2, 0.3, 0.3, 0.2]
    
    # Compute Weighted Intraday Range
    df['weighted_intraday_range'] = (recent_weights[0] * df['intraday_range']) + (older_weights[0] * df['intraday_range'].shift(1))
    
    # Compute Weighted Close-to-Open Return
    df['weighted_close_to_open_return'] = (recent_weights[1] * df['close_to_open_return']) + (older_weights[1] * df['close_to_open_return'].shift(1))
    
    # Compute Weighted VWAP
    df['weighted_vwap'] = (recent_weights[2] * df['vwap']) + (older_weights[2] * df['vwap'].shift(1))
    
    # Compute Weighted Long-Term Momentum
    df['weighted_long_term_momentum'] = (recent_weights[3] * df['long_term_momentum']) + (older_weights[3] * df['long_term_momentum'].shift(1))
    
    # Compute Weighted Medium-Term Momentum
    df['weighted_medium_term_momentum'] = (recent_weights[4] * df['medium_term_momentum']) + (older_weights[4] * df['medium_term_momentum'].shift(1))
    
    # Compute Weighted Volume Impact
    df['weighted_volume_impact'] = (recent_weights[5] * df['volume_impact']) + (older_weights[5] * df['volume_impact'].shift(1))
    
    # Final Alpha Factor
    df['alpha_factor'] = (df['weighted_intraday_range'] + 
                          df['weighted_close_to_open_return'] + 
                          df['weighted_vwap'] + 
                          df['weighted_long_term_momentum'] + 
                          df['weighted_medium_term_momentum'] + 
                          df['weighted_volume_impact'])
    
    return df['alpha_factor']
```
