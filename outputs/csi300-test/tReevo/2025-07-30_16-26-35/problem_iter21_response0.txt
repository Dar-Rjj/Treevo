```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df.shift(1)['open']) / df.shift(1)['open']
    
    # Calculate volume-based weights
    median_volume = df['volume'].median()
    df['volume_weight'] = (df['volume'] - median_volume) / median_volume
    df['volume_weight'] = df['volume_weight'].apply(lambda x: max(min(x, 1), -1))
    
    # Define recent and older periods
    recent_period = 5
    older_period = len(df) - recent_period
    
    # Initialize the alpha factor
    df['alpha_factor'] = 0.0
    
    # Compute the weighted combination for recent period
    df.loc[df.index[:recent_period], 'alpha_factor'] = (
        0.7 * df.loc[df.index[:recent_period], 'intraday_range'] + 
        0.3 * df.loc[df.index[:recent_period], 'close_to_open_return']
    )
    
    # Compute the weighted combination for older period
    df.loc[df.index[recent_period:], 'alpha_factor'] = (
        0.5 * df.loc[df.index[recent_period:], 'intraday_range'] + 
        0.5 * df.loc[df.index[recent_period:], 'close_to_open_return']
    )
    
    # Adjust weights based on volume
    df['alpha_factor'] = (
        df['alpha_factor'] * (0.5 + 0.5 * df['volume_weight'])
    )
    
    return df['alpha_factor']
```
