```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df.shift(1)['open']) / df.shift(1)['open']
    
    # Assign adaptive weights based on recent data
    df['adaptive_weighted_combination'] = 0.0
    df.loc[df.index < df.index[0] + pd.DateOffset(days=30), 'adaptive_weighted_combination'] = 0.7 * df['intraday_range'] + 0.3 * df['close_to_open_return']
    df.loc[df.index >= df.index[0] + pd.DateOffset(days=30), 'adaptive_weighted_combination'] = 0.5 * df['intraday_range'] + 0.5 * df['close_to_open_return']
    
    # Short-Term Trend Analysis
    df['20_day_ma'] = df['close'].rolling(window=20).mean()
    df['100_day_ma'] = df['close'].rolling(window=100).mean()
    
    # Add or subtract 0.1 based on the moving average comparison
    df['trend_adjustment'] = 0.0
    df.loc[df['20_day_ma'] > df['100_day_ma'], 'trend_adjustment'] = 0.1
    df.loc[df['20_day_ma'] < df['100_day_ma'], 'trend_adjustment'] = -0.1
    
    # Final Factor
    df['final_factor'] = df['adaptive_weighted_combination'] + df['trend_adjustment']
    
    return df['final_factor']
```
