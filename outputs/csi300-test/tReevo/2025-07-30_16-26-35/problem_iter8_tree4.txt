```txt
Intraday Volatility Adjusted Return with Momentum and Volatility
├── Calculate Intraday Range
│   ├── Use High price
│   └── Use Low price
│       ├── Compute Intraday Range: High - Low
├── Calculate Close-to-Open Return
│   ├── Use Open price
│   └── Use Previous Day's Close price
│       ├── Compute Close-to-Open Return: (Close - Previous Day's Close) / Previous Day's Close
├── Combine Intraday Range and Close-to-Open Return
│   ├── Weighted Combination
│   │   ├── Assign weights to recent data
│   │   ├── Recent Weights: 0.7 for Intraday Range, 0.3 for Close-to-Open Return
│   │   └── Older Weights: 0.5 for Intraday Range, 0.5 for Close-to-Open Return
├── Incorporate Volume Shocks
│   ├── Calculate Volume Change
│   │   ├── Use Volume
│   │   ├── Use Previous Day's Volume
│   │   └── Compute Volume Shock: (Volume - Previous Day's Volume) / Previous Day's Volume
│   └── Integrate Volume Shock with Combined Return
│       ├── Weighted Integration
│       │   ├── Assign weights to volume shock
│       │   ├── Volume Shock Weight: 0.2
│       │   ├── Combined Return Weight: 0.8
│       └── Interim Factor: (Combined Return * 0.8) + (Volume Shock * 0.2)
├── Incorporate Momentum
│   ├── Calculate Short-term Momentum
│   │   ├── Use Close price
│   │   └── Period: 10 days
│   └── Calculate Long-term Momentum
│       ├── Use Close price
│       └── Period: 50 days
│       ├── Compute Momentum Difference: Short-term Momentum - Long-term Momentum
├── Incorporate Volatility
│   ├── Calculate Short-term Volatility
│   │   ├── Use Close price
│   │   └── Period: 10 days
│   └── Calculate Long-term Volatility
│       ├── Use Close price
│       └── Period: 50 days
│       ├── Compute Volatility Ratio: Short-term Volatility / Long-term Volatility
└── Final Factor Integration
    ├── Combine Interim Factor, Momentum, and Volatility
    │   ├── Assign weights to momentum and volatility
    │   ├── Momentum Weight: 0.4
    │   ├── Volatility Weight: 0.4
    │   └── Interim Factor Weight: 0.2
    └── Final Factor: (Interim Factor * 0.2) + (Momentum Difference * 0.4) + (Volatility Ratio * 0.4)
```
