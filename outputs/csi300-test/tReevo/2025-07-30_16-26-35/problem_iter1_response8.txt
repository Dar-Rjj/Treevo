```python
import pandas as pd

def heuristics_v2(df, lookback=20):
    # Calculate Daily Breakout
    df['daily_range'] = df['high'] - df['low']
    df['upper_breakout_level'] = df['close'] + 0.5 * df['daily_range']
    df['lower_breakout_level'] = df['close'] - 0.5 * df['daily_range']

    # Calculate Distance to Breakout Levels
    df['distance_to_upper'] = df['upper_breakout_level'] - df['close']
    df['distance_to_lower'] = df['close'] - df['lower_breakout_level']
    
    # Determine if Close is Above or Below Midpoint
    df['midpoint'] = (df['high'] + df['low']) / 2
    df['is_above_midpoint'] = df['close'] > df['midpoint']
    
    # Assign Weight Based on Volume
    df['weighted_distance'] = 0
    df.loc[df['is_above_midpoint'], 'weighted_distance'] = df['distance_to_upper'] * df['volume']
    df.loc[~df['is_above_midpoint'], 'weighted_distance'] = df['distance_to_lower'] * df['volume']
    
    # Calculate Final Alpha Factor
    alpha_factor = df['weighted_distance'].rolling(window=lookback).sum()
    
    return alpha_factor
```
