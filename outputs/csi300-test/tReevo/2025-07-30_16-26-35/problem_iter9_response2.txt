```python
import pandas as pd

def heuristics_v2(df):
    # Ensure the DataFrame is sorted by date
    df = df.sort_index()

    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']

    # Calculate Close-to-Open Return
    close_to_open_return = (df['close'].shift(-1) - df['open']) / df['open']

    # Integrate Volume Shock
    volume_change = df['volume'].pct_change()
    # Define a Volume Shock as a 2x increase in volume
    volume_shock = (volume_change > 1.0).astype(int)

    # Combine Intraday Range and Close-to-Open Return
    recent_weights = {
        'intraday_range': 0.7,
        'close_to_open_return': 0.3
    }
    older_weights = {
        'intraday_range': 0.5,
        'close_to_open_return': 0.5
    }

    # Adjust weights for Volume Shocks
    adjusted_weights = []
    for shock in volume_shock:
        if shock == 1:
            adjusted_weights.append({
                'intraday_range': 0.8,
                'close_to_open_return': 0.2
            })
        else:
            adjusted_weights.append(recent_weights if shock == 1 else older_weights)

    # Apply the weighted combination
    factor_values = []
    for i, (ir, cto, weights) in enumerate(zip(intraday_range, close_to_open_return, adjusted_weights)):
        if i == len(df) - 1:  # Skip the last row
            continue
        w_ir = weights['intraday_range']
        w_cto = weights['close_to_open_return']
        factor_value = w_ir * ir + w_cto * cto
        factor_values.append(factor_value)

    # Create a Series with the calculated factor values
    factor_series = pd.Series(factor_values, index=df.index[:-1])

    return factor_series
```
