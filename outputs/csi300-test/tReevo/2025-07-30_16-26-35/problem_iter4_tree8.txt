```txt
Volume-Weighted Intraday Volatility-Adjusted Momentum with Market Sentiment
├── Calculate Intraday Range
│   ├── Use High price
│   └── Use Low price
│       └── Subtract to find range (High - Low)
├── Calculate Intraday Volatility
│   ├── Take the last 20 days' intraday ranges
│   └── Average these ranges
├── Calculate Daily Return
│   ├── Use Close price of today
│   └── Use Close price of yesterday
│       └── Subtract and divide by yesterday's close to get return
├── Calculate Adjusted Momentum
│   ├── Take the last 20 days' daily returns
│   └── Sum these returns
├── Divide by Intraday Volatility
│   └── Get the final adjusted momentum score
├── Incorporate Volume Weighting
│   ├── Use Volume
│   └── Multiply the adjusted momentum score by the average volume over the last 20 days
├── Incorporate Market Sentiment
│   ├── Calculate Market Return
│   │   ├── Use Close price of today
│   │   └── Use Close price of previous day
│   │       └── Subtract and divide by previous day's close to get market return
│   ├── Modulate Adjusted Momentum with Market Return
│   │   ├── If Market Return > 0, multiply adjusted momentum by 1.05
│   │   └── If Market Return <= 0, multiply adjusted momentum by 0.95
├── Multi-Period Analysis
│   ├── Repeat the above steps for different lookback periods (e.g., 10, 20, 30, 40 days)
│   ├── Store the results for each period
│   └── Combine the results using a weighted sum, with weights inversely proportional to the lookback period
├── Adaptive Weighting
│   ├── Calculate the standard deviation of the returns for each lookback period
│   ├── Assign higher weight to periods with lower standard deviation
│   └── Normalize the weights so they sum to 1
└── Interpreting the Factor
    ├── High positive adjusted momentum
    │   └── Indicates strong upward movement, less affected by volatility and supported by high volume
    ├── Near zero adjusted momentum
    │   └── Indicates no significant trend, may suggest market consolidation
    └── Low negative adjusted momentum
        └── Indicates a weakening trend, more affected by increased volatility and low volume
```
