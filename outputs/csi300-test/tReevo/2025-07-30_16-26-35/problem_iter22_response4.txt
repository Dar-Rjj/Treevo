```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the price change from the previous day
    df['price_change'] = df['close'].pct_change()
    
    # Calculate the 5-day moving average of the closing price
    df['5_day_ma'] = df['close'].rolling(window=5).mean()
    
    # Calculate the 20-day moving average of the closing price
    df['20_day_ma'] = df['close'].rolling(window=20).mean()
    
    # Calculate the momentum factor: difference between the 5-day and 20-day moving averages
    df['momentum'] = df['5_day_ma'] - df['20_day_ma']
    
    # Calculate the relative range: (high - low) / close
    df['relative_range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate the volume ratio: current volume / 5-day average volume
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=5).mean()
    
    # Calculate the alpha factor: weighted sum of the above factors
    df['alpha_factor'] = (df['price_change'] * 0.3) + (df['momentum'] * 0.4) + (df['relative_range'] * 0.1) + (df['volume_ratio'] * 0.2)
    
    return df['alpha_factor'].dropna()

# Example usage:
# df = pd.DataFrame({
#     'open': [...],
#     'high': [...],
#     'low': [...],
#     'close': [...],
#     'amount': [...],
#     'volume': [...]
# }, index=pd.to_datetime([...]))
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
