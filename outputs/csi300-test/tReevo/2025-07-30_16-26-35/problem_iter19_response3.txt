```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df['open']) / df['open']
    
    # Create a shifted version of the intraday range and close-to-open return for the previous day
    df['prev_intraday_range'] = df['intraday_range'].shift(1)
    df['prev_close_to_open_return'] = df['close_to_open_return'].shift(1)
    
    # Weighted Combination
    def weighted_combination(row):
        if pd.notna(row['prev_intraday_range']):
            return 0.5 * row['intraday_range'] + 0.5 * row['close_to_open_return']
        else:
            return 0.7 * row['intraday_range'] + 0.3 * row['close_to_open_return']
    
    df['alpha_factor'] = df.apply(weighted_combination, axis=1)
    
    return df['alpha_factor']

# Example usage
# df = pd.DataFrame({
#     'date': ['2023-01-01', '2023-01-02', '2023-01-03'],
#     'open': [100, 102, 101],
#     'high': [105, 106, 104],
#     'low': [98, 100, 100],
#     'close': [104, 105, 103],
#     'amount': [10000, 15000, 12000],
#     'volume': [1000, 1500, 1200]
# })
# df.set_index('date', inplace=True)
# alpha_factors = heuristics_v2(df)
# print(alpha_factors)
```
