```python
import pandas as pd
import numpy as np
from talib import RSI, MACD, BBANDS
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split

def heuristics_v2(df):
    # Calculate Intraday Range
    df['Intraday_Range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['Close_to_Open_Return'] = (df['close'].shift(-1) - df['open']) / df['open']
    
    # Incorporate Volume and Amount
    df['Liquidity'] = df['volume'] / df['amount']
    
    # Additional Indicators
    df['RSI'] = RSI(df['close'], timeperiod=14)
    macd, signal, _ = MACD(df['close'], fastperiod=12, slowperiod=26, signalperiod=9)
    df['MACD'] = macd
    df['Signal_Line'] = signal
    upper, middle, lower = BBANDS(df['close'], timeperiod=20, nbdevup=2, nbdevdn=2, matype=0)
    df['BB_Upper'] = upper
    df['BB_Middle'] = middle
    df['BB_Lower'] = lower
    
    # Dynamic Weighting Based on Recency and Market Conditions
    recent_data_mask = df.index.isin(df.index[-5:])
    
    # Weights for Recent Data
    recent_weights = 0.5 * df['Intraday_Range'] + 0.3 * df['Close_to_Open_Return'] + 0.1 * df['Liquidity'] + 0.1 * df['RSI']
    
    # Weights for Older Data
    older_weights = 0.4 * df['Intraday_Range'] + 0.3 * df['Close_to_Open_Return'] + 0.2 * df['Liquidity'] + 0.1 * df['RSI']
    
    # Final Alpha Factor Calculation
    df['Alpha_Factor'] = np.where(recent_data_mask, recent_weights, older_weights)
    
    # Assess Market Conditions
    df['Daily_Volatility'] = df['close'].pct_change().rolling(window=20).std()
    df['Trend'] = df['close'].rolling(window=50).mean().diff()
    trend_multiplier = np.where(df['Trend'] > 0, 1.2, 0.8)
    
    # Integrate Machine Learning for Trend and Volatility Assessment
    features = ['Intraday_Range', 'Close_to_Open_Return', 'Liquidity', 'RSI', 'MACD', 'Signal_Line', 'BB_Upper', 'BB_Middle', 'BB_Lower']
    target = df['close'].pct_change().shift(-1).fillna(0)  # Future Stock Returns
    X_train, X_test, y_train, y_test = train_test_split(df[features], target, test_size=0.2, shuffle=False)
    model = RandomForestClassifier(n_estimators=100)
    model.fit(X_train, y_train > 0)
    predictions = model.predict_proba(X_test)[:, 1]
    
    # Adjust Weights Based on Model Predictions
    trend_prediction = np.where(predictions > 0.5, 'Positive', 'Negative')
    positive_trend_mask = trend_prediction == 'Positive'
    negative_trend_mask = trend_prediction == 'Negative'
    
    df['Alpha_Factor'] = np.where(positive_trend_mask,
                                 0.6 * df['Intraday_Range'] + 0.4 * df['Close_to_Open_Return'] + 0.05 * df['Liquidity'] + 0.05 * df['RSI'],
                                 0.4 * df['Intraday_Range'] + 0.3 * df['Close_to_Open_Return'] + 0.15 * df['Liquidity'] + 0.15 * df['RSI'])
    
    df['Alpha_Factor'] *= trend_multiplier
    
    return df['Alpha_Factor']
```
