```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'].shift(-1) - df['open']) / df['open']
    
    # Calculate Daily Volatility
    df['daily_volatility'] = df['close'].pct_change().rolling(window=5).std()
    
    # Determine Market Trend
    df['moving_average'] = df['close'].rolling(window=5).mean()
    df['market_trend_multiplier'] = 1.1 * (df['moving_average'].diff() > 0) + 0.9 * (df['moving_average'].diff() <= 0)
    
    # Weighted Combination for recent data (last 5 days)
    df['recent_factor'] = 0.7 * df['intraday_range'] + 0.3 * df['close_to_open_return']
    
    # Weighted Combination for older data (more than 5 days ago)
    df['older_factor'] = 0.5 * df['intraday_range'] + 0.5 * df['close_to_open_return']
    
    # Final Alpha Factor
    df['alpha_factor'] = df['recent_factor'].where(df.index.isin(df.index[-5:]), df['older_factor'])
    df['alpha_factor'] = df['alpha_factor'] * df['market_trend_multiplier']
    
    return df['alpha_factor']
```
