```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df['open'].shift(1)) / df['open'].shift(1)
    
    # Combine Intraday Range and Close-to-Open Return
    recent_weights = 0.7 * df['intraday_range'] + 0.3 * df['close_to_open_return']
    older_weights = 0.5 * df['intraday_range'] + 0.5 * df['close_to_open_return']
    combined_return = recent_weights.fillna(older_weights)
    
    # Incorporate Volume Shocks
    df['volume_shock'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    interim_factor = (combined_return * 0.8) + (df['volume_shock'] * 0.2)
    
    # Incorporate Momentum
    short_term_momentum = df['close'].pct_change(10)
    long_term_momentum = df['close'].pct_change(50)
    momentum_difference = short_term_momentum - long_term_momentum
    
    # Incorporate Volatility
    short_term_volatility = df['close'].rolling(window=10).std()
    long_term_volatility = df['close'].rolling(window=50).std()
    volatility_ratio = short_term_volatility / long_term_volatility
    
    # Final Factor Integration
    final_factor = (interim_factor * 0.2) + (momentum_difference * 0.4) + (volatility_ratio * 0.4)
    
    return final_factor
```
