```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Return
    df['close_to_open_return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate Price Momentum
    df['price_momentum'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Determine recent and older weights
    recent_weights = {'intraday_range': 0.6, 'close_to_open_return': 0.3, 'price_momentum': 0.1}
    older_weights = {'intraday_range': 0.4, 'close_to_open_return': 0.4, 'price_momentum': 0.2}
    
    # Apply dynamic weights based on market conditions
    # For simplicity, we will use a simple moving average of the close price to determine market conditions
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['is_recent'] = df['close'] > df['sma_20']
    
    # Initialize the alpha factor series
    alpha_factor = pd.Series(index=df.index, name='alpha_factor')
    
    for i in range(len(df)):
        if df.iloc[i]['is_recent']:
            alpha_factor.iloc[i] = (recent_weights['intraday_range'] * df.iloc[i]['intraday_range'] +
                                    recent_weights['close_to_open_return'] * df.iloc[i]['close_to_open_return'] +
                                    recent_weights['price_momentum'] * df.iloc[i]['price_momentum'])
        else:
            alpha_factor.iloc[i] = (older_weights['intraday_range'] * df.iloc[i]['intraday_range'] +
                                    older_weights['close_to_open_return'] * df.iloc[i]['close_to_open_return'] +
                                    older_weights['price_momentum'] * df.iloc[i]['price_momentum'])
    
    return alpha_factor
```
