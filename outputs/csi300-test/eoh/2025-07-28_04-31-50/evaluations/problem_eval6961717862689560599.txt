def heuristics_v2(df):
    close_15_sma = df['close'].rolling(window=15).mean()
    close_30_sma = df['close'].rolling(window=30).mean()
    volume_10_ema = df['volume'].ewm(span=10, adjust=False).mean()
    volume_20_ema = df['volume'].ewm(span=20, adjust=False).mean()
    high_7_std = df['high'].rolling(window=7).std()
    heuristics_matrix = ((close_15_sma + close_30_sma) / 2) * (volume_10_ema / volume_20_ema) + high_7_std
    return heuristics_matrix
