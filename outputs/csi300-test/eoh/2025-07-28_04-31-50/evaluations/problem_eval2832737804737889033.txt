import pandas as pd
import numpy as np

def heuristics_v2(df):
    short_window = 10
    long_window = 30
    ema_volume_window = 20
    close_short_rolling = df['close'].rolling(window=short_window).mean()
    close_long_rolling = df['close'].rolling(window=long_window).mean()
    log_ratio = np.log(close_short_rolling / close_long_rolling)
    ema_volume = df['volume'].ewm(span=ema_volume_window, adjust=False).mean()
    heuristics_matrix = log_ratio - ema_volume
    return heuristics_matrix
