def heuristics_v2(df):
    close_20_ma = df['close'].rolling(window=20).mean()
    high_10_ma = df['high'].rolling(window=10).mean()
    amount_volume_ratio_30_prod = (df['amount'] / df['volume']).rolling(window=30).apply(lambda x: x.prod(), raw=True)
    heuristics_matrix = (close_20_ma - high_10_ma) * amount_volume_ratio_30_prod
    return heuristics_matrix
