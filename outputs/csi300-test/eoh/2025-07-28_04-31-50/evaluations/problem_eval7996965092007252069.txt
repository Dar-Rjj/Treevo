import pandas as pd

def heuristics_v2(df):
    close_7_ema = df['close'].ewm(span=7, adjust=False).mean()
    momentum_close_7_ema = close_7_ema.pct_change(periods=1)
    
    volume_15_ema = df['volume'].ewm(span=15, adjust=False).mean()
    high_30_max = df['high'].rolling(window=30).max()
    ema_volume_to_high = volume_15_ema / high_30_max
    
    heuristics_matrix = momentum_close_7_ema + ema_volume_to_high
    return heuristics_matrix
