def heuristics_v2(df):
    open_15_sma = df['open'].rolling(window=15).mean()
    volume_7_std = df['volume'].rolling(window=7).std()
    amount_21_std = df['amount'].rolling(window=21).std()
    std_ratio = volume_7_std / amount_21_std
    heuristics_matrix = open_15_sma * std_ratio
    return heuristics_matrix
