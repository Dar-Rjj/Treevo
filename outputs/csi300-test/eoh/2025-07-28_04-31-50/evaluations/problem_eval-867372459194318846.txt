def heuristics_v2(df):
    high_10_ma = df['high'].rolling(window=10).mean()
    low_20_ma = df['low'].rolling(window=20).mean()
    volume_30_cumprod = df['volume'].rolling(window=30).apply(lambda x: np.prod(x), raw=True)
    amount_40_cumprod = df['amount'].rolling(window=40).apply(lambda x: np.prod(x), raw=True)
    heuristics_matrix = (high_10_ma - low_20_ma) * (volume_30_cumprod / amount_40_cumprod)
    return heuristics_matrix
