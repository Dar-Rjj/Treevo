def heuristics_v2(df):
    # Calculate momentum factor (Close - Close 30 days ago)
    momentum = df['close'] - df['close'].shift(30)
    
    # Calculate volatility factor (Standard deviation of daily returns over 30 days)
    daily_returns = df['close'].pct_change()
    volatility = daily_returns.rolling(window=30).std()
    
    # Calculate volume factor (Average volume over 30 days)
    volume_avg = df['volume'].rolling(window=30).mean()
    
    # Combine the factors into a single score
    heuristics_matrix = momentum + volatility + volume_avg
    
    return heuristics_matrix
