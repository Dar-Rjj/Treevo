def heuristics_v2(df):
    close_15_ewm = df['close'].ewm(span=15).mean()
    volume_10_cumprod = df['volume'].rolling(window=10).apply(lambda x: x.prod(), raw=True)
    amount_5_median = df['amount'].rolling(window=5).median()
    heuristics_matrix = (close_15_ewm / volume_10_cumprod) + amount_5_median
    return heuristics_matrix
