import pandas as pd

def heuristics_v2(df):
    # Calculate 20-day EMA of close prices
    ema_20 = df['close'].ewm(span=20, adjust=False).mean()
    # Rate of change in 20-day EMA
    ema_change_rate = ema_20.pct_change()
    
    # Ratio of today's volume to 30-day mean volume
    volume_ratio = df['volume'] / df['volume'].rolling(window=30).mean()
    
    # Normalized distance between the current close and the 5-day low
    low_5 = df['low'].rolling(window=5).min()
    low_distance = (df['close'] - low_5) / (df['high'].rolling(window=5).max() - low_5)
    
    # Combine into a single heuristics matrix
    heuristics_matrix = ema_change_rate + volume_ratio + low_distance
    return heuristics_matrix
