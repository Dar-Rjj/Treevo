def heuristics_v2(df):
    df['first_5_avg'] = df['close'].rolling(window=10).apply(lambda x: x[:5].mean(), raw=False)
    df['last_5_avg'] = df['close'].rolling(window=10).apply(lambda x: x[-5:].mean(), raw=False)
    heuristics_matrix = (df['last_5_avg'] - df['first_5_avg']).dropna()
    return heuristics_matrix
