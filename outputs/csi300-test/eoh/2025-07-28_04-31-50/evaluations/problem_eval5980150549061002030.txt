import pandas as pd

def heuristics_v2(df):
    short_window = 20
    long_window = 50
    df['short_mavg'] = df['close'].rolling(window=short_window, min_periods=1).mean()
    df['long_mavg'] = df['close'].rolling(window=long_window, min_periods=1).mean()
    df['mavg_diff'] = df['short_mavg'] - df['long_mavg']
    df['z_score'] = df['mavg_diff'].rolling(window=long_window, min_periods=1).apply(lambda x: (x[-1] - x.mean()) / x.std())
    heuristics_matrix = df['z_score']
    return heuristics_matrix
