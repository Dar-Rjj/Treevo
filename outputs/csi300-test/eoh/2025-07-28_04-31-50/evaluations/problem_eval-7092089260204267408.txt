import pandas as pd

def heuristics_v2(df):
    # Calculate 50-day EMA
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    # Distance between close and 50-day EMA
    ema_distance = df['close'] - ema_50
    
    # Calculate A/D line
    ad_line = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']
    ad_line = ad_line.cumsum()
    # Rate of change in A/D line
    ad_change_rate = ad_line.pct_change()
    
    # Ratio of positive to total trading volume over the past 10 days
    positive_volume = df['volume'] * (df['close'] > df['open'])
    volume_ratio = positive_volume.rolling(window=10).sum() / df['volume'].rolling(window=10).sum()

    # Combine into a single heuristics matrix
    heuristics_matrix = ema_distance + ad_change_rate + volume_ratio
    return heuristics_matrix
