import pandas as pd

def heuristics_v2(df):
    # Calculate 10-day and 30-day price returns
    df['10_day_return'] = df['close'].pct_change(10)
    df['30_day_return'] = df['close'].pct_change(30)
    
    # Calculate 10-day standard deviation of returns as a measure of volatility
    df['daily_return'] = df['close'].pct_change()
    df['10_day_volatility'] = df['daily_return'].rolling(window=10).std()
    
    # Generate the heuristics matrix using a weighted sum of momentum and volatility
    df['heuristics'] = 0.5 * (df['10_day_return'] + df['30_day_return']) - 0.5 * df['10_day_volatility']
    
    heuristics_matrix = df['heuristics']
    
    return heuristics_matrix
