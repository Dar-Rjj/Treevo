import pandas as pd

def heuristics_v2(df):
    df['avg_price'] = (df['high'] * 0.6 + df['low'] * 0.4)
    df['vol_ma_10'] = df['volume'].rolling(window=10).mean()
    df['weighted_avg_price_5'] = ((df['avg_price'] * df['vol_ma_10']).rolling(window=5).sum()) / df['vol_ma_10'].rolling(window=5).sum()
    df['ema_close_20'] = df['close'].ewm(span=20, adjust=False).mean()
    heuristics_matrix = df['weighted_avg_price_5'] + df['ema_close_20']
    return heuristics_matrix
