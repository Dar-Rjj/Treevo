import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['returns'] = df['close'].pct_change()
    
    # Calculate the exponential moving average of the last 5 days' returns
    df['ema5'] = df['returns'].ewm(span=5, adjust=False).mean()
    
    # Calculate the standard deviation over the last 30 days
    df['std30'] = df['returns'].rolling(window=30).std()
    
    # Generate the heuristic value
    df['heuristic_value'] = df['ema5'] / df['std30']
    
    # Create the heuristics_matrix with only the 'heuristic_value' column
    heuristics_matrix = df['heuristic_value'].dropna()
    
    return heuristics_matrix
