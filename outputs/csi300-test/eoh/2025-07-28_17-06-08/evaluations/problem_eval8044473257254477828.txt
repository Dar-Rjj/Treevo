def heuristics_v2(df):
    df['weight'] = df['volume'].pct_change().fillna(0)
    df['weighted_price'] = ((df['high'] * df['weight']) + (df['low'] * (1 - df['weight']))).rolling(window=15).mean()
    df['sma_close'] = df['close'].rolling(window=20).mean()
    heuristics_matrix = (df['weighted_price'] - df['sma_close']).dropna()
    return heuristics_matrix
