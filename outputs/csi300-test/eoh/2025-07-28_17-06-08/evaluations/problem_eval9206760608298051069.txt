import pandas as pd

def heuristics_v3(df):
    close_sma = df['close'].rolling(window=20).mean()
    close_momentum_sma = (df['close'] / close_sma) - 1
    amount_change = df['amount'].pct_change()
    sma_high = df['high'].rolling(window=20).mean()
    sma_low = df['low'].rolling(window=20).mean()
    bband_width = sma_high - sma_low
    
    # Compute dynamic correlations for weighting using a 10-day rolling window
    corr_close_return = df['close'].pct_change().shift(-1).rolling(window=10).corr(close_momentum_sma)
    corr_amount_change = df['close'].pct_change().shift(-1).rolling(window=10).corr(amount_change)
    corr_bband = df['close'].pct_change().shift(-1).rolling(window=10).corr(bband_width)

    heuristics_matrix = (corr_close_return * close_momentum_sma + 
                         corr_amount_change * amount_change + 
                         corr_bband * bband_width).dropna()
    return heuristics_matrix
