def heuristics_v2(df):
    df['ewm_high_low'] = (df['high'].ewm(span=20).mean() + df['low'].ewm(span=20).mean()) / 2
    df['cum_product_ratio'] = (df['close'] / df['open']).rolling(window=10).apply(lambda x: x.prod(), raw=True)
    heuristics_matrix = (df['ewm_high_low'] * df['cum_product_ratio']).dropna()
    return heuristics_matrix
