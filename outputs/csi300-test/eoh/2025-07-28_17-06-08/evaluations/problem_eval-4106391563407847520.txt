def heuristics_v2(df):
    df['volume_ema'] = df['volume'].ewm(span=7, adjust=False).mean()
    df['high_weighted'] = df['high'] * df['volume_ema']
    df['low_weighted'] = df['low'] * df['volume_ema']
    df['weighted_avg_price'] = (df['high_weighted'].rolling(window=15).sum() + df['low_weighted'].rolling(window=15).sum()) / df['volume_ema'].rolling(window=15).sum()
    heuristics_matrix = df['weighted_avg_price'].dropna()
    return heuristics_matrix
