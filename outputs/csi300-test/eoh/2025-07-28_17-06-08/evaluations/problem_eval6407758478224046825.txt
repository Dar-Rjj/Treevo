def heuristics_v2(df):
    df['ema12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema12'] - df['ema26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['histogram'] = df['macd_line'] - df['signal_line']
    df['volume_momentum'] = df['volume'].pct_change().rolling(window=5).mean()
    heuristics_matrix = (df['histogram'] * df['volume_momentum']).dropna()
    return heuristics_matrix
