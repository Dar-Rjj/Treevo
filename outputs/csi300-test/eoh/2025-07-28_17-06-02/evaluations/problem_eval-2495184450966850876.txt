import pandas as pd

def heuristics_v2(df):
    close_prices = df['close']
    volumes = df['volume']

    # Momentum (using 5-day simple moving average)
    momentum = close_prices / close_prices.shift(5) - 1

    # Volatility (using 5-day standard deviation of daily returns)
    daily_returns = close_prices.pct_change()
    volatility = daily_returns.rolling(window=5).std()

    # Volume change (percentage change over 5 days)
    volume_change = volumes.pct_change(5)

    # Heuristic factor
    heuristics_matrix = (momentum - volatility) * volume_change

    return heuristics_matrix
