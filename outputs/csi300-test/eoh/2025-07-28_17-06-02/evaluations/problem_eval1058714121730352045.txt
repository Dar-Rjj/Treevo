def heuristics_v2(df):
    # Calculate Chaikin Money Flow (CMF)
    mfm = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    cmf = (mfm * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Bollinger Bands
    ma_20 = df['close'].rolling(window=20).mean()
    std_20 = df['close'].rolling(window=20).std()
    upper_band = ma_20 + 2 * std_20
    lower_band = ma_20 - 2 * std_20
    bb_width = (upper_band - lower_band) / ma_20
    
    # On-Balance Volume (OBV)
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    obv = obv.cumsum()

    # Composite heuristic
    heuristics_matrix = (cmf + bb_width + obv) / 3
    return heuristics_matrix
