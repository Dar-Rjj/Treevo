import pandas as pd

def heuristics_v2(df):
    close_prices = df['close']
    avg_30d_close = close_prices.rolling(window=30).mean()
    roc = (close_prices - avg_30d_close) / avg_30d_close
    heuristics_matrix = roc.rolling(window=10).mean().dropna()
    return heuristics_matrix
