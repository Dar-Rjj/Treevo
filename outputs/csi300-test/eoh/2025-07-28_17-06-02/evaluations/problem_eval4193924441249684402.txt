import pandas as pd

def heuristics_v2(df):
    # Calculate exponential moving average
    ema_10 = df['close'].ewm(span=10, adjust=False).mean()
    
    # Calculate positive and negative volumes
    pos_volume = df['volume'].where(df['close'] > df['open'], 0)
    neg_volume = df['volume'].where(df['close'] < df['open'], 0)
    
    # Calculate the ratio of positive to negative volume
    volume_ratio = pos_volume.rolling(window=20).sum() / neg_volume.rolling(window=20).sum()
    
    # Composite heuristic
    heuristics_matrix = (ema_10 + volume_ratio) / 2
    return heuristics_matrix
