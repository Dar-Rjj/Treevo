import pandas as pd

def heuristics_v2(df):
    def calculate_momentum(series, window):
        return series.pct_change(periods=window).dropna()

    def calculate_volatility(series, window):
        return series.pct_change().rolling(window=window).std().dropna()

    def calculate_volume_ratio(df, short_window, long_window):
        short_vol = df['volume'].rolling(window=short_window).mean()
        long_vol = df['volume'].rolling(window=long_window).mean()
        return (short_vol / long_vol).dropna()
    
    momentum_5 = calculate_momentum(df['close'], 5)
    momentum_20 = calculate_momentum(df['close'], 20)
    volatility_20 = calculate_volatility(df['close'], 20)
    volume_ratio = calculate_volume_ratio(df, 5, 20)
    
    heuristics_matrix = pd.concat([momentum_5, momentum_20, volatility_20, volume_ratio], axis=1).mean(axis=1)
    heuristics_matrix.name = 'heuristic_factor'
    return heuristics_matrix
