import pandas as pd

def heuristics_v2(df):
    # Calculate Williams %R
    hh = df['high'].rolling(window=14).max()
    ll = df['low'].rolling(window=14).min()
    williams_r = -100 * ((hh - df['close']) / (hh - ll))
    
    # On-Balance Volume (OBV)
    obv = (df['volume'] * (df['close'] > df['close'].shift(1))).cumsum()
    
    # Money Flow Index (MFI)
    tp = (df['high'] + df['low'] + df['close']) / 3
    mf = tp * df['volume']
    positive_mf = mf.where(df['close'] > df['close'].shift(1), 0)
    negative_mf = mf.where(df['close'] < df['close'].shift(1), 0)
    mfi = 100 - (100 / (1 + (positive_mf.rolling(window=14).sum() / negative_mf.rolling(window=14).sum())))
    
    # Composite heuristic
    heuristics_matrix = (williams_r + obv + mfi) / 3
    return heuristics_matrix
