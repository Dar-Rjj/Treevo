import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages
    sma_7 = df['close'].rolling(window=7).mean()
    sma_21 = df['close'].rolling(window=21).mean()
    sma_ratio = (sma_7 / sma_21) - 1
    
    # Stochastic Oscillator with 14-day lookback
    lowest_low = df['low'].rolling(window=14).min()
    highest_high = df['high'].rolling(window=14).max()
    k_percent = 100 * (df['close'] - lowest_low) / (highest_high - lowest_low)
    
    # Rate of Change (ROC) with 10-day window
    roc = (df['close'] / df['close'].shift(10)) - 1
    
    # Volume weighted by typical price
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    volume_weighted = df['volume'] * typical_price
    
    # Composite heuristic
    heuristics_matrix = (sma_ratio + k_percent + roc + volume_weighted) / 4
    return heuristics_matrix
