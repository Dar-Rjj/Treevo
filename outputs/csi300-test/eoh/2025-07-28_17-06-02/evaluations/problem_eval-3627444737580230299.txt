import pandas as pd

def heuristics_v2(df):
    # Calculate short and long EMA
    ema_short = df['close'].ewm(span=12, adjust=False).mean()
    ema_long = df['close'].ewm(span=26, adjust=False).mean()
    
    # EMA crossover signal
    ema_crossover = ema_short - ema_long
    
    # Relative Strength Indicator compared to the overall market
    df['market_close'] = df.groupby(df.index)['close'].transform('mean')  # Assuming 'df' contains multiple stocks
    relative_strength = df['close'] / df['market_close'] - 1
    
    # Cash Flow Indicator
    cash_flow = (df['volume'] * (df['close'] - df['close'].shift(1))).cumsum()
    
    # Combine the factors into a heuristics matrix, assigning equal weights for simplicity
    heuristics_matrix = (ema_crossover + relative_strength + cash_flow) / 3
    
    return heuristics_matrix
