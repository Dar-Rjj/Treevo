import pandas as pd

def heuristics_v2(df):
    # Moving Average Convergence Divergence (MACD)
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd_line = ema_12 - ema_26
    signal_line = macd_line.ewm(span=9, adjust=False).mean()
    macd_diff = macd_line - signal_line
    
    # Average True Range (ATR) for measuring volatility
    true_range = df[['high', 'low']].diff(axis=0).abs().max(axis=1)
    atr = true_range.rolling(window=14).mean()
    
    # On-Balance Volume (OBV)
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    obv = obv.cumsum()
    
    # Composite heuristic
    heuristics_matrix = (macd_diff + atr + obv) / 3
    return heuristics_matrix
