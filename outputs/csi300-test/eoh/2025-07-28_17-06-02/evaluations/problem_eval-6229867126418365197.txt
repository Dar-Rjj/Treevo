def heuristics_v2(df):
    # Simple Moving Averages
    sma_50 = df['close'].rolling(window=50).mean()
    sma_100 = df['close'].rolling(window=100).mean()
    sma_ratio = (sma_50 / sma_100) - 1
    
    # Chaikin Oscillator with 30-day window
    adl = ((2 * df['close'] - df['high'] - df['low']) / (df['high'] - df['low'])) * df['volume']
    chaikin_oscillator = adl.rolling(window=3).sum() - adl.rolling(window=10).sum()
    
    # Stochastic Oscillator over 28 days
    low_28 = df['low'].rolling(window=28).min()
    high_28 = df['high'].rolling(window=28).max()
    stoch_k = 100 * (df['close'] - low_28) / (high_28 - low_28)
    
    # Momentum Indicator using 60-day percentage change in closing prices
    momentum = df['close'].pct_change(periods=60)
    
    # Composite heuristic
    heuristics_matrix = (sma_ratio + chaikin_oscillator + stoch_k + momentum) / 4
    return heuristics_matrix
