import pandas as pd

def heuristics_v2(df):
    # Calculate the momentum as the difference between the current close and the 30-day average close
    momentum = df['close'] - df['close'].rolling(window=30).mean()
    
    # Calculate the average volume over the past 30 days
    avg_volume_30 = df['volume'].rolling(window=30).mean()
    
    # Calculate the volume ratio as the current volume divided by the 30-day average volume
    volume_ratio = df['volume'] / avg_volume_30
    
    # Calculate the average true range (a measure of volatility) over the last 14 days
    tr1 = abs(df["high"] - df["low"])
    tr2 = abs(df["high"] - df["close"].shift())
    tr3 = abs(df["low"] - df["close"].shift())
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    ema_true_range = true_range.ewm(span=14, adjust=False).mean()
    
    # Combine the factors into a heuristics matrix, assigning equal weights for simplicity
    heuristics_matrix = (momentum + volume_ratio + ema_true_range) / 3
    
    return heuristics_matrix
