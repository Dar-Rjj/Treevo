import pandas as pd

def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change().fillna(0)
    ewma_10 = df['daily_return'].ewm(span=10).mean()
    ewma_abs_30 = df['daily_return'].abs().ewm(span=30).mean()

    heuristics_matrix = ewma_10 / ewma_abs_30
    heuristics_matrix.name = 'heuristic_factor'
    return heuristics_matrix
