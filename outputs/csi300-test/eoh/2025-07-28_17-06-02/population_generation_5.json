[
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics based on price and volume data, incorporating exponential moving averages, stochastic oscillator, and average directional index to create a composite factor aimed at predicting future stock returns.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate exponential moving averages\n    ema_5 = df['close'].ewm(span=5, adjust=False).mean()\n    ema_10 = df['close'].ewm(span=10, adjust=False).mean()\n    ema_ratio = (ema_5 / ema_10) - 1\n    \n    # Stochastic Oscillator\n    low_14 = df['low'].rolling(window=14).min()\n    high_14 = df['high'].rolling(window=14).max()\n    k_percent = 100 * ((df['close'] - low_14) / (high_14 - low_14))\n    \n    # Average Directional Index (ADX)\n    tr = df['high'] - df['low']\n    up_move = df['high'] - df['close'].shift(1)\n    down_move = df['low'] - df['close'].shift(1)\n    plus_dm = up_move.where((up_move > down_move) & (up_move > 0), 0)\n    minus_dm = down_move.where((down_move > up_move) & (down_move > 0), 0)\n    tr_14 = tr.rolling(window=14).sum()\n    plus_di = 100 * (plus_dm.rolling(window=14).sum() / tr_14)\n    minus_di = 100 * (minus_dm.rolling(window=14).sum() / tr_14)\n    dx = 100 * (abs(plus_di - minus_di) / (plus_di + minus_di))\n    adx = dx.rolling(window=14).mean()\n    \n    # Volume weighted by close price\n    volume_weighted = df['volume'] * df['close']\n    \n    # Composite heuristic\n    heuristics_matrix = (ema_ratio + k_percent - adx + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03608,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm combines a 7-day and 21-day exponential moving average ratio, a 14-day Chaikin Money Flow, a 28-day Aroon Oscillator, and a price-weighted volume to generate a composite factor.",
          "code": "def heuristics_v2(df):\n    # Exponential Moving Averages\n    ema_7 = df['close'].ewm(span=7, adjust=False).mean()\n    ema_21 = df['close'].ewm(span=21, adjust=False).mean()\n    ema_ratio = (ema_7 / ema_21) - 1\n    \n    # Chaikin Money Flow (CMF)\n    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])\n    money_flow_volume = money_flow_multiplier * df['volume']\n    cmf = money_flow_volume.rolling(window=14).sum() / df['volume'].rolling(window=14).sum()\n    \n    # Aroon Oscillator\n    aroon_up = df['high'].rolling(window=28).apply(lambda x: (x.argmax() + 1) / 28 * 100, raw=True)\n    aroon_down = df['low'].rolling(window=28).apply(lambda x: (x.argmin() + 1) / 28 * 100, raw=True)\n    aroon_oscillator = aroon_up - aroon_down\n    \n    # Price weighted by volume\n    price_weighted = (df['open'] + df['high'] + df['low'] + df['close']) / 4 * df['volume']\n    \n    # Composite heuristic\n    heuristics_matrix = (ema_ratio + cmf + aroon_oscillator + price_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03601,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics using a 10-day and 20-day exponential moving average, a 28-period stochastic oscillator, and a 21-period ADX, combined with a volume-weighted close price to create a composite factor.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    ema_10 = df['close'].ewm(span=10, adjust=False).mean()\n    ema_20 = df['close'].ewm(span=20, adjust=False).mean()\n    ema_ratio = (ema_10 / ema_20) - 1\n    \n    low_28 = df['low'].rolling(window=28).min()\n    high_28 = df['high'].rolling(window=28).max()\n    k_percent = 100 * ((df['close'] - low_28) / (high_28 - low_28))\n    \n    tr = df['high'] - df['low']\n    up_move = df['high'] - df['close'].shift(1)\n    down_move = df['low'] - df['close'].shift(1)\n    plus_dm = up_move.where((up_move > down_move) & (up_move > 0), 0)\n    minus_dm = down_move.where((down_move > up_move) & (down_move > 0), 0)\n    tr_21 = tr.rolling(window=21).sum()\n    plus_di = 100 * (plus_dm.rolling(window=21).sum() / tr_21)\n    minus_di = 100 * (minus_dm.rolling(window=21).sum() / tr_21)\n    dx = 100 * (abs(plus_di - minus_di) / (plus_di + minus_di))\n    adx = dx.rolling(window=21).mean()\n    \n    volume_weighted = df['volume'] * df['close']\n    \n    heuristics_matrix = (ema_ratio + k_percent - adx + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03587,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm integrates exponential moving averages with spans of 5 and 10 days, a modified RSI using a 10-day lookback, and the Money Flow Index (MFI) with a 10-day window, along with an adjustment for volume, to create a composite heuristic aimed at forecasting future stock returns.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Exponential Moving Averages\n    ema_5 = df['close'].ewm(span=5, adjust=False).mean()\n    ema_10 = df['close'].ewm(span=10, adjust=False).mean()\n    ema_ratio = (ema_5 / ema_10) - 1\n    \n    # Modified Relative Strength Index (RSI) with 10-day lookback\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=10).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=10).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Money Flow Index (MFI) with 10-day window\n    typical_price = (df['high'] + df['low'] + df['close']) / 3\n    raw_money_flow = typical_price * df['volume']\n    positive_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)\n    negative_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)\n    money_flow_ratio = positive_flow.rolling(window=10).sum() / negative_flow.rolling(window=10).sum()\n    mfi = 100 - (100 / (1 + money_flow_ratio))\n    \n    # Volume weighted by typical price\n    volume_weighted = df['volume'] * typical_price\n    \n    # Composite heuristic\n    heuristics_matrix = (ema_ratio + rsi + mfi + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03576,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm integrates a 5-day and 10-day exponential moving average ratio, an RSI with a 9-day lookback, a modified MFI using a 9-day window, and a volume-weighted median price of the open, high, low, and close, with all components averaged for the final score.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Exponential Moving Averages\n    ema_5 = df['close'].ewm(span=5, adjust=False).mean()\n    ema_10 = df['close'].ewm(span=10, adjust=False).mean()\n    ema_ratio = (ema_5 / ema_10) - 1\n    \n    # Traditional Relative Strength Index (RSI) with 9-day lookback\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=9).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=9).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Modified Money Flow Index (MFI) with 9-day window\n    typical_price = (df['high'] + df['low'] + df['open'] + df['close']) / 4\n    raw_money_flow = typical_price * df['volume']\n    positive_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)\n    negative_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)\n    money_flow_ratio = positive_flow.rolling(window=9).sum() / negative_flow.rolling(window=9).sum()\n    mfi = 100 - (100 / (1 + money_flow_ratio))\n    \n    # Volume weighted by the median of open, high, low, and close prices\n    med_price = (df[['open', 'high', 'low', 'close']].median(axis=1))\n    volume_weighted = df['volume'] * med_price\n    \n    # Composite heuristic\n    heuristics_matrix = (ema_ratio + rsi + mfi + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03574,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics using a 5-day and 20-day simple moving average ratio, a 14-day RSI, and a 10-day ATR, with a volume-weighted close price, to create a composite factor.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate simple moving averages\n    sma_5 = df['close'].rolling(window=5).mean()\n    sma_20 = df['close'].rolling(window=20).mean()\n    sma_ratio = (sma_5 / sma_20) - 1\n    \n    # Relative Strength Index (RSI)\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Average True Range (ATR)\n    tr = df['high'] - df['low']\n    atr = tr.rolling(window=10).mean()\n    \n    # Volume weighted by close price\n    volume_weighted = df['volume'] * df['close']\n    \n    # Composite heuristic\n    heuristics_matrix = (sma_ratio + rsi - atr + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03567,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics based on price and volume data, incorporating moving averages, relative strength index, and average true range with adjusted parameters to create a composite factor aimed at predicting future stock returns.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate simple moving averages\n    sma_7 = df['close'].rolling(window=7).mean()\n    sma_14 = df['close'].rolling(window=14).mean()\n    sma_ratio = (sma_7 / sma_14) - 1\n    \n    # Relative Strength Index (RSI)\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=21).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=21).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Average True Range (ATR)\n    tr = df['high'] - df['low']\n    atr = tr.rolling(window=21).mean()\n    \n    # Volume weighted by close price\n    volume_weighted = df['volume'] * df['close']\n    \n    # Composite heuristic\n    heuristics_matrix = (sma_ratio + rsi - atr + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03566,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics based on price and volume data, using a combination of Bollinger Bands, a 14-day modified RSI, and the coefficient of variation of returns to create a composite factor.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate Bollinger Bands\n    middle_band = df['close'].rolling(window=20).mean()\n    std_dev = df['close'].rolling(window=20).std()\n    upper_band = middle_band + 2 * std_dev\n    lower_band = middle_band - 2 * std_dev\n    bollinger_ratio = (df['close'] - lower_band) / (upper_band - lower_band)\n    \n    # Modified Relative Strength Index (RSI) with a 14-day lookback\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Coefficient of Variation of Returns\n    mean_returns = df['close'].pct_change().rolling(window=21).mean()\n    std_returns = df['close'].pct_change().rolling(window=21).std()\n    cv = std_returns / mean_returns\n    \n    # Volume weighted by close price\n    volume_weighted = df['volume'] * df['close']\n    \n    # Composite heuristic\n    heuristics_matrix = (bollinger_ratio + rsi - cv + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03563,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm integrates a 14-day and 28-day exponential moving average ratio, a RSI with a 21-day lookback, a modified Money Flow Index (MFI) using a 21-day window, alongside a volume-weighted price that uses the weighted average of the open, high, low, and close prices.",
          "code": "def heuristics_v2(df):\n    # Exponential Moving Averages\n    ema_14 = df['close'].ewm(span=14, adjust=False).mean()\n    ema_28 = df['close'].ewm(span=28, adjust=False).mean()\n    ema_ratio = (ema_14 / ema_28) - 1\n    \n    # Traditional Relative Strength Index (RSI) with 21-day lookback\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=21).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=21).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Modified Money Flow Index (MFI) with 21-day window\n    typical_price = (df['high'] + df['low'] + df['open'] + df['close']) / 4\n    raw_money_flow = typical_price * df['volume']\n    positive_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)\n    negative_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)\n    money_flow_ratio = positive_flow.rolling(window=21).sum() / negative_flow.rolling(window=21).sum()\n    mfi = 100 - (100 / (1 + money_flow_ratio))\n    \n    # Volume weighted by the weighted average of open, high, low, and close prices\n    volume_weighted = df['volume'] * (0.2*df['open'] + 0.3*df['high'] + 0.3*df['low'] + 0.2*df['close'])\n    \n    # Composite heuristic\n    heuristics_matrix = (ema_ratio + rsi + mfi + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.03561,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a set of technical and fundamental heuristics based on price and volume data, incorporating moving averages, relative strength index, and average true range to create a composite factor aimed at predicting future stock returns.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate simple moving averages\n    sma_5 = df['close'].rolling(window=5).mean()\n    sma_10 = df['close'].rolling(window=10).mean()\n    sma_ratio = (sma_5 / sma_10) - 1\n    \n    # Relative Strength Index (RSI)\n    delta = df['close'].diff(1)\n    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()\n    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n    \n    # Average True Range (ATR)\n    tr = df['high'] - df['low']\n    atr = tr.rolling(window=14).mean()\n    \n    # Volume weighted by close price\n    volume_weighted = df['volume'] * df['close']\n    \n    # Composite heuristic\n    heuristics_matrix = (sma_ratio + rsi - atr + volume_weighted) / 4\n    return heuristics_matrix",
          "objective": -0.0356,
          "other_inf": null
     }
]