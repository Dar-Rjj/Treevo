def heuristics_v2(df):
    ema_vol_30 = df['volume'].ewm(span=30, adjust=False).mean()
    price_diff_weighted = (df['high'] - df['low']) * (df['volume'] / ema_vol_30)
    heuristics_matrix = price_diff_weighted
    return heuristics_matrix
