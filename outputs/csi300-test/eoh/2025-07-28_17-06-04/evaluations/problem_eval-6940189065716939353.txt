def heuristics_v2(df):
    roc_close = df['close'].pct_change()
    ema_volume_short = df['volume'].ewm(span=5, adjust=False).mean()
    ema_volume_long = df['volume'].ewm(span=20, adjust=False).mean()
    volume_diff_ema = ema_volume_short - ema_volume_long
    price_range_ratio = df['high'] / df['low']
    heuristics_matrix = (roc_close * volume_diff_ema * price_range_ratio).rename('heuristics_factor')
    return heuristics_matrix
