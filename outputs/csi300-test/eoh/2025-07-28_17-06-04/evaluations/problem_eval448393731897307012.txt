def heuristics_v2(df):
    avg_vol_30 = df['volume'].rolling(window=30).mean()
    avg_vol_150 = df['volume'].rolling(window=150).mean()
    delta_close = df['close'].diff()
    gain = (delta_close.where(delta_close > 0, 0)).rolling(window=14).mean()
    loss = (-delta_close.where(delta_close < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    heuristics_matrix = (avg_vol_30 / avg_vol_150) * (rsi / 50)
    return heuristics_matrix
