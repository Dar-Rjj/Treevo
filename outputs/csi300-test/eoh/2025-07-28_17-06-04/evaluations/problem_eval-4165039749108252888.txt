def heuristics_v2(df):
    avg_vol_100 = df['volume'].rolling(window=100).mean()
    heuristics_matrix = df['volume'] / avg_vol_100
    smoothed_heuristics_matrix = heuristics_matrix.ewm(span=5, adjust=False).mean()
    return heuristics_matrix
