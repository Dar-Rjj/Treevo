def heuristics_v2(df):
    def calculate_factors(data):
        data['price_change'] = data['close'].pct_change()
        data['volume_change'] = data['volume'].pct_change()
        data['volatility'] = data['high'] - data['low']
        data['momentum'] = data['close'] - data['open']
        return (data['price_change'] * 0.4 + data['volume_change'] * 0.3 + data['volatility'] * 0.2 + data['momentum'] * 0.1)
    
    heuristics_matrix = calculate_factors(df)
    return heuristics_matrix
