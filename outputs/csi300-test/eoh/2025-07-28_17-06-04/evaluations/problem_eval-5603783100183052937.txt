def heuristics_v2(df):
    high_low_diff_30 = (df['high'].rolling(window=30).max() - df['low'].rolling(window=30).min())
    close_momentum_30 = df['close'] - df['close'].shift(30)
    heuristics_matrix = high_low_diff_30 + close_momentum_30
    return heuristics_matrix
