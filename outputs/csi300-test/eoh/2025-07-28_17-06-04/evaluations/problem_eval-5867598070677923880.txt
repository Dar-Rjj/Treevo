import pandas as pd
import numpy as np

def heuristics_v2(df):
    hl_ratio_avg_50 = df['high'].rolling(window=50).mean() / df['low'].rolling(window=50).mean()
    log_hl_ratio = np.log(hl_ratio_avg_50)
    close_momentum_20 = df['close'] - df['close'].shift(20)
    heuristics_matrix = log_hl_ratio * close_momentum_20
    return heuristics_matrix
