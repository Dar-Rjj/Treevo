def heuristics_v2(df):
    avg_close_10 = df['close'].rolling(window=10).mean()
    avg_high_50 = df['high'].rolling(window=50).mean()
    vol_ratio = df['volume'].rolling(window=10).mean() / df['volume'].rolling(window=50).mean()
    heuristics_matrix = (avg_close_10 / avg_high_50) * (1 + vol_ratio)
    return heuristics_matrix
