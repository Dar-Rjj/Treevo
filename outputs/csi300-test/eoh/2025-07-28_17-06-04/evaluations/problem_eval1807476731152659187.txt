def heuristics_v2(df):
    def calculate_factors(data):
        # Calculate Relative Strength Index (RSI)
        delta = data['close'].diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
        rs = gain / loss
        rsi = 100 - (100 / (1 + rs))

        # Calculate Average True Range (ATR)
        true_range = data[['high', 'low']].apply(lambda x: x['high'] - x['low'], axis=1)
        atr = true_range.rolling(window=14).mean()

        # Calculate Rate of Change (ROC)
        roc = data['close'].pct_change(periods=14)

        # Combine the factors
        combined_factor = (rsi + atr + roc) / 3

        return combined_factor

    heuristics_matrix = calculate_factors(df)
    return heuristics_matrix
