import numpy as np

def heuristics_v2(df):
    avg_vol_50 = df['volume'].rolling(window=50).mean()
    avg_vol_200 = df['volume'].rolling(window=200).mean()
    log_returns_40_avg = np.log(df['close'] / df['close'].shift(1)).rolling(window=40).mean()
    heuristics_matrix = (avg_vol_50 / avg_vol_200) * (1 + log_returns_40_avg)
    return heuristics_matrix
