import pandas as pd

def heuristics_v2(df):
    def calculate_momentum(df):
        return df['close'].pct_change(periods=30).fillna(0)

    def calculate_volatility(df):
        daily_returns = df['close'].pct_change().fillna(0)
        return daily_returns.rolling(window=60).std().fillna(0)

    def calculate_liquidity(df):
        return (df['volume'] / df['amount']).fillna(0)

    momentum = calculate_momentum(df)
    volatility = calculate_volatility(df)
    liquidity = calculate_liquidity(df)
    
    heuristics_matrix = 0.5 * momentum - 0.3 * volatility + 0.2 * liquidity
    return heuristics_matrix
