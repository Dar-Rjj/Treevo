def heuristics_v2(df):
    def calculate_rsi_with_volume(data):
        data['price_change'] = data['close'].diff()
        data['up'] = data['price_change'].apply(lambda x: x if x > 0 else 0)
        data['down'] = data['price_change'].apply(lambda x: -x if x < 0 else 0)
        avg_gain = data['up'].rolling(window=14).mean() * data['volume']
        avg_loss = data['down'].rolling(window=14).mean() * data['volume']
        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))
        return rsi

    heuristics_matrix = calculate_rsi_with_volume(df)
    return heuristics_matrix
