def heuristics_v2(df):
    price_change = df['close'].diff().fillna(0)
    cum_price_change = price_change.rolling(window=50).sum()
    vol_adj_factor = df['volume'] / df['volume'].rolling(window=50).mean()
    market_volatility = (df['high'] - df['low']).rolling(window=50).std()
    heuristics_matrix = cum_price_change * (vol_adj_factor / market_volatility)
    return heuristics_matrix
