def heuristics_v2(df):
    avg_price = (df['high'] + df['low']) / 2
    roc_avg_price = avg_price.pct_change()
    amount_to_volume_ratio = df['amount'] / df['volume']
    ema_roc_avg = roc_avg_price.ewm(span=5, adjust=False).mean()
    ema_amt_to_vol = amount_to_volume_ratio.ewm(span=5, adjust=False).mean()
    weight_roc_avg = ema_roc_avg / (ema_roc_avg + ema_amt_to_vol)
    weight_amt_to_vol = 1 - weight_roc_avg
    heuristics_matrix = (weight_roc_avg * roc_avg_price + weight_amt_to_vol * amount_to_volume_ratio).rename('heuristics_factor')
    return heuristics_matrix
