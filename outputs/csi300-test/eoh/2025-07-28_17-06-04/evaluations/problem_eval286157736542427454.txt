def heuristics_v2(df):
    roc_close = df['close'].pct_change()
    vol_to_amount_ratio = df['volume'] / df['amount']
    ema_roc = roc_close.ewm(span=5, adjust=False).mean()
    ema_vol_to_amt = vol_to_amount_ratio.ewm(span=5, adjust=False).mean()
    weight_roc = ema_roc / (ema_roc + ema_vol_to_amt)
    weight_vol_to_amt = 1 - weight_roc
    heuristics_matrix = (weight_roc * roc_close + weight_vol_to_amt * vol_to_amount_ratio).rename('heuristics_factor')
    return heuristics_matrix
