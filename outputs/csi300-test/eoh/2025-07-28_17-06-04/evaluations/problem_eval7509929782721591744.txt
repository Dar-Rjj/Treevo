import pandas as pd

def heuristics_v2(df):
    df['price_diff'] = df['close'] - df['open']
    df['tr'] = df[['high', 'low', 'close']].shift(1).apply(lambda x: max(x['high'], x['close']) - min(x['low'], x['close']), axis=1)
    df['atr'] = df['tr'].rolling(window=14).mean()
    df['obv'] = ((df['close'] - df['close'].shift(1)) / abs(df['close'] - df['close'].shift(1)) * df['volume']).fillna(0).cumsum()
    heuristics_matrix = (df['price_diff'] / df['atr']) * df['obv']
    return heuristics_matrix
