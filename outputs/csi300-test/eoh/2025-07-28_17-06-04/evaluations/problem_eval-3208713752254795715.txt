def heuristics_v2(df):
    def calculate_consistency(series):
        return (series.diff().dropna() > 0).rolling(window=20).mean()

    open_consistency = calculate_consistency(df['open'])
    close_consistency = calculate_consistency(df['close'])
    volume_consistency = calculate_consistency(df['volume'])

    open_factor = df['open'].pct_change() * open_consistency
    close_factor = df['close'].pct_change() * close_consistency
    volume_factor = df['volume'].pct_change() * volume_consistency

    heuristics_matrix = (open_factor + close_factor) / 2 + volume_factor
    return heuristics_matrix
