def heuristics_v2(df):
    # Trend Following: Calculate the 10-day and 50-day exponential moving averages
    df['EMA_short'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_long'] = df['close'].ewm(span=50, adjust=False).mean()
    
    # Volatility-Adjusted Return: Adjust returns by recent price volatility
    df['return'] = df['close'].pct_change()
    df['volatility'] = df['close'].rolling(window=30).std()
    df['adjusted_return'] = df['return'] / (df['volatility'] + 1)
    
    # Liquidity: Volume weighted by closing price
    df['liquidity'] = df['volume'] * df['close']
    
    # Combine the factors into a single heuristic
    df['heuristic_score'] = (df['EMA_short'] > df['EMA_long']).astype(int) * df['adjusted_return'] * df['liquidity']
    
    # Extract the heuristic score series
    heuristics_matrix = df['heuristic_score']
    
    return heuristics_matrix
