import pandas as pd

def heuristics_v2(df):
    # Momentum: Using close price shift to calculate simple return
    df['momentum'] = df['close'].pct_change()
    
    # Volatility: Standard deviation of daily returns over a 30-day window
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity: Volume weighted by closing price
    df['liquidity'] = df['volume'] * df['close']
    
    # Combine factors into a single heuristic
    df['heuristic_score'] = df['momentum'] / (df['volatility'] + 1) * df['liquidity']
    
    # Extract the heuristic score series
    heuristics_matrix = df['heuristic_score']
    
    return heuristics_matrix
