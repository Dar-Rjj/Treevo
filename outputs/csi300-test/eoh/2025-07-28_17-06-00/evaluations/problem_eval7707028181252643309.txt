def heuristics_v2(df):
    # Calculate daily price change
    price_change = df['close'].diff(1).fillna(0)
    
    # Calculate the 10-day momentum of the closing price
    close_momentum = df['close'].pct_change(periods=10).fillna(0)
    
    # Compute the weighted volume difference (up days * volume - down days * volume), using close price as weight
    volume_diff = (df['volume'] * df['close'] * (price_change > 0) - df['volume'] * df['close'] * (price_change < 0)).cumsum()
    
    # Combine the 10-day momentum with the weighted volume difference
    heuristics_matrix = close_momentum * volume_diff
    
    return heuristics_matrix
