import pandas as pd

def heuristics_v2(df):
    # Calculate Exponential Moving Average for close price and volume
    ema_close = df['close'].ewm(span=10, adjust=False).mean()
    ema_volume = df['volume'].ewm(span=10, adjust=False).mean()
    
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    
    # Calculate volatility as the standard deviation of daily returns over a 30-day window
    volatility = daily_returns.rolling(window=30).std()
    
    # Heuristic formula: EMA of Close + EMA of Volume - Volatility
    heuristics_matrix = ema_close + ema_volume - volatility
    
    return heuristics_matrix
