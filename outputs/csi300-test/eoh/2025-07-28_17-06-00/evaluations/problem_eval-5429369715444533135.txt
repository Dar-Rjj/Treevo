def heuristics_v2(df):
    window_size = 15
    price_trend_weight = 0.5
    volume_weight = 0.3
    volatility_weight = 0.2
    df['ema_close'] = df['close'].ewm(span=window_size, adjust=False).mean()
    df['ema_volume'] = df['volume'].ewm(span=window_size, adjust=False).mean()
    price_trend_ratio = (df['close'] / df['ema_close']) * price_trend_weight
    intraday_volatility = (df['high'] - df['low']) * volatility_weight
    weighted_ema_volume = df['ema_volume'] * volume_weight
    heuristics_matrix = price_trend_ratio + weighted_ema_volume + intraday_volatility
    return heuristics_matrix
