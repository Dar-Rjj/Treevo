def heuristics_v2(df):
    window_size = 20
    
    # Calculate 20-period rolling mean and standard deviation for the close price
    df['close_mean'] = df['close'].rolling(window=window_size).mean()
    df['close_std'] = df['close'].rolling(window=window_size).std()
    
    # Upper Bollinger Band
    df['upper_band'] = df['close_mean'] + 2 * df['close_std']
    
    # Momentum: difference between current close and the close 20 days ago
    df['momentum'] = df['close'] - df['close'].shift(window_size)
    
    # Rate of Change (ROC) for volume
    df['roc_volume'] = df['volume'] / df['volume'].shift(window_size) - 1
    
    # Distance of close from upper Bollinger Band
    df['distance_from_upper_band'] = (df['close'] - df['upper_band']) / (2 * df['close_std'])
    
    heuristics_matrix = df['momentum'] * df['roc_volume'] * df['distance_from_upper_band']
    return heuristics_matrix
