def heuristics_v2(df):
    window_size = 14
    df['ema_amount'] = df['amount'].ewm(span=window_size, adjust=False).mean()
    df['ema_volume'] = df['volume'].ewm(span=window_size, adjust=False).mean()
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up = up.rolling(window=window_size).mean()
    roll_down = down.abs().rolling(window=window_size).mean().abs()
    rs = roll_up / roll_down
    rsi = 100.0 - (100.0 / (1.0 + rs))
    heuristics_matrix = (rsi + (df['ema_amount'] - df['ema_volume']) / df['volume']) * df['macd_line']
    return heuristics_matrix
