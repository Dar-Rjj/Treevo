def heuristics_v2(df):
    window_size = 10
    df['ema_close'] = df['close'].ewm(span=window_size, adjust=False).mean()
    df['roc_ema_close'] = df['ema_close'].pct_change()
    df['ema_amount'] = df['amount'].ewm(span=window_size, adjust=False).mean()
    df['sma_volume'] = df['volume'].rolling(window=window_size).mean()
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    r_up = up.ewm(com=window_size-1, adjust=False).mean()
    r_down = down.ewm(com=window_size-1, adjust=False).mean().abs()
    rs = r_up / r_down
    df['rsi'] = 100 - (100 / (1 + rs))
    heuristics_matrix = df['roc_ema_close'] + (df['ema_amount'] / df['sma_volume']) * df['rsi']
    return heuristics_matrix
