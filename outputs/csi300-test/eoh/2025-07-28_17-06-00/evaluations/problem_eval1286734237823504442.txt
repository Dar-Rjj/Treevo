import pandas as pd

def heuristics_v2(df):
    close = df['close']
    high = df['high']
    low = df['low']
    volume = df['volume']

    # MACD for closing price with standard parameters (12, 26, 9)
    ema_12 = close.ewm(span=12, adjust=False).mean()
    ema_26 = close.ewm(span=26, adjust=False).mean()
    macd_line = ema_12 - ema_26
    signal_line = macd_line.ewm(span=9, adjust=False).mean()
    macd_hist = macd_line - signal_line

    # Chaikin Money Flow (CMF) over a 20-day period
    mfv = ((close - low) - (high - close)) / (high - low)
    mfv = mfv * volume
    cmf = mfv.rolling(window=20).sum() / volume.rolling(window=20).sum()

    # Bollinger Bands: Percentage Bandwidth
    bb_mavg = close.rolling(window=20).mean()
    bb_std = close.rolling(window=20).std()
    bb_upper = bb_mavg + (bb_std * 2)
    bb_lower = bb_mavg - (bb_std * 2)
    bb_percentage_bandwidth = (bb_upper - bb_lower) / bb_mavg * 100

    # Alpha factor as a combination of MACD histogram, CMF, and Bollinger Bands' percentage bandwidth
    heuristics_matrix = (macd_hist + cmf) * bb_percentage_bandwidth

    return heuristics_matrix
