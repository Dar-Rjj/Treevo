def heuristics_v2(df):
    close = df['close']
    volume = df['volume']
    high = df['high']
    low = df['low']
    amount = df['amount']  # Assuming 'amount' is the total traded value (close * volume)
    
    # Calculate the price-to-book ratio
    price_to_book_ratio = close / (amount / volume)
    
    # Simple Moving Average for closing price with a 50-day span
    sma_close = close.rolling(window=50).mean()
    
    # Daily returns
    daily_return = close.pct_change()
    
    # Coefficient of variation of daily returns over a 30-day period
    cv_daily_returns = daily_return.rolling(window=30).std() / daily_return.rolling(window=30).mean()
    
    # Alpha factor as a combination of price-to-book ratio, SMA close, and CV of daily returns
    heuristics_matrix = price_to_book_ratio * sma_close * cv_daily_returns
    
    return heuristics_matrix
