def heuristics_v2(df):
    ema_close_window = 20
    sma_close_window = 10
    ema_volume_window = 10
    
    df['ema_close'] = df['close'].ewm(span=ema_close_window, adjust=False).mean()
    df['sma_close'] = df['close'].rolling(window=sma_close_window).mean()
    df['ema_volume'] = df['volume'].ewm(span=ema_volume_window, adjust=False).mean()
    
    price_trend_difference = df['ema_close'] - df['sma_close']
    liquidity_ratio = df['volume'] / df['ema_volume']
    
    heuristics_matrix = price_trend_difference * liquidity_ratio
    return heuristics_matrix
