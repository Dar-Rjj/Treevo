def heuristics_v2(df):
    ema_close_window = 20
    pos_neg_change_window = 10
    avg_volume_window = 5
    
    df['ema_close'] = df['close'].ewm(span=ema_close_window, adjust=False).mean()
    df['price_change'] = df['close'].diff()
    df['positive_change'] = df['price_change'].apply(lambda x: x if x > 0 else 0)
    df['negative_change'] = df['price_change'].apply(lambda x: abs(x) if x < 0 else 0)
    
    df['avg_positive_change'] = df['positive_change'].rolling(window=pos_neg_change_window).sum()
    df['avg_negative_change'] = df['negative_change'].rolling(window=pos_neg_change_window).sum()
    df['momentum_ratio'] = df['avg_positive_change'] / (df['avg_positive_change'] + df['avg_negative_change'])
    
    df['avg_volume'] = df['volume'].rolling(window=avg_volume_window).mean()
    
    heuristics_matrix = (df['ema_close'] * df['momentum_ratio']) + df['avg_volume']
    return heuristics_matrix
