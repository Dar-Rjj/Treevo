def heuristics_v2(df):
    # Calculate daily price change
    price_change = df['close'].diff(1).fillna(0)
    
    # Calculate the difference between high and low as a measure of intraday volatility, with a 30-day rolling mean
    intraday_volatility = (df['high'] - df['low']).rolling(window=30).mean()
    
    # Compute the cumulative difference between up and down days in volume
    volume_diff = (df['volume'] * (price_change > 0) - df['volume'] * (price_change < 0)).cumsum()
    
    # Apply an exponential moving average to the intraday volatility for emphasis on recent data
    ema_intraday_volatility = intraday_volatility.ewm(span=30, adjust=False).mean()
    
    # Calculate the Relative Strength Index (RSI) for the closing prices over a 21-day period
    gain = df['close'].diff(1).apply(lambda x: max(x, 0))
    loss = df['close'].diff(1).apply(lambda x: abs(min(x, 0)))
    avg_gain = gain.rolling(window=21).mean()
    avg_loss = loss.rolling(window=21).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    
    # Combine the EMA-adjusted intraday volatility, volume difference, and RSI
    heuristics_matrix = ema_intraday_volatility * volume_diff * rsi
    
    return heuristics_matrix
