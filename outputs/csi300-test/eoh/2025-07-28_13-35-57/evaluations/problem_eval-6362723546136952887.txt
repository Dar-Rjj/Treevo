def heuristics_v2(df):
    n = 20
    df['Range'] = df['high'] - df['low']
    df['Volatility'] = df['Range'].rolling(window=n).std().fillna(0)
    weight_adjustment = 1 / (1 + df['Volatility'])
    df['close_ma'] = df['close'].rolling(window=n).mean().fillna(0)
    close_deviation = df['close'] - df['close_ma']
    heuristics_matrix = (close_deviation * df['volume']) * weight_adjustment
    return heuristics_matrix
