import pandas as pd
import numpy as np

def heuristics_v2(df):
    df['Trading_Activity'] = (df['close'] - df['open']).abs() / df['volume']
    df['Directional_Agreement'] = np.where((df['close'] > df['open']) & (df['high'] > df['low']), 1, 0)
    df['Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    heuristics_matrix = df['Trading_Activity'] * df['Directional_Agreement'] + df['Log_Return']
    return heuristics_matrix
