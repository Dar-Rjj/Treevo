import pandas as pd

def heuristics_v2(df):
    # Calculate 14-day momentum for closing prices
    df['Momentum'] = df['close'] - df['close'].shift(14)
    
    # Calculate the 7-day average true range (ATR)
    df['True_Range'] = df[['high', 'low']].apply(lambda x: max(x) - min(x), axis=1)
    df['ATR'] = df['True_Range'].rolling(window=7).mean()
    
    # Calculate the 5-day EMA of the trading volume
    df['Volume_EMA'] = df['volume'].ewm(span=5, adjust=False).mean()
    
    # Integrate Momentum, ATR, and Volume_EMA
    heuristics_matrix = df['Momentum'] * df['ATR'] * df['Volume_EMA']
    
    return heuristics_matrix
