def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['shifted_daily_return'] = df['daily_return'].shift(-1)
    df['std_20d'] = df['daily_return'].rolling(window=20).std()
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    df['cumulative_log_return_30d'] = df['log_return'].rolling(window=30).sum()
    df['momentum_volatility_factor'] = (df['cumulative_log_return_30d'] / df['std_20d']).replace([np.inf, -np.inf], np.nan)
    heuristics_matrix = (df['shifted_daily_return'] * df['momentum_volatility_factor']).dropna()
    return heuristics_matrix
