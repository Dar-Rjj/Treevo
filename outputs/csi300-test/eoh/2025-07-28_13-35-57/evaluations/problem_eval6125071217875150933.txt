def heuristics_v2(df):
    def compute_heuristic(row):
        momentum = (row['close'] - df.loc[row.name - pd.Timedelta(days=20)]['close']) / df.loc[row.name - pd.Timedelta(days=20)]['close']
        avg_volume = df.loc[row.name - pd.Timedelta(days=20):row.name, 'volume'].mean()
        volume_ratio = row['volume'] / avg_volume
        return momentum * volume_ratio
    
    heuristics_matrix = df.apply(compute_heuristic, axis=1)
    return heuristics_matrix
