def heuristics_v2(df):
    n = 10
    smooth_factor = 0.2
    df['Range'] = df['high'] - df['low']
    df['Volatility'] = df['Range'].ewm(span=n, adjust=False).mean().fillna(0)
    weight_adjustment = 1 / (1 + df['Volatility'])
    heuristics_matrix = (df['close'] * df['volume']).ewm(alpha=smooth_factor).mean() * weight_adjustment
    return heuristics_matrix
