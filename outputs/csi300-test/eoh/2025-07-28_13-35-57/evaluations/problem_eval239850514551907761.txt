import pandas as pd

def heuristics_v2(df):
    # Calculate the 100-period moving average
    ma_100 = df['close'].rolling(window=100).mean()
    
    # Ratio of close price to its 100-period moving average
    ratio_ma100 = df['close'] / ma_100
    
    # Calculate the EMA for 'volume'
    ema_volume = df['volume'].ewm(span=30, adjust=False).mean()
    
    # Standard deviation of daily log returns
    daily_log_returns = (df['close'].pct_change().fillna(0)).apply(lambda x: np.log(1 + x))
    std_daily_log_returns = daily_log_returns.rolling(window=30).std()
    
    # Determine dynamic weights based on the standard deviation of daily log returns
    weight_ratio = 1 / (1 + std_daily_log_returns.fillna(0))
    weight_ema = 1 - weight_ratio
    
    # Compute the heuristic factor
    heuristics_matrix = (ratio_ma100 * weight_ratio) + (ema_volume * weight_ema)
    
    return heuristics_matrix
