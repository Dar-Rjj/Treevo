import pandas as pd

def heuristics_v2(df):
    df['close_open_ratio'] = df['close'] / df['open']
    df['high_low_log_diff'] = (df['high'] - df['low']).apply(lambda x: abs(x) if x != 0 else 1).apply(lambda x: math.log(x))
    heuristics_matrix = (df['close_open_ratio'] * df['high_low_log_diff']).dropna()
    return heuristics_matrix
