def heuristics_v2(df):
    # Calculate simple moving average for closing prices
    sma_close = df['close'].rolling(window=20).mean()
    
    # Compute daily log-returns of closing prices
    log_returns = np.log(df['close'] / df['close'].shift(1))
    
    # Estimate the rolling standard deviation of log-returns as a measure of volatility
    vol = log_returns.rolling(window=20).std()
    
    # Generate a heuristic factor by combining the momentum (SMA difference) and volatility (inverted to favor lower vol)
    heuristics_matrix = (df['close'] - sma_close) / (vol + 1e-8)  # Adding small epsilon to avoid division by zero
    
    return heuristics_matrix
