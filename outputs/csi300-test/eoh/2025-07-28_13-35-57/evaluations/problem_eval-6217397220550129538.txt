import pandas as pd

def heuristics_v2(df):
    # Calculate 14-day EMA for closing prices
    df['EMA'] = df['close'].ewm(span=14, adjust=False).mean()
    
    # Calculate a modified 9-day RSI
    delta = df['close'].diff(1)
    up = delta.clip(lower=0)
    down = -delta.clip(upper=0)
    ema_up = up.ewm(com=8, adjust=False).mean()
    ema_down = down.ewm(com=8, adjust=False).mean()
    rs = ema_up/ema_down
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Calculate the 7-day EMA of the ratio of positive volume to total volume
    df['Volume_Pos_Ratio'] = (df['volume'] * (df['close'] > df['open']).astype(int)) / df['volume']
    df['Volume_Pos_Ratio_EMA'] = df['Volume_Pos_Ratio'].ewm(span=7, adjust=False).mean()
    
    # Integrate EMA, RSI, and Volume_Pos_Ratio_EMA
    heuristics_matrix = df['EMA'] * df['RSI'] * df['Volume_Pos_Ratio_EMA']
    
    return heuristics_matrix
