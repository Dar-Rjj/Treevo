import pandas as pd

def heuristics_v2(df):
    # Calculate the 50-period moving average
    ma_50 = df['close'].rolling(window=50).mean()
    
    # Ratio of close price to its 50-period moving average
    ratio_ma50 = df['close'] / ma_50
    
    # Calculate the EMA for 'volume'
    ema_volume = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Standard deviation of daily returns
    daily_returns = df['close'].pct_change().fillna(0)
    std_daily_returns = daily_returns.rolling(window=20).std()
    
    # Determine dynamic weights based on the standard deviation of daily returns
    weight_ratio = 1 / (1 + std_daily_returns.fillna(0))
    weight_ema = 1 - weight_ratio
    
    # Compute the heuristic factor
    heuristics_matrix = (ratio_ma50 * weight_ratio) + (ema_volume * weight_ema)
    
    return heuristics_matrix
