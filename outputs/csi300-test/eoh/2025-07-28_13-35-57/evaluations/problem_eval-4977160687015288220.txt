def heuristics_v2(df):
    n = 20
    df['Range'] = df['high'] - df['low']
    df['Volatility'] = df['Range'].rolling(window=n).std().fillna(0)
    weight_adjustment = 1 / (1 + df['Volatility'])
    heuristics_matrix = (df['close'] * df['volume']) * weight_adjustment
    return heuristics_matrix
