def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['shifted_daily_return'] = df['daily_return'].shift(-1)
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up = up.rolling(window=14).mean()
    roll_down = down.abs().rolling(window=14).mean()
    rs = roll_up / roll_down
    rsi = 100 - (100 / (1 + rs))
    df['log_diff'] = np.log(df['high']) - np.log(df['low'])
    heuristics_matrix = (df['shifted_daily_return'] * rsi * df['log_diff']).dropna()
    return heuristics_matrix
