def heuristics_v2(df):
    # Calculate 20-period SMA for closing prices
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Calculate 14-period ATR
    tr = df[['high', 'low', 'close']].diff().abs().max(axis=1)
    atr_14 = tr.rolling(window=14).mean()
    
    # Calculate the cumulative sum of volume differences over the last 5 periods
    vol_diff_cumsum = df['volume'].diff().rolling(window=5).sum()
    
    # Integrate SMA, ATR, and volume difference cumulative sum
    heuristics_matrix = sma_20 * atr_14 * vol_diff_cumsum
    
    return heuristics_matrix
