def heuristics_v2(df):
    n = 20
    weights = pd.Series(range(1,n+1))
    wma_close = df['close'].rolling(window=n).apply(lambda x: (x*weights).sum() / weights.sum(), raw=True)
    std_range = df['high'] - df['low']
    mean_range = (df['high'] + df['low']) / 2
    rolling_std = std_range.rolling(window=n).std()
    rolling_mean = mean_range.rolling(window=n).mean()
    coeff_variation = rolling_std / rolling_mean
    heuristics_matrix = wma_close / coeff_variation
    return heuristics_matrix
