import pandas as pd

def heuristics_v2(df):
    # Calculate moving averages for all columns
    ma = df.rolling(window=14).mean()
    
    # Calculate RSI for 'close' price
    delta = df['close'].diff(1)
    up_days = delta.copy()
    down_days = delta.copy()
    up_days[up_days < 0] = 0
    down_days[down_days > 0] = 0
    roll_up14 = up_days.rolling(window=14).mean()
    roll_down14_abs = down_days.abs().rolling(window=14).mean()
    RS = roll_up14 / roll_down14_abs
    RSI = 100.0 - (100.0 / (1.0 + RS))
    
    # Combine factors: Moving Averages and RSI
    weights = [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2]
    combined_factors = (ma * weights[:-1]).sum(axis=1) + RSI*weights[-1]
    
    return heuristics_matrix
