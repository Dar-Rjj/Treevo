def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['shifted_daily_return'] = df['daily_return'].shift(-1)
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['std_10d'] = df['close'].rolling(window=10).std()
    df['log_diff_ma'] = (df['close'] - df['ma_10d']).apply(lambda x: abs(math.log(x + 1)))
    heuristics_matrix = (df['shifted_daily_return'] * df['log_diff_ma'] / df['std_10d']).dropna()
    return heuristics_matrix
