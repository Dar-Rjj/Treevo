def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate cumulative returns
    df['cumulative_return'] = (1 + df['daily_return']).cumprod() - 1
    
    # Calculate the 10-day average volume
    df['avg_volume_10d'] = df['volume'].rolling(window=10).mean()
    
    # Calculate the volume ratio
    df['volume_ratio'] = df['volume'] / df['avg_volume_10d']
    
    # Calculate the 10-day standard deviation of daily returns as a measure of recent volatility
    df['volatility'] = df['daily_return'].rolling(window=10).std().fillna(0)
    
    # Determine dynamic weights based on the recent volatility
    weight_cumulative = 1 / (1 + df['volatility'])
    weight_volume = 1 - weight_cumulative
    
    # Compute the heuristic factor
    heuristics_matrix = (df['cumulative_return'] * weight_cumulative) + (df['volume_ratio'] * weight_volume)
    
    return heuristics_matrix
