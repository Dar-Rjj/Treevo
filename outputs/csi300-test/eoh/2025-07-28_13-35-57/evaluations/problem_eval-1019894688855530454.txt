import pandas as pd

def heuristics_v2(df):
    # Calculate the 20-period moving average
    ma_20 = df['close'].rolling(window=20).mean()
    
    # Ratio of close price to its 20-period moving average
    ratio_ma20 = df['close'] / ma_20
    
    # Calculate the SMA for 'volume'
    sma_volume = df['volume'].rolling(window=20).mean()
    
    # Mean of daily returns
    daily_returns = df['close'].pct_change().fillna(0)
    mean_daily_returns = daily_returns.rolling(window=10).mean()
    
    # Determine dynamic weights based on the mean of daily returns
    weight_ratio = 1 / (1 + mean_daily_returns.fillna(0))
    weight_sma = 1 - weight_ratio
    
    # Compute the heuristic factor
    heuristics_matrix = (ratio_ma20 * weight_ratio) + (sma_volume * weight_sma)
    
    return heuristics_matrix
