def heuristics_v2(df):
    def macd(data, fast=12, slow=26, signal=9):
        ema_fast = data.ewm(span=fast, adjust=False).mean()
        ema_slow = data.ewm(span=slow, adjust=False).mean()
        macd_line = ema_fast - ema_slow
        signal_line = macd_line.ewm(span=signal, adjust=False).mean()
        return macd_line - signal_line

    close_prices = df['close']
    macd_values = macd(close_prices)
    
    weight_volume, weight_amount = 0.5, 0.5
    combined_factor = macd_values + (df['volume'] * weight_volume + df['amount'] * weight_amount)
    
    heuristics_matrix = pd.Series(combined_factor, index=df.index)
    return heuristics_matrix
