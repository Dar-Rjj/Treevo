def heuristics_v2(df):
    # Calculate the rolling median of close prices over a 20-day window
    df['rolling_median_close'] = df['close'].rolling(window=20).median()
    # Compute the ratio of close price to its rolling median
    df['price_to_rolling_median_ratio'] = df['close'] / df['rolling_median_close']
    
    # Calculate the mean of the volume over a 20-day window
    df['avg_volume'] = df['volume'].rolling(window=20).mean()
    # Compute the deviation of today's volume from the average
    df['volume_deviation'] = (df['volume'] - df['avg_volume']) / df['avg_volume']
    
    # Create the heuristic factor using the computed ratios and deviations
    heuristics_matrix = df['price_to_rolling_median_ratio'] * df['volume_deviation'].fillna(0)
    
    return heuristics_matrix
