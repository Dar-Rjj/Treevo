import pandas as pd

def heuristics_v2(df):
    # Calculate RSI
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    
    # Calculate ADX
    tr = pd.DataFrame({'H-L': df['high'] - df['low'], 
                       'H-PC': abs(df['high'] - df['close'].shift()), 
                       'L-PC': abs(df['low'] - df['close'].shift())})
    tr['TR'] = tr.max(axis=1)
    tr.drop(['H-L', 'H-PC', 'L-PC'], axis=1, inplace=True)
    atr = tr['TR'].rolling(window=14).mean()
    
    dm_pos = (df['high'] - df['high'].shift()).where(lambda x: x > 0, 0)
    dm_neg = (df['low'].shift() - df['low']).where(lambda x: x > 0, 0)
    
    di_pos = 100 * (dm_pos.rolling(window=14).sum() / atr)
    di_neg = 100 * (dm_neg.rolling(window=14).sum() / atr)
    
    dx = 100 * (abs(di_pos - di_neg) / (di_pos + di_neg))
    adx = dx.rolling(window=14).mean()
    
    # Calculate the standard deviation of returns as a measure of volatility
    daily_returns = df['close'].pct_change().fillna(0)
    volatility = daily_returns.rolling(window=20).std().fillna(0)
    
    # Adjust volume based on volatility
    adjusted_volume = df['volume'] / (1 + volatility)
    
    # Compute the heuristic factor
    heuristics_matrix = (rsi + adx) * adjusted_volume
    
    return heuristics_matrix
