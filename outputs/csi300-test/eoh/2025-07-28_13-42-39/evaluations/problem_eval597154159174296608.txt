import pandas as pd

def heuristics_v2(df):
    def ema(series, span=10):
        return series.ewm(span=span, adjust=False).mean()
    
    close_prices = df['close']
    volumes = df['volume']

    ema_close = ema(close_prices)
    sma_volume = volumes.rolling(window=20).mean()
    ema_volume = ema(volumes)

    momentum_indicator = (ema_volume - sma_volume)

    heuristics_matrix = (ema_close * 0.7 + momentum_indicator * 0.3).apply(np.log)

    return heuristics_matrix
