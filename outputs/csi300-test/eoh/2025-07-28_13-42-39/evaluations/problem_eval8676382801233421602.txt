def heuristics_v2(df):
    # Calculate daily log returns
    df['log_ret'] = np.log(df['close'] / df['close'].shift(1))
    
    # Define momentum as the 12-day moving average of log returns
    df['momentum'] = df['log_ret'].rolling(window=12).mean()
    
    # Define volatility as the standard deviation of log returns over the past 12 days
    df['volatility'] = df['log_ret'].rolling(window=12).std()
    
    # Measure the consistency of momentum and volatility as predictors by correlating them with next day's return
    df['consistency_momentum'] = df['momentum'].shift(1).corr(df['log_ret'])
    df['consistency_volatility'] = df['volatility'].shift(1).corr(df['log_ret'])

    # Normalize the consistencies to get the weights
    total_consistency = df['consistency_momentum'] + df['consistency_volatility']
    df['weight_momentum'] = df['consistency_momentum'] / total_consistency
    df['weight_volatility'] = df['consistency_volatility'] / total_consistency

    # Construct the heuristic factor
    df['heuristic_factor'] = (df['momentum'] * df['weight_momentum']) - (df['volatility'] * df['weight_volatility'])

    heuristics_matrix = df['heuristic_factor']

    return heuristics_matrix
