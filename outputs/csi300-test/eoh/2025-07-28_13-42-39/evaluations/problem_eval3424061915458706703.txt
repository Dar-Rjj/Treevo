def heuristics_v2(df):
    avg_amount_20_days = df['amount'].rolling(window=20).mean()
    close_price_ratio = avg_amount_20_days / df['close']
    high_price_change_10_days = df['high'].pct_change(periods=10)
    heuristics_matrix = close_price_ratio - high_price_change_10_days
    return heuristics_matrix
