import pandas as pd
    
    def macd(close, fast=12, slow=26, signal=9):
        exp1 = close.ewm(span=fast, adjust=False).mean()
        exp2 = close.ewm(span=slow, adjust=False).mean()
        macd = exp1 - exp2
        signal_line = macd.ewm(span=signal, adjust=False).mean()
        return macd - signal_line

    def proprietary_volatility_ratio(high, low, n=20):
        avg_true_range = (high - low).rolling(window=n).mean()
        long_term_avg = (high - low).rolling(window=5*n).mean()
        return avg_true_range / long_term_avg

    macd_val = macd(df['close'])
    prop_vol_ratio = proprietary_volatility_ratio(df['high'], df['low'])

    heuristics_matrix = (macd_val + prop_vol_ratio).rename('heuristic_factor')
    
    return heuristics_matrix
