def heuristics_v2(df):
    df['ratio'] = (df['close'] - df['open']) / df['volume']
    df['rolling_std'] = df['ratio'].rolling(window=30).std()
    df['high_ewma_200'] = df['high'].ewm(span=200, adjust=False).mean()
    heuristics_matrix = df['rolling_std'] / df['high_ewma_200']
    return heuristics_matrix
