import pandas as pd

def heuristics_v2(df):
    def calculate_roc(series, n):
        return series.pct_change(periods=n).fillna(0)
    
    rocs = {f'roc_{n}': df.apply(calculate_roc, args=(n,)) for n in [5, 10, 20]}
    weights = {feature: 1/len(df.columns) for feature in df.columns}
    heuristics_matrix = pd.Series(dtype='float64')
    for n, roc_df in rocs.items():
        for feature, weight in weights.items():
            heuristics_matrix += roc_df[feature] * weight
    heuristics_matrix = heuristics_matrix.groupby(level=0).sum()
    return heuristics_matrix
