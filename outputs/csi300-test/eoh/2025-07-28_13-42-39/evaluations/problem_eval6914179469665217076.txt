import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the daily trading volume to close price ratio
    vol_to_close = df['volume'] / df['close']
    
    # Calculate the rolling standard deviation of the close price (volatility)
    close_volatility = df['close'].rolling(window=20).std()
    
    # Compute the ratio of average daily trading volume to price volatility
    ratio = vol_to_close / close_volatility
    
    # Smooth the ratio with short, medium, and long-term moving averages
    short_term_ma = ratio.rolling(window=5).mean()
    medium_term_ma = ratio.rolling(window=20).mean()
    long_term_ma = ratio.rolling(window=60).mean()
    
    # Generate the heuristic factor as a weighted sum of the moving averages
    heuristics_matrix = 0.2 * short_term_ma + 0.3 * medium_term_ma + 0.5 * long_term_ma
    
    return heuristics_matrix
