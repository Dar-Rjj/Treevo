import pandas as pd

def heuristics_v2(df):
    def rsi(series, periods=14):
        delta = series.diff()
        gain = delta.where(delta > 0, 0)
        loss = -delta.where(delta < 0, 0)
        avg_gain = gain.rolling(window=periods).mean()
        avg_loss = loss.rolling(window=periods).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))

    def roc(series, periods=12):
        return series.pct_change(periods=periods)

    close_prices = df['close']
    volumes = df['volume']

    rsi_values = rsi(close_prices)
    roc_volumes = roc(volumes)

    heuristics_matrix = (rsi_values * 0.6 + roc_volumes * 0.4).rolling(window=5).mean()

    return heuristics_matrix
