def heuristics_v2(df):
    close = df['close']
    tr = pd.concat([df['high'] - df['low'], (df['high'] - close.shift(1)).abs(), (df['low'] - close.shift(1)).abs()], axis=1).max(axis=1)
    atr = tr.rolling(window=14).mean()
    min_close_50 = close.rolling(window=50).min()
    factor = (close - min_close_50) / atr
    return heuristics_matrix
