def heuristics_v2(df):
    df['high_ema'] = df['high'].ewm(span=20, adjust=False).mean()
    df['low_ema'] = df['low'].ewm(span=20, adjust=False).mean()
    direction_movement = df['high_ema'] / df['low_ema']
    weights = [i for i in range(1, 11)]
    heuristics_matrix = direction_movement.rolling(window=10).apply(lambda x: (x * weights).sum() / sum(weights), raw=True)
    return heuristics_matrix
