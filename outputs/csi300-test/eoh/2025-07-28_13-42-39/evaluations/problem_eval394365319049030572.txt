def heuristics_v2(df):
    close = df['close']
    high_low_avg = (df['high'] + df['low']) / 2
    high_low_ma = high_low_avg.rolling(window=20).mean()
    vol_change = df['volume'].pct_change()
    factor1 = close / high_low_ma
    factor2 = (vol_change + 1).cumprod() - 1
    heuristics_matrix = factor1 * factor2
    return heuristics_matrix
