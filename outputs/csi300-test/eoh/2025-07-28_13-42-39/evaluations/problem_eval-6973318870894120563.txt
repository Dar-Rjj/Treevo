def heuristics_v2(df):
    df['ewma_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['ewma_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['atr_14'] = df[['high', 'low', 'close']].pct_change().abs().rolling(window=14).mean().max(axis=1)
    heuristics_matrix = (df['ewma_20'] - df['ewma_5']) / df['atr_14']
    return heuristics_matrix
