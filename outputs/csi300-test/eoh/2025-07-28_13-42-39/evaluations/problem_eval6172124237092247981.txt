def heuristics_v2(df):
    high = df['high']
    low = df['low']
    close = df['close']
    avg_high_low = (high.rolling(window=20).mean() + low.rolling(window=20).mean()) / 2
    factor1 = high / low
    factor2 = close - avg_high_low
    heuristics_matrix = (factor1 * factor2)
    return heuristics_matrix
