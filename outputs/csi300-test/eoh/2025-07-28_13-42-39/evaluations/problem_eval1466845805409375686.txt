import pandas as pd

def heuristics_v2(df):
    df['hl_avg'] = (df['high'].rolling(window=10).mean() + df['low'].rolling(window=10).mean()) / 2
    df['volume_sum'] = df['volume'].rolling(window=10).sum()
    adjusted_liquidity = df['hl_avg'] / df['volume_sum']
    heuristics_matrix = adjusted_liquidity.ewm(span=30, adjust=False).mean()
    return heuristics_matrix
