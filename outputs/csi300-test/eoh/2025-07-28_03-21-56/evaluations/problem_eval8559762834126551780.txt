def heuristics_v2(df):
    def compute_roc(series, period=14):
        return series.pct_change(periods=period) * 100

    def compute_mad(series, period=10):
        return series.rolling(window=period).apply(lambda x: np.mean(np.abs(x - x.mean())), raw=True)

    df['roc'] = compute_roc(df['close'])
    df['mad'] = compute_mad(df['close'])
    heuristics_matrix = df['roc'] + df['mad']
    return heuristics_matrix
