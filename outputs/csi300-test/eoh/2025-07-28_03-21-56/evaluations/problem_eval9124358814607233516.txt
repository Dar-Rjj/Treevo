def heuristics_v2(df):
    def compute_roc(series, n=14):
        roc = (series - series.shift(n)) / series.shift(n) * 100
        return roc

    def compute_cmf(high, low, close, volume, n=20):
        mfm = ((close - low) - (high - close)) / (high - low)
        mf_volume = mfm * volume
        cmf = mf_volume.rolling(window=n).sum() / volume.rolling(window=n).sum()
        return cmf

    df['roc'] = compute_roc(df['close'])
    df['cmf'] = compute_cmf(df['high'], df['low'], df['close'], df['volume'])
    heuristics_matrix = df['roc'] + df['cmf']
    return heuristics_matrix
