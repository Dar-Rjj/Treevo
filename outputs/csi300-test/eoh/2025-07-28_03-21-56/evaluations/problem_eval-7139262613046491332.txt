import pandas as pd

def heuristics_v2(df):
    # Calculate the 10-day EMA of the closing price
    ema_close = df['close'].ewm(span=10, adjust=False).mean()
    
    # Calculate the positive and negative volumes
    positive_volume = df[df['close'] > df['close'].shift(1)]['volume']
    negative_volume = df[df['close'] < df['close'].shift(1)]['volume']
    
    # Fill NaNs with 0 for days without positive or negative volume
    positive_volume = positive_volume.fillna(0)
    negative_volume = negative_volume.fillna(0)
    
    # Calculate the ratio of positive to negative volume
    pos_neg_ratio = positive_volume / (negative_volume + 1e-6)  # add a small constant to avoid division by zero
    
    # Generate the heuristic factor by combining the EMA and the volume ratio
    heuristics_matrix = ema_close * pos_neg_ratio
    
    return heuristics_matrix
