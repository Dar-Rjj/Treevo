def heuristics_v2(df):
    # Calculate the daily price change
    daily_price_change = df['close'].diff()
    
    # Compute the 10-day rolling mean of the daily price change
    rolling_mean_price_change = daily_price_change.rolling(window=10).mean()
    
    # Compute the 30-day maximum amount
    max_amount_30d = df['amount'].rolling(window=30).max()
    
    # Calculate the ratio of current day's amount to the 30-day maximum amount
    amount_ratio = df['amount'] / max_amount_30d
    
    # Generate the heuristic factor by combining rolling mean of price change and amount ratio
    heuristics_matrix = rolling_mean_price_change * amount_ratio
    
    return heuristics_matrix
