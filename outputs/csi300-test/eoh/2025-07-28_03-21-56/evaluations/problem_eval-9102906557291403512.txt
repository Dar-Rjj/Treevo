import pandas as pd

def heuristics_v2(df):
    # Calculate the rate of change (momentum) of closing prices
    momentum_close = df['close'].pct_change()
    
    # Compute the average volume over a 30-day window
    avg_volume = df['volume'].rolling(window=30).mean()
    
    # Calculate the ratio of daily volume to average volume
    volume_ratio = df['volume'] / avg_volume
    
    # Generate the heuristic factor by multiplying momentum and volume ratio
    heuristics_matrix = momentum_close * volume_ratio
    
    return heuristics_matrix
