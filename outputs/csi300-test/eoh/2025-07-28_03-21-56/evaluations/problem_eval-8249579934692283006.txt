def heuristics_v2(df):
    def compute_ema(series, span=20):
        return series.ewm(span=span, adjust=False).mean()

    def compute_ad(series, high, low, close, volume):
        money_flow_multiplier = ((close - low) - (high - close)) / (high - low)
        money_flow_volume = money_flow_multiplier * volume
        ad = money_flow_volume.cumsum()
        return ad

    df['ema'] = compute_ema(df['close'])
    df['ad'] = compute_ad(df['close'], df['high'], df['low'], df['close'], df['volume'])
    adosc = df['ad'] - df['ad'].rolling(window=10).mean() - (df['ad'] - df['ad'].rolling(window=3).mean())
    heuristics_matrix = df['ema'] + adosc
    return heuristics_matrix
