def heuristics_v2(df):
    def calculate_weighted_sum(row, std_close, std_volume):
        return (row['close_change'] / std_close) + (row['volume_change'] / std_volume)
    
    df['close_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()
    rolling_std_close = df['close'].rolling(window=30).std().shift(1)
    rolling_std_volume = df['volume'].rolling(window=30).std().shift(1)
    
    df['heuristic_factor'] = df.apply(lambda row: calculate_weighted_sum(row, rolling_std_close[row.name], rolling_std_volume[row.name]), axis=1)
    heuristics_matrix = df['heuristic_factor'].dropna()
    
    return heuristics_matrix
