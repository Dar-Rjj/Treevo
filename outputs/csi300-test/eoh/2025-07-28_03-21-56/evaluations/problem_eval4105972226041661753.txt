def heuristics_v2(df):
    # Calculate the 20-day moving average of the average of high and low prices
    ma_high_low = (df['high'] + df['low']) / 2
    ma_price = ma_high_low.rolling(window=20).mean()
    
    # Compute the ratio of the close price to this moving average
    ratio_close_ma = df['close'] / ma_price
    
    # Calculate the change in trading amount
    amount_change = df['amount'].diff()
    
    # Generate the heuristic factor
    heuristics_matrix = ratio_close_ma * amount_change
    
    return heuristics_matrix
