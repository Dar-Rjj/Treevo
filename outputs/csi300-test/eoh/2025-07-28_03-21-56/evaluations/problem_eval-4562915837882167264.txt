def heuristics_v2(df):
    def compute_roc(series, period=10):
        return (series - series.shift(period)) / series.shift(period) * 100

    def compute_cmf(high, low, close, volume, period=20):
        mfm = ((close - low) - (high - close)) / (high - low)
        mf_volume = mfm * volume
        cmf = mf_volume.rolling(window=period).sum() / volume.rolling(window=period).sum()
        return cmf

    df['roc'] = compute_roc(df['close'])
    df['cmf'] = compute_cmf(df['high'], df['low'], df['close'], df['volume'])
    heuristics_matrix = df['roc'] + df['cmf']
    return heuristics_matrix
