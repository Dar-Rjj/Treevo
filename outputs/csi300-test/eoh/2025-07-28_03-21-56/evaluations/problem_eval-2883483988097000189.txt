import pandas as pd

def heuristics_v2(df):
    short_period = 10
    long_period = 30
    short_returns = (df['close'].pct_change(short_period) + 1).rolling(window=short_period).apply(lambda x: (x.product() - 1), raw=True)
    long_returns = (df['close'].pct_change(long_period) + 1).rolling(window=long_period).apply(lambda x: (x.product() - 1), raw=True)
    heuristics_matrix = short_returns - long_returns
    return heuristics_matrix
