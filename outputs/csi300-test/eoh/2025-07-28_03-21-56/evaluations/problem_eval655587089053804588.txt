def heuristics_v2(df):
    # Calculate the rate of change (ROC) of the closing prices
    roc = df['close'].pct_change()
    
    # Calculate the acceleration of the closing prices
    acceleration = roc.pct_change()
    
    # Calculate the weighted moving average of the volume over a 20-day window
    wma_volume = df['volume'].rolling(window=20).apply(lambda x: (x * range(1, 21)).sum() / 210)
    
    # Generate the heuristic factor by combining ROC, acceleration, and WMA of volume
    heuristics_matrix = roc + acceleration + wma_volume
    
    return heuristics_matrix
