import pandas as pd

def heuristics_v2(df):
    # Calculate the ratio of close price to open price
    close_open_ratio = df['close'] / df['open']
    
    # Compute the 10-day and 30-day Exponential Moving Averages (EMAs)
    ema_short = df['close'].ewm(span=10, adjust=False).mean()
    ema_long = df['close'].ewm(span=30, adjust=False).mean()
    
    # Generate the EMA crossover signal
    ema_crossover_signal = (ema_short > ema_long).astype(int)
    
    # Generate the heuristic factor by combining the close/open ratio and EMA crossover signal
    heuristics_matrix = close_open_ratio * ema_crossover_signal
    
    return heuristics_matrix
