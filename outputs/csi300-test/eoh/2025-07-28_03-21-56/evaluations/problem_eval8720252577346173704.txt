def heuristics_v2(df):
    df['high_low_ratio'] = df['high'] / df['low']
    ema_high_low_ratio = df['high_low_ratio'].ewm(span=7, adjust=False).mean()
    close_min_7d = df['close'].rolling(window=7).min()
    diff_close_min = df['close'] - close_min_7d
    volume_std = df['volume'].rolling(window=7).std()
    heuristics_matrix = (ema_high_low_ratio * 0.5) + (diff_close_min * 0.5 * volume_std)
    return heuristics_matrix
