import pandas as pd

def heuristics_v2(df):
    close = df['close']
    ema_short = close.ewm(span=10, adjust=False).mean()
    ema_long = close.ewm(span=50, adjust=False).mean()
    returns = close.pct_change()
    rsi = 100 - (100 / (1 + (returns.rolling(window=14).apply(lambda x: x[x > 0].mean() / abs(x[x < 0].mean())))))
    std_dev = close.rolling(window=30).std()
    heuristics_matrix = (ema_short - ema_long) / std_dev + rsi
    return heuristics_matrix
