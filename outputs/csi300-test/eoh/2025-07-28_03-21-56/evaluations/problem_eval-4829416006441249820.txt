def heuristics_v2(df):
    def compute_cmo(series, period=14):
        delta = series.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=period).sum()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).sum()
        cmo = ((gain - loss) / (gain + loss)) * 100
        return cmo

    def compute_obv(close, volume):
        obv = (np.sign(close.diff()) * volume).cumsum()
        return obv

    close = df['close']
    volume = df['volume']
    
    df['cmo'] = compute_cmo(close)
    df['obv'] = compute_obv(close, volume)
    df['obv_ma'] = df['obv'].rolling(window=10).mean()
    heuristics_matrix = df['cmo'] + (df['obv'] - df['obv_ma'])
    return heuristics_matrix
