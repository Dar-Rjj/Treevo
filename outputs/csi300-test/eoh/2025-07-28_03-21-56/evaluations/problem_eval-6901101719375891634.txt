def heuristics_v2(df):
    # Calculate daily return
    df['return'] = df['close'].pct_change()
    
    # Sum of positive returns over the past 5 days
    positive_returns_sum = df['return'].where(df['return'] > 0, 0).rolling(window=5).sum()
    
    # Sum of absolute returns over the past 5 days
    abs_returns_sum = df['return'].abs().rolling(window=5).sum()
    
    # Ratio of positive returns to total absolute returns
    pos_to_abs_ratio = positive_returns_sum / abs_returns_sum
    
    # Sum of trading amounts over the past 10 days
    amount_sum = df['amount'].rolling(window=10).sum()
    
    # Generate the heuristic factor
    heuristics_matrix = pos_to_abs_ratio * amount_sum
    
    return heuristics_matrix
