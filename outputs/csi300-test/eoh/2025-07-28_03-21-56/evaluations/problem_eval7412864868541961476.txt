import pandas as pd

def heuristics_v2(df):
    close = df['close']
    volume = df['volume']
    ema_short = close.ewm(span=10, adjust=False).mean()
    ema_long = close.ewm(span=50, adjust=False).mean()
    vol_avg = volume.rolling(window=50).mean()
    vol_ratio = volume / vol_avg
    roc_close = close.pct_change(periods=20)
    heuristics_matrix = (ema_short - ema_long) * vol_ratio + roc_close
    return heuristics_matrix
