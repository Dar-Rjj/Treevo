def heuristics_v2(df):
    close_open_diff = df['close'] - df['open']
    log_high_low_ratio = np.log(df['high'] / df['low'])
    volume_change = df['volume'].pct_change()
    weighted_sum = (close_open_diff * 0.5) + (log_high_low_ratio * 0.3) + (volume_change * 0.2)
    heuristics_matrix = weighted_sum.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
