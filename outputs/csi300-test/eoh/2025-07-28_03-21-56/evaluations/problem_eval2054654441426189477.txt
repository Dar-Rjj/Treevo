def heuristics_v2(df):
    df['high_rolling_median'] = df['high'].rolling(window=30).median()
    df['low_rolling_median'] = df['low'].rolling(window=30).median()
    df['volume_change'] = (df['volume'] - df['volume'].shift(4)) / df['volume'].shift(4)
    heuristics_matrix = (df['close'] / ((df['high_rolling_median'] + df['low_rolling_median']) / 2)) * (1 + df['volume_change'])
    return heuristics_matrix
