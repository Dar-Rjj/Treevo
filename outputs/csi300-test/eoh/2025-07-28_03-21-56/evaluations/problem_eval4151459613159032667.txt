def heuristics_v2(df):
    def calculate_momentum(df, window):
        return df['close'].pct_change(window)
    
    def calculate_volatility(df, window):
        return df['close'].rolling(window).std()
    
    def calculate_volume_trend(df, window):
        return df['volume'].rolling(window).mean().pct_change()
    
    short_window = 10
    medium_window = 30
    long_window = 90
    
    momentum_short = calculate_momentum(df, short_window)
    momentum_medium = calculate_momentum(df, medium_window)
    momentum_long = calculate_momentum(df, long_window)
    
    volatility_short = calculate_volatility(df, short_window)
    volatility_medium = calculate_volatility(df, medium_window)
    volatility_long = calculate_volatility(df, long_window)
    
    volume_trend_short = calculate_volume_trend(df, short_window)
    volume_trend_medium = calculate_volume_trend(df, medium_window)
    volume_trend_long = calculate_volume_trend(df, long_window)
    
    heuristics_matrix = (momentum_short + momentum_medium + momentum_long +
                         -volatility_short - volatility_medium - volatility_long +
                         volume_trend_short + volume_trend_medium + volume_trend_long) / 9
    
    return heuristics_matrix
