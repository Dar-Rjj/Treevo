def heuristics_v2(df):
    atr = df[['high', 'low', 'close']].rolling(window=10).apply(lambda x: talib.ATR(x['high'], x['low'], x['close'], timeperiod=10), raw=False)
    close_open_diff = df['close'] - df['open']
    atr_close_open_ratio = close_open_diff / atr
    daily_returns = df['close'].pct_change()
    ema_daily_returns = daily_returns.ewm(span=10, adjust=False).mean()
    volume_change = df['volume'].pct_change()
    heuristics_matrix = (atr_close_open_ratio * 0.5) + (ema_daily_returns * 0.5 * (1 + volume_change))
    return heuristics_matrix
