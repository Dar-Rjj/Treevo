def heuristics_v2(df):
    log_returns = np.log(df['close'] / df['close'].shift(1))
    volume_change = df['volume'].pct_change()
    close_open_ratio = df['close'] / df['open']
    smoothed_close_open_ratio = close_open_ratio.rolling(window=5).mean()
    combined_factor = (log_returns - volume_change) + smoothed_close_open_ratio
    heuristics_matrix = combined_factor.rolling(window=10).mean()
    return heuristics_matrix
