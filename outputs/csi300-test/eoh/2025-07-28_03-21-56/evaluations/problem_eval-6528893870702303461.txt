import pandas as pd

def heuristics_v2(df):
    close = df['close']
    delta = close.diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up = up.rolling(window=14).mean()
    roll_down = down.abs().rolling(window=14).mean()
    rs = roll_up / roll_down
    rsi = 100.0 - (100.0 / (1.0 + rs))
    
    m_flow_volume = (2 * df['close'] - df['low'] - df['high']) / (df['high'] - df['low']) * df['volume']
    cmf = m_flow_volume.rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    heuristics_matrix = rsi + cmf
    return heuristics_matrix
