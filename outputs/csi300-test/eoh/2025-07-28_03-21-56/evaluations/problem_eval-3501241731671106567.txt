def heuristics_v2(df):
    def calculate_directional_movement(df, window):
        df['direction'] = 0
        df['direction'][df['close'] > df['close'].shift(1)] = 1
        df['direction'][df['close'] < df['close'].shift(1)] = -1
        return df['direction'].rolling(window).mean()
    
    def calculate_positive_negative_volume_trend(df, window):
        df['positive_volume'] = df['volume']
        df['positive_volume'][df['close'] < df['close'].shift(1)] = 0
        df['negative_volume'] = df['volume']
        df['negative_volume'][df['close'] >= df['close'].shift(1)] = 0
        return (df['positive_volume'].rolling(window).sum() / df['negative_volume'].rolling(window).sum()).fillna(0)

    short_window = 10
    medium_window = 30
    long_window = 90
    
    directional_short = calculate_directional_movement(df, short_window)
    directional_medium = calculate_directional_movement(df, medium_window)
    directional_long = calculate_directional_movement(df, long_window)
    
    volume_ratio_short = calculate_positive_negative_volume_trend(df, short_window)
    volume_ratio_medium = calculate_positive_negative_volume_trend(df, medium_window)
    volume_ratio_long = calculate_positive_negative_volume_trend(df, long_window)
    
    heuristics_matrix = (directional_short + directional_medium + directional_long +
                         volume_ratio_short + volume_ratio_medium + volume_ratio_long) / 6
    
    return heuristics_matrix
