import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    daily_return = df['close'].pct_change()
    
    # Compute the exponential moving average of the daily return
    ema_daily_return = daily_return.ewm(span=10).mean()
    
    # Calculate the ratio of the closing price to the highest high over a trailing window
    high_over_trailing_window = df['high'].rolling(window=30).max()
    close_to_high_ratio = df['close'] / high_over_trailing_window
    
    # Generate the heuristic factor
    heuristics_matrix = ema_daily_return * close_to_high_ratio
    
    return heuristics_matrix
