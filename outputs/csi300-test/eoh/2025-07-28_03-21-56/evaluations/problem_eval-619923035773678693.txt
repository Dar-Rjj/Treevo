def heuristics_v2(df):
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    volatility = df['close'].rolling(window=20).std()
    heuristics_matrix = (money_flow - money_flow.shift(1)) / volatility
    return heuristics_matrix
