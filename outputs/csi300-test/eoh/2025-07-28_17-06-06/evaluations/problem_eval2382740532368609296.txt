def heuristics_v2(df):
    # Calculate the 20-day and 100-day rolling percentiles of the closing price
    percentile_20 = df['close'].rolling(window=20).apply(lambda x: (x[-1] - x.min()) / (x.max() - x.min()), raw=True)
    percentile_100 = df['close'].rolling(window=100).apply(lambda x: (x[-1] - x.min()) / (x.max() - x.min()), raw=True)
    
    # Calculate the standard deviation of the closing price over a 20-day period
    std_20 = df['close'].rolling(window=20).std()
    
    # Create a signal based on the difference between the two percentiles
    signal = percentile_20 - percentile_100
    
    # Create a heuristic score by dividing the signal by the standard deviation
    heuristics_matrix = (signal / std_20).dropna()
    
    return heuristics_matrix
