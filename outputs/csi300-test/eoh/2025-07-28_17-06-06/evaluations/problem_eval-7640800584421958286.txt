def heuristics_v2(df):
    df['10d_mean_close'] = df['close'].rolling(window=10).mean()
    df['squared_dist_to_10d_mean'] = (df['close'] - df['10d_mean_close']) ** 2
    df['weighted_volume'] = df['volume'] * df['squared_dist_to_10d_mean']
    df['weighted_amount'] = df['amount'] * df['squared_dist_to_10d_mean']
    df['exp_weighted_avg_volume'] = df['weighted_volume'].ewm(span=20, adjust=False).mean()
    df['exp_weighted_avg_amount'] = df['weighted_amount'].ewm(span=20, adjust=False).mean()
    df['combined_exp_weighted_avg'] = (df['exp_weighted_avg_volume'] + df['exp_weighted_avg_amount'])
    heuristics_matrix = df['combined_exp_weighted_avg'].dropna()
    return heuristics_matrix
