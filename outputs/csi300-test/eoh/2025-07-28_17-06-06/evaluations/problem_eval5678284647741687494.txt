def heuristics_v2(df):
    # Calculate the 20-day high and low
    df['20d_high'] = df['high'].rolling(window=20).max()
    df['20d_low'] = df['low'].rolling(window=20).min()
    
    # Average of the 20-day high and low
    df['avg_20d_price'] = (df['20d_high'] + df['20d_low']) / 2
    
    # Calculate the 20-day average volume
    df['avg_20d_volume'] = df['volume'].rolling(window=20).mean()
    
    # Ratio of the current volume to the 20-day average volume
    df['volume_ratio'] = df['volume'] / df['avg_20d_volume']
    
    # Calculate the momentum factor
    df['momentum_factor'] = (df['close'] - df['avg_20d_price']) * df['volume_ratio']
    
    # Create the heuristics matrix
    heuristics_matrix = df['momentum_factor'].dropna()
    
    return heuristics_matrix
