import pandas as pd

def heuristics_v2(df):
    # Calculate the close-to-amount ratio
    df['close_to_amount_ratio'] = df['close'] / df['amount']
    
    # Calculate the 30-day rolling mean of the close-to-amount ratio
    df['rolling_mean_ratio'] = df['close_to_amount_ratio'].rolling(window=30).mean()
    
    # Calculate the exponential moving average (EMA) of volume with a span of 7 days
    df['volume_ema'] = df['volume'].ewm(span=7, adjust=False).mean()
    
    # Adjust the rolling mean of the close-to-amount ratio by the EMA of volume
    df['adjusted_ratio'] = df['rolling_mean_ratio'] * df['volume_ema']
    
    # Create the heuristics matrix
    heuristics_matrix = df['adjusted_ratio']
    
    return heuristics_matrix
