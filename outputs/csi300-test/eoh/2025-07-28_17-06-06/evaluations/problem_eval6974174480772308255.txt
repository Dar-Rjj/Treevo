def heuristics_v2(df):
    df['30d_high'] = df['high'].rolling(window=30).max()
    df['30d_low'] = df['low'].rolling(window=30).min()
    df['price_range'] = df['30d_high'] - df['30d_low']
    df['avg_volume_30d'] = df['volume'].rolling(window=30).mean()
    df['factor_value'] = df['price_range'] * df['avg_volume_30d']
    heuristics_matrix = df['factor_value'].dropna()
    return heuristics_matrix
