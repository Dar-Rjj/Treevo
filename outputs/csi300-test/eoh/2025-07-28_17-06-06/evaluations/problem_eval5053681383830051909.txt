def heuristics_v2(df):
    df['return'] = df['close'].pct_change()
    df['inv_volume'] = 1 / df['volume']
    df['wma_returns'] = (df['return'] * df['inv_volume']).rolling(window=20).sum() / df['inv_volume'].rolling(window=20).sum()
    heuristics_matrix = df['return'] - df['wma_returns']
    return heuristics_matrix
