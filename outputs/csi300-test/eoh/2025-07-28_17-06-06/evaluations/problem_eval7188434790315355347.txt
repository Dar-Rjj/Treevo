import pandas as pd

def heuristics_v2(df):
    # Calculate short-term (5 days) and long-term (30 days) moving averages of daily returns
    df['daily_return'] = df['close'].pct_change()
    df['short_term_momentum'] = df['daily_return'].rolling(window=5).mean().fillna(0)
    df['long_term_momentum'] = df['daily_return'].rolling(window=30).mean().fillna(0)
    
    # Compute the weighted difference between short-term and long-term momentum
    df['momentum_difference'] = (df['short_term_momentum'] - df['long_term_momentum']) * df['volume']
    
    # Integrate the effect of volume change
    df['volume_trend'] = df['volume'].pct_change().fillna(0)
    heuristics_matrix = df['momentum_difference'] * df['volume_trend']
    
    return heuristics_matrix
