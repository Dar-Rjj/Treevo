def heuristics_v2(df):
    df['10d_median_close'] = df['close'].rolling(window=10).median()
    df['abs_diff_to_10d_median'] = (df['close'] - df['10d_median_close']).abs() * df['volume']
    df['cumulative_scaled_diff'] = df['abs_diff_to_10d_median'].rolling(window=30).sum()
    heuristics_matrix = df['cumulative_scaled_diff'].dropna()
    return heuristics_matrix
