def heuristics_v2(df):
    df['daily_return_diff'] = df['close'] - df['open']
    df['pos_daily_return_diff'] = df['daily_return_diff'].apply(lambda x: max(0, x))
    total_cumsum = df['daily_return_diff'].abs().rolling(window=10).sum()
    pos_cumsum = df['pos_daily_return_diff'].rolling(window=10).sum()
    heuristics_matrix = (pos_cumsum / total_cumsum).dropna()
    return heuristics_matrix
