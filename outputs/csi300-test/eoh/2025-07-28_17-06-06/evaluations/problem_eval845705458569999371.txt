def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['pos_returns'] = df['daily_return'].apply(lambda x: x if x > 0 else 0)
    df['neg_returns'] = df['daily_return'].apply(lambda x: x if x < 0 else 0)
    df['cum_pos_returns'] = df['pos_returns'].rolling(window=30).sum()
    df['cum_neg_returns'] = df['neg_returns'].rolling(window=30).sum()
    df['momentum_factor'] = df['cum_pos_returns'] - df['cum_neg_returns']
    heuristics_matrix = df['momentum_factor'].dropna()
    return heuristics_matrix
