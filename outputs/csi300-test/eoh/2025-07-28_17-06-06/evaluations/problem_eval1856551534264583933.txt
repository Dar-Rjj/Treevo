import pandas as pd

def heuristics_v2(df):
    def roc_series(price, periods=14):
        return (price / price.shift(periods) - 1) * 100

    def obv_series(df):
        obv = (df['volume'] * ((df['close'] > df['close'].shift(1)).astype(int) - (df['close'] < df['close'].shift(1)).astype(int))).cumsum()
        return obv

    roc = roc_series(df['close'])
    obv = obv_series(df)

    heuristics_matrix = 0.5 * roc + 0.5 * (obv - obv.shift(20))
    return heuristics_matrix
