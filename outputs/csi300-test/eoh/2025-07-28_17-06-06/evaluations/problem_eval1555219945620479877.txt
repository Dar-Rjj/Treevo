import pandas as pd

def heuristics_v2(df):
    # Calculate the weighted moving average of close prices using volume as weights
    wma_close = (df['close'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    # Calculate the simple moving average of the high and low prices
    sma_high_low = (df['high'] + df['low']) / 2
    sma_high_low = sma_high_low.rolling(window=20).mean()
    # Generate the heuristic factor
    heuristics_matrix = wma_close - sma_high_low
    return heuristics_matrix
