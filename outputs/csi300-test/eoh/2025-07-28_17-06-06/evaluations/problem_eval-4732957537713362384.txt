def heuristics_v2(df):
    df['close_change'] = df['close'].diff()
    df['positive_changes'] = df['close_change'].apply(lambda x: x if x > 0 else 0)
    df['negative_changes'] = df['close_change'].apply(lambda x: abs(x) if x < 0 else 0)
    sum_positive = df['positive_changes'].rolling(window=5).sum()
    sum_negative = df['negative_changes'].rolling(window=5).sum()
    heuristics_matrix = (sum_positive / sum_negative).dropna()
    return heuristics_matrix
