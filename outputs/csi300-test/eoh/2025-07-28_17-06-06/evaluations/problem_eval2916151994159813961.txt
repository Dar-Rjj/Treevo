def heuristics_v2(df):
    # Calculate the 30-day rolling standard deviation of the close price
    df['close_std'] = df['close'].rolling(window=30).std().fillna(0)
    
    # Calculate the 30-day momentum (difference between the current close and the close 30 days ago)
    df['momentum_30'] = df['close'] - df['close'].shift(30).fillna(0)
    
    # Calculate the 30-day average volume
    df['avg_volume'] = df['volume'].rolling(window=30).mean().fillna(0)
    
    # Calculate the volume ratio (current volume divided by the 30-day average volume)
    df['volume_ratio'] = df['volume'] / df['avg_volume']
    
    # Create the heuristics matrix
    heuristics_matrix = (df['momentum_30'] / df['close_std']) * df['volume_ratio']
    
    return heuristics_matrix
