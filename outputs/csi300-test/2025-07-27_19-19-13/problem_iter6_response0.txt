```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    
    # Calculate Raw Price Momentum
    df['close_to_close_return'] = df['close'].pct_change()
    df['log_return'] = np.log(1 + df['close_to_close_return'])
    
    # Calculate Intraday Volatility
    df['intraday_volatility_1'] = (df['high'] - df['low']) / df['low']
    df['intraday_volatility_2'] = (df['high'] - df['close'].shift(1)) / df['close'].shift(1)
    df['intraday_volatility'] = (df['intraday_volatility_1'] + df['intraday_volatility_2']) / 2
    
    # Determine Volume Change and Calculate Volume Ratio
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    
    # Determine Amount Change and Calculate Amount Ratio
    df['amount_ratio'] = df['amount'] / df['amount'].shift(1)
    
    # Combine Factors
    # Use a weighted combination of the factors
    df['factor'] = (0.4 * df['intraday_return'] 
                    + 0.3 * df['log_return'] 
                    + 0.2 * df['intraday_volatility'] 
                    + 0.05 * (df['volume_ratio'] - 1) 
                    + 0.05 * (df['amount_ratio'] - 1))
    
    return df['factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor = heuristics_v2(df)
# print(factor)
```
