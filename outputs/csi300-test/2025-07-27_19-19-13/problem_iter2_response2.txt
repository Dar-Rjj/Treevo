```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Return using High and Low prices
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    
    # Calculate Raw Price Momentum using Close-to-Close return, then apply logarithmic transformation
    df['raw_momentum'] = np.log(df['close'] / df['close'].shift(1))
    
    # Calculate Intraday Volatility
    df['price_diff_high_low'] = df['high'] - df['low']
    df['price_diff_high_prev_close'] = df['high'] - df['close'].shift(1)
    df['intraday_volatility'] = (df['price_diff_high_low'] + df['price_diff_high_prev_close']) / 2
    
    # Determine Volume Change and calculate Volume Ratio
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    
    # Combine Factors: Use a weighted sum of intraday_return, intraday_volatility, raw_momentum, and volume_ratio
    df['alpha_factor'] = (0.3 * df['intraday_return'] 
                          + 0.2 * df['intraday_volatility'] 
                          + 0.4 * df['raw_momentum'] 
                          + 0.1 * df['volume_ratio'])
    
    # Drop intermediate columns if not needed
    df.drop(columns=['intraday_return', 'raw_momentum', 'price_diff_high_low', 'price_diff_high_prev_close', 'intraday_volatility', 'volume_ratio'], inplace=True)
    
    return df['alpha_factor']
```
