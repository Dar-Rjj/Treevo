import pandas as pd
import numpy as np

def heuristics_v2(df):
    log_returns = np.log(df['close'] / df['close'].shift(1)).fillna(0)
    cum_log_returns = log_returns.cumsum()
    vol_weighted = df['volume'] * (df['close'] / df['open'])
    heuristics_matrix = cum_log_returns * vol_weighted
    return heuristics_matrix
