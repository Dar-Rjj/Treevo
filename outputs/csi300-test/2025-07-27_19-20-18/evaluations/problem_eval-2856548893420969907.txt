def heuristics_v2(df):
    def calculate_roc(series, window=14):
        return series.pct_change(window)

    def calculate_volume_spike(volume, ma_volume):
        return (volume > 1.5 * ma_volume).astype(int)

    close = df['close']
    volume = df['volume']

    roc = calculate_roc(close, window=14)
    ma_volume = calculate_moving_average(volume, window=30)
    volume_spike = calculate_volume_spike(volume, ma_volume)

    heuristics_matrix = roc * volume_spike

    return heuristics_matrix
