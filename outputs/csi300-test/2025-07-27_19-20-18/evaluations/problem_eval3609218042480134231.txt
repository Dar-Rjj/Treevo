def heuristics_v2(df):
    def simple_moving_average(series, window):
        return series.rolling(window=window).mean()

    def bollinger_bands(series, window, nstd):
        sma = simple_moving_average(series, window)
        rstd = series.rolling(window=window).std()
        upper_band = sma + (rstd * nstd)
        lower_band = sma - (rstd * nstd)
        return (series - lower_band) / (upper_band - lower_band)

    close = df['close']
    sma_10 = simple_moving_average(close, 10)
    sma_30 = simple_moving_average(close, 30)
    bb_score = bollinger_bands(close, 20, 2)
    momentum = close.pct_change(20)
    heuristics_matrix = (sma_10 - sma_30) + bb_score + momentum
    return heuristics_matrix
