import pandas as pd

def heuristics_v2(df):
    def calculate_ema(series, span=50):
        return series.ewm(span=span, adjust=False).mean()

    def calculate_percentage_change(series):
        return series.pct_change(1)

    close = df['close']
    volume = df['volume']

    ema_close = calculate_ema(close, span=50)
    diff_close_ema = close - ema_close
    volume_pct_change = calculate_percentage_change(volume)

    heuristics_matrix = diff_close_ema * volume_pct_change

    return heuristics_matrix
