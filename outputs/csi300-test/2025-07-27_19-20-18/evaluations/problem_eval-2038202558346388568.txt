import pandas as pd

def heuristics_v2(df):
    ema_close = df['close'].ewm(span=5, adjust=False).mean()
    avg_volume = df['volume'].rolling(window=5).mean()
    log_volume_diff = (df['volume'] - avg_volume).apply(lambda x: 0 if x == 0 else math.log(abs(x)))
    heuristics_matrix = ema_close + log_volume_diff
    return heuristics_matrix
