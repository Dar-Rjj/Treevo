import pandas as pd

def heuristics_v2(df):
    def calculate_ema(series, span=14):
        return series.ewm(span=span, adjust=False).mean()

    def calculate_roc(series, period=10):
        return (series / series.shift(period) - 1) * 100

    def calculate_atr(df, window=14):
        high = df['high']
        low = df['low']
        close = df['close']
        tr = pd.concat([high - low, abs(high - close.shift()), abs(low - close.shift())], axis=1).max(axis=1)
        atr = tr.rolling(window=window).mean()
        return atr

    close = df['close']
    volume = df['volume']

    ema_short = calculate_ema(close, span=5)
    ema_long = calculate_ema(close, span=30)
    roc = calculate_roc(close, period=10)
    atr = calculate_atr(df, window=20)

    heuristics_matrix = (ema_short - ema_long) * roc / atr * (volume / volume.shift(1))

    return heuristics_matrix
