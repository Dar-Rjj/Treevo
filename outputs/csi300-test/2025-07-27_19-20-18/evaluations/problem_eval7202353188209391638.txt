import pandas as pd

def heuristics_v2(df):
    ema_close = df['close'].ewm(span=3, adjust=False).mean()
    avg_low = df['low'].rolling(window=10).mean()
    volume_ratio = df['volume'] / avg_low
    adjusted_volume_ratio = volume_ratio.apply(lambda x: x if x > 0 else 1).apply(lambda x: np.log(x))
    heuristics_matrix = ema_close * adjusted_volume_ratio
    return heuristics_matrix
