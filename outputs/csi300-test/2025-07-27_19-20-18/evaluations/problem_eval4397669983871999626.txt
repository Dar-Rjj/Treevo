def heuristics_v2(df):
    def macd_series(price_series, fast=12, slow=26, signal=9):
        exp1 = price_series.ewm(span=fast, adjust=False).mean()
        exp2 = price_series.ewm(span=slow, adjust=False).mean()
        macd = exp1 - exp2
        signal_line = macd.ewm(span=signal, adjust=False).mean()
        return macd - signal_line  # MACD histogram

    df['macd_hist'] = df['close'].rolling(window=26).apply(macd_series, raw=False)
    df['momentum'] = df['close'].pct_change(periods=12)  # 12-day momentum
    heuristics_matrix = 0.7 * df['macd_hist'] + 0.3 * df['momentum']
    
    return heuristics_matrix
