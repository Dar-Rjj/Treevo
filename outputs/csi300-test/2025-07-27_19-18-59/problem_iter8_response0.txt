```python
import pandas as pd

def heuristics_v2(df, N=20, M=10):
    # Calculate Volume-Weighted Momentum
    close_ema = df['close'].ewm(span=N, adjust=False).mean()
    momentum = df['close'] - close_ema
    cumulative_volume = df['volume'].rolling(window=N).sum()
    volume_weighted_momentum = momentum * cumulative_volume
    
    # Calculate Intraday True Range and Adjust by Volume
    intraday_range = df['high'] - df['low']
    intraday_return = (df['close'] - df['open']) / df['open']
    intraday_momentum = intraday_range * intraday_return
    
    volume_trend_ratio = df['volume'] / df['volume'].shift(1)
    accumulated_volume = df['volume'].rolling(window=5).sum()
    volume_adjusted_intraday_momentum = intraday_momentum * volume_trend_ratio * accumulated_volume
    
    true_range = pd.concat([df['high'] - df['low'], 
                            (df['high'] - df['close'].shift(1)).abs(), 
                            (df['low'] - df['close'].shift(1)).abs()], axis=1).max(axis=1)
    average_true_range = true_range.rolling(window=N).mean()
    average_volume = df['volume'].rolling(window=N).mean()
    volume_adjusted_true_range = average_true_range * (df['volume'] / average_volume)
    
    # Measure High-Low Range Volatility
    daily_range = df['high'] - df['low']
    rolling_variance = daily_range.rolling(window=M).var()
    high_low_range_volatility = 1 / (rolling_variance + 1e-8)  # Add a small constant to avoid division by zero
    
    # Combine All Components
    weights = [0.4, 0.3, 0.3]  # Define weights for each component
    combined_factor = (weights[0] * volume_weighted_momentum + 
                       weights[1] * volume_adjusted_intraday_momentum + 
                       weights[2] * volume_adjusted_true_range * high_low_range_volatility)
    
    return combined_factor
```
