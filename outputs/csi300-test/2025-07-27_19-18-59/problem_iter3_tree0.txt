```txt
Volume and Price Momentum Factor with Enhanced Weighting
├── Calculate Price Momentum
│   ├── Compute 5-day Return
│   │   ├── Use Close price
│   │   └── (Close[t] / Close[t-5]) - 1
│   ├── Compute 20-day Return
│   │   ├── Use Close price
│   │   └── (Close[t] / Close[t-20]) - 1
│   ├── Combine 5-day and 20-day Returns
│   │   └── (5-day Return + 20-day Return) / 2
├── Calculate Volume Momentum
│   ├── Compute 5-day Volume Trend
│   │   ├── Use Volume
│   │   └── (Volume[t] - Volume[t-5])
│   ├── Compute 20-day Volume Trend
│   │   ├── Use Volume
│   │   └── (Volume[t] - Volume[t-20])
│   ├── Combine 5-day and 20-day Volume Trends
│   │   └── (5-day Volume Trend + 20-day Volume Trend) / 2
└── Adaptive Weighted Average of Price and Volume Momentum
    ├── Calculate Price Volatility
    │   ├── Compute 5-day Price Volatility
    │   │   ├── Use Close price
    │   │   └── Standard Deviation of Close prices over last 5 days
    │   ├── Compute 20-day Price Volatility
    │   │   ├── Use Close price
    │   │   └── Standard Deviation of Close prices over last 20 days
    │   ├── Combine 5-day and 20-day Price Volatilities
    │   │   └── (5-day Price Volatility + 20-day Price Volatility) / 2
    ├── Calculate Volume Volatility
    │   ├── Compute 5-day Volume Volatility
    │   │   ├── Use Volume
    │   │   └── Standard Deviation of Volumes over last 5 days
    │   ├── Compute 20-day Volume Volatility
    │   │   ├── Use Volume
    │   │   └── Standard Deviation of Volumes over last 20 days
    │   ├── Combine 5-day and 20-day Volume Volatilities
    │   │   └── (5-day Volume Volatility + 20-day Volume Volatility) / 2
    ├── Determine Weights
    │   ├── Price Weight
    │   │   └── 1 / (1 + (Price Volatility / (Price Volatility + Volume Volatility)))
    │   ├── Volume Weight
    │   │   └── 1 / (1 + (Volume Volatility / (Price Volatility + Volume Volatility)))
    └── Multiply and Sum
        ├── (Price Momentum * Price Weight) + (Volume Momentum * Volume Weight)
```
