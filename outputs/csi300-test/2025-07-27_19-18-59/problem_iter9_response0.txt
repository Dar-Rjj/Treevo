```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=10, M=10, momentum_weight=0.5, volatility_weight=0.3, gap_weight=0.2):
    # Calculate Volume-Adjusted Momentum
    df['daily_return'] = df['close'].pct_change()
    df['adjusted_volume'] = df['volume'] * (df['daily_return'] + 1)
    df['cumulative_adjusted_volume'] = df['adjusted_volume'].rolling(window=N).sum()
    df['ema_close'] = df['close'].ewm(span=N, adjust=False).mean()
    df['momentum'] = (df['close'] - df['ema_close']) * df['cumulative_adjusted_volume']
    
    # Measure High-Low Range Volatility
    df['daily_range'] = df['high'] - df['low']
    df['range_volatility'] = df['daily_range'].rolling(window=M).var()
    df['stability_factor'] = 1 / (1 + df['range_volatility'])
    
    # Incorporate Open-Close Gap
    df['open_close_gap'] = df['open'] - df['close']
    df['gap_abs'] = df['open_close_gap'].abs()
    
    # Combine Volume-Adjusted Momentum, Range Volatility, and Open-Close Gap
    df['factor_value'] = (
        momentum_weight * df['momentum'] +
        volatility_weight * df['stability_factor'] +
        gap_weight * df['gap_abs']
    )
    
    return df['factor_value']

# Example usage:
# df = pd.DataFrame({
#     'date': pd.date_range(start='1/1/2020', periods=100),
#     'open': np.random.rand(100) * 100,
#     'high': np.random.rand(100) * 100,
#     'low': np.random.rand(100) * 100,
#     'close': np.random.rand(100) * 100,
#     'amount': np.random.rand(100) * 1000000,
#     'volume': np.random.randint(10000, 100000, size=100)
# })
# df.set_index('date', inplace=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
