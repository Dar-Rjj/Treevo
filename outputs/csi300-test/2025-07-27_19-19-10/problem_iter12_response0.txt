```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute Short-Term Weighted Moving Average of Close Prices (5 days, exponential weights)
    short_term_wma = df['close'].ewm(span=5, adjust=False).mean()
    
    # Compute Long-Term Weighted Moving Average of Close Prices (20 days, exponential weights)
    long_term_wma = df['close'].ewm(span=20, adjust=False).mean()
    
    # Calculate the Difference between Short-Term WMA and Long-Term WMA
    adjusted_price_momentum = short_term_wma - long_term_wma
    
    # Compute Percentage Change in Volume (14 days)
    vroc = df['volume'].pct_change(periods=14)
    
    # Calculate the Exponential Moving Average (EMA) of VROC
    ema_vroc = vroc.ewm(alpha=0.1, adjust=False).mean()
    
    # Combine Adjusted Price Momentum and VROC Indicators
    combined_indicator = adjusted_price_momentum * ema_vroc
    
    # Assign Dynamic Weights Based on Volatility (10-day standard deviation)
    volatility = df['close'].rolling(window=10).std()
    dynamic_weight = 1 / (volatility + 1e-6)  # Add a small constant to avoid division by zero
    weighted_combined_indicator = combined_indicator * dynamic_weight
    
    # Apply a Dynamic Threshold to Select Significant Values
    market_return = df['close'].pct_change().mean()
    threshold = 0.5 * market_return  # Example: Threshold as a function of market return
    significant_values = weighted_combined_indicator[weighted_combined_indicator > threshold]
    
    # Rank the Selected Values
    ranked_values = significant_values.rank(ascending=False)
    
    # Introduce a Secondary Ranking Metric
    daily_returns = np.log(df['close'] / df['close'].shift(1))
    market_daily_returns = np.log(df['sp500_close'] / df['sp500_close'].shift(1))  # Assuming 'sp500_close' is in the DataFrame
    correlation = daily_returns.rolling(window=30).corr(market_daily_returns)
    secondary_ranked_values = ranked_values * correlation
    
    return secondary_ranked_values
```
