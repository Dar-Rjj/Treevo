```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute Daily VWAP
    df['daily_vwap'] = (df[['high', 'low', 'close', 'open']].mean(axis=1) * df['volume']).cumsum() / df['volume'].cumsum()

    # Apply Exponential Moving Average (EMA) over the last 3 days to get Refined VWAP
    df['refined_vwap'] = df['daily_vwap'].ewm(span=3, adjust=False).mean()

    # Calculate Intraday High-Low Spread
    df['intraday_spread'] = df['high'] - df['low']

    # Calculate Previous Day's Close-to-Open Return
    df['prev_close_to_open'] = df['open'] - df['close'].shift(1)

    # Compute Volume Trend
    df['volume_trend'] = df['volume'] - df['volume'].shift(1)

    # Compute Price Change Momentum
    df['price_change_momentum'] = df['close'] - df['close'].shift(1)
    df['price_change_momentum_ema'] = df['price_change_momentum'].ewm(span=3, adjust=False).mean()

    # Combine Intraday Momentum, VWAP, and Sentiment
    df['combined_value'] = (df['refined_vwap'] - df['intraday_spread']) * df['volume_trend']

    # Weight by Intraday Volume
    df['weighted_value'] = df['combined_value'] * df['volume']

    # Final Factor Smoothing: Apply EMA over the last 3 days
    df['final_factor'] = df['weighted_value'].ewm(span=3, adjust=False).mean()

    return df['final_factor']
```
