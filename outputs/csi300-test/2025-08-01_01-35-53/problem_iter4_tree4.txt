```txt
Volume-Weighted Intraday Momentum Alpha with Volume Trend Integration and Smoothing
├── Calculate Intraday Momentum
│   ├── Compute Intraday High-Low Spread
│   │   ├── Use High price (t)
│   │   └── Use Low price (t) (High - Low)
│   └── Compute Previous Day's Close-to-Open Return
│       ├── Use Previous Day's Close price (t-1)
│       └── Use Today's Open price (t) (Open - Close[-1])
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Compute Daily VWAP
│   │   ├── Use High price (t)
│   │   ├── Use Low price (t)
│   │   ├── Use Close price (t)
│   │   └── Use Volume (t) (Sum of (Price * Volume) / Total Volume)
│   └── Apply VWAP as a Measure of Market Sentiment
├── Calculate Intraday Volume Trend
│   ├── Compute 5-Day Moving Average Volume
│   │   ├── Sum of Volume for the last 5 days (t, t-1, t-2, t-3, t-4)
│   │   └── Divide by 5
│   └── Compute 20-Day Moving Average Volume
│       ├── Sum of Volume for the last 20 days (t, t-1, ..., t-19)
│       └── Divide by 20
├── Compute Volume Ratio
│   ├── Use 5-Day Moving Average Volume
│   └── Use 20-Day Moving Average Volume (5-day MA / 20-day MA)
├── Combine Intraday Momentum, VWAP, and Volume Ratio
│   ├── Subtract Intraday High-Low Spread from VWAP
│   │   ├── VWAP - (High - Low)
│   └── Multiply by Volume Ratio
└── Smooth the Factor
    ├── Apply Exponential Moving Average (EMA)
    │   ├── Over the Last 5 Days
    └── Output the Resulting Factor
```
