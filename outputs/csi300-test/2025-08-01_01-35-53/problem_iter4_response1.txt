```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Volume Weighted Average Price (VWAP)
    df['VWAP'] = (df['high'] * df['volume'] + df['low'] * df['volume'] + df['close'] * df['volume']) / (3 * df['volume'])

    # Calculate Intraday High-Low Spread
    df['Intraday_HL_Spread'] = df['high'] - df['low']

    # Compute Previous Day's Close-to-Open Return
    df['Prev_Day_Close'] = df['close'].shift(1)
    df['Close_to_Open_Return'] = df['open'] - df['Prev_Day_Close']

    # Combine Intraday Momentum and VWAP
    df['Intraday_VWAP_Mom'] = df['VWAP'] - df['Intraday_HL_Spread']
    df['Intraday_VWAP_Mom_Vol_Weighted'] = df['Intraday_VWAP_Mom'] * df['volume']

    # Smooth the Factor using Exponential Moving Average (EMA) over the last 5 days
    df['Factor'] = df['Intraday_VWAP_Mom_Vol_Weighted'].ewm(span=5, adjust=False).mean()

    # Output the resulting factor
    return df['Factor']
```
