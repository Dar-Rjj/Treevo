```txt
Volume-Weighted Intraday Momentum Alpha with Volatility and Market Cap Integration
├── Calculate Intraday Momentum
│   ├── Compute Intraday High-Low Spread
│   │   ├── Use High price
│   │   └── Use Low price (High - Low)
│   └── Compute Previous Day's Close-to-Open Return
│       ├── Use Previous Day's Close price
│       └── Use Today's Open price (Open - Close[-1])
├── Calculate Volume Weighted Average Price (VWAP)
│   ├── Compute Daily VWAP
│   │   ├── Sum of (Price * Volume) / Total Volume
│   │   │   ├── Use High price
│   │   │   ├── Use Low price
│   │   │   ├── Use Close price
│   │   │   └── Use Volume
├── Combine Intraday Momentum and VWAP
│   ├── Subtract Intraday High-Low Spread from VWAP
│   └── Weight by Intraday Volume
│       ├── Use Today's Volume
│       └── Multiply Combined Value by Volume
├── Integrate Volatility
│   ├── Calculate Daily Volatility
│   │   ├── Use 30-Day Historical Volatility
│   │   │   ├── Use High, Low, and Close prices over the last 30 days
├── Incorporate Market Cap
│   ├── Use Market Capitalization
│   │   ├── Get Market Cap Data
│   │   └── Normalize Factor by Market Cap
└── Smooth the Factor
    ├── Apply Exponential Moving Average (EMA)
    │   ├── Over the Last 20 Days
```
