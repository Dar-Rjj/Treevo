```txt
Volume-Weighted Intraday Momentum with Liquidity and Dynamic Weighting
├── Calculate Intraday Momentum
│   ├── Compute Intraday High-Low Spread
│   │   ├── Use High price
│   │   └── Use Low price (High - Low)
│   └── Compute Previous Day's Close-to-Open Return
│       ├── Use Previous Day's Close price
│       └── Use Today's Open price (Open - Close[-1])
├── Calculate Volume Weighted Average Price (VWAP)
│   ├── Compute Daily VWAP
│   │   ├── Use High price
│   │   ├── Use Low price
│   │   ├── Use Close price
│   │   └── Use Volume (Sum of (Price * Volume) / Total Volume)
│   └── Apply VWAP as a Measure of Market Sentiment
├── Integrate Liquidity
│   ├── Calculate Dollar Volume
│   │   ├── Use Close price
│   │   └── Use Volume (Close * Volume)
│   └── Smooth Dollar Volume
│       ├── Apply Exponential Moving Average (EMA)
│       │   ├── Over the Last 20 Days
└── Combine Intraday Momentum, VWAP, and Liquidity
    ├── Subtract Intraday High-Low Spread from VWAP
    ├── Weight by Intraday Volume
    │   ├── Use Today's Volume
    │   └── Multiply Combined Value by Volume
    ├── Adjust for Liquidity
    │   ├── Use Smoothed Dollar Volume
    │   └── Multiply Combined Value by Smoothed Dollar Volume
└── Smooth the Factor
    ├── Apply Exponential Moving Average (EMA)
    │   ├── Over the Last 5 Days
    └── Output the Resulting Factor
```
