import pandas as pd

def heuristics_v2(df):
    med_price_change_10d = (df['close'] - df['open']).rolling(window=10).median()
    avg_vol_5d = df['volume'].rolling(window=5).mean()
    max_vol = df['volume'].max()
    vol_ratio = avg_vol_5d / max_vol
    heuristics_matrix = med_price_change_10d * vol_ratio
    return heuristics_matrix
