import pandas as pd
from scipy.stats import zscore

def heuristics_v2(df):
    range_15d = (df['high'] - df['low']).rolling(window=15).mean()
    vol_7d_sum = df['volume'].rolling(window=7).sum()
    z_range = zscore(range_15d.fillna(0))
    z_vol = zscore(vol_7d_sum.fillna(0))
    combined_factor = (z_range * range_15d + z_vol * vol_7d_sum) / (z_range + z_vol)
    heuristics_matrix = combined_factor
    return heuristics_matrix
