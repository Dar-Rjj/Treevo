import pandas as pd

def heuristics_v2(df):
    daily_return = df['close'].pct_change()
    ema_20d_return = daily_return.ewm(span=20, adjust=False).mean()
    ma_30d_amount = df['amount'].rolling(window=30).mean()
    rel_diff_amount = (df['amount'] - ma_30d_amount) / ma_30d_amount
    heuristics_matrix = (ema_20d_return + rel_diff_amount) / 2
    return heuristics_matrix
