def heuristics_v2(df):
    # Define the window size for the moving average
    window = 20
    
    # Calculate the moving average of the closing price
    ma_close = df['close'].rolling(window=window).mean()
    
    # Calculate the difference between the closing price and its moving average
    diff_close_ma = df['close'] - ma_close
    
    # Calculate the mean volume over the same window
    avg_volume = df['volume'].rolling(window=window).mean()
    
    # Calculate the ratio of today's volume to the average volume
    volume_ratio = df['volume'] / avg_volume
    
    # Combine the two factors into a single heuristics matrix
    heuristics_matrix = diff_close_ma * volume_ratio
    
    return heuristics_matrix
