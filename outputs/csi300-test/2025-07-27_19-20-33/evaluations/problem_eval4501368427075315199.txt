def heuristics_v2(df):
    std_returns_30d = df['close'].pct_change().rolling(window=30).std()
    avg_vol_5d = df['volume'].rolling(window=5).mean()
    total_med_vol = df['volume'].median()
    rel_diff_vol = (avg_vol_5d - total_med_vol) / total_med_vol
    heuristics_matrix = (std_returns_30d + rel_diff_vol) / 2
    return heuristics_matrix
