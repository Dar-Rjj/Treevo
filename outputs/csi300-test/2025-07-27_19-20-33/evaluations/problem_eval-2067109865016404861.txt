import pandas as pd

def heuristics_v2(df):
    close_to_avg_close = df['close'] / df['close'].rolling(window=30).mean()
    log_diff_vol = (df['volume'] - df['volume'].rolling(window=60).mean()).apply(lambda x: max(0, x)).apply(lambda x: pd.np.log1p(x) if x > 0 else 0)
    heuristics_matrix = (close_to_avg_close + log_diff_vol) / 2
    return heuristics_matrix
