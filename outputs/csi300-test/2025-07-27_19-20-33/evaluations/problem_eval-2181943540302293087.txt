import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute rolling means and standard deviations for each feature
    window = 10
    roll_mean = df.rolling(window=window).mean()
    roll_std = df.rolling(window=window).std()

    # Combine them using a non-linear transformation
    composite = (roll_mean / (1 + roll_std)).apply(np.tanh)
    
    # Sum across columns to get a single time series
    heuristics_matrix = composite.sum(axis=1)

    return heuristics_matrix
