import pandas as pd
import numpy as np

def heuristics_v2(df):
    ema_30d = df['close'].ewm(span=30, adjust=False).mean()
    max_vol_14d = df['volume'].rolling(window=14).max()
    min_vol_14d = df['volume'].rolling(window=14).min()
    log_diff_vol = np.log(max_vol_14d) - np.log(min_vol_14d)
    heuristics_matrix = (ema_30d + log_diff_vol) / 2
    return heuristics_matrix
