```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the price range and the average price
    df['price_range'] = df['high'] - df['low']
    df['avg_price'] = (df['open'] + df['close'] + df['high'] + df['low']) / 4
    
    # Calculate the volume weighted average price (VWAP)
    df['vwap'] = (df['amount'] / df['volume'])
    
    # Calculate the ratio of today's VWAP to the average price
    df['vwap_to_avg_ratio'] = df['vwap'] / df['avg_price']
    
    # Calculate a simple moving average of the VWAP to AVG Price Ratio
    df['sma_vwap_to_avg_ratio'] = df['vwap_to_avg_ratio'].rolling(window=10).mean()
    
    # Calculate the factor: normalized vwap to avg ratio minus its SMA
    df['factor'] = (df['vwap_to_avg_ratio'] - df['sma_vwap_to_avg_ratio']) / df['price_range']
    
    return df['factor']
```
