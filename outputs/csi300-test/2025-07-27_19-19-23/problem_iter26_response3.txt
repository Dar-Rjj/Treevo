```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Parameters
    volume_spike_threshold = 1.5
    momentum_weight = 1.5
    ema_span = 20
    lookback_period = 10
    vroc_period = 30
    proc_period = 30
    price_zscore_threshold = 2.0
    volume_zscore_threshold = 2.0
    ewm_span_short = 5
    ewm_span_long = 10

    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))

    # Identify Volume Spikes
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    df['relative_volume'] = df['volume'] / df['avg_volume_20']
    df['volume_spike'] = (df['relative_volume'] > volume_spike_threshold).astype(int)

    # Adjust Momentum for Volume Spikes
    df['adjusted_log_return'] = df['log_return'] * (1 + (df['volume_spike'] * (momentum_weight - 1)))

    # Smooth the Adjusted Returns
    df['smoothed_returns'] = df['adjusted_log_return'].ewm(span=ema_span, min_periods=ema_span).mean()

    # Cumulative Momentum Factor
    df['cumulative_momentum'] = (df['smoothed_returns'] + 1).cumprod()

    # Calculate High-Low Difference
    df['high_low_diff'] = df['high'] - df['low']

    # Combine High-Low Difference and Volume Spikes
    df['high_low_diff_spike'] = df['high_low_diff'] * df['volume_spike']
    df['sum_high_low_diff_spike'] = df['high_low_diff_spike'].rolling(window=lookback_period).sum()

    # Calculate Volume Trend (VROC)
    df['vroc'] = df['volume'].pct_change(periods=vroc_period)

    # Combined Factor
    combined_factor = df['cumulative_momentum'] * df['sum_high_low_diff_spike'] * df['vroc']

    # Calculate Price-Volume Divergence
    df['proc'] = df['close'].pct_change(periods=proc_period)
    df['price_volume_divergence'] = df['proc'] - df['vroc']

    # Final Combined Alpha Factor
    final_combined_factor = combined_factor * df['price_volume_divergence']

    # Identify Volume and Price Spikes
    df['z_score_volume'] = (df['volume'] - df['volume'].rolling(window=20).mean()) / df['volume'].rolling(window=20).std()
    df['z_score_price'] = (df['high'] - df['low']) / ((df['high'] + df['low']).rolling(window=20).std())
    df['price_spike'] = (np.abs(df['z_score_price']) > price_zscore_threshold).astype(int)
    df['volume_spike'] = (np.abs(df['z_score_volume']) > volume_zscore_threshold).astype(int)

    # Adjust Momentum for Volume and Price Spikes
    df['total_spike'] = (df['price_spike'] | df['volume_spike']).astype(int)
    df['adjusted_log_return_final'] = df['log_return'] * (1 + (df['total_spike'] * (momentum_weight - 1)))

    # Calculate Daily Price Movement
    df['daily_price_movement'] = df['close'] - df['open']

    # Calculate Volume Adjusted Price Movement
    df['volume_adjusted_price_movement'] = df['daily_price_movement'] * df['volume']

    # Calculate Rolling Momentum Indicator
    df['rolling_30_day_sum'] = df['volume_adjusted_price_movement'].rolling(window=30).sum()
    df['ema_short'] = df['rolling_30_day_sum'].ewm(span=ewm_span_short, min_periods=ewm_span_short).mean()
    df['ema_long'] = df['rolling_30_day_sum'].ewm(span=ewm_span_long, min_periods=ewm_span_long).mean()
    df['rolling_momentum'] = df['ema_short'] - df['ema_long']

    # Combine High-Low and Price Momentum
    df['final_momentum'] = df['cumulative_momentum'] * df['sum_high_low_diff_spike'] * df['rolling_momentum']

    # Combined Factor
    final_combined_alpha_factor = final_combined_factor * df['final_momentum']

    return final_combined_alpha_factor
```
