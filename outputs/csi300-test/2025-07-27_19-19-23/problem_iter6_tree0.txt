```txt
Price Momentum and Volume Trend Adjusted by Spikes and Close Price Volatility
├── Calculate Price Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   └── Compute Average High-Low Difference
│       ├── Sum High-Low Differences over last n days
│       └── Divide by n
├── Calculate Volume Trend
│   ├── Compute Volume Rate of Change (VROC)
│   │   ├── Use Volume
│   │   └── Compute VROC for period m
│   └── Multiply Price Momentum by VROC
│       ├── Use calculated Price Momentum
│       └── Use computed VROC
├── Identify Volume Spikes
│   ├── Calculate Z-Score of Volume
│   │   ├── Use Volume
│   │   └── Calculate Rolling Standard Deviation
│   └── Classify as Spike if Z-Score exceeds a threshold
├── Adjust Combined Momentum for Volume Spikes
│   ├── Multiply Combined Momentum with Spike Indicator
│   │   ├── If Spike, multiply by weight
│   │   └── If not, use original combined momentum
│   └── Smooth the Adjusted Combined Momentum
│       ├── Use Exponential Moving Average
│       └── Select an appropriate span
├── Integrate Close Price Volatility
│   ├── Compute Close Price Log Returns
│   │   ├── Use Close price
│   │   └── Calculate log returns
│   └── Calculate Volatility
│       ├── Use Close price log returns
│       └── Compute Rolling Standard Deviation over p days
└── Cumulative Adjusted Momentum Factor
    ├── Adjust Smoothed Combined Momentum by Volatility
    │   ├── Multiply Smoothed Combined Momentum by Volatility
    └── Sum Up Adjusted Momentum
        ├── Initial value set to 1
        └── Add 1 to each daily return before multiplication
```
