```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=10, m=5, p=20, spike_threshold=3, smoothing_span=10, spike_weight=0.5):
    # Calculate Price Momentum
    high_low_diff = df['high'] - df['low']
    avg_high_low_diff = high_low_diff.rolling(window=n).mean()
    
    # Calculate Volume Trend (VROC)
    vroc = df['volume'].pct_change(periods=m).fillna(0)
    combined_momentum = avg_high_low_diff * vroc
    
    # Identify Volume Spikes
    volume_z_score = (df['volume'] - df['volume'].rolling(window=p).mean()) / df['volume'].rolling(window=p).std()
    volume_spike = (volume_z_score > spike_threshold).astype(int)
    
    # Adjust Combined Momentum for Volume Spikes
    adjusted_combined_momentum = combined_momentum * (1 - volume_spike * (1 - spike_weight))
    
    # Smooth the Adjusted Combined Momentum
    smoothed_combined_momentum = adjusted_combined_momentum.ewm(span=smoothing_span, adjust=False).mean()
    
    # Integrate Close Price Volatility
    close_log_returns = np.log(df['close']).diff().fillna(0)
    volatility = close_log_returns.rolling(window=p).std()
    
    # Cumulative Adjusted Momentum Factor
    adjusted_momentum_factor = (smoothed_combined_momentum * volatility + 1).cumprod().fillna(1)
    
    return adjusted_momentum_factor
```
