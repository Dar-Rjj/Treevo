```txt
Crossover of Price and Volume Momentum with Spike Indicator and Price Momentum and Volume Trend Adjusted by Spikes
├── Calculate High-Low Difference
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   └── Sum High-Low Differences over last n days
├── Calculate Volume Rate of Change (VROC)
│   ├── Use Volume
│   └── Compute VROC for period m
├── Identify Volume Spikes
│   ├── Calculate Daily Volume Percentage Change
│   │   ├── Use Volume
│   │   └── Compare to Previous Day's Volume
│   ├── Define Threshold for Spike
│   │   ├── Set a fixed percentage increase (e.g., 20%)
│   │   └── Flag days exceeding the threshold
│   └── Multiply VROC by Spike Indicator
├── Calculate Average High-Low Difference
│   ├── Sum High-Low Differences over last n days
│   └── Divide by n
├── Combine Price and Volume Factors
│   ├── Multiply Sum of High-Low Differences by VROC Spike Product
│   └── Sum over a fixed lookback period (e.g., 10 days)
│       ├── Use previous 10 days' data
│       └── Sum the multiplied values
├── Adjust Combined Momentum for Volume Spikes
│   ├── Multiply Combined Momentum with Spike Indicator
│   │   ├── If Spike, multiply by weight
│   │   └── If not, use original combined momentum
│   └── Smooth the Adjusted Combined Momentum
│       ├── Use Exponential Moving Average
│       └── Select an appropriate span
└── Cumulative Adjusted Momentum Factor
    ├── Sum Up Smoothed Adjusted Combined Momentum
    └── Add 1 to each daily return before multiplication
```
