```txt
Integrated Price Momentum and Volume Trend Adjusted for Spikes
├── Calculate Integrated Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Compute Average High-Low Difference
│   │   ├── Sum High-Low Differences over last n days
│   │   └── Divide by n
│   └── Calculate Daily Log Return
│       ├── Use Close price
│       └── Compute log of current close / previous day close
├── Calculate Volume Trend
│   ├── Compute Volume Rate of Change (VROC)
│   │   ├── Use Volume
│   │   └── Compute VROC for period m
│   └── Multiply Integrated Momentum by VROC
│       ├── Use calculated Integrated Momentum
│       └── Use computed VROC
├── Identify Volume Spikes
│   ├── Calculate Z-Score of Volume
│   │   ├── Use Volume
│   │   └── Calculate Rolling Standard Deviation
│   └── Classify as Spike if Z-Score exceeds a threshold
├── Adjust Combined Momentum for Volume Spikes
│   ├── If Spike, multiply combined momentum by weight
│   └── If not, use original combined momentum
├── Smooth the Adjusted Combined Momentum
│   ├── Use Exponential Moving Average
│   └── Select an appropriate span
└── Cumulative Adjusted Momentum Factor
    ├── Sum Up Smoothed Adjusted Combined Momentum
    └── Set initial value to 1
        └── Add 1 to each daily return before multiplication
```
