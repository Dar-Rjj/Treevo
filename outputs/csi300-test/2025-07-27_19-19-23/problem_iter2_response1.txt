```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=20, m=10, spike_threshold=3, weight=0.5, ema_span=5):
    # Calculate Price Momentum
    df['High-Low Diff'] = df['high'] - df['low']
    df['Avg High-Low Diff'] = df['High-Low Diff'].rolling(window=n).mean()
    
    # Calculate Volume Rate of Change (VROC)
    df['VROC'] = df['volume'].pct_change(periods=m)
    
    # Multiply Price Momentum by VROC
    df['Combined Momentum'] = df['Avg High-Low Diff'] * df['VROC']
    
    # Identify Volume Spikes
    df['Z-Score Vol'] = (df['volume'] - df['volume'].rolling(window=n).mean()) / df['volume'].rolling(window=n).std()
    df['Spike Indicator'] = np.where(df['Z-Score Vol'] > spike_threshold, 1, 0)
    
    # Adjust Combined Momentum for Volume Spikes
    df['Adjusted Combined Momentum'] = df['Combined Momentum'] * (weight * df['Spike Indicator'] + (1 - df['Spike Indicator']))
    
    # Smooth the Adjusted Combined Momentum using EMA
    df['Smoothed Adjusted Combined Momentum'] = df['Adjusted Combined Momentum'].ewm(span=ema_span).mean()
    
    # Cumulative Adjusted Momentum Factor
    df['Cumulative Adjusted Momentum'] = (df['Smoothed Adjusted Combined Momentum'] + 1).cumprod()
    
    # Normalize to starting value
    df['Cumulative Adjusted Momentum'] = df['Cumulative Adjusted Momentum'] / df['Cumulative Adjusted Momentum'].iloc[0]
    
    return df['Cumulative Adjusted Momentum']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# factor_values = heuristics_v2(df)
```
