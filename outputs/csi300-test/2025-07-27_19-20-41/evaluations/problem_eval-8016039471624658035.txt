def heuristics_v2(df):
    def compute_momentum(data, window=10):
        return data.diff(window).fillna(0)
    
    def compute_avg_daily_range(data, window=20):
        return (data['high'] - data['low']).rolling(window=window).mean().fillna(0)
    
    close_momentum = compute_momentum(df['close'])
    volume_change = df['volume'].pct_change().fillna(0)
    avg_daily_range = compute_avg_daily_range(df)

    heuristics_matrix = (close_momentum * volume_change) / (avg_daily_range + 1e-6)
    return heuristics_matrix
