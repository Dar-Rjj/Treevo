def heuristics_v3(df):
    # Calculate the 30-day rolling return
    rolling_return = (df['close'] / df['close'].shift(30)) - 1
    
    # Calculate the average volume over the same period
    avg_volume = df['volume'].rolling(window=30).mean()
    
    # Adjust the rolling return by the closing price to average volume ratio
    heuristics_matrix = rolling_return / (df['close'] / avg_volume)
    
    return heuristics_matrix
