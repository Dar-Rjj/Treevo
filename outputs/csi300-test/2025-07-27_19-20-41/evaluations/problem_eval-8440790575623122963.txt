def heuristics_v2(df):
    sum_10_days_close = df['close'].rolling(window=10).sum().fillna(0)
    sum_30_days_close = df['close'].rolling(window=30).sum().fillna(0)
    log_volume = np.log(df['volume']).fillna(0)
    
    heuristics_matrix = (sum_10_days_close / (sum_30_days_close + 1e-6)) - log_volume
    return heuristics_matrix
