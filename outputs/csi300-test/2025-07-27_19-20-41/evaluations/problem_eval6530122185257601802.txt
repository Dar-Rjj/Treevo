import pandas as pd
import numpy as np

def heuristics_v2(df):
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    log_cumsum = df['log_return'].rolling(window=10).sum()
    ema = df['close'].ewm(span=20, adjust=False).mean()
    heuristics_matrix = log_cumsum * ema
    return heuristics_matrix
