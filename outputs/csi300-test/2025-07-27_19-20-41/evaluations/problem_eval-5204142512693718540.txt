import pandas as pd
import numpy as np

def heuristics_v2(df):
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    ema_log_return = df['log_return'].ewm(span=5, adjust=False).mean()
    lowest_14 = df['low'].rolling(window=14).min()
    highest_14 = df['high'].rolling(window=14).max()
    stochastic_oscillator = 100 * (df['close'] - lowest_14) / (highest_14 - lowest_14)
    heuristics_matrix = ema_log_return * stochastic_oscillator
    return heuristics_matrix
