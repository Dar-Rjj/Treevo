import pandas as pd
    import numpy as np
    
    # Calculate 30-day momentum
    momentum = df['close'].pct_change(periods=30)
    
    # Calculate 30-day volatility
    returns = df['close'].pct_change()
    volatility = returns.rolling(window=30).std()
    
    # Calculate 30-day volume trend
    volume_trend = df['volume'].pct_change(periods=30)
    
    # Composite factor
    heuristics_matrix = (momentum + 1/volatility + volume_trend) / 3
    
    return heuristics_matrix
