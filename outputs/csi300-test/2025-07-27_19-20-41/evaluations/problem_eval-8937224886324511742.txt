def heuristics_v2(df):
    ema_close = df['close'].ewm(span=30, adjust=False).mean()
    true_range = df[['high', 'low', 'close']].apply(lambda x: max(x['high'] - x['low'], abs(x['high'] - x['close'].shift(1)), abs(x['low'] - x['close'].shift(1))), axis=1)
    atr_14 = true_range.rolling(window=14).mean()
    momentum_7 = df['close'] / df['close'].shift(7)
    heuristics_matrix = (ema_close / atr_14) * momentum_7
    return heuristics_matrix
