def heuristics_v2(df):
    close_to_high_ratio = df['close'] / df['high']
    close_to_high_mean = close_to_high_ratio.rolling(window=10).mean()
    volume_ma = df['volume'].rolling(window=5).mean()
    volume_ratio = df['volume'] / volume_ma
    volume_ratio_cumprod = volume_ratio.cumprod()
    heuristics_matrix = close_to_high_mean * volume_ratio_cumprod
    return heuristics_matrix
