def heuristics_v3(df):
    daily_returns = df['close'].pct_change().fillna(0)
    avg_amount = df['amount'].rolling(window=20).mean()
    weight = df['amount'] / avg_amount
    heuristics_matrix = (daily_returns * weight).rolling(window=20).sum()
    return heuristics_matrix
