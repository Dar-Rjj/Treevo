```python
import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages (SMA)
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()

    # Calculate exponential moving averages (EMA)
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()

    # Compute the difference between 20-day EMA and 50-day EMA
    df['EMA_diff'] = df['EMA_20'] - df['EMA_50']

    # Calculate the rate of change (ROC) of the 50-day EMA
    df['EMA_50_ROC'] = df['EMA_50'].pct_change(periods=1)

    # Measure volume spikes
    df['volume_20_MA'] = df['volume'].rolling(window=20).mean()
    df['volume_spike'] = (df['volume'] > 2 * df['volume_20_MA']).astype(int)

    # Calculate the correlation between daily volume and price changes over the past 30 days
    df['price_change'] = df['close'].pct_change()
    df['volume_price_corr'] = df['volume'].rolling(window=30).corr(df['price_change'])

    # Calculate the ratio of up-volume to down-volume over the past 30 days
    df['up_volume'] = df['volume'] * (df['price_change'] > 0).astype(int)
    df['down_volume'] = df['volume'] * (df['price_change'] < 0).astype(int)
    df['up_down_ratio'] = df['up_volume'].rolling(window=30).sum() / df['down_volume'].rolling(window=30).sum()

    # Determine daily price range
    df['daily_range'] = df['high'] - df['low']
    df['range_to_close_ratio'] = df['daily_range'] / df['close']

    # Investigate opening price gaps
    df['prev_close'] = df['close'].shift(1)
    df['gap'] = df['open'] - df['prev_close']
    df['gap_magnitude'] = abs(df['gap']) / df['prev_close']
    df['bullish_gap'] = ((df['gap'] > 0) & (df['gap_magnitude'] > 0.01)).astype(int)
    df['bearish_gap'] = ((df['gap'] < 0) & (df['gap_magnitude'] > 0.01)).astype(int)

    # Calculate true range
    df['true_high'] = df[['high', 'prev_close']].max(axis=1)
    df['true_low'] = df[['low', 'prev_close']].min(axis=1)
    df['true_range'] = df['true_high'] - df['true_low']

    # Compute average true range (ATR)
    df['ATR_14'] = df['true_range'].rolling(window=14).mean()
    df['ATR_to_close_ratio'] = df['ATR_14'] / df['close']

    # Develop a composite factor
    # Assign weights to each component based on historical performance
    df['composite_factor'] = (
        0.2 * df['EMA_diff'] +
        0.1 * df['EMA_50_ROC'] +
        0.1 * df['volume_spike'] +
        0.1 * df['volume_price_corr'] +
        0.1 * df['up_down_ratio'] +
        0.1 * df['range_to_close_ratio'] +
        0.1 * df['bullish_gap'] -
        0.1 * df['bearish_gap'] +
        0.1 * df['ATR_to_close_ratio']
    )

    return df['composite_factor']
```
