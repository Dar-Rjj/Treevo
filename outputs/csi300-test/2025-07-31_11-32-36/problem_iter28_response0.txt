```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between closing and opening prices
    df['close_open_diff'] = df['close'] - df['open']
    
    # Compute the rolling 5-day sum of (close - open)
    df['rolling_5d_sum_close_open_diff'] = df['close_open_diff'].rolling(window=5).sum()
    
    # Calculate the cumulative amount traded over the past 10 days
    df['cumulative_amount_10d'] = df['amount'].rolling(window=10).sum()
    
    # Divide the current day's volume by the 10-day cumulative volume
    df['relative_volume'] = df['volume'] / df['cumulative_amount_10d']
    
    # Find the highest and lowest prices over the past 20 days
    df['highest_high_20d'] = df['high'].rolling(window=20).max()
    df['lowest_low_20d'] = df['low'].rolling(window=20).min()
    
    # Calculate the range as (highest high - lowest low) over 20 days
    df['range_20d'] = df['highest_high_20d'] - df['lowest_low_20d']
    
    # Use this range to normalize the daily (high - low) to measure intraday volatility
    df['normalized_intraday_volatility'] = (df['high'] - df['low']) / df['range_20d']
    
    # Track the ratio of the current day's close to the 20-day moving average of the close
    df['ma_close_20d'] = df['close'].rolling(window=20).mean()
    df['close_to_ma_ratio'] = df['close'] / df['ma_close_20d']
    
    # Combine all the sub-factors into a single alpha factor
    df['alpha_factor'] = (
        df['rolling_5d_sum_close_open_diff'] + 
        df['relative_volume'] + 
        df['normalized_intraday_volatility'] + 
        df['close_to_ma_ratio']
    )
    
    return df['alpha_factor']
```
