```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Composite Score
    high_low_delta = df['high'] - df['low']
    close_open_delta = df['close'] - df['open']
    sum_of_deltas = high_low_delta + close_open_delta
    
    mav = df['volume'].rolling(window=20).mean()
    intraday_composite_score = sum_of_deltas * (df['volume'] / mav)
    
    # Daily Return and Volatility
    daily_returns = df['close'].pct_change()
    ema_returns = daily_returns.ewm(span=20, adjust=False).mean()
    ema_squared_returns = (daily_returns**2).ewm(span=20, adjust=False).mean()
    ema_volatility = np.sqrt(ema_squared_returns)
    
    divergence = np.abs(ema_returns - ema_volatility)
    high_low_range = df['high'] - df['low']
    weighted_divergence = (divergence * df['volume']) / high_low_range
    
    # Intraday Movement Factor
    intraday_high_low_spread = df['high'] - df['low']
    prev_day_true_range = (df['high'].shift(1) - df['low'].shift(1)).abs().fillna(0)
    intraday_movement_factor = intraday_high_low_spread / prev_day_true_range
    
    # Close Price Direction
    close_price_direction = df['close'] - df['open']
    
    # Volume Impact
    volume_change = df['volume'] - df['volume'].shift(1)
    combined_factors = weighted_divergence * intraday_movement_factor
    
    # Weighted Momentum
    moving_avg_10d = daily_returns.rolling(window=10, min_periods=1).mean().shift(1)
    weighted_momentum = moving_avg_10d * df['volume'].shift(1)
    
    # Volatility
    std_10d = daily_returns.rolling(window=10, min_periods=1).std().shift(1)
    inverse_volatility = 1 / (std_10d + 1e-6)  # Add a small constant to avoid division by zero
    momentum_volatility_sum = weighted_momentum + inverse_volatility
    
    # Intraday Price Range Ratio
    intraday_price_range_ratio = (df['high'] - df['low']) / df['low']
    
    # Volume Adjusted Close
    volume_adjusted_close = df['close'] * np.sqrt(df['volume'])
    
    # Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']
    
    # Final Alpha Factor
    final_alpha_factor = (
        intraday_composite_score + 
        weighted_divergence + 
        momentum_volatility_sum + 
        intraday_price_range_ratio + 
        volume_adjusted_close + 
        intraday_return
    ) * volume_change
    
    return final_alpha_factor
```
