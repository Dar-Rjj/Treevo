```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    intraday_high_low_range = df['high'] - df['low']
    
    # Calculate Close to Open Difference
    close_to_open_diff = df['close'] - df['open']
    
    # Compute Intraday Momentum Score
    intraday_momentum_score = (intraday_high_low_range + close_to_open_diff) * df['volume']
    
    # Calculate Volume Weighted Price
    volume_weighted_price = (df['close'] * df['volume'] + df['open'] * df['volume']) / df['volume'].sum()
    
    # Calculate Volume Weighted Price Change
    volume_weighted_price_change = volume_weighted_price.diff().fillna(0)
    
    # Compute Combined Intraday and Daily Momentum
    combined_momentum = intraday_momentum_score + volume_weighted_price_change
    
    # Apply Exponential Moving Average (EMA) to Combined Momentum
    ema_combined_momentum = combined_momentum.ewm(span=20, min_periods=20).mean()
    
    # Calculate Intraday Volatility Score
    high_close_delta = df['high'] - df['close']
    low_close_delta = df['low'] - df['close']
    avg_deltas = (high_close_delta + low_close_delta) / 2
    intraday_volatility_score = avg_deltas * df['amount']
    
    # Compute EMA of Squared Returns for Volatility
    daily_returns = df['close'].pct_change()
    squared_returns = daily_returns ** 2
    ema_squared_returns = squared_returns.ewm(span=20, min_periods=20).mean()
    
    # Calculate Divergence between EMA of Returns and Volatility
    divergence = np.abs(ema_combined_momentum - ema_squared_returns)
    
    # Calculate Divergence and Weight Factor
    divergence_weight_factor = (divergence * df['volume']) / intraday_high_low_range
    
    # Integrate Composite Momentum, Volatility, and Volume Trends
    ema_30d_combined_momentum = combined_momentum.ewm(span=30, min_periods=30).mean()
    integrated_scores = combined_momentum - ema_30d_combined_momentum - intraday_volatility_score + divergence_weight_factor
    
    # Introduce Time-Varying Volatility Adjustment
    long_term_volatility = squared_returns.ewm(span=60, min_periods=60).mean()
    short_term_volatility = squared_returns.ewm(span=5, min_periods=5).mean()
    volatility_ratio = short_term_volatility / long_term_volatility
    adjusted_integrated_scores = integrated_scores * volatility_ratio
    
    # Incorporate Volume Trend Analysis
    volume_10d_ema = df['volume'].ewm(span=10, min_periods=10).mean()
    volume_momentum = df['volume'] - volume_10d_ema
    volume_50d_ema = df['volume'].ewm(span=50, min_periods=50).mean()
    normalized_volume_momentum = volume_momentum / volume_50d_ema
    
    # Integrate Volume Momentum into Final Score
    final_score = adjusted_integrated_scores * normalized_volume_momentum
    
    return final_score
```
