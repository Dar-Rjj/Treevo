```python
import pandas as pd

def heuristics_v2(df, N=10, M=5, K=20, smooth_window=5):
    # Calculate Intraday Volatility
    df['range'] = df['high'] - df['low']
    intraday_volatility = df['range'].rolling(window=N).mean()
    
    # Calculate Momentum from Close Price
    df['daily_return'] = df['close'] / df['close'].shift(1) - 1
    momentum = (df['close'] / df['close'].shift(M) - 1)
    
    # Combine Initial Factors
    raw_combined_factor = intraday_volatility * momentum
    avg_volume = df['volume'].rolling(window=K).mean()
    combined_factor = raw_combined_factor / avg_volume
    
    # Calculate Intraday Momentum
    intraday_return = (df['high'] - df['low']) / df['close']
    weighted_volume = (df['volume'] / 2)
    intraday_momentum = intraday_return * weighted_volume
    
    # Calculate Volume Thrust
    volume_ratio = df['volume'] / df['volume'].shift(1)
    intraday_range_normalized = (df['high'] - df['low']) / df['close']
    volume_thrust = volume_ratio * intraday_range_normalized
    
    # Final Combination and Smoothing
    final_factor = combined_factor * intraday_momentum * volume_thrust
    smoothed_factor = final_factor.rolling(window=smooth_window).mean()
    
    return smoothed_factor
```
