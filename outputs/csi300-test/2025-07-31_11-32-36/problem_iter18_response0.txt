```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Sum of Intraday Range over the past 5 days
    df['sum_intraday_range_5d'] = df['intraday_range'].rolling(window=5).sum()
    
    # Compare with the previous 5-day sum to identify trends
    df['volatility_trend'] = df['sum_intraday_range_5d'].diff(periods=5)
    
    # Calculate the close-to-open return (CtoOR)
    df['ctoor'] = (df['close'] - df['open']) / df['open']
    
    # Average CtoOR over the past 7 days
    df['avg_ctoor_7d'] = df['ctoor'].rolling(window=7).mean()
    
    # Calculate the percentage change in volume
    df['volume_change_pct'] = df['volume'].pct_change()
    
    # Calculate the cumulative return over the past 10 days
    df['cumulative_return_10d'] = (df['close'] / df['close'].shift(10)) - 1
    
    # Calculate the distance between the current close and the 20-day moving average of the close
    df['ma_20d'] = df['close'].rolling(window=20).mean()
    df['close_ma_20d_diff'] = df['close'] - df['ma_20d']
    
    # Calculate the Relative Strength Index (RSI) based on the past 14 days
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi_14d'] = 100 - (100 / (1 + rs))
    
    # Calculate the Money Flow Index (MFI) based on the past 14 days
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    positive_money_flow = money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_money_flow = money_flow.where(typical_price < typical_price.shift(1), 0)
    money_ratio = positive_money_flow.rolling(window=14).sum() / negative_money_flow.rolling(window=14).sum()
    df['mfi_14d'] = 100 - (100 / (1 + money_ratio))
    
    # Calculate the Accumulation/Distribution Line (A/D Line)
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    money_flow_volume = money_flow_multiplier * df['volume']
    df['ad_line'] = money_flow_volume.cumsum()
    
    # Calculate the Chaikin Money Flow (CMF) over the past 20 days
    cmf_numerator = (money_flow_multiplier * df['volume']).rolling(window=20).sum()
    cmf_denominator = df['volume'].rolling(window=20).sum()
    df['cmf_20d'] = cmf_numerator / cmf_denominator
    
    # Combine all the factors into a single alpha factor
    alpha_factor = (
        df['volatility_trend'] +
        df['avg_ctoor_7d'] +
        df['volume_change_pct'] +
        df['cumulative_return_10d'] +
        df['close_ma_20d_diff'] +
        df['rsi_14d'] +
        df['mfi_14d'] +
        df['ad_line'] +
        df['cmf_20d']
    )
    
    return alpha_factor
```
