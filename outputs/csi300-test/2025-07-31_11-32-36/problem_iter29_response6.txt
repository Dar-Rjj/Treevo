```python
import pandas as pd
import numpy as np

def heuristics_v2(df, ema_span=10, lookback_window=30):
    # Intraday Momentum Score
    sum_of_deltas = (df['high'] - df['low']) + (df['close'] - df['open'])
    mav = df['volume'].rolling(window=lookback_window).mean()
    weighted_momentum = sum_of_deltas * (df['volume'] / mav)

    # Intraday Volatility Score
    average_of_deltas = ((df['high'] - df['close']) + (df['low'] - df['close'])) / 2
    maa = df['amount'].rolling(window=lookback_window).mean()
    weighted_volatility = average_of_deltas * (df['amount'] / maa)

    # Price Trend Factor
    close_open_ratio = df['close'] / df['open']
    smoothed_ratio = close_open_ratio.ewm(span=ema_span, min_periods=ema_span).mean()

    # Daily Momentum and Volatility Components
    daily_returns = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    ema_returns = daily_returns.ewm(span=ema_span, min_periods=ema_span).mean()
    ema_squared_returns = (daily_returns**2).ewm(span=ema_span, min_periods=ema_span).mean()
    weighted_divergence = np.abs(ema_returns - ema_squared_returns) * (df['volume'] / (df['high'] - df['low']))

    # Combined Scores
    total_momentum = weighted_momentum + smoothed_ratio
    net_score = total_momentum - weighted_volatility + weighted_divergence

    # Integrated Momentum
    volume_weighted_price_change = (((df['close'] * df['volume'] + df['open'] * df['volume']) / (2 * df['volume'])) - 
                                    ((df['close'].shift(1) * df['volume'].shift(1) + df['open'].shift(1) * df['volume'].shift(1)) / (2 * df['volume'].shift(1))))
    integrated_momentum = (weighted_momentum + volume_weighted_price_change).ewm(span=30, min_periods=30).mean()

    # Volatility Ratio
    long_term_volatility = ema_squared_returns.ewm(span=50, min_periods=50).mean()
    short_term_volatility = ema_squared_returns.ewm(span=10, min_periods=10).mean()
    volatility_ratio = short_term_volatility / long_term_volatility

    # Final Alpha Factor
    core_factor = (net_score + integrated_momentum) * volatility_ratio
    volume_trend = (df['volume'] - df['volume'].shift(1)) / (lookback_window * 2)
    final_alpha = core_factor + volume_trend

    # Additional Factors
    momentum_difference = (df['high'] - df['low']) - (df['close'] - df['open'])
    momentum_reversal_score = momentum_difference.ewm(span=5, min_periods=5).mean()
    volume_delta = df['volume'] - df['volume'].shift(1)
    volume_shock_score = volume_delta.ewm(span=10, min_periods=10).mean()

    # Combine all factors into the final alpha
    final_alpha = final_alpha + momentum_reversal_score + volume_shock_score

    return final_alpha
```
