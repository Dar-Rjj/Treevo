```python
import pandas as pd
import numpy as np

def heuristics_v2(df, mav_lookback=20, maa_lookback=20, ema_span=20, volume_trend_lookback=20):
    # Intraday Momentum Score
    high_low_delta = df['high'] - df['low']
    close_open_delta = df['close'] - df['open']
    sum_of_deltas = high_low_delta + close_open_delta
    mav = df['volume'].rolling(window=mav_lookback).mean()
    intraday_momentum_score = sum_of_deltas * (df['volume'] / mav)

    # Intraday Volatility Score
    high_close_delta = df['high'] - df['close']
    low_close_delta = df['close'] - df['low']
    avg_of_deltas = (high_close_delta + low_close_delta) / 2
    maa = df['amount'].rolling(window=maa_lookback).mean()
    intraday_volatility_score = avg_of_deltas * (df['amount'] / maa)

    # Price Trend Factor
    close_open_ratio = df['close'] / df['open']
    smooth_close_open_ratio = close_open_ratio.ewm(span=ema_span, adjust=False).mean()

    # Daily Momentum and Volatility Components
    daily_return = df['close'].pct_change()
    ema_returns = daily_return.ewm(span=ema_span, adjust=False).mean()
    ema_squared_returns = (daily_return**2).ewm(span=ema_span, adjust=False).mean()
    divergence = (ema_squared_returns - ema_returns).abs()
    high_low_range = df['high'] - df['low']
    weighted_divergence = (divergence * df['volume']) / high_low_range

    # Combine Intraday and Daily Scores
    combined_scores = intraday_momentum_score - intraday_volatility_score + smooth_close_open_ratio + weighted_divergence

    # Volume and Price Adjusted Momentum
    volume_weighted_price = (df['close'] * df['volume'] + df['open'] * df['volume']) / (2 * df['volume'])
    volume_weighted_price_change = volume_weighted_price.diff()
    combined_intraday_daily_momentum = intraday_momentum_score + volume_weighted_price_change
    integrated_momentum = combined_intraday_daily_momentum - combined_intraday_daily_momentum.ewm(span=30, adjust=False).mean()

    # Final Alpha Factor
    final_alpha_factor = weighted_divergence + integrated_momentum + combined_scores
    volume_difference = df['volume'].diff()
    rolling_avg_volume_diff = volume_difference.rolling(window=volume_trend_lookback).mean()
    final_alpha_factor += rolling_avg_volume_diff

    return final_alpha_factor
```
