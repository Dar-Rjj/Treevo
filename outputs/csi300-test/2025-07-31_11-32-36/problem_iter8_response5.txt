```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=10, M=20, ema_span=5):
    # Intraday Momentum Score
    high_low_delta = df['high'] - df['low']
    close_open_delta = df['close'] - df['open']
    delta_sum = high_low_delta + close_open_delta
    mav = df['volume'].rolling(window=N).mean()
    weighted_momentum = (delta_sum * df['volume']) / mav

    # Intraday Volatility Score
    intraday_range = df['high'] - df['low']
    average_intraday_range = intraday_range.rolling(window=N).mean()
    maa = df['amount'].rolling(window=N).mean()
    weighted_volatility = (average_intraday_range * df['amount']) / maa

    # Price Trend Factor
    close_open_ratio = df['close'] / df['open']
    smoothed_close_open_ratio = close_open_ratio.ewm(span=ema_span, adjust=False).mean()
    close_price_returns = df['close'].pct_change()

    # Cumulative Return
    cumulative_return = close_price_returns.rolling(window=M).sum()

    # Combine Scores
    combined_factor = weighted_momentum - weighted_volatility
    combined_factor = combined_factor * cumulative_return

    # Adjust for Volume
    ema_volume = df['volume'].ewm(span=ema_span, adjust=False).mean()
    adjusted_combined_factor = combined_factor / ema_volume

    return adjusted_combined_factor
```
