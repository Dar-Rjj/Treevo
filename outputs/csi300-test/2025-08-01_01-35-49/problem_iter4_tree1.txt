```txt
Intraday Momentum and Volatility Factor Enhanced
├── Calculate Intraday Return
│   ├── Use Close Price
│   └── Use Open Price
│       └── Subtract Open from Close
├── Calculate Intraday High-Low Range
│   ├── Use High Price
│   └── Use Low Price
│       └── Subtract Low from High
├── Combine Intraday Return and High-Low Range
│   ├── Multiply Intraday Return by High-Low Range
│   └── Smooth using Exponential Moving Average (EMA)
│       └── Choose EMA period
└── Apply Volume Weighting
    ├── Use Volume
    └── Multiply Combined Factor by Volume
├── Incorporate Historical Volatility
│   ├── Calculate 20-Day Standard Deviation of Log Returns
│   │   ├── Compute Log Returns
│   │   │   ├── Use Close Price
│   │   │   └── Shift Close Price by 1 day
│   │   │       └── Take natural logarithm of the ratio
│   │   └── Compute Standard Deviation over 20 days
│   └── Normalize Historical Volatility
│       ├── Divide by the maximum historical volatility in the lookback window
│       └── Use 20-day window for normalization
└── Integrate All Components
    ├── Combine Intraday Momentum, Volatility, and Volume
    │   ├── Use Intraday Momentum and Volume Weighted Factor
    │   └── Use Normalized Historical Volatility
    │       └── Multiply the two factors
    └── Final Smoothing
        ├── Apply a 5-Day Simple Moving Average to the integrated factor
        │   ├── Use the last 5 days of the integrated factor
        │   └── Compute the average
        └── Output the final alpha factor
```
