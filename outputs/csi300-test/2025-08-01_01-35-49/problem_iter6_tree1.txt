```txt
Intraday Momentum and Volatility Factor with Enhanced Smoothing and Historical Data Integration
├── Calculate Intraday Return
│   ├── Use Close Price at t
│   └── Subtract Open Price at t
├── Calculate Intraday High-Low Range
│   ├── Use High Price at t
│   └── Subtract Low Price at t
├── Combine Intraday Return and High-Low Range
│   ├── Multiply Intraday Return by High-Low Range
│   └── Smooth using Exponential Moving Average (EMA)
│       └── Choose EMA period
├── Apply Volume Weighting
│   ├── Use Volume at t
│   └── Multiply Combined Factor by Volume
├── Incorporate Previous Day's Closing Gap
│   ├── Calculate the difference between today's Open price at t and previous day's Close price at t-1
│   └── Add to the Volume-Weighted Smoothed Factor
├── Integrate Long-Term Momentum
│   ├── Calculate Long-Term Return
│   │   ├── Use Close Price from a longer period (e.g., 50 days ago) at t-50
│   │   └── Use Today's Close Price at t
│   └── Divide Long-Term Return by High-Low Range
├── Incorporate Medium-Term Momentum
│   ├── Calculate Medium-Term Return
│   │   ├── Use Close Price from an intermediate period (e.g., 20 days ago) at t-20
│   │   └── Use Today's Close Price at t
│   └── Divide Medium-Term Return by High-Low Range
├── Final Factor Calculation
    ├── Sum of all components
    │   ├── Volume-Weighted Smoothed Factor
    │   ├── Previous Day's Closing Gap
    │   ├── Long-Term Return Divided by High-Low Range
    │   └── Medium-Term Return Divided by High-Low Range
    └── Apply Non-Linear Transformation
        └── Use a function like log(1 + x) to capture non-linear effects
```
