```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Close-to-High Distance
    close_to_high_distance = df['high'] - df['close']
    
    # Exponential Moving Average (EMA) of Close-to-High Distance
    ema_close_to_high = close_to_high_distance.ewm(span=10, adjust=False).mean()
    
    # Weight by Volume
    weighted_ema = ema_close_to_high * df['volume']
    
    # Unweighted EMA
    unweighted_ema = ema_close_to_high
    
    # Calculate the sum of Weighted EMA and Unweighted EMA
    sum_weighted_ema = weighted_ema.sum()
    sum_unweighted_ema = unweighted_ema.sum()
    
    # Calculate the ratio of Weighted EMA to Unweighted EMA
    factor_value = sum_weighted_ema / sum_unweighted_ema
    
    return factor_value

# Example usage:
# df = pd.DataFrame({
#     'open': [1, 2, 3, 4],
#     'high': [2, 3, 4, 5],
#     'low': [1, 1, 2, 3],
#     'close': [2, 3, 4, 5],
#     'amount': [10, 20, 30, 40],
#     'volume': [100, 200, 300, 400]
# }, index=pd.to_datetime(['2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04']))

# factor_series = heuristics_v2(df)
# print(factor_series)
```
