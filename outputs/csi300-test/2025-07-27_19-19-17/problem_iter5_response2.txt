```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['low']

    # Calculate Open-to-Close Return
    df['open_to_close_return'] = (df['close'] - df['open']) / df['open']

    # Integrate Returns
    df['integrated_return'] = df['intraday_return'] + df['open_to_close_return']

    # Confirm with Volume and Amount
    df['volume_confirm'] = df['volume'] > df['volume'].shift(1)
    df['amount_confirm'] = df['amount'] > df['amount'].shift(1)

    # Calculate the weight based on volume and amount
    df['avg_volume_10d'] = df['volume'].rolling(window=10).mean()
    df['avg_amount_10d'] = df['amount'].rolling(window=10).mean()
    df['weight'] = (df['volume'] / df['avg_volume_10d']) * (df['amount'] / df['avg_amount_10d'])

    # Apply the weight to the integrated return
    df['factor'] = df['integrated_return'] * df['weight']
    
    # Only keep the factor if both volume and amount confirm
    df['factor'] = df['factor'] * df['volume_confirm'] * df['amount_confirm']

    return df['factor']
```
