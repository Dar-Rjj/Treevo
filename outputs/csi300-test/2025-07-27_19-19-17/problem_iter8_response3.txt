```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate True Range (TR)
    df['TR'] = df[['high', 'low', 'close']].apply(
        lambda x: max(x['high'] - x['low'], abs(x['high'] - df['close'].shift(1)), abs(x['low'] - df['close'].shift(1))), 
        axis=1
    )
    
    # Calculate ATR over a window, e.g., 14 days
    df['ATR'] = df['TR'].rolling(window=14).mean()
    
    # Calculate Volume and Amount Differences
    df['volume_diff'] = df['volume'] - df['volume'].shift(1)
    df['amount_diff'] = df['amount'] - df['amount'].shift(1)
    df['vol_amount_sum'] = df['volume_diff'] + df['amount_diff']
    
    # Normalize the sum by average volume and amount over a window, e.g., 20 days
    df['avg_volume'] = df['volume'].rolling(window=20).mean()
    df['avg_amount'] = df['amount'].rolling(window=20).mean()
    df['norm_vol_amount'] = df['vol_amount_sum'] / (df['avg_volume'] + df['avg_amount'])
    
    # Calculate Intraday Return
    df['intraday_return'] = df['high'] - df['low']
    
    # Calculate Open-to-Close Return
    df['open_close_return'] = df['close'] - df['open']
    
    # Integrate Returns
    df['integrated_return'] = df['intraday_return'] + df['open_close_return']
    
    # Confirm with Volume
    df['weighted_integrated_return'] = df['integrated_return'] * (df['volume'] / df['volume'].rolling(window=10).mean())
    df['weighted_integrated_return'] = df.apply(lambda x: x['weighted_integrated_return'] if x['volume'] > df['volume'].shift(1) else 0, axis=1)
    
    # Calculate SMAs of Close price
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    
    # Compute the difference between the two SMAs
    df['SMA_diff'] = df['SMA_10'] - df['SMA_50']
    
    # Multiply the SMA difference by the ATR
    df['SMA_ATR_product'] = df['SMA_diff'] * df['ATR']
    
    # Adjust the product by adding the normalized volume-amount difference
    df['combined_alpha_factor'] = df['SMA_ATR_product'] + df['norm_vol_amount']
    
    # Calculate Intraday High-Low Spread
    df['high_low_spread'] = df['high'] - df['low']
    
    # Integrate High-Low and Close-Open for Momentum
    df['integrated_momentum'] = df['high_low_spread'] * df['open_close_return']
    
    # Smooth the Integrated Momentum using EMA
    df['smoothed_momentum'] = df['integrated_momentum'].ewm(span=5, adjust=False).mean()
    
    # Final Factor
    df['final_factor'] = df['weighted_integrated_return'] + df['smoothed_momentum'] + df['combined_alpha_factor']
    
    # Adjust for Volume
    df['final_factor'] = df['final_factor'] / df['volume']
    
    return df['final_factor']
```
