def heuristics_v2(df):
    def calculate_moving_averages(prices, periods):
        return {period: prices.rolling(window=period).mean() for period in periods}
    
    def calculate_volatility(prices, window):
        return prices.pct_change().rolling(window=window).std()
    
    close_prices = df['close']
    volumes = df['volume']
    short_window, long_window = 10, 50
    vola_window = 20
    
    mavg_short, mavg_long = calculate_moving_averages(close_prices, [short_window, long_window]).values()
    volatility = calculate_volatility(close_prices, vola_window)
    
    # Heuristic calculation
    trend_signal = (mavg_short - mavg_long) / close_prices
    volume_signal = (volumes - volumes.rolling(window=long_window).mean()) / volumes
    heuristics_matrix = 0.7 * trend_signal + 0.3 * volume_signal / (volatility + 1e-6)
    
    return heuristics_matrix
