def heuristics_v2(df):
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    df['true_range_10'] = (df['high'] - df['low']).rolling(window=10).mean()
    df['true_range_30'] = (df['high'] - df['low']).rolling(window=30).mean()
    df['std_20'] = df['close'].rolling(window=20).std()
    df['std_50'] = df['close'].rolling(window=50).std()
    df['weighted_momentum'] = (df['EMA_20'] * df['std_50'] + df['EMA_50'] * df['std_20']) / (df['std_20'] + df['std_50'])
    heuristics_matrix = (df['weighted_momentum'] * (df['true_range_10'] / df['true_range_30'])).fillna(0)
    return heuristics_matrix
