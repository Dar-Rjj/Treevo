def heuristics_v2(df):
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    df['true_range_10'] = (df['high'] - df['low']).rolling(window=10).mean()
    df['true_range_20'] = (df['high'] - df['low']).rolling(window=20).mean()
    df['volatility_20'] = df['true_range_20']
    df['volatility_50'] = df['true_range_20'].rolling(window=50).mean()
    df['weighted_momentum'] = (df['EMA_20'] / df['volatility_20'] + df['EMA_50'] / df['volatility_50']) / (1/df['volatility_20'] + 1/df['volatility_50'])
    heuristics_matrix = (df['weighted_momentum'] * (df['true_range_10'] / df['true_range_20'])).fillna(0)
    return heuristics_matrix
