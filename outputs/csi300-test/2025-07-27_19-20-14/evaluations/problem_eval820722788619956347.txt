def heuristics_v2(df):
    def calc_price_momentum(series, window):
        return (series / series.shift(window)) - 1

    def calc_volume_change(series, window):
        return (series - series.shift(window)) / series.shift(window)

    def calc_amount_momentum(series, window):
        return (series / series.shift(window)) - 1

    price_mom_5 = calc_price_momentum(df['close'], 5)
    price_mom_20 = calc_price_momentum(df['close'], 20)
    vol_change_5 = calc_volume_change(df['volume'], 5)
    amt_mom_20 = calc_amount_momentum(df['amount'], 20)
    
    heuristics_matrix = 0.4 * price_mom_5 + 0.3 * price_mom_20 + 0.2 * vol_change_5 + 0.1 * amt_mom_20
    return heuristics_matrix
