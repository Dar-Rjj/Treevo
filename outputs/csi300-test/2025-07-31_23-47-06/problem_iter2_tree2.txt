```txt
Multi-Period High-to-Low Momentum with Volume Weighting
├── Calculate High-to-Low Momentum
│   ├── Use High price
│   └── Use Low price
├── Calculate Short-Term Trend
│   ├── Average High-to-Low Momentum (3 days)
│   ├── Average High-to-Low Momentum (10 days)
│   └── Combine Averages
│       └── (3-day Average + 10-day Average) / 2
├── Calculate Long-Term Trend
│   ├── Average High-to-Low Momentum (20 days)
│   ├── Average High-to-Low Momentum (50 days)
│   └── Combine Averages
│       └── (20-day Average + 50-day Average) / 2
├── Compute Trend Difference
│   ├── Subtract Short-Term Trend from Long-Term Trend
├── Detect Volume Spikes
│   ├── Use Volume
│   ├── Calculate Standard Deviation of Volume
│   │   └── Use Last N days Volume
│   └── Identify Days with Volume > Mean + 2 * Standard Deviation
└── Weight by Volume and Adjust for Volume Spikes
    ├── Use Volume
    ├── Multiply by Trend Difference
    └── Adjust by Volume Spike Indicator
        └── Set 1 if Volume > Mean + 2 * Standard Deviation, else 0
```
