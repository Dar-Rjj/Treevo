```python
import pandas as pd

def heuristics_v2(df):
    # Compute 5-day percentage change in closing price
    df['close_5d_pct_change'] = df['close'].pct_change(periods=5)
    
    # Determine if today's volume is higher than the average of the past 20 days
    df['volume_20d_avg'] = df['volume'].rolling(window=20).mean()
    df['volume_above_avg'] = (df['volume'] > df['volume_20d_avg']).astype(int)
    
    # Create a factor based on the absolute value of the daily price range
    df['daily_range'] = abs(df['high'] - df['low'])
    
    # Measure the ratio of today's range to the average range over the last 10 days
    df['range_10d_avg'] = df['daily_range'].rolling(window=10).mean()
    df['range_ratio'] = df['daily_range'] / df['range_10d_avg']
    
    # Calculate the percentage difference between today's opening price and yesterday's closing price
    df['open_gap_pct'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['close_5d_pct_change'] + 
        df['volume_above_avg'] * 0.5 + 
        df['range_ratio'] * 0.3 + 
        df['open_gap_pct'] * 0.2
    )
    
    return df['alpha_factor'].dropna()

# Example usage:
# df = pd.DataFrame({
#     'date': pd.date_range(start='2023-01-01', periods=30),
#     'open': [100, 101, 99, ...],
#     'high': [102, 103, 101, ...],
#     'low': [98, 97, 96, ...],
#     'close': [101, 100, 98, ...],
#     'amount': [...],
#     'volume': [1000, 1200, 1100, ...]
# })
# df.set_index('date', inplace=True)
# alpha_factor = heuristics_v2(df)
```
