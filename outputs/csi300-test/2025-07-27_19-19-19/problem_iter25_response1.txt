```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate trend-following indicators
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Identify potential reversal points
    df['daily_range'] = df['high'] - df['low']
    df['prev_daily_range'] = df['daily_range'].shift(1)
    df['range_expansion'] = df['daily_range'] > df['prev_daily_range']
    
    df['midpoint'] = (df['high'] + df['low']) / 2
    df['close_above_midpoint'] = df['close'] > df['midpoint']
    
    df['bullish_engulfing'] = (df['open'] < df['close']) & (df['open'].shift(-1) > df['close'].shift(-1)) & (df['close'] >= df['open'].shift(-1)) & (df['open'] <= df['close'].shift(-1))
    df['bearish_engulfing'] = (df['open'] > df['close']) & (df['open'].shift(-1) < df['close'].shift(-1)) & (df['close'] <= df['open'].shift(-1)) & (df['open'] >= df['close'].shift(-1))
    
    # Assess market sentiment through volume analysis
    df['Volume_SMA_20'] = df['volume'].rolling(window=20).mean()
    df['volume_above_sma'] = df['volume'] > df['Volume_SMA_20']
    
    # Integrate multiple factors to create composite signals
    df['trend_signal'] = (df['close'] > df['SMA_50']).astype(int) + (df['close'] > df['EMA_20']).astype(int) + df['volume_above_sma'].astype(int)
    
    df['ohlc_signal'] = (df['range_expansion'] * 1) + (df['close_above_midpoint'] * 1) + (df['bullish_engulfing'] * -1) + (df['bearish_engulfing'] * 1)
    
    # Final composite signal
    df['composite_signal'] = df['trend_signal'] * (1 + df['ohlc_signal'])
    
    return df['composite_signal']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# factor_values = heuristics_v2(df)
# print(factor_values)
```
