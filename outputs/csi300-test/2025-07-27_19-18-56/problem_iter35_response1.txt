```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=10, short_term_ma=5, long_term_ma=20):
    # Compute Close-to-Close Return
    df['close_return'] = df['close'].pct_change()
    
    # Sum over n periods
    df['momentum'] = df['close_return'].rolling(window=n).sum()
    
    # Confirm with Trading Volume Increase
    df['volume_change'] = (df['volume'] > df['volume'].shift(1)).astype(int)
    df['momentum'] = df['momentum'] * df['volume_change']
    
    # Volume-Weighted High-Low Range
    df['hl_range'] = (df['high'] - df['low']) * df['volume']
    total_volume = df['volume'].rolling(window=10).sum()
    df['volume_weighted_hl_range'] = df['hl_range'].rolling(window=10).sum() / total_volume
    
    # Adjust for Market Sentiment
    df['close_open_return'] = df['close'] - df['open']
    market_sentiment_multiplier = np.where(df['close_open_return'] > 0, 1.2, 0.8)
    df['volume_weighted_hl_range'] = df['volume_weighted_hl_range'] * market_sentiment_multiplier
    
    # Smoothed High-Low Spread
    df['hl_spread'] = df['high'] - df['low']
    df['ema_hl_spread'] = df['hl_spread'].ewm(span=short_term_ma, adjust=False).mean()
    df['smoothed_hl_spread'] = df['hl_spread'] - df['ema_hl_spread']
    
    # Integrate with Convergence-Divergence of High-Low Prices
    df['short_term_ma'] = ((df['high'] + df['low']) / 2).rolling(window=short_term_ma).mean()
    df['long_term_ma'] = ((df['high'] + df['low']) / 2).rolling(window=long_term_ma).mean()
    df['convergence_divergence'] = df['short_term_ma'] - df['long_term_ma']
    
    # Filter by Volume Change
    df['filtered_convergence_divergence'] = df['convergence_divergence'] * df['volume_change']
    
    # Trend Confirmation
    df['5_day_ema'] = df['close'].ewm(span=5, adjust=False).mean()
    df['20_day_ema'] = df['close'].ewm(span=20, adjust=False).mean()
    df['trend_confirmation'] = (df['5_day_ema'] > df['20_day_ema']).astype(int)
    
    # Final Alpha Factor Construction
    df['combined_factor'] = (df['volume_weighted_hl_range'] * df['volume_change'] +
                             df['smoothed_hl_spread'] * df['volume_change'] +
                             df['momentum'] * df['volume_change'])
    df['final_alpha_factor'] = df['combined_factor'] * df['trend_confirmation']
    
    # Enhance with Additional Volume Check
    df['volume_change_n'] = (df['volume'] > df['volume'].shift(n)).astype(int)
    df['final_alpha_factor'] = df['final_alpha_factor'] * df['volume_change_n']
    
    return df['final_alpha_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=True, index_col='date')
# alpha_factor = heuristics_v2(df)
```
