```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the money flow ratio which is a measure of buying to selling pressure
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    positive_flow = money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_flow = money_flow.where(typical_price < typical_price.shift(1), 0)
    money_ratio = positive_flow.rolling(window=14).sum() / negative_flow.rolling(window=14).sum()

    # Calculate the relative strength compared to the average close price over the last 30 days
    avg_close_30 = df['close'].rolling(window=30).mean()
    relative_strength = df['close'] / avg_close_30

    # Combine the factors into a final heuristic score
    factor = (money_ratio * 0.5 + relative_strength * 0.5).fillna(0)

    return factor
```
