```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the change in closing price and volume from the previous day
    df['delta_close'] = df['close'].diff()
    df['delta_volume'] = df['volume'].diff()

    # Calculate the weighted moving average of the delta_close using delta_volume as weights
    window_size = 5
    df['wma_delta_close'] = (df['delta_close'] * df['delta_volume']).rolling(window=window_size).sum() / df['delta_volume'].rolling(window=window_size).sum()

    # Factor: Ratio of the WMA of delta_close to the mean of the past 20 days' high prices
    factor = df['wma_delta_close'] / df['high'].rolling(window=20).mean()
    return factor
```
