```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between close and open price
    close_open_diff = df['close'] - df['open']
    
    # Calculate the weighted average of volume and amount
    w_avg_vol_amt = (df['volume'] * df['amount']) / (df['volume'].rolling(window=5).mean() + 1e-7)
    
    # Calculate the volatility as the standard deviation of the last 5 days' close prices
    volatility_5d = df['close'].rolling(window=5).std()
    
    # Calculate the factor by normalizing the close-open difference by the high-low range, scaling it by the weighted average of volume and amount, and then adjusting for volatility
    factor = (close_open_diff / (df['high'] - df['low'] + 1e-7)) * w_avg_vol_amt / (volatility_5d + 1e-7)
    
    return factor
```
