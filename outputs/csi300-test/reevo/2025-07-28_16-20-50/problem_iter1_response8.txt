```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between close and open price
    close_open_diff = df['close'] - df['open']
    
    # Calculate the weighted average of volume and amount
    w_avg_vol_amt = (df['volume'] * df['amount']) / (df['volume'].rolling(window=5).mean() + 1e-7)
    
    # Calculate the factor by normalizing the close-open difference by the high-low range and scaling it by the weighted average of volume and amount
    factor = (close_open_diff / (df['high'] - df['low'] + 1e-7)) * w_avg_vol_amt
    
    return factor
```
