```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 30-day and 90-day simple moving average of close prices
    df['sma_30'] = df['close'].rolling(window=30).mean()
    df['sma_90'] = df['close'].rolling(window=90).mean()

    # Calculate the ratio of the 30-day to 90-day SMA, representing a medium to long-term trend
    sma_ratio = df['sma_30'] / df['sma_90']

    # Calculate the 7-day volume-weighted average price (VWAP)
    df['vwap'] = (df['close'] * df['volume']).rolling(window=7).sum() / df['volume'].rolling(window=7).sum()

    # Calculate the relative change in VWAP over the past 14 days
    vwap_change = df['vwap'].pct_change(periods=14)

    # Calculate the 30-day and 90-day standard deviation of close prices for volatility
    df['volatility_30'] = df['close'].rolling(window=30).std()
    df['volatility_90'] = df['close'].rolling(window=90).std()

    # Calculate the ratio of 30-day to 90-day volatility
    volatility_ratio = df['volatility_30'] / (df['volatility_90'] + 1e-7)

    # Calculate the 30-day and 90-day cumulative volume for liquidity
    df['liquidity_30'] = df['volume'].rolling(window=30).sum()
    df['liquidity_90'] = df['volume'].rolling(window=90).sum()

    # Calculate the ratio of 30-day to 90-day liquidity
    liquidity_ratio = df['liquidity_30'] / (df['liquidity_90'] + 1e-7)

    # Calculate the 5-day and 20-day rate of change (ROC) for momentum
    df['roc_5'] = df['close'].pct_change(periods=5)
    df['roc_20'] = df['close'].pct_change(periods=20)

    # Calculate the ratio of 5-day to 20-day ROC
    roc_ratio = df['roc_5'] / (df['roc_20'] + 1e-7)

    # Calculate the 30-day and 90-day exponential moving average of close prices for smoothness
    df['ema_30'] = df['close'].ewm(span=30, adjust=False).mean()
    df['ema_90'] = df['close'].ewm(span=90, adjust=False).mean()

    # Calculate the ratio of 30-day to 90-day EMA
    ema_ratio = df['ema_30'] / df['ema_90']

    # Combine the SMA ratio, VWAP change, volatility ratio, liquidity ratio, ROC ratio, and EMA ratio into a single factor
    factor = (sma_ratio + vwap_change + volatility_ratio + liquidity_ratio + roc_ratio + ema_ratio) / 6

    return factor
```
