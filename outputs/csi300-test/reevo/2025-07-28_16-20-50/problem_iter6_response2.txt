```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 30-day and 90-day simple moving average of close prices
    df['sma_30'] = df['close'].rolling(window=30).mean()
    df['sma_90'] = df['close'].rolling(window=90).mean()

    # Calculate the ratio of the 30-day to 90-day SMA, representing a medium to long-term trend
    sma_ratio = df['sma_30'] / df['sma_90']

    # Calculate the 7-day volume-weighted average price (VWAP)
    df['vwap'] = (df['close'] * df['volume']).rolling(window=7).sum() / df['volume'].rolling(window=7).sum()

    # Calculate the relative change in VWAP over the past 14 days
    vwap_change = df['vwap'].pct_change(periods=14)

    # Calculate the 60-day high and low prices
    df['high_60'] = df['high'].rolling(window=60).max()
    df['low_60'] = df['low'].rolling(window=60).min()

    # Calculate the percentage distance from the 60-day high and low
    pct_from_high = (df['close'] - df['high_60']) / df['high_60']
    pct_from_low = (df['close'] - df['low_60']) / df['low_60']

    # Incorporate longer-term trends using exponential smoothing
    trend = df['close'].ewm(span=20, adjust=False).mean()

    # Calculate the difference between close and open price
    price_diff = df['close'] - df['open']

    # Calculate the average of high and low prices
    avg_price = (df['high'] + df['low']) / 2

    # Calculate the price volatility using the standard deviation of the price difference
    price_volatility = price_diff.rolling(window=10).std()

    # Combine the SMA ratio, VWAP change, percentage distances, trend, price movement, and volatility into a single factor
    factor = sma_ratio + vwap_change + pct_from_high + pct_from_low + trend + (price_diff / avg_price) / (price_volatility + 1e-7)

    return factor
```
