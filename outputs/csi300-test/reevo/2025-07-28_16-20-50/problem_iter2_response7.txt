```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the directional volume, positive when close > open, negative otherwise
    df['directional_volume'] = df['volume'] * (df['close'] - df['open']).apply(lambda x: 1 if x > 0 else -1)
    
    # Calculate the cumulative sum of positive and negative directional volumes
    df['cumulative_positive_vol'] = df['directional_volume'].clip(lower=0).cumsum()
    df['cumulative_negative_vol'] = df['directional_volume'].clip(upper=0).abs().cumsum()
    
    # Calculate the rolling sum over a 5-day window for both positive and negative cumulative volumes
    pos_roll_sum = df['cumulative_positive_vol'].rolling(window=5).mean()
    neg_roll_sum_abs = df['cumulative_negative_vol'].rolling(window=5).mean()
    
    # Factor: ratio of positive rolling sum to absolute negative rolling sum
    factor = pos_roll_sum / (neg_roll_sum_abs + 1e-7)
    
    return factor
```
