```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between close and open, then scale by the volume
    price_diff_scaled_by_volume = (df['close'] - df['open']) * df['volume']
    
    # Calculate a weighted moving average of the scaled price difference
    # Use a 10-day window for the moving average
    weighted_moving_avg = price_diff_scaled_by_volume.rolling(window=10).mean()
    
    # Calculate the ratio of the current day's price change to the moving average
    factor = (df['close'] - df['open']) / (weighted_moving_avg + 1e-7)
    
    return factor
```
