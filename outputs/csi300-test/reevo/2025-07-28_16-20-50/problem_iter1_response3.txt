```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the weighted moving average of closing prices, using volume as weights
    df['wma'] = (df['close'] * df['volume']).rolling(window=7).sum() / df['volume'].rolling(window=7).sum()
    # Calculate the ratio of today's close price to the 7-day weighted moving average
    factor = df['close'] / df['wma']
    return factor
```
