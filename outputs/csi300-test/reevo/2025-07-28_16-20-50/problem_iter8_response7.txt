```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 30-day and 90-day simple moving average of close prices
    df['sma_30'] = df['close'].rolling(window=30).mean()
    df['sma_90'] = df['close'].rolling(window=90).mean()

    # Calculate the ratio of the 30-day to 90-day SMA, representing a medium to long-term trend
    sma_ratio = df['sma_30'] / df['sma_90']

    # Calculate the 7-day volume-weighted average price (VWAP)
    df['vwap'] = (df['close'] * df['volume']).rolling(window=7).sum() / df['volume'].rolling(window=7).sum()

    # Calculate the relative change in VWAP over the past 14 days
    vwap_change = df['vwap'].pct_change(periods=14)

    # Calculate the 60-day high and low prices
    df['high_60'] = df['high'].rolling(window=60).max()
    df['low_60'] = df['low'].rolling(window=60).min()

    # Calculate the percentage distance from the 60-day high and low
    pct_from_high = (df['close'] - df['high_60']) / df['high_60']
    pct_from_low = (df['close'] - df['low_60']) / df['low_60']

    # Calculate the 20-day and 60-day exponential moving average (EMA) of close prices
    df['ema_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['ema_60'] = df['close'].ewm(span=60, adjust=False).mean()

    # Calculate the ratio of the 20-day to 60-day EMA, representing a short to medium-term trend
    ema_ratio = df['ema_20'] / df['ema_60']

    # Calculate the 30-day and 90-day momentum of close prices
    df['momentum_30'] = df['close'] - df['close'].shift(30)
    df['momentum_90'] = df['close'] - df['close'].shift(90)

    # Calculate the ratio of 30-day to 90-day momentum
    momentum_ratio = df['momentum_30'] / (df['momentum_90'] + 1e-7)

    # Combine the SMA ratio, EMA ratio, VWAP change, percentage distances, and momentum ratio into a single factor
    factor = sma_ratio + ema_ratio + vwap_change + pct_from_high + pct_from_low + momentum_ratio

    return factor
```
