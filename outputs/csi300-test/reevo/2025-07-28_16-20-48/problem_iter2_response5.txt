```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the volume-weighted close price
    vw_close = df['close'] * df['volume']
    
    # Calculate the average volume over the last 10 days
    avg_volume = df['volume'].rolling(window=10).mean()
    
    # Calculate the 10-day and 30-day moving averages of the close price
    ma_10 = df['close'].rolling(window=10).mean()
    ma_30 = df['close'].rolling(window=30).mean()
    
    # Calculate the trend factor as the difference between the 10-day and 30-day moving averages
    trend_factor = (ma_10 - ma_30) / (ma_30 + 1e-7)
    
    # Calculate the market sentiment factor using the difference between high and low prices
    daily_range = df['high'] - df['low']
    sentiment_factor = (df['close'] - df['open']) / (daily_range + 1e-7)
    
    # Combine the volume-weighted close, trend, and sentiment factors
    factor = (vw_close / (avg_volume + 1e-7)) * trend_factor * sentiment_factor
    factor = factor.fillna(0)
    
    return factor
```
