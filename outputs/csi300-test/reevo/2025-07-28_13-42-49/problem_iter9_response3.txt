```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the log return of close prices
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Calculate the exponential moving average of the log returns over the past 10 days
    df['ema_10d'] = df['log_return'].ewm(span=10, adjust=False).mean()
    
    # Calculate the adaptive window for volume based on the standard deviation of the past 5 days
    df['vol_std_5d'] = df['volume'].rolling(window=5).std()
    df['adaptive_window'] = (df['volume'] / df['vol_std_5d']).clip(lower=5, upper=20)
    
    # Calculate the smoothed volume ratio using the adaptive window
    df['smoothed_vol_ratio'] = df['volume'] / df['volume'].rolling(window=df['adaptive_window'].astype(int)).mean()
    
    # Calculate the trend component by taking the difference between the current close and the exponential moving average
    df['trend'] = df['close'] - df['close'].ewm(span=10, adjust=False).mean()
    
    # Combine the log return, smoothed volume ratio, and trend into a single factor
    factor = df['log_return'] + (df['amount'] * df['smoothed_vol_ratio']) - df['trend']
    
    return factor.dropna()
```
