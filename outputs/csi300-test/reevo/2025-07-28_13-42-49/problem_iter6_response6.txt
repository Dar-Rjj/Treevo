```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()

    # Calculate the difference between today's close and the 10-day moving average
    df['close_ma_10d_diff'] = df['close'] - df['ma_10d']

    # Calculate the 10-day and 30-day rolling standard deviation of the close price to measure volatility
    df['std_10d'] = df['close'].rolling(window=10).std()
    df['std_30d'] = df['close'].rolling(window=30).std()

    # Calculate the ratio of the 10-day standard deviation to the 30-day standard deviation
    df['volatility_ratio'] = df['std_10d'] / df['std_30d']

    # Calculate the 10-day and 30-day moving averages of the volume
    df['vol_ma_10d'] = df['volume'].rolling(window=10).mean()
    df['vol_ma_30d'] = df['volume'].rolling(window=30).mean()

    # Calculate the ratio of today's volume to the 10-day moving average of the volume
    df['vol_ratio_10d'] = df['volume'] / df['vol_ma_10d']

    # Calculate the trend component by taking the difference between the 10-day and 30-day moving averages
    df['trend'] = df['ma_10d'] - df['ma_30d']

    # Calculate the 10-day and 30-day relative strength (RS)
    df['rs_10d'] = df['close'] / df['close'].rolling(window=10).mean()
    df['rs_30d'] = df['close'] / df['close'].rolling(window=30).mean()

    # Calculate the 10-day and 30-day momentum
    df['momentum_10d'] = df['close'].pct_change(10)
    df['momentum_30d'] = df['close'].pct_change(30)

    # Adaptive volatility measure using the average true range (ATR) over 14 days
    df['tr'] = df[['high', 'low', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['atr_14d'] = df['tr'].rolling(window=14).mean()

    # Combine the close price difference, volume ratio, trend, relative strength, momentum, and adaptive volatility into a single factor
    factor = (df['close_ma_10d_diff'] + (df['amount'] * df['vol_ratio_10d'])) * df['volatility_ratio'] + df['trend'] + (df['rs_10d'] - df['rs_30d']) + (df['momentum_10d'] - df['momentum_30d']) - (df['close'] / df['atr_14d'])

    return factor.dropna()
```
