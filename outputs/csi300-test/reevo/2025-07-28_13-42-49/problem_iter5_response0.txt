```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()

    # Calculate the difference between today's close and the 10-day moving average
    df['close_ma_10d_diff'] = df['close'] - df['ma_10d']

    # Calculate the 10-day and 30-day rolling standard deviation of the close price to measure volatility
    df['std_10d'] = df['close'].rolling(window=10).std()
    df['std_30d'] = df['close'].rolling(window=30).std()

    # Calculate the ratio of the 10-day standard deviation to the 30-day standard deviation
    df['volatility_ratio'] = df['std_10d'] / df['std_30d']

    # Calculate the 10-day and 30-day moving averages of the volume
    df['vol_ma_10d'] = df['volume'].rolling(window=10).mean()
    df['vol_ma_30d'] = df['volume'].rolling(window=30).mean()

    # Calculate the ratio of today's volume to the 10-day moving average of the volume
    df['vol_ratio_10d'] = df['volume'] / df['vol_ma_10d']

    # Calculate the trend component by taking the difference between the 10-day and 30-day moving averages
    df['trend'] = df['ma_10d'] - df['ma_30d']

    # Combine the close price difference, volume ratio, and trend into a single factor
    factor = (df['close_ma_10d_diff'] + (df['amount'] * df['vol_ratio_10d'])) * df['volatility_ratio'] + df['trend']

    return factor.dropna()
```
