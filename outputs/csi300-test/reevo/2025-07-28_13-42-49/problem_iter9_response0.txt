```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between today's close and yesterday's close
    df['close_diff'] = df['close'].diff()
    
    # Calculate the exponential moving average of the volume over the past 5 days
    df['ema_volume_5d'] = df['volume'].ewm(span=5, adjust=False).mean()
    
    # Calculate the weighted moving average of the close price over an adaptive window based on liquidity
    adaptive_window = (df['amount'] / df['volume']).rolling(window=10).mean().fillna(10).astype(int)
    weights = [i for i in range(1, max(adaptive_window) + 1)]
    df['wma_close'] = df.apply(lambda row: sum(w * p for w, p in zip(weights[:row['adaptive_window']], row.name - pd.Timedelta(days=row['adaptive_window']):row.name)) / sum(weights[:row['adaptive_window']]) if row['adaptive_window'] > 0 else row['close'], axis=1)
    
    # Calculate the ratio of today's volume to the exponential moving average volume over the past 5 days
    df['vol_ratio'] = df['volume'] / df['ema_volume_5d']
    
    # Calculate the trend component by taking the difference between the current close and the weighted moving average close
    df['trend'] = df['close'] - df['wma_close']
    
    # Combine the close price difference, volume ratio, and trend into a single factor
    factor = df['close_diff'] + (df['amount'] * df['vol_ratio']) - df['trend']
    
    return factor.dropna()
```
