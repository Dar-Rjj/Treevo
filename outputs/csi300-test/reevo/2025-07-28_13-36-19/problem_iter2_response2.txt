```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the typical price (average of high, low, and close)
    typical_price = (df['high'] + df['low'] + df['close']) / 3

    # Calculate the percentage change in the typical price
    pct_change_typical = typical_price.pct_change().fillna(0)

    # Calculate the money flow, which is the typical price multiplied by volume
    money_flow = typical_price * df['volume']

    # Calculate the difference between current and previous money flow
    delta_money_flow = money_flow.diff().fillna(0)

    # Calculate the exponential moving average of the typical price
    ema_typical = typical_price.ewm(span=14, adjust=False).mean()

    # Calculate the weighted average of high, low, and close prices
    weighted_avg = (df['high'] * 0.3 + df['low'] * 0.3 + df['close'] * 0.4)

    # Calculate the exponential moving average of the weighted average
    ema_weighted_avg = weighted_avg.ewm(span=14, adjust=False).mean()

    # Calculate the volatility as the standard deviation of the typical price
    volatility = typical_price.rolling(window=10).std().fillna(0)

    # Combine the percentage change in the typical price, the difference in money flow,
    # the exponential moving average of the typical price, and the volatility
    factor = (pct_change_typical * delta_money_flow) + (ema_typical - ema_weighted_avg) / (volatility + 1e-7)

    return factor
```
