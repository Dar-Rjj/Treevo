```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day and 20-day moving average of closing prices
    df['close_5d_sma'] = df['close'].rolling(window=5).mean()
    df['close_20d_sma'] = df['close'].rolling(window=20).mean()
    
    # Calculate the 10-day standard deviation of daily returns for volatility
    df['daily_return'] = df['close'].pct_change()
    df['volatility_10d'] = df['daily_return'].rolling(window=10).std()
    
    # Momentum factor: difference between 5-day and 20-day moving averages
    df['momentum'] = df['close_5d_sma'] - df['close_20d_sma']
    
    # Smoothed momentum: 5-day moving average of the momentum
    df['smooth_momentum'] = df['momentum'].rolling(window=5).mean()
    
    # Factor: ratio of smoothed momentum to 10-day volatility
    factor = df['smooth_momentum'] / (df['volatility_10d'] + 1e-7)
    
    return factor
```
