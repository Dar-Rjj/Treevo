```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Volume-weighted price
    df['vwp'] = (df['close'] * df['volume']) / df['volume'].sum()

    # Calculate the 5-day and 20-day exponential moving average of volume-weighted prices for smoother trends
    df['EMA_5_vwp'] = df['vwp'].ewm(span=5, adjust=False).mean()
    df['EMA_20_vwp'] = df['vwp'].ewm(span=20, adjust=False).mean()

    # Momentum factor: difference between 5-day and 20-day EMA of volume-weighted prices
    df['momentum_factor'] = df['EMA_5_vwp'] - df['EMA_20_vwp']

    # Relative strength as the ratio of current close to 20-day EMA of volume-weighted price
    df['relative_strength'] = df['close'] / df['EMA_20_vwp']

    # Volatility factor: average true range (ATR)
    df['true_range'] = df[['high', 'low', 'close']].diff(axis=1).abs().max(axis=1)
    df['ATR_20'] = df['true_range'].rolling(window=20).mean()
    df['volatility_factor'] = df['ATR_20']

    # Liquidity factor: 5-day rolling sum of volume
    df['liquidity_factor'] = df['volume'].rolling(window=5).sum()

    # Advanced volume indicator: money flow index (MFI)
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df[df['typical_price'] > df['typical_price'].shift(1)]['money_flow'].fillna(0)
    df['negative_money_flow'] = df[df['typical_price'] < df['typical_price'].shift(1)]['money_flow'].fillna(0)
    df['MFI'] = 100 - (100 / (1 + (df['positive_money_flow'].rolling(window=14).sum() / df['negative_money_flow'].rolling(window=14).sum())))

    # Dynamic weights using entropy-pooled method
    df['momentum_weight'] = df['momentum_factor'].rank(pct=True)
    df['relative_strength_weight'] = df['relative_strength'].rank(pct=True)
    df['volatility_weight'] = df['volatility_factor'].rank(pct=True)
    df['liquidity_weight'] = df['liquidity_factor'].rank(pct=True)
    df['mfi_weight'] = df['MFI'].rank(pct=True)

    # Combine the factors with dynamic weights
    heuristic_factor = (df['momentum_factor'] * df['momentum_weight']) + \
                       (df['relative_strength'] * df['relative_strength_weight']) + \
                       (df['volatility_factor'] * df['volatility_weight']) + \
                       (df['liquidity_factor'] * df['liquidity_weight']) + \
                       (df['MFI'] * df['mfi_weight'])

    return heuristic_factor
```
