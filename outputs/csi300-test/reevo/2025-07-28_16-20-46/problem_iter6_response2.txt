```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day and 20-day simple moving average of closing prices to capture momentum
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Momentum factor: difference between 5-day and 20-day moving averages
    df['momentum_factor'] = df['SMA_5'] - df['SMA_20']

    # Calculate the 20-day standard deviation of closing prices to capture volatility
    df['volatility_factor'] = df['close'].rolling(window=20).std()

    # Calculate the 5-day rolling sum of volume to capture liquidity
    df['liquidity_factor'] = df['volume'].rolling(window=5).sum()

    # Calculate relative strength as the ratio of current close to 20-day SMA
    df['relative_strength'] = df['close'] / df['SMA_20']

    # Calculate market breadth: difference between 5-day and 20-day moving averages of (high - low)
    df['range_5'] = df['high'].rolling(window=5).mean() - df['low'].rolling(window=5).mean()
    df['range_20'] = df['high'].rolling(window=20).mean() - df['low'].rolling(window=20).mean()
    df['market_breadth'] = df['range_5'] - df['range_20']

    # Calculate the 5-day and 20-day skewness of the closing prices
    df['skewness_5'] = df['close'].rolling(window=5).skew()
    df['skewness_20'] = df['close'].rolling(window=20).skew()

    # Skewness factor: difference between 5-day and 20-day skewness
    df['skewness_factor'] = df['skewness_5'] - df['skewness_20']

    # Calculate the 5-day and 20-day kurtosis of the closing prices
    df['kurtosis_5'] = df['close'].rolling(window=5).kurt()
    df['kurtosis_20'] = df['close'].rolling(window=20).kurt()

    # Kurtosis factor: difference between 5-day and 20-day kurtosis
    df['kurtosis_factor'] = df['kurtosis_5'] - df['kurtosis_20']

    # Market microstructure factor: ratio of amount to volume to capture transaction size
    df['microstructure_factor'] = df['amount'] / (df['volume'] + 1e-7)

    # Combine the factors: momentum, volatility, liquidity, relative strength, market breadth, skewness, kurtosis, and microstructure
    heuristic_factor = (
        (df['momentum_factor'] / (df['volatility_factor'] + 1e-7)) * 
        (df['liquidity_factor'] + 1e-7) * 
        df['relative_strength'] * 
        df['market_breadth'] * 
        (df['skewness_factor'] + 1e-7) * 
        (df['kurtosis_factor'] + 1e-7) * 
        (df['microstructure_factor'] + 1e-7)
    )

    return heuristic_factor
```
