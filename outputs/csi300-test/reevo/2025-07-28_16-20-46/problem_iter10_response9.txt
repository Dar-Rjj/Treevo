```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day and 20-day simple moving average of closing prices to capture momentum
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Momentum factor: difference between 5-day and 20-day moving averages
    df['momentum_factor'] = df['SMA_5'] - df['SMA_20']

    # Calculate the 20-day standard deviation of closing prices to capture volatility
    df['volatility_factor'] = df['close'].rolling(window=20).std()

    # Calculate the 5-day rolling sum of volume to capture liquidity
    df['liquidity_factor'] = df['volume'].rolling(window=5).sum()

    # Calculate relative strength as the ratio of current close to 20-day SMA
    df['relative_strength'] = df['close'] / df['SMA_20']

    # Calculate market breadth: difference between 5-day and 20-day moving averages of (high - low)
    df['range_5'] = (df['high'] - df['low']).rolling(window=5).mean()
    df['range_20'] = (df['high'] - df['low']).rolling(window=20).mean()
    df['market_breadth'] = df['range_5'] - df['range_20']

    # Additional technical indicators
    # Calculate the 14-day EMA (Exponential Moving Average)
    df['ema_14'] = df['close'].ewm(span=14, adjust=False).mean()

    # Calculate the 14-day ATR (Average True Range)
    tr = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    df['atr_14'] = tr.rolling(window=14).mean()

    # Calculate the 14-day MACD (Moving Average Convergence Divergence)
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_hist'] = df['macd_line'] - df['signal_line']

    # Adaptive weights for the factors
    df['momentum_weight'] = df['volatility_factor'].rank(pct=True)
    df['liquidity_weight'] = df['liquidity_factor'].rank(pct=True)
    df['relative_strength_weight'] = df['relative_strength'].rank(pct=True)
    df['market_breadth_weight'] = df['market_breadth'].rank(pct=True)

    # Additional adaptive weights for new technical indicators
    df['ema_weight'] = (df['close'] - df['ema_14']).rank(pct=True)
    df['atr_weight'] = df['atr_14'].rank(pct=True)
    df['macd_hist_weight'] = df['macd_hist'].rank(pct=True)

    # Calculate the 5-day and 20-day moving average of price change
    df['price_change'] = df['close'].pct_change()
    df['price_change_SMA_5'] = df['price_change'].rolling(window=5).mean()
    df['price_change_SMA_20'] = df['price_change'].rolling(window=20).mean()

    # Dynamic weights based on the price change
    df['dynamic_weight'] = (df['price_change_SMA_5'] - df['price_change_SMA_20']).rank(pct=True)

    # Incorporate dynamic weights into the final factor
    heuristic_factor = (df['momentum_factor'] * df['momentum_weight']) + \
                       (df['liquidity_factor'] * df['liquidity_weight']) + \
                       (df['relative_strength'] * df['relative_strength_weight']) + \
                       (df['market_breadth'] * df['market_breadth_weight']) + \
                       ((df['close'] - df['ema_14']) * df['ema_weight']) + \
                       (df['atr_14'] * df['atr_weight']) + \
                       (df['macd_hist'] * df['macd_hist_weight'])

    # Use advanced statistical measures
    df['skewness'] = df['close'].rolling(window=20).skew()
    df['kurtosis'] = df['close'].rolling(window=20).kurt()

    # Incorporate skewness and kurtosis into the final
