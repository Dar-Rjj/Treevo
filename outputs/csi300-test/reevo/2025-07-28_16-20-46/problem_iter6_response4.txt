```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price and volume changes
    df['price_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()

    # Calculate the 5-day and 20-day moving standard deviation (volatility) of the closing prices
    df['volatility_5'] = df['close'].rolling(window=5).std()
    df['volatility_20'] = df['close'].rolling(window=20).std()

    # Calculate the ratio of short-term volatility to long-term volatility
    df['volatility_ratio'] = df['volatility_5'] / (df['volatility_20'] + 1e-7)

    # Calculate the leverage as a weighted sum of price change, volume change, and volatility ratio
    leverage = (df['price_change'] + 2 * df['volume_change'] + 3 * df['volatility_ratio']) / 6

    # Calculate the 5-day and 20-day moving average of the closing prices
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()

    # Calculate the trend as the ratio of the 5-day SMA to the 20-day SMA
    df['trend'] = df['sma_5'] / (df['sma_20'] + 1e-7)

    # Calculate momentum as the 20-day rate of change of the closing price
    df['momentum'] = df['close'].pct_change(periods=20)

    # Calculate mean reversion as the 20-day RSI (Relative Strength Index)
    delta = df['close'].diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=20).mean()
    avg_loss = loss.rolling(window=20).mean()
    rs = avg_gain / (avg_loss + 1e-7)
    df['rsi'] = 100 - (100 / (1 + rs))

    # Calculate market sentiment using the high-low ratio
    df['high_low_ratio'] = df['high'] / (df['low'] + 1e-7)

    # Incorporate additional technical indicators
    # Calculate the 14-day EMA (Exponential Moving Average)
    df['ema_14'] = df['close'].ewm(span=14, adjust=False).mean()

    # Calculate the 14-day ATR (Average True Range)
    tr = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    df['atr_14'] = tr.rolling(window=14).mean()

    # Calculate the 14-day MACD (Moving Average Convergence Divergence)
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_hist'] = df['macd_line'] - df['signal_line']

    # Combine all factors with optimized weights
    df['alpha_factor'] = (
        0.3 * leverage * df['trend'] +
        0.2 * df['momentum'] +
        0.1 * (100 - df['rsi']) / 100 +
        0.1 * df['high_low_ratio'] +
        0.15 * (df['ema_14'] - df['close']) / df['close'] +
        0.15 * df['macd_hist'] / (df['atr_14'] + 1e-7)
    )

    return df['alpha_factor']
```
