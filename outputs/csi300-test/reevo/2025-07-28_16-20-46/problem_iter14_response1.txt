```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day and 20-day simple moving average of closing prices to capture momentum
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # Momentum factor: difference between 5-day and 20-day moving averages
    df['momentum_factor'] = df['SMA_5'] - df['SMA_20']

    # Calculate the 20-day standard deviation of closing prices to capture volatility
    df['volatility_factor'] = df['close'].rolling(window=20).std()

    # Calculate the 5-day rolling sum of volume to capture liquidity
    df['liquidity_factor'] = df['volume'].rolling(window=5).sum()

    # Calculate relative strength as the ratio of current close to 20-day SMA
    df['relative_strength'] = df['close'] / df['SMA_20']

    # Calculate market breadth: difference between 5-day and 20-day moving averages of (high - low)
    df['range_5'] = df['high'].rolling(window=5).mean() - df['low'].rolling(window=5).mean()
    df['range_20'] = df['high'].rolling(window=20).mean() - df['low'].rolling(window=20).mean()
    df['market_breadth'] = df['range_5'] - df['range_20']

    # Adaptive weights for the factors
    df['momentum_weight'] = df['volatility_factor'].rank(pct=True)
    df['liquidity_weight'] = df['liquidity_factor'].rank(pct=True)
    df['relative_strength_weight'] = df['relative_strength'].rank(pct=True)
    df['market_breadth_weight'] = df['market_breadth'].rank(pct=True)

    # Calculate a dynamic weight adjustment factor based on the overall market trend
    df['trend_factor'] = df['SMA_20'].pct_change(periods=20)
    df['trend_weight'] = df['trend_factor'].rank(pct=True)

    # Incorporate a dynamic volume factor to adjust for trading activity
    df['volume_change'] = df['volume'].pct_change(periods=5)
    df['volume_weight'] = df['volume_change'].rank(pct=True)

    # Price acceleration: second derivative of the close price
    df['price_acceleration'] = df['close'].diff().diff()
    df['acceleration_weight'] = df['price_acceleration'].rank(pct=True)

    # Money flow index (MFI) for 14 days to capture buying and selling pressure
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    positive_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)
    positive_flow_14 = positive_flow.rolling(window=14).sum()
    negative_flow_14 = negative_flow.rolling(window=14).sum()
    money_ratio = positive_flow_14 / negative_flow_14
    df['MFI'] = 100 - (100 / (1 + money_ratio))
    df['MFI_weight'] = df['MFI'].rank(pct=True)

    # Additional factor: Average True Range (ATR) to capture market volatility
    df['true_range'] = df[['high', 'low']].apply(lambda x: max(x['high'], x.shift(1)['close']) - min(x['low'], x.shift(1)['close']), axis=1)
    df['ATR'] = df['true_range'].rolling(window=14).mean()
    df['ATR_weight'] = df['ATR'].rank(pct=True)

    # Combine the factors with adaptive weights, trend weight, and volume weight
    heuristic_factor = (
        (df['momentum_factor'] * df['momentum_weight']) +
        (df['liquidity_factor'] * df['liquidity_weight']) +
        (df['relative_strength'] * df['relative_strength_weight']) +
        (df['market_breadth'] * df['market_breadth_weight']) +
        (df['price_acceleration'] * df['acceleration_weight']) +
        (df['MFI'] * df['MFI_weight']) +
        (df['ATR'] * df['ATR_weight'])
    ) * (df['trend_weight'] + df
