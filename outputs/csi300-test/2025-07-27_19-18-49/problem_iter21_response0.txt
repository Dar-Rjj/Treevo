```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=20, m=30, L=100):
    # Calculate Momentum Components
    df['Close_Mom'] = (df['close'] / df['close'].shift(n)) - 1
    df['Open_Mom'] = (df['open'] / df['open'].shift(n)) - 1
    df['Volume_Mom'] = (df['volume'] / df['volume'].shift(n)) - 1
    df['HL_Range'] = df['high'] - df['low']
    df['HL_Range_Mom'] = (df['HL_Range'] / df['HL_Range'].shift(n)) - 1
    
    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Calculate Open-Adjusted Daily Log Return
    df['open_adj_log_return'] = df['log_return'] - (np.log(df['open']) - np.log(df['close'].shift(1)))
    
    # Multiply Open-Adjusted Log Return by Volume
    df['vol_adj_open_log_return'] = df['open_adj_log_return'] * df['volume']
    
    # Sum Over N Days
    df['sum_vol_adj_open_log_return'] = df['vol_adj_open_log_return'].rolling(window=n).sum()
    
    # Weight by Recent Trading Activity
    df['avg_volume_m'] = df['volume'].rolling(window=m).mean()
    df['avg_volume_L'] = df['volume'].rolling(window=L).mean()
    df['volume_weight'] = df['avg_volume_m'] / df['avg_volume_L']
    
    # Detect Volume Shocks
    df['daily_return'] = df['close'].pct_change()
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['avg_vol_change_30'] = df['volume_change'].rolling(window=30).mean()
    df['vol_shock'] = (df['volume_change'] > 2 * df['avg_vol_change_30']).astype(int)
    
    # Detect High-Low Range Shocks
    df['hl_range_change'] = df['HL_Range'] - df['HL_Range'].shift(1)
    df['avg_hl_range_change_30'] = df['hl_range_change'].rolling(window=30).mean()
    df['hl_range_shock'] = (df['hl_range_change'] > 2 * df['avg_hl_range_change_30']).astype(int)
    
    # Combine Indicators
    df['momentum_factor'] = (df['Close_Mom'] + df['Open_Mom'] + df['Volume_Mom'] + df['HL_Range_Mom']) * df['volume_weight']
    df['alpha_factor'] = df['momentum_factor'] * df['vol_shock'] * df['hl_range_shock']
    
    return df['alpha_factor'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
```
