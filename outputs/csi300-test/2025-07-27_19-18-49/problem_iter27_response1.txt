```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=20, m=30, L=180):
    # Calculate Momentum Components
    close_momentum = df['close'] / df['close'].shift(n)
    open_momentum = df['open'] / df['open'].shift(n)
    volume_momentum = df['volume'] / df['volume'].shift(n)

    # Calculate Daily Log Return
    daily_log_return = np.log(df['close']) - np.log(df['close'].shift(1))

    # Calculate Open-Adjusted Daily Log Return
    open_adjusted_log_return = daily_log_return - (np.log(df['open']) - np.log(df['close'].shift(1)))

    # Multiply Open-Adjusted Log Return by Volume
    open_adj_volume = open_adjusted_log_return * df['volume']

    # Sum Over N Days
    cum_sum = open_adj_volume.rolling(n).sum()

    # Weight by Recent Trading Activity
    avg_vol_short = df['volume'].rolling(m).mean()
    avg_vol_long = df['volume'].rolling(L).mean()
    vol_weight = avg_vol_short / avg_vol_long

    # Detect Volume Shocks
    volume_change = df['volume'] - df['volume'].shift(1)
    avg_volume_change_30 = volume_change.rolling(30).mean()
    threshold_volume_shock = 2 * avg_volume_change_30
    volume_shock = (volume_change > threshold_volume_shock).astype(int)

    # Detect Volatility
    daily_return = df['close'].pct_change()
    rolling_std_dev = daily_return.rolling(20).std()
    historical_std_dev = rolling_std_dev.expanding().mean()
    high_volatility_threshold = 2 * historical_std_dev
    high_volatility = (rolling_std_dev > high_volatility_threshold).astype(int)

    # Combine Indicators
    momentum_sum = (close_momentum + open_momentum + volume_momentum) * vol_weight
    combined_factor = momentum_sum * (1 + volume_shock) * (1 + high_volatility)

    return combined_factor
```
