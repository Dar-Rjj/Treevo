```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=5, m=10, L=30, N=20):
    # Calculate Momentum Components
    df['Close_Momentum'] = (df['close'] / df['close'].shift(n)) - 1
    df['Open_Momentum'] = (df['open'] / df['open'].shift(n)) - 1
    df['Volume_Momentum'] = (df['volume'] / df['volume'].shift(n)) - 1
    df['High_Low_Range'] = df['high'] - df['low']
    df['High_Low_Range_Momentum'] = (df['High_Low_Range'] / df['High_Low_Range'].shift(n)) - 1

    # Calculate Daily Log Return
    df['Log_Return'] = np.log(df['close']) - np.log(df['close'].shift(1))

    # Adjust Log Return by Open Price
    df['Open_Adjusted_Log_Return'] = df['Log_Return'] - np.log(df['open']) + np.log(df['close'].shift(1))

    # Multiply Open-Adjusted Log Return by Volume
    df['Volume_Adjusted_Log_Return'] = df['Open_Adjusted_Log_Return'] * df['volume']

    # Weight by Recent Trading Activity
    df['Avg_Volume_m_days'] = df['volume'].rolling(m).mean()
    df['Avg_Volume_L_days'] = df['volume'].rolling(L).mean()
    df['Weight'] = df['Avg_Volume_m_days'] / df['Avg_Volume_L_days']

    # Detect Volume Shocks
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Avg_Volume_Change_30_days'] = df['Volume_Change'].rolling(30).mean()
    df['Volume_Shock'] = (df['Volume_Change'] > 2 * df['Avg_Volume_Change_30_days']).astype(int)

    # Detect High-Low Range Shocks
    df['High_Low_Range_Change'] = df['High_Low_Range'] - df['High_Low_Range'].shift(1)
    df['Avg_High_Low_Range_Change_30_days'] = df['High_Low_Range_Change'].rolling(30).mean()
    df['High_Low_Range_Shock'] = (df['High_Low_Range_Change'] > 2 * df['Avg_High_Low_Range_Change_30_days']).astype(int)

    # Integrate Price, Volume, and Close Momentum with Open-Price Integration
    df['Integrated_Momentum'] = (df['close'] - df['open']) / df['open'] + (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['5_Day_Agg_Momentum'] = df['Integrated_Momentum'].rolling(5).sum() / 5

    # Combine Indicators
    df['Momentum_Sum'] = (
        df['Close_Momentum'] * df['Weight'] +
        df['Open_Momentum'] * df['Weight'] +
        df['Volume_Momentum'] * df['Weight'] +
        df['High_Low_Range_Momentum'] * df['Weight']
    )
    df['Momentum_Sum'] *= (df['Volume_Shock'] + 1) * (df['High_Low_Range_Shock'] + 1)
    df['Momentum_Sum'] *= df['5_Day_Agg_Momentum'] * (df['close'] - df['close'].shift(1)) / df['close'].shift(1) * (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1) * (df['high'] - df['low'])

    # Cumulative Sum of Volume-Weighted Adjusted Returns
    df['Volume_Weighted_Adjusted_Return'] = df['Volume_Adjusted_Log_Return'] * df['Weight']
    df['Cumulative_Sum'] = df['Volume_Weighted_Adjusted_Return'].rolling(N).sum()

    return df['Momentum_Sum'] * df['Cumulative_Sum']
```
