```python
import pandas as pd

def heuristics_v2(df, n=10, m=20, L=50):
    # Calculate Momentum Components
    close_momentum = df['close'].pct_change(periods=n)
    open_momentum = df['open'].pct_change(periods=n)
    volume_momentum = df['volume'].pct_change(periods=n)

    # Weight by Recent Trading Activity
    avg_volume_recent = df['volume'].rolling(window=m).mean()
    avg_volume_long_term = df['volume'].rolling(window=L).mean()
    volume_weight = (avg_volume_recent / avg_volume_long_term) - 1

    # Combine Momentum and Volume Weights
    close_momentum_weighted = close_momentum * volume_weight
    open_momentum_weighted = open_momentum * volume_weight
    total_factor = close_momentum_weighted + open_momentum_weighted + volume_momentum

    return total_factor
```
