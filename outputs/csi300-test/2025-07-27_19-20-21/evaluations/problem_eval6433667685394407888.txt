def heuristics_v2(df):
    # Calculate the 14-period Rate of Change (ROC)
    roc_14 = (df['close'] - df['close'].shift(14)) / df['close'].shift(14) * 100
    
    # Calculate the 14-period Average True Range (ATR)
    tr = pd.DataFrame({'H-L': df['high'] - df['low'], 
                       'H-Cp': abs(df['high'] - df['close'].shift(1)), 
                       'L-Cp': abs(df['low'] - df['close'].shift(1))}).max(axis=1)
    atr_14 = tr.rolling(window=14).mean()
    
    # Calculate the 28-period Weighted Moving Average (WMA) of the close price
    wma_28 = df['close'].rolling(window=28).apply(lambda x: np.dot(x, list(range(1, 29))) / 28 * 27, raw=True)
    
    # Combine ROC, ATR, and WMA into a single heuristic matrix
    heuristics_matrix = 0.5 * roc_14 + 0.3 * (1 - atr_14 / df['close']) + 0.2 * (wma_28 - df['close']) / df['close']
    
    return heuristics_matrix
