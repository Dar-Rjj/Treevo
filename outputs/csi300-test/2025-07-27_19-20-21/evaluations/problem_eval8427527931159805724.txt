import numpy as np
    # Calculate the median of the closing prices over the past 30 days
    med_close = df['close'].rolling(window=30).median()
    
    # Compute the natural logarithm of the closing price divided by its median
    log_price = np.log(df['close'] / med_close)
    
    # Calculate the natural logarithm of the volume
    log_vol = np.log(df['volume'])
    
    # Calculate the mean of the log volumes over the past 60 days
    mean_log_vol = log_vol.rolling(window=60).mean()
    
    # Calculate the difference between the log of today's volume and the mean of log volumes
    vol_diff = log_vol - mean_log_vol
    
    # Combine the factors into a single heuristics matrix
    heuristics_matrix = log_price + vol_diff
    
    return heuristics_matrix
