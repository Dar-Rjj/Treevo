def heuristics_v2(df):
    # Calculate the Money Flow Index (MFI)
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow = typical_price * df['volume']
    positive_money_flow = money_flow.where(typical_price > typical_price.shift(1), 0).rolling(window=14).sum()
    negative_money_flow = money_flow.where(typical_price < typical_price.shift(1), 0).rolling(window=14).sum()
    mfi = 100 - (100 / (1 + (positive_money_flow / negative_money_flow)))
    
    # Calculate the Commodity Channel Index (CCI)
    tp_rolling_mean = typical_price.rolling(window=20).mean()
    mean_deviation = (typical_price - tp_rolling_mean).abs().rolling(window=20).mean()
    cci = (typical_price - tp_rolling_mean) / (0.015 * mean_deviation)
    
    # Combine MFI and CCI into a single heuristic matrix
    heuristics_matrix = 0.5 * mfi + 0.5 * cci
    
    return heuristics_matrix
