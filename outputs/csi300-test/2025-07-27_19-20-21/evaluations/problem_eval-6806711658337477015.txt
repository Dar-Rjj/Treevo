def heuristics_v2(df):
    # Calculate Stochastic Oscillator
    low_14 = df['low'].rolling(window=14).min()
    high_14 = df['high'].rolling(window=14).max()
    k = 100 * ((df['close'] - low_14) / (high_14 - low_14))
    
    # Calculate On-Balance Volume
    obv = df['volume'].copy()
    obv[1:] = obv[1:].where(df['close'].diff(1) >= 0, -obv[1:])
    obv = obv.cumsum()
    
    # Calculate Bollinger Bands
    ma_20 = df['close'].rolling(window=20).mean()
    std_20 = df['close'].rolling(window=20).std()
    upper_band = ma_20 + 2 * std_20
    lower_band = ma_20 - 2 * std_20
    bb = (df['close'] - lower_band) / (upper_band - lower_band)
    
    # Combine SO, OBV, and BB into a single heuristic matrix
    heuristics_matrix = 0.4 * k + 0.3 * obv + 0.3 * bb
    
    return heuristics_matrix
