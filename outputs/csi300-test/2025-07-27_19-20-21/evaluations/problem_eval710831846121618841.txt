def heuristics_v2(df):
    # Calculate simple moving averages with different windows
    sma_short = df['close'].rolling(window=20).mean()
    sma_long = df['close'].rolling(window=50).mean()
    
    # Calculate the difference between short and long SMAs
    sma_diff = sma_short - sma_long
    
    # Calculate the rate of change over 20 periods
    roc_20 = df['close'].pct_change(periods=20)
    
    # Calculate the average true range over 21 periods
    tr = df['high'] - df['low']
    atr_21 = tr.rolling(window=21).mean()
    
    # Combine the factors into a single heuristics matrix with new weights
    heuristics_matrix = 0.6 * sma_diff + 0.2 * roc_20 - 0.2 * atr_21
    
    return heuristics_matrix
