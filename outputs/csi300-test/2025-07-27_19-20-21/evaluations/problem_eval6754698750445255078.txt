def heuristics_v2(df):
    # Calculate EMA
    ema = df['close'].ewm(span=14, adjust=False).mean()
    
    # Calculate OBV
    obv = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    
    # Calculate ADX
    tr = np.maximum((df['high'] - df['low']), np.abs(df['high'] - df['close'].shift(1)), np.abs(df['low'] - df['close'].shift(1)))
    atr = tr.rolling(window=14).mean()
    plus_dm = df['high'].diff().where(df['high'].diff() > 0, 0)
    minus_dm = -df['low'].diff().where(df['low'].diff() < 0, 0)
    plus_di = 100 * (plus_dm.rolling(window=14).sum() / atr)
    minus_di = 100 * (minus_dm.rolling(window=14).sum() / atr)
    dx = 100 * (np.abs(plus_di - minus_di) / (plus_di + minus_di))
    adx = dx.rolling(window=14).mean()
    
    # Combine EMA, OBV, and ADX into a single heuristic matrix
    heuristics_matrix = 0.4 * ema + 0.3 * obv + 0.3 * adx
    
    return heuristics_matrix
