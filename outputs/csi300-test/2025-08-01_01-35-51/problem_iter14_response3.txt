```python
import pandas as pd
import numpy as np
from scipy.stats import rankdata

def heuristics_v2(df):
    # Calculate Intraday Price Range
    df['Intraday_Price_Range'] = df['high'] - df['low']
    
    # Compute Intraday Return
    df['Intraday_Return'] = df['close'] - df['open']
    
    # Determine Intraday Volatility
    df['Intraday_Volatility'] = (df['high'] - df['low']) / df['close']
    
    # Adjust Volatility by Volume
    df['Adjusted_Volatility'] = df['Intraday_Volatility'] * df['volume']
    
    # Calculate Short-Term Momentum
    df['Short_Term_Momentum'] = df['close'] - df['close'].shift(1)
    
    # Calculate Long-Term Momentum
    df['Long_Term_Momentum'] = df['close'] - df['close'].shift(5)
    
    # Combine Intraday Return, Adjusted Volatility, and Momentum
    df['Combined_Value'] = (df['Intraday_Return'] - df['Adjusted_Volatility'] + 
                             df['Short_Term_Momentum'] + df['Long_Term_Momentum'])
    
    # Generate Final Alpha Factor
    df['Indicator'] = (df['Combined_Value'] > 0).astype(int)
    
    # Calculate Average Volume over 5 days
    df['Average_Volume'] = df['volume'].rolling(window=5).mean()
    
    # Relative Volume
    df['Relative_Volume'] = df['volume'] / df['Average_Volume']
    
    # Apply Dynamic Weighting
    df['Final_Alpha_Factor'] = df['Indicator'] * df['Relative_Volume']
    
    # Integrate More Market Indicators
    # Calculate RSI
    def rsi(series, period=14):
        delta = series.diff(1)
        gain = delta.where(delta > 0, 0)
        loss = -delta.where(delta < 0, 0)
        avg_gain = gain.rolling(window=period).mean()
        avg_loss = loss.rolling(window=period).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))
    
    df['RSI'] = rsi(df['close'])
    
    # Calculate MACD
    df['EMA_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['EMA_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = df['EMA_12'] - df['EMA_26']
    
    # Calculate ATR
    df['True_Range'] = df[['high', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['ATR'] = df['True_Range'].rolling(window=14).mean()
    
    # Use Rolling Windows for Momentum
    df['Short_Term_Rolling_Momentum'] = df['close'].rolling(window=5).apply(lambda x: x[-1] - x[0], raw=True)
    df['Long_Term_Rolling_Momentum'] = df['close'].rolling(window=20).apply(lambda x: x[-1] - x[0], raw=True)
    
    # Apply Machine Learning for Dynamic Weighting (simplified example with equal weights)
    factors = ['Intraday_Return', 'Adjusted_Volatility', 'Short_Term_Momentum', 'Long_Term_Momentum', 
               'RSI', 'MACD', 'ATR', 'Short_Term_Rolling_Momentum', 'Long_Term_Rolling_Momentum']
    df['Weighted_Sum'] = df[factors].sum(axis=1)  # Replace with actual ML model predictions
    
    # Generate Final Alpha Factor
    df['Final_Alpha_Factor'] = (df['Weighted_Sum'] > 0).astype(int)
    
    # Output Final Alpha Factor
    final_alpha_factor = df['Final_Alpha_Factor']
    
    return final_alpha_factor
```
