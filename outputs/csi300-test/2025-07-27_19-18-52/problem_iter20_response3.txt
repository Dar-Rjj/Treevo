```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute Intraday Dynamics
    intraday_price_range = df['high'] - df['low']
    intraday_return = df['close'] - df['open']
    intraday_trading_range = df['high'] - df['low']

    # Compute Volume-Weighted Average Metrics
    lookback_period = 20
    vwma_close = (df['close'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    vwap = ((df['high'] + df['low'] + df['close']) / 3 * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()

    # Integrate Intraday and Daily Momentum with Volume-Weighted Metrics
    intraday_price_range_vwap = intraday_price_range * vwap
    intraday_return_trading_range = intraday_return * intraday_trading_range
    volume_intensity_score = df['volume'] / (df['high'] - df['low'])

    composite_factor = (intraday_price_range_vwap + intraday_return_trading_range) * volume_intensity_score

    # Adjusted Composite Momentum Factor
    adjusted_composite_momentum = (intraday_return + intraday_trading_range) * volume_intensity_score

    # Integrate Adjusted Composite Momentum Factor with VWMA
    integrated_factor = adjusted_composite_momentum * vwma_close - vwma_close

    # Calculate Daily Momentum
    daily_momentum = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)

    # Determine if Today's Volume is a Shock
    avg_volume = df['volume'].rolling(window=lookback_period).mean()
    volume_shock = (df['volume'] > 1.5 * avg_volume).astype(int)

    # Determine if Today's Close Price is a Shock
    avg_close = df['close'].rolling(window=lookback_period).mean()
    price_shock = (df['close'] > 1.5 * avg_close).astype(int)

    # Determine if Today's Volume is a Surge
    median_volume = df['volume'].rolling(window=lookback_period).median()
    volume_surge = (df['volume'] > 2 * median_volume).astype(int)

    # Determine if Today's High Price is a Breakout
    highest_high = df['high'].rolling(window=lookback_period).max()
    price_breakout = (df['high'] > highest_high).astype(int)

    # Final Alpha Factor
    alpha_factor = (composite_factor * daily_momentum 
                    * volume_shock * price_shock 
                    * volume_surge * price_breakout)

    return alpha_factor
```
