```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    df['intraday_return'] = df['close'] - df['open']
    
    # Intraday Trading Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Volume Intensity Score
    df['volume_intensity'] = df['volume'] / (df['high'] - df['low']).clip(lower=1e-6)
    
    # Composite Momentum Factor
    df['composite_momentum'] = (df['intraday_return'] * 
                                df['intraday_range'] * 
                                df['volume_intensity']) + 1e-6
    
    # Compute Volume-Weighted Moving Average (VWMA) of Close Prices
    lookback_period = 20
    df['vwap'] = (df['close'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    
    # Adjust Composite Momentum Factor with VWMA
    df['adjusted_composite_momentum'] = df['composite_momentum'] - df['vwap']
    
    # Incorporate Short-Term Price Trend
    df['short_term_trend'] = df['close'].rolling(window=5).mean()
    df['trend_adjusted_momentum'] = df['adjusted_composite_momentum'] - df['short_term_trend']
    
    # Combine Short-Term Trend and VWMA Adjusted Momentum
    df['combined_factor'] = df['trend_adjusted_momentum'] * df['adjusted_composite_momentum']
    
    # Calculate Daily Return
    df['daily_return'] = df['close'].diff().fillna(0)
    
    # Integrate Daily Return with Composite Momentum Factor
    weighting_factor = 0.5
    df['final_factor'] = df['daily_return'] * weighting_factor + df['combined_factor']
    
    return df['final_factor']
```
