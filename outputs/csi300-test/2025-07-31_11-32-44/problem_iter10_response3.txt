```python
import pandas as pd

def heuristics_v2(df, N=20, M=10, snr_threshold=0.5):
    """
    Generate an alpha factor that combines Enhanced Price Momentum with Volume-Adjusted Intraday Return.
    
    Parameters:
    df (pd.DataFrame): DataFrame with columns (open, high, low, close, amount, volume) and index (date).
    N (int): Number of days to look back for the price momentum calculation.
    M (int): Smoothing factor for the exponential moving average.
    snr_threshold (float): Signal-to-noise ratio threshold to filter out weak signals.
    
    Returns:
    pd.Series: Alpha factor values indexed by (date).
    """
    # Calculate N-day Close Price Percent Change
    df['close_pct_change_N'] = df['close'].pct_change(periods=N)
    
    # Apply M-day Exponential Moving Average to N-day Percent Change
    df['enhanced_price_momentum'] = df['close_pct_change_N'].ewm(span=M, adjust=False).mean()
    
    # Compute Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    
    # Weight by Volume
    df['volume_adjusted_intraday_return'] = df['intraday_return'] / df['volume']
    
    # Combine Metrics
    df['alpha_factor'] = df['enhanced_price_momentum'] * df['volume_adjusted_intraday_return']
    
    # Introduce Signal-to-Noise Filter
    df['alpha_factor'] = df['alpha_factor'].apply(lambda x: x if abs(x) >= snr_threshold else 0)
    
    return df['alpha_factor']
```
