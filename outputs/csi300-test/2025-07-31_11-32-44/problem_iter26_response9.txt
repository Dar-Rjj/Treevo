```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Momentum
    df['DailyMomentum'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate 5-Period Moving Average of Price Momentum
    df['5DayMomentumMA'] = df['DailyMomentum'].rolling(window=5).mean()
    
    # Calculate Volume Weighted Average Price (VWAP)
    df['TypicalPrice'] = (df['high'] + df['low']) / 2
    df['CumTPxVolume'] = (df['TypicalPrice'] * df['volume']).cumsum()
    df['CumVolume'] = df['volume'].cumsum()
    df['VWAP'] = df['CumTPxVolume'] / df['CumVolume']
    
    # Combine Daily Momentum and VWAP-Close Difference
    df['MomentumVWAPDiff'] = df['DailyMomentum'] * (df['VWAP'] - df['close'])
    
    # Confirm with Volume
    df['VolumeChange'] = df['volume'].pct_change().fillna(0)
    df['MomentumVWAPVol'] = df['MomentumVWAPDiff'] * np.log(df['VolumeChange'] + 1)
    
    # Calculate Intraday High-Low Spread
    df['IntradayHighLowSpread'] = df['high'] - df['low']
    
    # Compute M-day Average of N-day Close Price Percent Change
    N = 21
    M = 10
    df['NDayReturn'] = (df['close'] / df['close'].shift(N) - 1)
    df['MDayAverageNDayReturn'] = df['NDayReturn'].rolling(window=M).mean()
    
    # Combine Intraday High-Low Spread and Momentum
    df['HighLowSpreadMomentum'] = df['IntradayHighLowSpread'] * df['MDayAverageNDayReturn']
    
    # Adjust with Smoothed Volume
    df['SmoothedVolume'] = df['volume'].ewm(span=21, adjust=False).mean()
    df['AdjustedHighLowSpreadMomentum'] = df['HighLowSpreadMomentum'] * (df['volume'] / df['SmoothedVolume'])
    
    # Calculate Intraday Reversal
    df['IntradayReversal'] = (df['close'] - df['open']) - (df['close'].shift(1) - df['open'].shift(1))
    
    # Introduce Intraday Range Volatility
    P = 20
    df['IntradayRangeVolatility'] = df['IntradayHighLowSpread'].rolling(window=P).std()
    
    # Synthesize All Factors
    df['SynthesizedFactor'] = df['MomentumVWAPVol'] * df['IntradayReversal'] * df['IntradayRangeVolatility']
    
    # Integrate with Stochastic Oscillator
    df['KLine'] = (df['close'] - df['low'].rolling(window=14).min()) / (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min())
    df['DLine'] = df['KLine'].rolling(window=3).mean()
    df['StochasticOscillator'] = 0.5 * (df['KLine'] + df['DLine'])
    df['FinalSynthesizedFactor'] = df['SynthesizedFactor'] * df['StochasticOscillator'] * np.sign(df['VolumeChange'])
    
    # Calculate Raw Momentum
    df['RawMomentum'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    
    # Calculate Enhanced Raw Momentum
    N = 21
    df['NDayCloseReturn'] = (df['close'] / df['close'].shift(N) - 1)
    df['ExponentialWeightedMomentum'] = (df['close'] - df['close'].shift(30)) / df['close'].shift(30)
    df['EnhancedRawMomentum'] = df['NDayCloseReturn'] * df['ExponentialWeightedMomentum']
    
    # Calculate Volume Delta
    df['VolumeDelta'] = df['volume'] - df['volume'].shift(20)
    
    # Calculate High-Low Range
    df['HighLowRange'] = df['high'] - df['low']
    
    # Calculate Intraday Volatility
    df['IntradayVolatility'] = (df['high'] - df['low']) / df['close']
    

