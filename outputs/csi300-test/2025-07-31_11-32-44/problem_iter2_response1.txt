```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Parameters
    N = 10  # Number of days for price percent change
    M = 5   # Number of days for averaging the price percent change
    lag = 1 # Lag for volume change
    window = 21  # Window for Z-score calculation

    # Calculate N-day Close Price Percent Change
    df['N_day_close_pct_change'] = df['close'].pct_change(periods=N)

    # Calculate M-day Average of N-day Close Price Percent Change
    df['M_day_avg_N_day_close_pct_change'] = df['N_day_close_pct_change'].rolling(window=M).mean()

    # Calculate High-Low Range
    df['high_low_range'] = df['high'] - df['low']

    # Combine High-Low Range and Price Momentum
    df['combined_factor'] = df['high_low_range'] * df['M_day_avg_N_day_close_pct_change']

    # Calculate Volume Change
    df['volume_change'] = df['volume'].pct_change(periods=lag)

    # Compute Z-score of Volume Change
    df['z_score_volume_change'] = (df['volume_change'] - df['volume_change'].rolling(window=window).mean()) / df['volume_change'].rolling(window=window).std()

    # Adjust the combined factor by Z-score of Volume Change
    df['adjusted_factor'] = df['combined_factor'] * df['z_score_volume_change']

    # Return the final factor
    return df['adjusted_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
```
