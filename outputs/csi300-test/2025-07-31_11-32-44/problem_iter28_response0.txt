```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    df['price_momentum'] = df['close'].diff()
    
    # Calculate Moving Average Crossover
    n = 20  # Number of days for the moving average
    df['moving_average'] = df['close'].rolling(window=n).mean()
    df['above_moving_average'] = (df['close'] > df['moving_average']).astype(int)
    
    # Compute Volume Spike Indicator
    m = 10  # Number of days for the volume average
    df['average_volume'] = df['volume'].rolling(window=m).mean()
    df['volume_spike'] = df['volume'] / df['average_volume']
    
    # Assess Volume-Price Confirmation
    df['price_increase'] = (df['close'] > df['open']).astype(int)
    df['volume_price_confirmation'] = df['price_increase'] * (df['volume'] > df['average_volume']).astype(int)
    
    # Measure Gap Analysis
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Check if the gap was filled during the day
    df['gap_filled'] = (df['open'] > df['close']) & (df['low'] < df['close'].shift(1)) | (df['open'] < df['close']) & (df['high'] > df['close'].shift(1))
    df['gap_fill_indicator'] = df['gap_filled'].astype(int)
    
    # Integrate indicators into a single score
    weight_price_momentum = 0.3
    weight_above_moving_average = 0.2
    weight_volume_spike = 0.2
    weight_volume_price_confirmation = 0.1
    weight_gap_fill_indicator = 0.2
    
    df['composite_alpha_factor'] = (
        df['price_momentum'] * weight_price_momentum +
        df['above_moving_average'] * weight_above_moving_average +
        df['volume_spike'] * weight_volume_spike +
        df['volume_price_confirmation'] * weight_volume_price_confirmation +
        df['gap_fill_indicator'] * weight_gap_fill_indicator
    )
    
    return df['composite_alpha_factor']
```
