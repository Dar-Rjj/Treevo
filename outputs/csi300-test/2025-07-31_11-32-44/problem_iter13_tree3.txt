```txt
Integrated Intraday and Long-Term Momentum with Volume-Weighted Adjustments
├── Calculate Intraday High-Low Spread
│   ├── Use High price
│   └── Subtract Low price
├── Calculate Previous Day's Intraday High-Low Spread
│   ├── Use Shifted High price by 1 period
│   └── Subtract shifted Low price by 1 period
├── Calculate Intraday Momentum
│   ├── Use Intraday High-Low Spread
│   └── Subtract Previous Day's Intraday High-Low Spread
├── Calculate 1-Period Return
│   ├── Use Close price
│   └── Subtract shifted Close price by 1 period
├── Calculate 5-Period Moving Average of Returns
│   ├── Sum of 5 consecutive 1-Period Returns
│   └── Divide by 5
├── Calculate N-day Price Momentum
│   ├── Use Close price
│   └── Compute N-day (e.g., 21) Close Price Percent Change
├── Calculate M-day Averaged N-day Price Momentum
│   ├── Use computed N-day Percent Change
│   └── Choose M (e.g., 5)
├── Calculate Volume Weighted Average Price (VWAP)
│   ├── Multiply (High + Low) / 2 by Volume for each day
│   └── Divide Aggregated (High + Low) / 2 * Volume by Total Volume
├── Calculate VWAP to Close Difference
│   ├── Subtract VWAP from Close price
│   └── Use Result as VWAP-Close Difference
├── Generate Alpha Factor Component
│   ├── Use 5-Period Moving Average of Returns
│   └── Multiply by sign of (Volume Change + Amount Change)
│       ├── Calculate Volume Change
│       │   ├── Use Volume
│       │   └── Subtract shifted Volume by 1 period
│       ├── Calculate Amount Change
│       │   ├── Use Amount
│       │   └── Subtract shifted Amount by 1 period
├── Combine Intraday and Long-Term Momentum
│   ├── Use Intraday Momentum
│   └── Add to M-day Averaged N-day Price Momentum
├── Adjust with High-Low Range and Volume
│   ├── Multiply High-Low Range by Combined Momentum
│   │   ├── Use Intraday High-Low Spread
│   │   └── Use M-day Averaged N-day Price Momentum
│   └── Compare with Volume Weighted Adjustment
│       ├── Use VWAP-Close Difference
│       └── Multiply by sign of (Volume Change + Amount Change)
└── Combine All Factors
    ├── Multiply Combined Momentum by Adjusted High-Low Range and Volume
    ├── Multiply the result by VWAP-Close Difference
    └── Use the final product as the alpha factor
```
