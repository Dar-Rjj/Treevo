```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Spread
    df['intraday_high_low_spread'] = df['high'] - df['low']
    
    # Calculate Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Intraday Volatility (Average True Range over a period)
    df['true_range'] = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    # Calculate Intraday Momentum
    df['intraday_momentum'] = df['intraday_high_low_spread'] - df['intraday_high_low_spread'].shift(1)
    
    # Calculate Intraday Reversal
    df['intraday_reversal'] = (df['close'] - df['open']) - (df['close'].shift(1) - df['open'].shift(1))
    df['intraday_reversal'] = df['intraday_reversal'] * df['intraday_momentum']
    
    # Calculate Volume Trend
    df['volume_ema_5'] = df['volume'].ewm(span=5, adjust=False).mean()
    
    # Compute Volume Reversal Component
    df['volume_sentiment'] = np.where(df['volume'] > df['volume_ema_5'], 1, -1)
    df['volume_reversal'] = df['intraday_return'] * df['volume_sentiment']
    
    # Introduce Intraday Gap Factor
    df['intraday_gap'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Incorporate Transaction Amount
    df['amount_sma_5'] = df['amount'].rolling(window=5).mean()
    df['transaction_amount_sentiment'] = np.where(df['amount'] > df['amount_sma_5'], 1, -1)
    df['transaction_amount_component'] = df['intraday_return'] * df['transaction_amount_sentiment']
    
    # Calculate Intraday Price Efficiency
    df['intraday_price_efficiency'] = (df['high'] - df['close']) / (df['high'] - df['low'])
    df['intraday_price_efficiency'] = df['intraday_price_efficiency'] + (df['close'] - df['low']) / (df['high'] - df['low'])
    
    # Incorporate Intraday Price Efficiency
    df['intraday_price_efficiency_change'] = df['intraday_price_efficiency'] - df['intraday_price_efficiency'].shift(1)
    df['intraday_price_efficiency_component'] = df['intraday_return'] * df['intraday_price_efficiency_change']
    
    # Compute N-day Close Price Percent Change
    n = 5
    df['n_day_close_percent_change'] = (df['close'] / df['close'].shift(n) - 1)
    
    # Apply M-day Exponential Moving Average to N-day Percent Change
    m = 7
    df['n_day_close_percent_change_ema'] = df['n_day_close_percent_change'].ewm(span=m, adjust=False).mean()
    
    # Calculate Volume-Adjusted Intraday Return
    df['volume_adjusted_intraday_return'] = (df['high'] - df['low']) / df['low'] / df['volume']
    
    # Introduce Overnight Sentiment
    df['overnight_sentiment'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Combine All Components
    alpha_factor = (
        df['intraday_return'] * df['intraday_range'] * df['atr_14'] +
        df['intraday_reversal'] +
        df['volume_reversal'] +
        df['intraday_gap'] +
        df['transaction_amount_component'] +
        df['intraday_price_efficiency_component'] +
        df['overnight_sentiment'] +
        df['n_day_close_percent_change_ema'] * df['volume_adjusted_intraday_return']
    )
    
    # Set to zero if the absolute value is below a threshold (e.g., 0.5)
    alpha_factor = np.where(np.abs(alpha_factor) < 0
