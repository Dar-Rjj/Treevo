```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=10, M=5, lag=5, EMA_span=10, P=21):
    # Calculate Intraday High-Low Spread
    intraday_high_low_spread = df['high'] - df['low']
    
    # Compute M-day Average of N-day Close Price Percent Change
    close_price_percent_change = df['close'].pct_change(periods=N)
    momentum = close_price_percent_change.rolling(window=M).mean()
    
    # Combine Intraday High-Low Spread and Momentum
    combined_momentum = intraday_high_low_spread * momentum
    
    # Adjust with Volume
    volume_weight = df['volume'].shift(lag)
    smoothed_volume_weight = volume_weight.ewm(span=EMA_span).mean()
    adjusted_momentum = combined_momentum * smoothed_volume_weight
    
    # Calculate Intraday Reversal
    intraday_reversal = df['close'] - df['open'] - (df['close'].shift(1) - df['open'].shift(1))
    
    # Introduce Intraday Range Volatility
    intraday_range = df['high'] - df['low']
    range_volatility = intraday_range.rolling(window=P).std()
    
    # Final Factor Combination
    final_factor = adjusted_momentum * intraday_reversal * range_volatility
    
    return final_factor

# Example usage:
# df = pd.DataFrame({
#     'date': pd.date_range(start='2023-01-01', periods=100),
#     'open': np.random.rand(100) * 100,
#     'high': np.random.rand(100) * 100,
#     'low': np.random.rand(100) * 100,
#     'close': np.random.rand(100) * 100,
#     'amount': np.random.rand(100) * 10000,
#     'volume': np.random.rand(100) * 1000
# })
# df.set_index('date', inplace=True)
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
