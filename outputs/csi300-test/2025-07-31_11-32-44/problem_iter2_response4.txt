```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=21, M=10, lag=5):
    # Calculate Daily Momentum
    daily_momentum = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate N-day Price Momentum
    n_day_momentum = df['close'].pct_change(N)
    
    # Calculate M-day Averaged N-day Price Momentum
    m_day_averaged_n_day_momentum = n_day_momentum.rolling(window=M).mean()
    
    # Calculate Volume Weighted Average Price (VWAP)
    typical_price = (df['high'] + df['low']) / 2
    vwap = (typical_price * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Calculate VWAP to Close Difference
    vwap_close_diff = df['close'] - vwap
    
    # Calculate Volume Reversal
    volume_change = df['volume'] - df['volume'].shift(lag)
    volume_z_score = (volume_change - volume_change.rolling(window=lag).mean()) / volume_change.rolling(window=lag).std()
    
    # Combine All Factors
    combined_factor = (m_day_averaged_n_day_momentum * vwap_close_diff * volume_z_score)
    
    return combined_factor
```
