def heuristics_v2(df):
    # Percentage price change over 7 days
    pct_change_7 = df['close'].pct_change(7)
    
    # Ratio of the highest high to the lowest low over 21 days
    high_21 = df['high'].rolling(window=21).max()
    low_21 = df['low'].rolling(window=21).min()
    high_low_ratio = high_21 / low_21
    
    # Average volume over 15 days
    avg_volume_15 = df['volume'].rolling(window=15).mean()
    
    # Heuristic matrix combining the factors
    heuristics_matrix = 0.4 * pct_change_7 + 0.4 * high_low_ratio + 0.2 * (df['volume'] / avg_volume_15)
    
    return heuristics_matrix
