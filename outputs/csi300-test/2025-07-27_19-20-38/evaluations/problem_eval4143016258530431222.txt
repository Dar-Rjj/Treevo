def heuristics_v2(df):
    def momentum(column):
        return (column - column.shift(5)) / column.shift(5)
    
    def rel_change(column):
        return (column - column.shift(1)) / column.shift(1)
        
    close_momentum = momentum(df['close'])
    volume_rel_change = rel_change(df['volume'])
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    pos_money_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0).rolling(window=14).sum()
    neg_money_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0).rolling(window=14).sum()
    money_flow_ratio = pos_money_flow / neg_money_flow
    
    heuristics_matrix = 0.6*close_momentum + 0.2*volume_rel_change + 0.2*money_flow_ratio
    return heuristics_matrix
