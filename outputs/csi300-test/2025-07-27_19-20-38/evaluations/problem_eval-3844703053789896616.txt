def heuristics_v2(df):
    # Volatility: Standard deviation of the last 30 days' closing prices
    volatility = df['close'].rolling(window=30).std()
    
    # Momentum: Difference between the current close and the 10-day minimum close
    min_10d = df['close'].rolling(window=10).min()
    momentum = df['close'] - min_10d
    
    # Amount Ratio: Today's amount divided by the 20-day moving average amount
    ma_amount_20d = df['amount'].rolling(window=20).mean()
    amount_ratio = df['amount'] / ma_amount_20d
    
    # Heuristic matrix combining the factors
    heuristics_matrix = 0.3 * volatility + 0.4 * momentum + 0.3 * amount_ratio
    
    return heuristics_matrix
