def heuristics_v2(df):
    # 20-day momentum
    mom_20d = df['close'] - df['close'].shift(20)
    
    # 10-day average volume relative to 60-day average volume
    avg_vol_10d = df['volume'].rolling(window=10).mean()
    avg_vol_60d = df['volume'].rolling(window=60).mean()
    rel_vol_avg = avg_vol_10d / avg_vol_60d
    
    # Custom indicator: Distance between close and 200D EMA
    ema_200d = df['close'].ewm(span=200, adjust=False).mean()
    dist_ema = df['close'] - ema_200d
    
    # Combine factors
    heuristics_matrix = mom_20d + 0.5 * rel_vol_avg + 0.5 * dist_ema
    
    return heuristics_matrix
