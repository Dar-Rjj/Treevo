defined period to predict future stock returns.}

```python
def heuristics_v2(df):
    # Volatility: Standard deviation of log returns over the last 30 days
    log_returns = np.log(df['close'] / df['close'].shift(1))
    volatility = log_returns.rolling(window=30).std()
    
    # Trading Range Ratio: The ratio of today's high-low range to the average high-low range over the past 50 days
    avg_range_50 = (df['high'] - df['low']).rolling(window=50).mean()
    range_ratio = (df['high'] - df['low']) / avg_range_50
    
    # Volume Change: Percentage change in volume over the last 15 days
    volume_change = df['volume'].pct_change(15)
    
    # Heuristic matrix combining the factors
    heuristics_matrix = 0.4 * volatility + 0.3 * range_ratio + 0.3 * volume_change
    
    return heuristics_matrix
