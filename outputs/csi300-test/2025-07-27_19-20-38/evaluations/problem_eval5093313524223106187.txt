def heuristics_v2(df):
    def momentum(column, days=10):
        return (column - column.shift(days)) / column.shift(days)
    
    def rel_change(column, avg_days=5):
        avg_volume = column.rolling(window=avg_days).mean()
        return (column - avg_volume) / avg_volume
    
    close_momentum = momentum(df['close'])
    volume_rel_change = rel_change(df['volume'])
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    adjusted_money_flow_ratio = raw_money_flow / raw_money_flow.rolling(window=20).sum()
    
    heuristics_matrix = 0.4*close_momentum + 0.3*volume_rel_change + 0.3*adjusted_money_flow_ratio
    return heuristics_matrix
