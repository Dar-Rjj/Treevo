def heuristics_v2(df):
    # Volatility: Standard deviation of the last 30 days' close prices
    volatility = df['close'].rolling(window=30).std()
    
    # Positive to Total Returns Ratio: Number of positive return days divided by the total number of days in the last 30 days
    returns = df['close'].pct_change()
    pos_returns_ratio = (returns > 0).rolling(window=30).mean()
    
    # Accumulation/Distribution Line: Measures buying and selling pressure
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    money_flow_volume = money_flow_multiplier * df['volume']
    ad_line = money_flow_volume.cumsum()
    
    # Heuristic matrix combining the factors
    heuristics_matrix = 0.4 * (1 / volatility) + 0.3 * pos_returns_ratio + 0.3 * ad_line
    
    return heuristics_matrix
