def heuristics_v2(df):
    # Percentage change in daily range
    daily_range = df['high'] - df['low']
    pct_change_range = (daily_range - daily_range.shift(1)) / daily_range.shift(1)
    
    # Amount relative to the 30-day average amount
    avg_amount_30d = df['amount'].rolling(window=30).mean()
    rel_amount = df['amount'] / avg_amount_30d
    
    # Difference: Closing price minus 20D SMA
    sma_20d = df['close'].rolling(window=20).mean()
    difference = df['close'] - sma_20d
    
    # Combine factors
    heuristics_matrix = pct_change_range + 0.4 * rel_amount + 0.6 * difference
    
    return heuristics_matrix
