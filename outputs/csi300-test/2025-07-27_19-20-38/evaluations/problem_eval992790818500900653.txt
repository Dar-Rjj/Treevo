def heuristics_v2(df):
    # Distance from 50-day Moving Average
    ma_50 = df['close'].rolling(window=50).mean()
    dist_from_ma = (df['close'] - ma_50) / ma_50
    
    # Relative Strength Index (RSI)
    delta = df['close'].diff(1)
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    
    # Rate of Change (ROC) in Volume
    roc_volume = (df['volume'] - df['volume'].shift(12)) / df['volume'].shift(12)
    
    # Combine factors using fixed weights (in practice, these should be optimized based on backtesting results)
    heuristics_matrix = 0.4 * dist_from_ma + 0.3 * rsi + 0.3 * roc_volume
    
    return heuristics_matrix
