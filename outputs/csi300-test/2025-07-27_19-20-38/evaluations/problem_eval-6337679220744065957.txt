def heuristics_v2(df):
    # Percentage change in high-low range over the last 20 days
    hl_range = df['high'] - df['low']
    pct_change_hl = (hl_range - hl_range.shift(20)) / hl_range.shift(20)
    
    # Amount relative to the 50-day average amount
    avg_amount_50d = df['amount'].rolling(window=50).mean()
    rel_amount = df['amount'] / avg_amount_50d
    
    # Difference between closing price and 100D SMA
    sma_100d = df['close'].rolling(window=100).mean()
    diff_close_sma = df['close'] - sma_100d
    
    # Combine factors
    heuristics_matrix = pct_change_hl + 0.4 * rel_amount + 0.6 * diff_close_sma
    
    return heuristics_matrix
