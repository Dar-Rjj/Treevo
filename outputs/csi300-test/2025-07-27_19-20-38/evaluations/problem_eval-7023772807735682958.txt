import pandas as pd

def heuristics_v2(df):
    # Momentum: 1-month return
    momentum = df['close'].pct_change(21)
    
    # Volatility: Standard deviation of daily returns over the last month
    volatility = df['close'].pct_change().rolling(window=21).std()
    
    # Liquidity: Average trading volume over the last month
    liquidity = df['volume'].rolling(window=21).mean()
    
    # Combine factors using fixed weights (for simplicity, in practice, these should be optimized based on backtesting results)
    heuristics_matrix = 0.5 * momentum - 0.3 * volatility + 0.2 * (liquidity / df['volume'].median())
    
    return heuristics_matrix
