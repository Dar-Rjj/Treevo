import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate the 30-day rolling mean of daily return as momentum indicator
    df['momentum_30'] = df['daily_return'].rolling(window=30).mean()
    
    # Calculate the 10-day rolling standard deviation of daily return as a volatility measure
    df['volatility_10'] = df['daily_return'].rolling(window=10).std()
    
    # Calculate the 20-day average daily volume
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    
    # Construct the heuristics factor
    heuristics_factor = (df['momentum_30'] / df['volatility_10']) * df['avg_volume_20']
    
    # Remove the rows with NaN values that were introduced by the rolling calculations
    heuristics_factor = heuristics_factor.dropna()
    
    return heuristics_matrix
