def heuristics_v2(df):
    def daily_return(row):
        if 'close' in row.index:
            return (row['close'] - row['open']) / row['open']
        else:
            return 0

    df['daily_return'] = df.apply(daily_return, axis=1)
    df['avg_daily_return'] = df['daily_return'].rolling(window=10).mean()
    df['abs_avg_daily_return'] = df['daily_return'].abs().rolling(window=10).mean()
    df['heuristics_factor'] = df['avg_daily_return'] - df['abs_avg_daily_return']
    heuristics_matrix = df['heuristics_factor']
    return heuristics_matrix
