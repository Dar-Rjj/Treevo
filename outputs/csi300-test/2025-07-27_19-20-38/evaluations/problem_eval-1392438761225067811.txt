def heuristics_v2(df):
    def momentum(column):
        return (column - column.shift(5)) / column.shift(5)
    
    def rel_change(column):
        return (column - column.shift(1)) / column.shift(1)
        
    close_momentum = momentum(df['close'])
    volume_rel_change = rel_change(df['volume'])
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    money_flow_ratio = raw_money_flow / raw_money_flow.rolling(window=14).sum()
    
    heuristics_matrix = 0.5*close_momentum + 0.3*volume_rel_change + 0.2*money_flow_ratio
    return heuristics_matrix
