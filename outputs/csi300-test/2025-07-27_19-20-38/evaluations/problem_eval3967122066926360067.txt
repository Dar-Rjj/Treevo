def heuristics_v2(df):
    # Rate of change in high price over the last 20 days
    roc_high = (df['high'] - df['high'].shift(20)) / df['high'].shift(20)
    
    # Amount relative to the 60-day average amount
    avg_amount_60d = df['amount'].rolling(window=60).mean()
    rel_amount = df['amount'] / avg_amount_60d
    
    # Difference: Closing price minus 100D SMA
    sma_100d = df['close'].rolling(window=100).mean()
    diff_close_sma = df['close'] - sma_100d
    
    # Combine factors
    heuristics_matrix = roc_high + 0.5 * rel_amount + 0.5 * diff_close_sma
    
    return heuristics_matrix
