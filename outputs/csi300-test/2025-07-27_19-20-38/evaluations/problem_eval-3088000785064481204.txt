def heuristics_v2(df):
    # Momentum: Rate of change in closing price over the last 20 days
    mom_close = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    
    # Volume relative to the maximum volume over the past 30 days
    max_vol_30d = df['volume'].rolling(window=30).max()
    rel_vol = df['volume'] / max_vol_30d
    
    # Custom indicator: Difference between the highest high and lowest low over the last 50 days
    high_low_diff = df['high'].rolling(window=50).max() - df['low'].rolling(window=50).min()
    
    # Combine factors
    heuristics_matrix = mom_close + 0.4 * rel_vol + 0.6 * high_low_diff
    
    return heuristics_matrix
