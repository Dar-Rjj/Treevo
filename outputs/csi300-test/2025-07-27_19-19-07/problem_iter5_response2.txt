```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Return
    df['intraday_return'] = (df['high'] - df['low']) / df['low']

    # Calculate Open-to-Close Return
    df['open_to_close_return'] = (df['close'] - df['open']) / df['open']

    # Calculate Adjusted Close Price Change
    df['close_change'] = df['close'].diff()

    # Compute Short-Term Volume Trend
    df['short_term_volume_trend'] = df['volume'].rolling(window=5).mean()

    # Calculate Long-Term Volume Trend
    df['long_term_volume_trend'] = df['volume'].rolling(window=20).mean()

    # Compute Volume Trend Ratio
    df['volume_trend_ratio'] = df['short_term_volume_trend'] / df['long_term_volume_trend']

    # Calculate High-Low Price Spread
    df['high_low_spread'] = df['high'] - df['low']

    # Incorporate Historical Price Change
    df['close_to_close_return'] = df['close'].pct_change()
    df['weighted_high_low_spread'] = df['high_low_spread'] * df['close_to_close_return']

    # Compute Final Alpha Factor
    intraday_momentum = 0.5 * df['intraday_return'] + 0.5 * df['open_to_close_return']
    
    # Volatility Component
    intraday_volatility = df['intraday_return'].rolling(window=20).std()
    open_to_close_volatility = df['open_to_close_return'].rolling(window=20).std()
    volatility_component = 0.5 * intraday_volatility + 0.5 * open_to_close_volatility
    
    # Adjust for Volume Trend
    volume_change = df['volume'].pct_change()
    volume_adjusted_factor = intraday_momentum * np.sign(volume_change)
    
    # Weight by VWAP
    vwap = ((df['high'] + df['low'] + df['close']) / 3 * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Combine Components
    combined_momentum = intraday_momentum * vwap
    adjusted_combined_momentum = combined_momentum - (volatility_component * vwap)
    final_factor = adjusted_combined_momentum + df['weighted_high_low_spread'] * np.sign(volume_change)
    
    # Adjust for Volume Trend Ratio
    final_factor = final_factor * df['volume_trend_ratio'].apply(lambda x: 1 if x > 1 else -1)

    return final_factor
```
