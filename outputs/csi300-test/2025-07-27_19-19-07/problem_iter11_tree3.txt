```txt
Enhanced Intraday and Long-Term Alpha Factor with Volume-Weighted High-Low Range Momentum and Historical Price Adjustments
├── Calculate Volume-Weighted High-Low Range
│   ├── Use High price
│   ├── Use Low price
│   └── Use Volume
│       └── Multiply (High - Low) by Volume
├── Incorporate Historical Price Change
│   ├── Calculate Close-to-Close Return
│   │   ├── Use Close price of day t
│   │   └── Use Close price of day t-1
│   │       └── Calculate percentage change
│   └── Multiply Volume-Weighted High-Low Range by Close-to-Previous Close Return
│       ├── Volume-Weighted High-Low Range
│       └── Close-to-Previous Close Return
├── Smooth the Resulting Series
│   ├── Apply Exponential Moving Average
│   │   └── Use a Specific Alpha
│   └── Final Factor Calculation
│       ├── Result from Smoothed Series
│       └── Adjust for Volume Trend
│           ├── Calculate Volume Change
│           │   ├── Use Volume of day t
│           │   └── Use Volume of day t-1
│           │       └── Calculate percentage change
│           └── If Volume Change is positive, amplify the factor; otherwise, dampen
│               └── Ensure directionality in the final output
├── Combine and Smooth Final Factor
│   ├── Use Final Factor Calculation
│   └── Apply Simple Moving Average
│       └── Use a Specific Window Size
├── Calculate Intraday Return
│   ├── Use High Price of day t
│   └── Subtract Low Price of day t
├── Calculate Open-to-Close Return
│   ├── Use Open Price of day t
│   └── Subtract Close Price of day t
├── Compute Short-Term Volume Trend
│   ├── Aggregate Volume over last 5 days
│   │   ├── Use Volume of day t
│   │   ├── Use Volume of day t-1
│   │   ├── Use Volume of day t-2
│   │   ├── Use Volume of day t-3
│   │   └── Use Volume of day t-4
│   └── Average the aggregated volumes
├── Calculate Long-Term Volume Trend
│   ├── Aggregate Volume over last 20 days
│   │   ├── Use Volume of day t
│   │   ├── Use Volume of day t-1
│   │   ├── ...
│   │   └── Use Volume of day t-19
│   └── Average the aggregated volumes
├── Compute Volume Trend Ratio
│   ├── Use Short-Term Volume Trend
│   └── Divide by Long-Term Volume Trend
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Sum of (High + Low + Close) / 3
│   ├── Multiply by Volume
│   └── Sum of Volumes
├── Compute Final Momentum Component
│   ├── Intraday Momentum
│   │   ├── Intraday Return
│   │   └── Open-to-Close Return
│   └── Long-Term Momentum
│       ├── Adjusted Close Price Change
│       └── Multiply by Volume Trend Ratio
├── Compute Volatility Component
│   ├── Standard Deviation of Intraday Returns
│   └── Standard Deviation of Open-to-Close Returns
├── Combine Momentum and Volatility
│   ├── Combine Momentum Components
│   │   ├── Add Intraday Momentum
│   │   └── Add Long-Term Momentum
│   └── Subtract Weighted Volatility
└── Final Alpha Factor
    ├── Multiply Combined Momentum by VWAP
    ├── Add Aggregated High-Low Price Bandwidth
    └── Add Smoothed and Volume-Adjusted Momentum Factor
```
