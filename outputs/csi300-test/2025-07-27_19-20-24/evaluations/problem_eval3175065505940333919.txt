def heuristics_v2(df):
    # Mean reversion factor: Price to 50-day moving average ratio
    ma_50 = df['close'].rolling(window=50).mean()
    mean_reversion = df['close'] / ma_50 - 1
    
    # Volatility factor: Standard deviation of daily returns over the last 60 days
    volatility = df['close'].pct_change().rolling(window=60).std()
    
    # Liquidity factor: Change in average trading volume over the past 20 days
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    volume_change = (avg_volume_20 - avg_volume_20.shift(1)) / avg_volume_20.shift(1)
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * mean_reversion + 0.3 * (1/volatility) + 0.3 * volume_change
    
    return heuristics_matrix
