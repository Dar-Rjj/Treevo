import pandas as pd

def heuristics_v2(df):
    ma_20 = df['close'].rolling(window=20).mean()
    ma_50 = df['close'].rolling(window=50).mean()
    price_signal = ma_20 - ma_50
    volume_std = df['volume'].rolling(window=20).std()
    avg_volume = df['volume'].rolling(window=20).mean()
    volume_spike = (df['volume'] > (avg_volume + 2 * volume_std)).astype(int)
    heuristics_matrix = 0.7 * price_signal + 0.3 * volume_spike
    return heuristics_matrix
