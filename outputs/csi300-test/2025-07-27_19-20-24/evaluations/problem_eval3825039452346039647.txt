import pandas as pd

def heuristics_v2(df):
    # Momentum indicator: 30-day moving average of the close-to-open price ratio
    mo_indicator = (df['close'] / df['open']).rolling(window=30).mean()
    
    # Price movement asymmetry: Skewness over the last 90 days
    ret = df['close'].pct_change()
    skewness = ret.rolling(window=90).skew()
    
    # Transaction activity: 10-day rate of change in the trading amount
    amount_roc_10 = df['amount'].pct_change(10)
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * mo_indicator + 0.3 * skewness + 0.3 * amount_roc_10
    
    return heuristics_matrix
