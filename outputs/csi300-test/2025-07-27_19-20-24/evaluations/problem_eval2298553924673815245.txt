def heuristics_v2(df):
    # Momentum factor: 50-day return
    momentum = df['close'].pct_change(50)
    
    # Risk-adjusted return factor: Coefficient of variation of daily returns over the last 90 days
    daily_returns = df['close'].pct_change()
    cv_90 = daily_returns.rolling(window=90).std() / daily_returns.rolling(window=90).mean()
    
    # Market activity factor: 20-day change in volume
    volume_change_20 = (df['volume'] - df['volume'].shift(20)) / df['volume'].shift(20)
    
    # Composite heuristic score
    heuristics_matrix = 0.3 * momentum + 0.4 * (1/cv_90) + 0.3 * volume_change_20
    
    return heuristics_matrix
