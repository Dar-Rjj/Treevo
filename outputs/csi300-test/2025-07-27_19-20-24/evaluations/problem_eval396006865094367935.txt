def heuristics_v2(df):
    def calc_momentum(series, window=10):
        return series.pct_change(window)
    
    def calc_volatility(series, window=30):
        return series.pct_change().rolling(window).std()
    
    # Calculate momentum for each feature
    momentum_df = df.apply(calc_momentum, axis=0)
    # Calculate volatility for each feature to use as weights
    weights = df.apply(calc_volatility, axis=0).mean()  # Average volatility over time as weight
    
    # Compute the weighted momentum
    heuristics_matrix = (momentum_df * weights).sum(axis=1)
    return heuristics_matrix
