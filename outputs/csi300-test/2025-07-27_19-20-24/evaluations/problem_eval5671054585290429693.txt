import pandas as pd

def heuristics_v2(df):
    # Long-term momentum: 6-month return
    long_momentum = df['close'].pct_change(120)
    
    # Medium-term volatility trend: 180-day moving average of standard deviation over the last 360 days
    vol_trend_360 = df['close'].pct_change().rolling(window=360).std().rolling(window=180).mean()
    
    # Short-term liquidity shift: Change in the 5-day average volume
    avg_vol_5 = df['volume'].rolling(window=5).mean()
    liquidity_shift = (avg_vol_5 - avg_vol_5.shift(1)) / avg_vol_5.shift(1)
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * long_momentum + 0.4 * (1/vol_trend_360) + 0.2 * liquidity_shift
    
    return heuristics_matrix
