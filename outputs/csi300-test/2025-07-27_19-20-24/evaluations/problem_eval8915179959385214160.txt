def heuristics_v2(df):
    # SMA Deviation factor: Deviation from 20-day SMA
    sma_20 = df['close'].rolling(window=20).mean()
    sma_deviation = (df['close'] - sma_20) / sma_20
    
    # Sharpe Ratio factor: Over a 90-day window
    daily_returns = df['close'].pct_change()
    excess_return = daily_returns - daily_returns.rolling(window=90).mean()
    volatility = daily_returns.rolling(window=90).std()
    sharpe_ratio = excess_return / volatility
    
    # Volume Change factor: 5-day change in volume
    volume_change_5 = (df['volume'] - df['volume'].shift(5)) / df['volume'].shift(5)
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * sma_deviation + 0.4 * sharpe_ratio + 0.2 * volume_change_5
    
    return heuristics_matrix
