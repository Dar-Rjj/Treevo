def heuristics_v2(df):
    # Mean reversion factor: Difference between current close and 20-day moving average
    mean_reversion = df['close'] - df['close'].rolling(window=20).mean()
    
    # Volatility factor: Average True Range over the last 30 days
    true_range = df[['high', 'low']].apply(lambda x: x['high'] - x['low'], axis=1)
    avg_true_range_30 = true_range.rolling(window=30).mean()
    
    # Price movement intensity factor: 5-day change in (High - Low) prices
    hl_change_5 = (df['high'] - df['low']).pct_change(5)
    
    # Composite heuristic score
    heuristics_matrix = 0.4 * mean_reversion + 0.4 * (1/avg_true_range_30) + 0.2 * hl_change_5
    
    return heuristics_matrix
