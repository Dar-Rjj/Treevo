def heuristics_v2(df):
    daily_return = df['close'].pct_change()
    diff_open_close = (df['open'] - df['close']).abs()
    diff_high_low_yesterday = (df['high'].shift(1) - df['low'].shift(1)).abs()
    total_diff = (diff_open_close + diff_high_low_yesterday).rolling(window=20).mean()
    heuristics_matrix = daily_return / total_diff
    return heuristics_matrix
