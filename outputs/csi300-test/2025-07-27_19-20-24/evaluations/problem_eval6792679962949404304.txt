def heuristics_v2(df):
    daily_return = df['close'].pct_change()
    diff_high_close = (df['high'] - df['close'].shift(1)).abs()
    diff_low_close = (df['low'] - df['close'].shift(1)).abs()
    avg_diff = (diff_high_close + diff_low_close).rolling(window=30).mean()
    heuristics_matrix = daily_return / avg_diff
    heuristics_matrix_smoothed = heuristics_matrix.rolling(window=10).mean()
    return heuristics_matrix
