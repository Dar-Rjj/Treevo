```txt
Intraday Volatility and Momentum Adjusted by Volume and Price Spikes
├── Intraday Range
│   ├── High price
│   └── Low price
│   └── Subtract Low from High
├── Close-to-Open Return
│   ├── Close price
│   └── Open price
│   └── Subtract Open from Close
├── Price Change
│   ├── Current Close
│   └── Previous Close
│   └── Subtract Previous Close from Current Close
├── Combined Factor
│   ├── Average Intraday Range over n periods
│   └── Add (Close-to-Open Return + Price Change)
├── Volume and Price Spike Adjustment
│   ├── Identify Volume Spikes
│   │   ├── Use Volume
│   │   └── Compare with Previous Volume
│   └── Identify Price Spikes
│       ├── Use Close Price
│       └── Compare with Previous Close Price
│   └── Combine Volume and Price Spikes
│       ├── Add Volume Spike and Price Spike
│   └── Adjust Combined Factor
│       ├── Divide Combined Factor by Combined Spike
│       └── Cap at a Threshold to Avoid Extreme Values
└── Volume Weight
    ├── Volume
    └── Average Volume over n periods
    └── Divide Volume by Average Volume
    └── Multiply adjusted combined factor by this weight
```
