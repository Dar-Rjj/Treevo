```txt
Enhanced and Volume-Adjusted Intraday Momentum with Comprehensive Volatility
├── Calculate Intraday Range
│   ├── High price
│   └── Low price
│   └── Subtract Low from High
├── Close-to-Open Return
│   ├── Close price
│   └── Open price
│   └── Subtract Open from Close
├── Price Change
│   ├── Current Close
│   └── Previous Close
│   └── Subtract Previous Close from Current Close
├── Combined Intraday Features
│   ├── Intraday Midpoint
│   │   ├── Sum (High + Low)
│   │   └── Divide by 2
│   ├── Opening Gap
│   │   ├── Open price
│   │   └── Previous Close
│   │   └── Subtract Previous Close from Open
│   └── Subtract Intraday Midpoint from Open price
│   └── Add Opening Gap to result
├── Enhanced Intraday Factor
│   ├── Average Intraday Range over n periods
│   └── Multiply by (Close-to-Open Return + Price Change)
│   └── Add Combined Intraday Features
├── Recent Volatility
│   ├── Absolute Price Change
│   │   ├── Current Close
│   │   └── Previous Close
│   │   └── Take Absolute Value
│   └── Average Absolute Price Change over m periods
│   └── Multiply Enhanced Intraday Factor by this average
├── Adjust for Combined Volume and Price Spikes
    ├── Compare Current Volume to Previous Volume
    │   └── Calculate Volume Spike Factor
    ├── Compare Current Price Change to Previous Price Change
    │   └── Calculate Price Spike Factor
    └── Scale Recent Volatility by Combined Spike Factor
        └── Cap at Threshold to Avoid Extreme Values
├── Volume Weight
    ├── Volume
    └── Average Volume over n periods
    └── Divide Volume by Average Volume
    └── If Volume is greater than Average Volume, set to 1; otherwise, set to 0.5
    └── Multiply Adjusted Recent Volatility by this weight
├── Trend Confirmation
    ├── Calculate Moving Average Convergence Divergence (MACD)
    │   ├── Short-term Exponential Moving Average (EMA) of Close
    │   └── Long-term Exponential Moving Average (EMA) of Close
    │   └── Subtract Long-term EMA from Short-term EMA
    └── Signal Line
        ├── Calculate 9-period EMA of MACD
        └── If MACD > Signal Line, set to 1; otherwise, set to 0.5
└── Final Factor
    ├── Multiply Enhanced Intraday Factor by Adjusted Recent Volatility
    └── Multiply by Volume Weight
    └── Multiply by Trend Confirmation
```
