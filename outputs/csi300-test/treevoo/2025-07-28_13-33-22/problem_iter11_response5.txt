```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=10):
    # Intraday Range
    intraday_range = df['high'] - df['low']

    # Close-to-Open Return
    close_to_open_return = df['close'] - df['open'].shift(1)

    # Price Change
    price_change = df['close'] - df['close'].shift(1)

    # Intraday Volatility
    intraday_volatility = intraday_range.rolling(window=n).std()

    # Combined Factor
    average_intraday_range = intraday_range.rolling(window=n).mean()
    combined_factor = (average_intraday_range + close_to_open_return + price_change) \
                      * (intraday_volatility * close_to_open_return)

    # Volume and Price Spike Adjustment
    volume_spike = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    price_spike = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    combined_spike = volume_spike + price_spike
    combined_factor_adjusted = combined_factor / combined_spike
    combined_factor_adjusted = combined_factor_adjusted.clip(lower=-5, upper=5)

    # Volume Weight
    average_volume = df['volume'].rolling(window=n).mean()
    volume_weight = df['volume'] / average_volume

    # Transaction Intensity
    transaction_intensity = df['amount'] / df['volume']
    average_transaction_intensity = transaction_intensity.rolling(window=n).mean()
    adjusted_transaction_intensity = transaction_intensity / average_transaction_intensity

    # Final Adjustment
    final_factor = combined_factor_adjusted * volume_weight * adjusted_transaction_intensity

    return final_factor
```
