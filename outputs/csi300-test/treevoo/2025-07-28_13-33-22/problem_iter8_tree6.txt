```txt
Volume-Weighted Intraday Momentum with Reversal, Volatility, and Range Adjustments
├── Calculate Daily Log Returns
│   ├── Use Close price (Day t)
│   └── Use Close price (Day t-1)
├── Compute Weighted Average Log Return
│   ├── Use Volume (Day t to Day t-n) as Weights
│   └── Use Daily Log Returns (Day t to Day t-n)
├── Incorporate Short-Term Price Reversal
│   ├── Calculate High-Low Range
│   │   ├── Use High price (Day t)
│   │   └── Use Low price (Day t)
│   └── Subtract High-Low Range from Weighted Average Log Return
│       ├── Use Weighted Average Log Return
│       └── Use High-Low Range
├── Calculate Intraday Range
│   ├── Use High price
│   └── Use Low price
│   └── Subtract Low from High
├── Calculate Close-to-Open Return
│   ├── Use Close price
│   └── Use Open price
│   └── Subtract Open from Close
├── Calculate Intraday Midpoint
│   ├── Sum (High + Low)
│   └── Divide by 2
├── Calculate Opening Gap
│   ├── Use Open price
│   └── Use Close price from the previous day
│   └── Subtract Previous Close from Open
├── Combine Intraday Features
│   ├── Subtract Intraday Midpoint from Open price
│   └── Subtract Opening Gap from result
├── Calculate Price Change
│   ├── Use Current Close
│   └── Use Previous Close
│   └── Subtract Previous Close from Current Close
├── Combine Factors
│   ├── Average Intraday Range over n periods
│   └── Multiply by (Close-to-Open Return + Price Change - High-Low Range + Weighted Average Log Return)
├── Enhance with Recent Volatility
│   ├── Calculate Absolute Price Change
│   │   ├── Use Current Close
│   │   └── Use Previous Close
│   │   └── Subtract Previous Close from Current Close
│   │   └── Take Absolute Value
│   └── Average Absolute Price Change over m periods
│   └── Multiply combined feature by this average
├── Adjust by Volume Spikes
│   ├── Identify Volume Spikes
│   │   ├── Use Volume
│   │   └── Compare with Previous Volume
│   └── Scale Combined Factor
│       ├── Divide Combined Factor by Volume Spike
│       └── Cap at a Threshold to Avoid Extreme Values
└── Weight by Relative Volume
    ├── Use Volume
    └── Divide by Average Volume over n periods
    └── Multiply scaled factor by this relative volume
```
