```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Calculate High-to-Low Price Range
    high_to_low_range = df['high'] - df['low']
    
    # Combine Intraday and High-to-Low Features
    combined_feature = (intraday_range + high_to_low_range).rolling(window=20).mean()
    
    # Calculate Intraday Midpoint
    intraday_midpoint = (df['high'] + df['low']) / 2
    
    # Calculate Opening Gap
    opening_gap = df['open'] - df['close'].shift(1)
    
    # Adjust for Opening Gap
    adjusted_opening_gap = (df['open'] - intraday_midpoint) - opening_gap
    
    # Identify Volume Spikes
    volume_spike = (df['volume'] > df['volume'].shift(1) * 2)
    
    # Adjust Combined Feature by Volume Spike
    if volume_spike.any():
        adjusted_opening_gap[volume_spike] = adjusted_opening_gap[volume_spike] / df['volume'][volume_spike]
        adjusted_opening_gap = adjusted_opening_gap.clip(lower=-1, upper=1)
    else:
        adjusted_opening_gap *= df['volume']
    
    # Calculate Weighted Momentum
    prev_high_to_low_range = (df['high'].shift(1) - df['low'].shift(1))
    momentum_factor = (high_to_low_range - prev_high_to_low_range)
    volume_ratio = df['volume'] / df['volume'].shift(1)
    weighted_momentum = momentum_factor * volume_ratio
    
    # Calculate Close-to-Open Return
    close_to_open_return = df['close'] - df['open']
    
    # Calculate Price Change
    price_change = df['close'] - df['close'].shift(1)
    
    # Combine Momentum and Price Change Factors
    combined_momentum_price_change = (close_to_open_return + price_change) * combined_feature
    
    # Adjust for Volume Volatility
    daily_volume_changes = df['volume'] - df['volume'].shift(1)
    volume_volatility = daily_volume_changes.rolling(window=20).std()
    normalized_weighted_momentum = weighted_momentum / volume_volatility
    
    # Apply Final Weighting
    average_volume = df['volume'].rolling(window=20).mean()
    final_weight = df['volume'] / average_volume
    final_factor = (combined_momentum_price_change + normalized_weighted_momentum) * final_weight
    
    return final_factor
```
