```txt
Intraday Momentum and Volatility Enhanced with Comprehensive Price, Volume, and Spike Adjustments
├── Calculate Intraday Range
│   ├── Subtract Low from High
├── Calculate Opening Gap
│   ├── Subtract Previous Close from Open
├── Combine Intraday Features
│   ├── Subtract (High + Low) / 2 from Open
│   └── Subtract Opening Gap from result
├── Calculate Close-to-Open Return
│   ├── Subtract Open from Close
├── Calculate Price Change
│   ├── Subtract Previous Close from Current Close
├── Combine Factors
│   ├── Average Intraday Range over n periods
│   └── Multiply by (Close-to-Open Return + Price Change)
├── Introduce Volatility Adjustment
│   ├── Calculate Log Returns
│   │   └── Take Logarithm of (Current Close / Previous Close)
│   └── Compute Standard Deviation of Log Returns
│       └── Use Rolling Window
│   └── Adjust Intraday Momentum
│       └── Multiply Intraday Momentum by the Inverse of Standard Deviation
├── Enhance with Recent Volatility
│   ├── Calculate Absolute Price Change
│   │   └── Take Absolute Value of (Current Close - Previous Close)
│   ├── Calculate Volatility Factor
│   │   └── Average Absolute Price Change over m periods
│   └── Scale Combined Feature by Volatility Factor
├── Adjust for Combined Volume and Price Spikes
    ├── Calculate Volume Spike Factor
    │   └── Compare Current Volume to Previous Volume
    ├── Calculate Price Spike Factor
    │   └── Compare Current Price Change to Previous Price Change
    └── Scale Combined Feature by Combined Spike Factor
└── Weight by Volume
    ├── Multiply adjusted feature by Volume
└── Add Recent Amount Trend
    ├── Calculate Average Amount over p periods
    └── Multiply combined feature by recent amount trend
└── Final Volatility Adjustment
    ├── Calculate Log Returns
    │   ├── Use Close Prices of Current and Previous Day
    │   └── Take Logarithm of (Current Close / Previous Close)
    ├── Compute Standard Deviation of Log Returns
    │   ├── Over a Fixed Number of Days
    │   └── Use Rolling Window
    └── Adjust Enhanced Intraday Factor
        └── Multiply Enhanced Intraday Factor by the Inverse of Standard Deviation
└── Scale Final Factor
    ├── Divide Enhanced Intraday Factor by Combined Spike
    │   ├── Combine Volume and Price Spikes
    │   └── Add Volume Spike and Price Spike
    └── Cap at a Threshold to Avoid Extreme Values
```
