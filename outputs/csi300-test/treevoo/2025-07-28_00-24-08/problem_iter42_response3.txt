```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-based Factors
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['ROC'] = df['close'].pct_change(periods=1)
    
    # Volatility-based Factors
    df['Daily_Range'] = df['high'] - df['low']
    df['ATR_14'] = df[['high', 'low', 'close']].apply(lambda x: np.max(x) - np.min(x), axis=1).rolling(window=14).mean()
    
    # Trend Strength Indicators
    df['+DM'] = np.maximum(df['high'] - df['high'].shift(1), 0)
    df['-DM'] = np.maximum(df['low'].shift(1) - df['low'], 0)
    df['+DI'] = 100 * (df['+DM'] / df['ATR_14']).rolling(window=14).mean()
    df['-DI'] = 100 * (df['-DM'] / df['ATR_14']).rolling(window=14).mean()
    df['DX'] = 100 * (abs(df['+DI'] - df['-DI']) / (df['+DI'] + df['-DI']))
    df['ADX'] = df['DX'].rolling(window=14).mean()
    
    # Volume-related Factors
    df['Vol_MA_10'] = df['volume'].rolling(window=10).mean()
    df['Vol_Ratio'] = df['volume'] / df['Vol_MA_10']
    df['Cum_Vol_Change_10'] = df['volume'].pct_change(periods=1).rolling(window=10).sum()
    
    # Amount and Price Interaction
    df['VWAP'] = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3).cumsum() / df['volume'].cumsum()
    df['MFI_14'] = ((df['close'] > df['close'].shift(1)) * df['volume']).rolling(window=14).sum() / df['volume'].rolling(window=14).sum()
    
    # Candlestick Patterns Analysis
    df['Doji'] = (df['open'] == df['close'])
    df['Hammer'] = (df['close'] > df['open']) & (df['low'] < df['close'] - 2 * (df['close'] - df['open'])) & (df['high'] - df['close'] < 0.5 * (df['close'] - df['open']))
    df['Engulfing'] = (df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))
    
    # Technical Indicator Combinations
    df['MACD_Line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['Signal_Line'] = df['MACD_Line'].ewm(span=9, adjust=False).mean()
    df['RSI_14'] = 100 - (100 / (1 + (df['close'].diff().clip(lower=0).rolling(window=14).mean() / df['close'].diff().clip(upper=0).rolling(window=14).mean())))
    
    # Cross-Period Analysis
    df['50_SMA'] = df['close'].rolling(window=50).mean()
    df['200_SMA'] = df['close'].rolling(window=200).mean()
    df['LTS_vs_STS'] = df['50_SMA'] - df['200_SMA']
    
    df['ATR_10'] = df[['high', 'low', 'close']].apply(lambda x: np.max(x) - np.min(x), axis=1).rolling(window=10).mean()
    df['ATR_Ratio'] = df['ATR_10'] / df['ATR_14']
    
    # Inter-day and Intra-day Analysis Integration
    df['Overnight_Gap'] = df['open'] - df['close'].shift(1)
    df['Midday_High_Low'] = (df['high'] + df['low']) / 2
    df['Midday_Momentum_Shift'] = df['
