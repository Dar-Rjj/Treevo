```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()

    # Momentum factors
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['momentum'] = df['sma_5'] - df['sma_20']

    df['ema'] = df['close'].ewm(span=10, adjust=False).mean()
    df['momentum_ema'] = df['ema'] - df['ema'].shift(5)

    # Volatility factor
    df['price_range'] = df['high'] - df['low']
    df['atr_14'] = df['price_range'].rolling(window=14).mean()
    df['volatility'] = df['atr_14']

    # Volume-based indicators
    df['volume_change'] = df['volume'].diff()
    df['vwap'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    df['vwap_deviation'] = df['close'] - df['vwap']

    # Transaction intensity
    df['amount_change'] = df['amount'].diff()
    df['transaction_intensity'] = df['amount_change'] / df['volume_change']

    # Composite factor
    composite = 0.3 * df['momentum'] + 0.3 * df['volatility'] + 0.4 * df['vwap_deviation']

    # Additional factors
    def rsi(data, period=14):
        delta = data.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    df['rsi_14'] = rsi(df['close'])
    df['rsi_factor'] = df['rsi_14']

    # On-balance volume (OBV)
    df['obv'] = np.where(df['close'].diff() >= 0, df['volume'], -df['volume']).cumsum()
    df['obv_factor'] = df['obv']

    # MACD
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    df['macd_factor'] = df['macd_histogram']

    # Enhanced composite factor
    enhanced_composite = 0.2 * df['momentum'] + 0.2 * df['volatility'] + 0.2 * df['vwap_deviation'] + \
                         0.1 * df['rsi_factor'] + 0.1 * df['obv_factor'] + 0.2 * df['macd_factor']

    return enhanced_composite.dropna()
```
