```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    """
    This function takes a pandas DataFrame with columns (open, high, low, close, amount, volume)
    and returns a pandas Series representing the factor values.
    The index of the DataFrame is the date.
    """
    
    # Momentum factor
    short_term_return = df['close'].pct_change(5)
    medium_term_return = df['close'].pct_change(20)
    momentum_factor = 0.7 * short_term_return + 0.3 * medium_term_return
    
    # Volume-based alpha factor
    N = 10
    avg_volume = df['volume'].rolling(window=N).mean()
    volume_ratio = df['volume'] / avg_volume
    volume_change = df['volume'].pct_change(1)
    volume_factor = 0.5 * volume_ratio + 0.5 * volume_change
    
    # Volatility-based alpha factor
    daily_range = df['high'] - df['low']
    P = 20
    std_close = df['close'].rolling(window=P).std()
    volatility_factor = np.sqrt(daily_range * std_close)
    
    # Transaction amount (dollar volume) alpha factor
    Q = 10
    amount_sum = df['amount'].rolling(window=Q).sum()
    amount_cv = df['amount'].rolling(window=Q).std() / df['amount'].rolling(window=Q).mean()
    amount_factor = amount_sum / (1 + amount_cv)
    
    # Gap opening factor
    S = 10
    opening_gap = df['open'] - df['close'].shift(1)
    positive_gaps = (opening_gap > 0).rolling(window=S).sum()
    negative_gaps = (opening_gap < 0).rolling(window=S).sum()
    gap_intensity = opening_gap.abs().rolling(window=S).sum() / S
    gap_factor = (positive_gaps - negative_gaps) / gap_intensity
    
    # Combine all factors into a composite factor
    composite_factor = (momentum_factor + volume_factor + volatility_factor + amount_factor + gap_factor) / 5
    
    return composite_factor
```
