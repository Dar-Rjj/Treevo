```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate the average of the open and close price
    df['avg_price'] = (df['open'] + df['close']) / 2
    
    # Calculate the money flow by multiplying the average price with the volume
    df['money_flow'] = df['avg_price'] * df['volume']
    
    # Calculate the 10-day moving average of the money flow
    df['money_flow_10d_avg'] = df['money_flow'].rolling(window=10).mean()
    
    # Calculate the 30-day moving average of the money flow
    df['money_flow_30d_avg'] = df['money_flow'].rolling(window=30).mean()
    
    # The alpha factor is the ratio of 10-day moving average to 30-day moving average of the money flow
    alpha_factor = df['money_flow_10d_avg'] / df['money_flow_30d_avg']
    
    return alpha_factor
```
