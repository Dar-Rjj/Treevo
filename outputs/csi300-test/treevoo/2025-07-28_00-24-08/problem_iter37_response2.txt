```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between open and close on day t
    df['open_close_diff'] = df['close'] - df['open']
    
    # Compute the range (high - low) on day t
    df['daily_range'] = df['high'] - df['low']
    
    # Determine the ratio of volume to price change
    df['price_change'] = df['close'].pct_change()
    df['volume_to_price_change_ratio'] = df['volume'] / df['price_change'].abs()
    
    # Calculate the average return over the past 5 days
    df['5_day_avg_return'] = df['close'].pct_change().rolling(window=5).mean()
    
    # Determine the momentum by comparing the current close to the 20-day moving average
    df['20_day_moving_avg'] = df['close'].rolling(window=20).mean()
    df['momentum'] = df['close'] / df['20_day_moving_avg'] - 1
    
    # Analyze the ratio of transaction amount to volume
    df['amount_to_volume_ratio'] = df['amount'] / df['volume']
    
    # Evaluate the change in transaction amount over the past 10 days
    df['10_day_amount_change'] = df['amount'].pct_change(periods=10)
    
    # Create a composite factor from the above factors
    df['composite_factor'] = (
        df['open_close_diff'] +
        df['daily_range'] +
        df['volume_to_price_change_ratio'] +
        df['5_day_avg_return'] +
        df['momentum'] +
        df['amount_to_volume_ratio'] +
        df['10_day_amount_change']
    )
    
    return df['composite_factor']
```
