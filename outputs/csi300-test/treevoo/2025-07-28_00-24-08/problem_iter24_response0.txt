```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()
    
    # Momentum factors
    # Short-term and long-term SMAs
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['momentum_sma'] = df['sma_5'] - df['sma_20']
    
    # EMA with a smoothing factor of 0.1
    df['ema'] = df['close'].ewm(alpha=0.1, adjust=False).mean()
    df['momentum_ema'] = df['ema'] - df['ema'].shift(5)
    
    # Volatility
    df['price_range'] = df['high'] - df['low']
    df['atr_14'] = df['price_range'].rolling(window=14).mean()  # Average True Range
    df['volatility'] = df['atr_14']
    
    # Volume-based indicators
    df['volume_change'] = df['volume'].diff()
    df['vwap_t'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    df['vwap_deviation'] = df['close'] - df['vwap_t']
    
    # Transaction amounts
    df['amount_change'] = df['amount'].diff()
    df['transaction_intensity'] = df['amount_change'] / df['volume_change']
    
    # Combine multiple factors into a composite factor
    w1, w2, w3 = 0.5, 0.3, 0.2  # Example weights
    df['composite'] = (w1 * df['momentum_sma'] + w2 * df['volatility'] + w3 * df['vwap_deviation']).fillna(0)
    
    return df['composite']
```
