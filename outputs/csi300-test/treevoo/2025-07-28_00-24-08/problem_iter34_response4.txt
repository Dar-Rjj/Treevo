```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the percentage change in close price
    df['pct_change'] = df['close'].pct_change()
    
    # Calculate the average of high and low
    df['avg_high_low'] = (df['high'] + df['low']) / 2
    
    # Calculate the ratio of volume to amount
    df['volume_to_amount'] = df['volume'] / df['amount']
    
    # Calculate the weighted average of open and close prices with weights 0.3 and 0.7 respectively
    df['weighted_open_close'] = 0.3 * df['open'] + 0.7 * df['close']
    
    # The final factor is a combination of these features
    df['factor'] = (df['pct_change'] + df['avg_high_low'] - df['volume_to_amount'] + df['weighted_open_close']).shift(1)
    
    return df['factor']
```
