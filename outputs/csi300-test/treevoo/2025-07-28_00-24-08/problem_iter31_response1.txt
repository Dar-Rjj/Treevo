```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return using close prices
    df['daily_return'] = df['close'].pct_change()
    
    # Count the number of consecutive days with positive returns
    def count_consecutive_positive_returns(ret_series):
        count = 0
        result = []
        for ret in ret_series:
            if ret > 0:
                count += 1
            else:
                count = 0
            result.append(count)
        return pd.Series(result, index=ret_series.index)
    
    df['consecutive_pos_returns'] = count_consecutive_positive_returns(df['daily_return'])
    
    # Calculate daily range (high - low)
    df['daily_range'] = df['high'] - df['low']
    
    # Sum daily ranges over a rolling window (e.g., 5 days)
    df['rolling_daily_range_sum'] = df['daily_range'].rolling(window=5).sum()
    
    # Determine if the close is higher than the open
    df['close_higher_than_open'] = (df['close'] > df['open']).astype(int)
    
    # Count the number of days where close > open in a rolling window (e.g., 5 days)
    df['rolling_close_higher_count'] = df['close_higher_than_open'].rolling(window=5).sum()
    
    # Calculate the gap between today's open and yesterday's close
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Identify the direction of the gap (positive or negative)
    df['gap_direction'] = (df['gap'] > 0).astype(int)
    
    # Calculate the change in volume from the previous day
    df['volume_change'] = df['volume'].pct_change()
    
    # Identify large volume changes (e.g., > 20% increase)
    df['large_volume_increase'] = (df['volume_change'] > 0.2).astype(int)
    
    # Calculate the ratio of current volume to average volume over a rolling window (e.g., 5 days)
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    df['volume_ratio'] = df['volume'] / df['avg_volume_5d']
    
    # Create a composite factor based on daily return, daily range, and volume change
    # Assign weights to each component (these can be tuned based on backtesting results)
    weight_return = 0.4
    weight_range = 0.3
    weight_volume = 0.3
    
    df['composite_factor'] = (weight_return * df['daily_return']) + \
                             (weight_range * df['rolling_daily_range_sum']) + \
                             (weight_volume * df['volume_ratio'])
    
    # Return the composite factor
    return df['composite_factor']
```
