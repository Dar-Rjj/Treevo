```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between close and open prices
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate the average of (close - open) over the last 5 days
    df['avg_close_open_5d'] = df['close_open_diff'].rolling(window=5).mean()
    
    # Calculate the ratio of (close - open) to (high - low) for a single day
    df['close_open_ratio'] = df['close_open_diff'] / (df['high'] - df['low'])
    
    # Calculate the average of this ratio over the last 10 days
    df['avg_close_open_ratio_10d'] = df['close_open_ratio'].rolling(window=10).mean()
    
    # Analyze the pattern of (close - open) over the last 10 days
    df['positive_days'] = df['close_open_diff'].gt(0).rolling(window=10).sum()
    df['negative_days'] = df['close_open_diff'].lt(0).rolling(window=10).sum()
    
    # Count the consecutive days where (close - open) is positive or negative
    df['consecutive_pos'] = (df['close_open_diff'] > 0).groupby((df['close_open_diff'] <= 0).cumsum()).cumcount()
    df['consecutive_neg'] = (df['close_open_diff'] < 0).groupby((df['close_open_diff'] >= 0).cumsum()).cumcount()
    
    # Identify the longest streak of consecutive positive or negative (close - open) days in the last 20 days
    df['longest_streak_20d'] = df[['consecutive_pos', 'consecutive_neg']].max(axis=1).rolling(window=20).max()
    
    # Investigate the relationship between volume and (close - open)
    df['vol_weighted_close_open'] = df['close_open_diff'] * df['volume']
    df['sum_vol_weighted_5d'] = df['vol_weighted_close_open'].rolling(window=5).sum()
    
    # Determine if there is a consistent increase or decrease in this metric over a period of 10 days
    df['change_sum_vol_weighted_10d'] = df['sum_vol_weighted_5d'].diff(periods=5)
    
    # Measure the volatility using high and low prices
    df['daily_range'] = df['high'] - df['low']
    df['std_daily_range_20d'] = df['daily_range'].rolling(window=20).std()
    
    # Examine the change in this standard deviation over the last 5 days
    df['change_std_daily_range_5d'] = df['std_daily_range_20d'].diff(periods=5)
    
    # Calculate the percentage change in the standard deviation of (high - low) from the last 5 days to the previous 5 days
    df['pct_change_std_daily_range_5d'] = df['change_std_daily_range_5d'] / df['std_daily_range_20d'].shift(5)
    
    # Calculate the ratio of (high - low) to (close - open) for each day, then average it over the last 10 days
    df['range_close_open_ratio'] = df['daily_range'] / df['close_open_diff']
    df['avg_range_close_open_ratio_10d'] = df['range_close_open_ratio'].rolling(window=10).mean()
    
    # Compare the average ratio of (high - low) to (close - open) over the last 10 days to the average ratio over the previous 10 days
    df['change_avg_range_close_open_ratio_10d'] = df['avg_range_close_open_ratio_10d'].diff(periods=10)
    
    # Analyze trading volume
    df['vol_30d_ma'] = df['volume'].rolling(window=30).mean()
    df['pct_change_vol_vs_30d_ma'] = (df['volume'] - df['vol_30d_ma']) / df['vol_30d_ma']
    
    # Calculate the cumulative volume over the last 7 days
    df['cum_volume_7d'] = df['volume'].rolling(window=7).sum()
    
    # Compare the cumulative volume of the last 7 days to the previous 7 days
    df['pct_change_cum_volume_7d'] = df['cum_volume_7d'].pct_change(periods=7)
    
    # Utilize the amount data
    df['net_amount_10d'] = df['
