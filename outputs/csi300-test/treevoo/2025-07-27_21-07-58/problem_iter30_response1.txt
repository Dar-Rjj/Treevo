```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate daily range
    df['high_low_range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate high-close and close-low spreads
    df['high_close_spread'] = (df['high'] - df['close']) / df['close']
    df['close_low_spread'] = (df['close'] - df['low']) / df['close']
    
    # Calculate daily volume change
    df['volume_change'] = df['volume'].diff()
    
    # Calculate volume-weighted average price (VWAP)
    df['VWAP'] = (df['amount'] / df['volume']).rolling(window=20).mean()
    
    # Calculate cumulative volume delta (difference between buy and sell volumes)
    df['cum_volume_delta'] = df['volume'].diff().cumsum()
    
    # Calculate daily amount change
    df['amount_change'] = df['amount'].diff()
    
    # Calculate amount-weighted average price (AWAP)
    df['AWAP'] = (df['amount'] / df['volume']).rolling(window=20).mean()
    
    # Calculate cumulative amount delta (difference between buy and sell amounts)
    df['cum_amount_delta'] = df['amount'].diff().cumsum()
    
    # Create composite indicators
    df['composite_indicator_1'] = (df['daily_return'] + df['volume_change'] + df['amount_change']) / 3
    df['momentum_indicator'] = (df['high_close_spread'] + df['close_low_spread']) / 2
    df['volatility_indicator'] = (df['high_low_range'] * df['volume_change']) / 2
    
    # Interaction between daily return and volume
    df['return_volume_interaction'] = df['daily_return'] * (df['volume_change'] / df['volume'])
    
    # Interaction between daily return and amount
    df['return_amount_interaction'] = df['daily_return'] * (df['amount_change'] / df['amount'])
    
    # Interaction between volume and amount
    df['volume_amount_interaction'] = (df['volume_change'] / df['volume']) * (df['amount_change'] / df['amount'])
    
    # Simple moving average (SMA) of closing prices
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Exponential moving average (EMA) of closing prices
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Day-of-the-week effect
    df['day_of_week'] = df.index.dayofweek
    
    # Month-of-the-year effect
    df['month_of_year'] = df.index.month
    
    # Drop any rows with NaN values
    df.dropna(inplace=True)
    
    # Return the final alpha factor
    return df['composite_indicator_1']
```
