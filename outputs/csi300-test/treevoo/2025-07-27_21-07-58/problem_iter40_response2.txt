```python
import pandas as pd

def heuristics_v2(df):
    # Calculate individual factors
    df['price_change_volume'] = (df['close'] - df['open']) / df['open'] * df['volume']
    df['high_trend'] = (df['high'] - df['high'].rolling(window=5).max()) / df['high'].rolling(window=5).max()
    df['low_trend'] = (df['low'] - df['low'].rolling(window=5).min()) / df['low'].rolling(window=5).min()
    df['amount_ratio'] = df['amount'] / df['amount'].rolling(window=10).mean()
    df['close_position'] = (df['close'] - df['low'].rolling(window=20).min()) / (df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min())

    # Define weights for the composite factor
    w1, w2, w3, w4, w5 = 0.2, 0.2, 0.2, 0.2, 0.2

    # Create the composite alpha factor
    df['composite_factor'] = (
        w1 * df['price_change_volume'] +
        w2 * df['high_trend'] +
        w3 * df['low_trend'] +
        w4 * df['amount_ratio'] +
        w5 * df['close_position']
    )

    return df['composite_factor'].dropna()

# Example usage:
# df = pd.read_csv('your_stock_data.csv')
# df.set_index('date', inplace=True)
# composite_factor = heuristics_v2(df)
# print(composite_factor)
```
