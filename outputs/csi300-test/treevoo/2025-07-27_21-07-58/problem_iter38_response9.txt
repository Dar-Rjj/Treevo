```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Thought 1.1: Daily return based on Close-to-Close
    df['daily_return_close'] = df['close'].pct_change()
    
    # Thought 1.2: Daily return based on Open-to-Close
    df['daily_return_open_close'] = (df['close'] - df['open']) / df['open']
    
    # Thought 2.1: Volume-to-Price ratio
    df['volume_to_price'] = df['volume'] / df['close']
    
    # Thought 3.1: Intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Thought 4.1: Price gap
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Thought 6.1: Daily price change
    df['daily_price_change'] = df['close'] - df['close'].shift(1)
    
    # Thought 6.2: Daily volume change
    df['daily_volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Thought 7.1: 5-day moving average of Close prices
    df['ma_5_close'] = df['close'].rolling(window=5).mean()
    
    # Thought 7.2: 5-day moving average of Volume
    df['ma_5_volume'] = df['volume'].rolling(window=5).mean()
    
    # Thought 8.1: Standard deviation of daily returns over the last 5 days
    df['std_5_daily_return'] = df['daily_return_close'].rolling(window=5).std()
    
    # Thought 8.2: Standard deviation of daily volume over the last 5 days
    df['std_5_daily_volume'] = df['volume'].rolling(window=5).std()
    
    # Thought 10.1: 5-day moving average of the volume-to-price ratio
    df['ma_5_volume_to_price'] = df['volume_to_price'].rolling(window=5).mean()
    
    # Thought 10.2: Compare the current volume-to-price ratio with its 5-day moving average
    df['volume_to_price_divergence'] = df['volume_to_price'] - df['ma_5_volume_to_price']
    
    # Thought 11.1: Daily high-low range
    df['high_low_range'] = df['high'] - df['low']
    
    # Thought 11.2: 5-day moving average of the daily high-low range
    df['ma_5_high_low_range'] = df['high_low_range'].rolling(window=5).mean()
    
    # Thought 12.1: Standard deviation of the daily high-low range over the last 5 days
    df['std_5_high_low_range'] = df['high_low_range'].rolling(window=5).std()
    
    # Assign weights to each factor
    weights = {
        'daily_return_close': 0.1,
        'daily_return_open_close': 0.1,
        'volume_to_price': 0.1,
        'intraday_momentum': 0.1,
        'price_gap': 0.1,
        'daily_price_change': 0.1,
        'daily_volume_change': 0.1,
        'ma_5_close': 0.1,
        'ma_5_volume': 0.1,
        'std_5_daily_return': 0.1,
        'std_5_daily_volume': 0.1,
        'volume_to_price_divergence': 0.1,
        'high_low_range': 0.1,
        'ma_5_high_low_range': 0.1,
        'std_5_high_low_range': 0.1
    }
    
    # Create a single final composite factor
    df['final_composite_factor'] = 0
    for factor, weight in weights.items():
        df['final_composite_factor'] += weight * (df[factor] - df[factor].mean()) / df[factor].std()
    
    return df['final_composite_factor']
```
