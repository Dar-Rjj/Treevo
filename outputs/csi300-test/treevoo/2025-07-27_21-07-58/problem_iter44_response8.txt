```python
import pandas as pd

def heuristics_v2(df, N=20):
    # Calculate the difference between the closing price and the average closing price over the last N days
    avg_close = df['close'].rolling(window=N).mean()
    diff_close = df['close'] - avg_close
    factor1 = diff_close.apply(lambda x: 1 if x > 0 else -1)
    
    # Identify the direction of the trend using a simple moving average crossover
    short_term_ma = df['close'].rolling(window=5).mean()
    long_term_ma = df['close'].rolling(window=20).mean()
    factor2 = (short_term_ma > long_term_ma).astype(int) * 2 - 1
    
    # Calculate the range between the high and low prices
    price_range = df['high'] - df['low']
    avg_range = price_range.rolling(window=N).mean()
    factor3 = price_range / avg_range
    
    # Analyze the intraday momentum
    intraday_momentum = (df['close'] - df['open']) / df['open']
    factor4 = intraday_momentum.apply(lambda x: 1 if x > 0 else -1)
    
    # Compare today's volume to the average volume over the last N days
    avg_volume = df['volume'].rolling(window=N).mean()
    volume_ratio = df['volume'] / avg_volume
    factor5 = volume_ratio
    
    # Identify days with volume significantly higher than the average
    volume_spike = (df['volume'] > avg_volume * 1.5).astype(int)
    factor6 = volume_spike
    
    # Combine the factors from trends, volatility, and volume
    final_factor = 0.3 * factor1 + 0.2 * factor2 + 0.1 * factor3 + 0.1 * factor4 + 0.2 * factor5 + 0.1 * factor6
    return final_factor
```
