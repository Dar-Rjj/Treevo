```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between close and open prices
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate the average of (close - open) over the last 5 days
    df['avg_close_open_5d'] = df['close_open_diff'].rolling(window=5).mean()
    
    # Use the ratio of (close - open) to (high - low) for a single day
    df['close_open_ratio'] = df['close_open_diff'] / (df['high'] - df['low'])
    
    # Analyze the pattern of (close - open) over the last 10 days
    df['positive_days'] = (df['close_open_diff'] > 0).rolling(window=10).sum()
    df['negative_days'] = (df['close_open_diff'] < 0).rolling(window=10).sum()
    
    # Count the consecutive days where (close - open) is positive or negative
    df['consecutive_pos'] = (df['close_open_diff'] > 0).groupby((df['close_open_diff'] <= 0).cumsum()).cumsum()
    df['consecutive_neg'] = (df['close_open_diff'] < 0).groupby((df['close_open_diff'] >= 0).cumsum()).cumsum()
    
    # Investigate the relationship between volume and (close - open)
    df['volume_weighted_close_open'] = (df['close_open_diff'] * df['volume']).rolling(window=5).sum()
    
    # Compute the standard deviation of (high - low) over the last 20 days
    df['std_high_low_20d'] = (df['high'] - df['low']).rolling(window=20).std()
    
    # Examine the change in this standard deviation over the last 5 days
    df['std_change_5d'] = df['std_high_low_20d'].pct_change(periods=5)
    
    # Calculate the ratio of (high - low) to (close - open) for each day
    df['high_low_close_open_ratio'] = (df['high'] - df['low']) / df['close_open_diff']
    
    # Average it over the last 10 days
    df['avg_high_low_close_open_ratio_10d'] = df['high_low_close_open_ratio'].rolling(window=10).mean()
    
    # Calculate the moving average of volume over the last 30 days
    df['vol_moving_avg_30d'] = df['volume'].rolling(window=30).mean()
    
    # Compare today's volume to this moving average
    df['volume_deviation'] = df['volume'] / df['vol_moving_avg_30d']
    
    # Calculate the cumulative volume over the last 7 days
    df['cumulative_volume_7d'] = df['volume'].rolling(window=7).sum()
    
    # Compare the cumulative volume of the last 7 days to the previous 7 days
    df['volume_trend'] = df['cumulative_volume_7d'].pct_change(periods=7)
    
    # Calculate the net amount (buying - selling) over the last 10 days
    df['net_amount_10d'] = df['amount'].rolling(window=10).sum()
    
    # Calculate the ratio of amount to volume for each day
    df['amount_to_volume_ratio'] = df['amount'] / df['volume']
    
    # Average it over the last 20 days
    df['avg_amount_to_volume_ratio_20d'] = df['amount_to_volume_ratio'].rolling(window=20).mean()
    
    # Combine multiple factors to create a final alpha factor
    df['alpha_factor'] = (
        df['avg_close_open_5d'] +
        df['close_open_ratio'] +
        (df['positive_days'] - df['negative_days']) +
        df['consecutive_pos'] - df['consecutive_neg'] +
        df['volume_weighted_close_open'] +
        df['std_high_low_20d'] +
        df['std_change_5d'] +
        df['avg_high_low_close_open_ratio_10d'] +
        df['volume_deviation'] +
        df['volume_trend'] +
        df['net_amount_10d'] +
        df['avg_amount_to_volume_ratio_20d']
    )
    
    return df['alpha_factor']
```
