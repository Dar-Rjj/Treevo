```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the individual factors
    df['price_change_vol'] = (df['close'] - df['open']) / df['open'] * df['volume']
    
    df['high_trend'] = (df['high'] - df['high'].rolling(window=5).max().shift(1)) / (df['high'].rolling(window=5).max().shift(1) - df['low'].rolling(window=5).min().shift(1))
    df['low_trend'] = (df['low'] - df['low'].rolling(window=5).min().shift(1)) / (df['high'].rolling(window=5).max().shift(1) - df['low'].rolling(window=5).min().shift(1))
    
    df['amount_ratio'] = df['amount'] / df['amount'].rolling(window=10).mean()
    
    df['relative_close_position'] = (df['close'] - df['low'].rolling(window=20).min()) / (df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min())
    
    df['volatility'] = df['close'].pct_change().rolling(window=20).std()

    # Combine the factors with weights
    w1, w2, w3, w4, w5, w6 = 0.2, 0.15, 0.15, 0.15, 0.2, 0.15
    df['composite_factor'] = (w1 * df['price_change_vol'] +
                              w2 * df['high_trend'] +
                              w3 * df['low_trend'] +
                              w4 * df['amount_ratio'] +
                              w5 * df['relative_close_position'] +
                              w6 * df['volatility'])
    
    # Return the composite factor
    return df['composite_factor'].dropna()
```
