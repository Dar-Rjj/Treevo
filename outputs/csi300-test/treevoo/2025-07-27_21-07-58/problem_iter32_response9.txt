```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Thought 1.1: Daily price range
    df['price_range'] = df['high'] - df['low']
    
    # Thought 1.2.1: Close-to-Close daily return
    df['close_return'] = df['close'].pct_change()
    
    # Thought 1.3.1: Open-to-Close daily return
    df['open_close_return'] = (df['close'] - df['open']) / df['open']
    
    # Thought 1.4: Average volume over the last 5 days
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    
    # Thought 2.1: Volume-to-price ratio
    df['volume_price_ratio'] = df['volume'] / df['close']
    
    # Thought 2.2: Average volume-to-price ratio over the last 5 days
    df['avg_volume_price_ratio_5d'] = df['volume_price_ratio'].rolling(window=5).mean()
    
    # Thought 3.1: Intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Thought 3.2: Average intraday momentum over the last 5 days
    df['avg_intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=5).mean()
    
    # Thought 4.1.1: Price gap
    df['price_gap'] = df['open'].shift(-1) - df['close']
    
    # Thought 4.2: Average price gap over the last 5 days
    df['avg_price_gap_5d'] = df['price_gap'].rolling(window=5).mean()
    
    # Thought 6.1.1: RSI over the last 14 days
    def rsi(series, n=14):
        delta = series.diff()
        gain = (delta.where(delta > 0, 0)).fillna(0)
        loss = (-delta.where(delta < 0, 0)).fillna(0)
        avg_gain = gain.rolling(n).mean()
        avg_loss = loss.rolling(n).mean()
        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))
        return rsi
    df['rsi_14d'] = rsi(df['close'])
    
    # Thought 6.2.1: MACD line
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    
    # Thought 6.2.2: Signal line
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    
    # Thought 6.2.3: MACD histogram
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Thought 7.1: Standard deviation of close prices over the last 20 days
    df['std_20d'] = df['close'].rolling(window=20).std()
    
    # Thought 7.2.1: True range
    df['true_range'] = df.apply(lambda row: max(row['high'] - row['low'], 
                                                 abs(row['high'] - row['close'].shift()), 
                                                 abs(row['low'] - row['close'].shift())), axis=1)
    
    # Thought 7.2.2: Average true range over the last 14 days
    df['atr_14d'] = df['true_range'].rolling(window=14).mean()
    
    # Thought 8.1.1: Weights for the final composite factor
    weights = {
        'price_range': 0.1,
        'close_return': 0.1,
        'open_close_return': 0.1,
        'avg_volume_5d': 0.1,
        'volume_price_ratio': 0.1,
        'avg_volume_price_ratio_5d': 0.1,
        'intraday_momentum': 0.1,
        'avg_intraday_momentum_5d': 0.1,
        'price_gap': 0.1,
        'avg_price_gap_5d': 0.1,
        'rsi_14d': 0.1,
        '
