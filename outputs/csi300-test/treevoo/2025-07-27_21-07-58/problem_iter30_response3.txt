```python
import pandas as pd
import numpy as np
from talib import SMA, EMA, ROC, ATR, WILLR, STOCH, OBV, CMF
from pandas.tseries.offsets import BDay

def heuristics_v2(df):
    # Calculate Simple Moving Average (SMA)
    df['SMA_5'] = SMA(df['close'], timeperiod=5)
    df['SMA_10'] = SMA(df['close'], timeperiod=10)
    df['SMA_20'] = SMA(df['close'], timeperiod=20)

    # Calculate Exponential Moving Average (EMA)
    df['EMA_5'] = EMA(df['close'], timeperiod=5)
    df['EMA_10'] = EMA(df['close'], timeperiod=10)
    df['EMA_20'] = EMA(df['close'], timeperiod=20)

    # Calculate Rate of Change (ROC)
    df['ROC_5'] = ROC(df['close'], timeperiod=5)
    df['ROC_10'] = ROC(df['close'], timeperiod=10)
    df['ROC_20'] = ROC(df['close'], timeperiod=20)

    # Calculate Historical Volatility
    df['log_returns'] = np.log(df['close']) - np.log(df['close'].shift(1))
    df['HV_5'] = df['log_returns'].rolling(window=5).std() * np.sqrt(252)
    df['HV_10'] = df['log_returns'].rolling(window=10).std() * np.sqrt(252)
    df['HV_20'] = df['log_returns'].rolling(window=20).std() * np.sqrt(252)

    # Calculate ATR
    df['ATR_5'] = ATR(df['high'], df['low'], df['close'], timeperiod=5)
    df['ATR_10'] = ATR(df['high'], df['low'], df['close'], timeperiod=10)
    df['ATR_20'] = ATR(df['high'], df['low'], df['close'], timeperiod=20)

    # Calculate Williams %R
    df['WILLR_5'] = WILLR(df['high'], df['low'], df['close'], timeperiod=5)
    df['WILLR_10'] = WILLR(df['high'], df['low'], df['close'], timeperiod=10)
    df['WILLR_20'] = WILLR(df['high'], df['low'], df['close'], timeperiod=20)

    # Calculate Stochastic Oscillator
    k, d = STOCH(df['high'], df['low'], df['close'], fastk_period=5, slowk_period=3, slowd_period=3)
    df['STOCH_K_5'] = k
    df['STOCH_D_5'] = d
    k, d = STOCH(df['high'], df['low'], df['close'], fastk_period=10, slowk_period=3, slowd_period=3)
    df['STOCH_K_10'] = k
    df['STOCH_D_10'] = d
    k, d = STOCH(df['high'], df['low'], df['close'], fastk_period=20, slowk_period=3, slowd_period=3)
    df['STOCH_K_20'] = k
    df['STOCH_D_20'] = d

    # Calculate On-Balance Volume (OBV)
    df['OBV'] = OBV(df['close'], df['volume'])

    # Calculate Chaikin Money Flow (CMF)
    def cmf(high, low, close, volume, n):
        clv = ((close - low) - (high - close)) / (high - low)
        adl = clv * volume
        return adl.rolling(n).sum() / volume.rolling(n).sum()
    df['CMF_5'] = cmf(df['high'], df['low'], df['close'], df['volume'], 5)
    df['CMF_10'] = cmf(df['high'], df['low'], df['close'], df['volume'], 10)
    df['CMF_20'] = cmf(df['high'], df['low'], df['close'], df['volume'], 20)

    # Calculate Inside Bar Pattern
    df['inside_bar_2'] = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1
