```python
import pandas as pd

def heuristics_v2(df):
    # Thought 1: Start with basic price patterns
    df['daily_price_range'] = df['high'] - df['low']
    df['daily_return_close_to_close'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['daily_return_open_to_close'] = (df['close'] - df['open']) / df['open']
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    df['sum_daily_price_range_5d'] = df['daily_price_range'].rolling(window=5).sum()

    # Thought 2: Explore relationships between price and volume
    df['volume_to_price_ratio'] = df['volume'] / df['close']
    df['avg_volume_to_price_ratio_5d'] = df['volume_to_price_ratio'].rolling(window=5).mean()
    df['cumulative_volume_to_price_ratio_5d'] = df['volume_to_price_ratio'].rolling(window=5).sum()

    # Thought 3: Investigate intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    df['avg_intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=5).mean()
    df['cumulative_intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=5).sum()

    # Thought 4: Analyze price gaps
    df['gap'] = df['open'] - df['close'].shift(1)
    df['avg_gap_5d'] = df['gap'].rolling(window=5).mean()
    df['cumulative_gap_5d'] = df['gap'].rolling(window=5).sum()

    # Thought 5: Combine factors for a more comprehensive view
    weights = {
        'sum_daily_price_range_5d': 0.2,
        'avg_volume_to_price_ratio_5d': 0.1,
        'cumulative_intraday_momentum_5d': 0.3,
        'cumulative_gap_5d': 0.2,
        'avg_intraday_momentum_5d': 0.2
    }
    
    # Thought 5.1: Create a composite factor using a weighted sum of the above factors
    df['composite_factor_sum'] = (
        df['sum_daily_price_range_5d'] * weights['sum_daily_price_range_5d'] +
        df['avg_volume_to_price_ratio_5d'] * weights['avg_volume_to_price_ratio_5d'] +
        df['cumulative_intraday_momentum_5d'] * weights['cumulative_intraday_momentum_5d'] +
        df['cumulative_gap_5d'] * weights['cumulative_gap_5d'] +
        df['avg_intraday_momentum_5d'] * weights['avg_intraday_momentum_5d']
    )

    # Thought 5.2: Create a composite factor using the product of the above factors
    df['composite_factor_product'] = (
        df['sum_daily_price_range_5d'] * weights['sum_daily_price_range_5d'] *
        df['avg_volume_to_price_ratio_5d'] * weights['avg_volume_to_price_ratio_5d'] *
        df['cumulative_intraday_momentum_5d'] * weights['cumulative_intraday_momentum_5d'] *
        df['cumulative_gap_5d'] * weights['cumulative_gap_5d'] *
        df['avg_intraday_momentum_5d'] * weights['avg_intraday_momentum_5d']
    )

    # Return the composite factor based on the sum
    return df['composite_factor_sum']
```
