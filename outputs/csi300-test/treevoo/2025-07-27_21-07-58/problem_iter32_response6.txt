```python
import pandas as pd

def heuristics_v2(df):
    # Ensure the data is a pandas DataFrame
    if not isinstance(df, pd.DataFrame):
        raise ValueError("Input should be a pandas DataFrame with index as date and columns as market features.")
    
    # Calculate the typical price
    typical_price = (df['high'] + df['low'] + df['close']) / 3.0
    
    # Calculate the money flow, which is typical price * volume
    money_flow = typical_price * df['volume']
    
    # Calculate the 14-period positive and negative money flow
    positive_flow = [money_flow[i] if typical_price[i] > typical_price[i-1] else 0 for i in range(1, len(typical_price))]
    negative_flow = [money_flow[i] if typical_price[i] < typical_price[i-1] else 0 for i in range(1, len(typical_price))]
    
    # Calculate the 14-period positive and negative money flow sums
    positive_money_flow_sum = pd.Series(positive_flow).rolling(window=14).sum()
    negative_money_flow_sum = pd.Series(negative_flow).rolling(window=14).sum()
    
    # Calculate the money flow ratio
    money_ratio = positive_money_flow_sum / negative_money_flow_sum
    
    # Calculate the money flow index (MFI)
    mfi = 100 - (100 / (1 + money_ratio))
    
    # Return the MFI series
    return mfi
```
