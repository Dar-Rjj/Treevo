```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate moving averages for close prices
    df['MA_5'] = df['close'].rolling(window=5).mean()
    df['MA_10'] = df['close'].rolling(window=10).mean()
    df['MA_20'] = df['close'].rolling(window=20).mean()

    # Compute the differences between the current close and the MAs
    df['Close_MA_5'] = df['close'] - df['MA_5']
    df['Close_MA_10'] = df['close'] - df['MA_10']
    df['Close_MA_20'] = df['close'] - df['MA_20']

    # Determine the trend by comparing the differences
    df['Trend_Score'] = (df['Close_MA_5'] + df['Close_MA_10'] + df['Close_MA_20']) / 3

    # Calculate rate of change (ROC) for closing prices
    df['ROC_5'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    df['ROC_10'] = (df['close'] - df['close'].shift(10)) / df['close'].shift(10)
    df['ROC_20'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)

    # Determine the momentum strength by comparing ROCs
    df['Momentum_Score'] = (df['ROC_5'] + df['ROC_10'] + df['ROC_20']) / 3

    # Calculate moving averages for volume
    df['Volume_MA_5'] = df['volume'].rolling(window=5).mean()
    df['Volume_MA_10'] = df['volume'].rolling(window=10).mean()
    df['Volume_MA_20'] = df['volume'].rolling(window=20).mean()

    # Compute the differences between the current volume and the MAs
    df['Volume_MA_5_diff'] = df['volume'] - df['Volume_MA_5']
    df['Volume_MA_10_diff'] = df['volume'] - df['Volume_MA_10']
    df['Volume_MA_20_diff'] = df['volume'] - df['Volume_MA_20']

    # Determine the volume trend by comparing the differences
    df['Volume_Trend_Score'] = (df['Volume_MA_5_diff'] + df['Volume_MA_10_diff'] + df['Volume_MA_20_diff']) / 3

    # Calculate moving averages for amount
    df['Amount_MA_5'] = df['amount'].rolling(window=5).mean()
    df['Amount_MA_10'] = df['amount'].rolling(window=10).mean()
    df['Amount_MA_20'] = df['amount'].rolling(window=20).mean()

    # Compute the differences between the current amount and the MAs
    df['Amount_MA_5_diff'] = df['amount'] - df['Amount_MA_5']
    df['Amount_MA_10_diff'] = df['amount'] - df['Amount_MA_10']
    df['Amount_MA_20_diff'] = df['amount'] - df['Amount_MA_20']

    # Determine the amount trend by comparing the differences
    df['Amount_Trend_Score'] = (df['Amount_MA_5_diff'] + df['Amount_MA_10_diff'] + df['Amount_MA_20_diff']) / 3

    # Identify local highs and lows
    df['Peak'] = df['high'][(df['high'].shift(1) < df['high']) & (df['high'].shift(-1) < df['high'])]
    df['Trough'] = df['low'][(df['low'].shift(1) > df['low']) & (df['low'].shift(-1) > df['low'])]

    # Evaluate the proximity of the current price to these levels
    df['Distance_to_Support'] = df['close'] - df['Trough'].fillna(method='ffill')
    df['Distance_to_Resistance'] = df['Peak'].fillna(method='ffill') - df['close']

    # Combine factors into a composite indicator
    w1, w2, w3, w4, w5, w6 = 0.2, 0.2, 0.2, 0.2, 0.1, 0.1  # Example weights
    df['Composite_Indicator'] = (
        w1 * df
