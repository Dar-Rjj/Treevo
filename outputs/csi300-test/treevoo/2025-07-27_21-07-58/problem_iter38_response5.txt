```python
import pandas as pd

def heuristics_v2(df):
    # Thought 1: Basic price patterns
    df['daily_return_close'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['daily_return_open_to_close'] = (df['close'] - df['open']) / df['open']
    
    # Thought 2: Volume-to-price ratio
    df['volume_to_price_ratio'] = df['volume'] / df['close']
    
    # Thought 3: Intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Thought 4: Price gaps
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Thought 5: Additional price and volume patterns
    df['daily_price_change'] = df['close'] - df['close'].shift(1)
    df['daily_volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Thought 6: Price and volume trends
    df['ma_5_close'] = df['close'].rolling(window=5).mean()
    df['ma_5_volume'] = df['volume'].rolling(window=5).mean()
    
    # Thought 7: Price and volume volatility
    df['std_5_daily_return'] = df['daily_return_close'].rolling(window=5).std()
    df['std_5_daily_volume'] = df['daily_volume_change'].rolling(window=5).std()
    
    # Thought 8: Composite factor
    weights = {
        'daily_return_close': 0.2,
        'daily_return_open_to_close': 0.2,
        'volume_to_price_ratio': 0.1,
        'intraday_momentum': 0.1,
        'price_gap': 0.1,
        'daily_price_change': 0.1,
        'daily_volume_change': 0.1,
        'ma_5_close': 0.05,
        'ma_5_volume': 0.05,
        'std_5_daily_return': 0.05,
        'std_5_daily_volume': 0.05
    }
    df['composite_factor'] = sum(df[col] * weight for col, weight in weights.items())
    
    # Thought 9: Refine and enhance the composite factor
    df['ma_5_composite_factor'] = df['composite_factor'].rolling(window=5).mean()
    df['refined_composite_factor'] = df['composite_factor'] - df['ma_5_composite_factor']
    
    # Thought 10: High and low price information
    df['daily_range'] = df['high'] - df['low']
    df['range_to_close_ratio'] = df['daily_range'] / df['close']
    
    # Thought 11: High and low price trends
    df['ma_5_high'] = df['high'].rolling(window=5).mean()
    df['ma_5_low'] = df['low'].rolling(window=5).mean()
    
    # Thought 12: High and low price volatility
    df['std_5_high'] = df['high'].rolling(window=5).std()
    df['std_5_low'] = df['low'].rolling(window=5).std()
    
    # Thought 13: Enhanced composite factor
    enhanced_weights = {
        'composite_factor': 0.5,
        'daily_range': 0.1,
        'range_to_close_ratio': 0.1,
        'ma_5_high': 0.05,
        'ma_5_low': 0.05,
        'std_5_high': 0.05,
        'std_5_low': 0.05
    }
    df['enhanced_composite_factor'] = sum(df[col] * weight for col, weight in enhanced_weights.items())
    
    return df['enhanced_composite_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date')
# alpha_factor = heuristics_v2(df)
```
