```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Thought 1.1: Close-to-Close daily return
    df['daily_return_close'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Thought 1.2: Open-to-Close daily return
    df['daily_return_open_close'] = (df['close'] - df['open']) / df['open']
    
    # Thought 2.1: Volume-to-Price ratio
    df['volume_to_price'] = df['volume'] / df['close']
    
    # Thought 3.1: Intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Thought 4.1: Price gap
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Thought 6.1: MACD
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Thought 7.1: ATR
    df['high_low'] = df['high'] - df['low']
    df['high_close_prev'] = np.abs(df['high'] - df['close'].shift(1))
    df['low_close_prev'] = np.abs(df['low'] - df['close'].shift(1))
    df['true_range'] = df[['high_low', 'high_close_prev', 'low_close_prev']].max(axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    # Thought 5.1 and 8.1: Composite factor
    df['composite_factor'] = (
        0.3 * df['daily_return_close'] +
        0.2 * df['daily_return_open_close'] +
        0.1 * df['volume_to_price'] +
        0.1 * df['intraday_momentum'] +
        0.1 * df['price_gap'] +
        0.1 * df['macd_histogram'] +
        0.1 * df['atr_14']
    )
    
    return df['composite_factor']
```
