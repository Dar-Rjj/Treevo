```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Thought 1.1: Calculate the daily return based on Close-to-Close
    df['daily_return_close'] = df['close'].pct_change()
    
    # Thought 1.2: Calculate the daily return based on Open-to-Close
    df['daily_return_open_close'] = (df['close'] - df['open']) / df['open']
    
    # Thought 2.1: Calculate the volume-to-price ratio
    df['volume_to_price'] = df['volume'] / df['close']
    
    # Thought 3.1: Calculate the intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Thought 4.1: Calculate the gap between today's Open and yesterday's Close
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Thought 6.1: Calculate the moving average convergence divergence (MACD)
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Thought 7.1: Calculate the average true range (ATR) over the last 14 days
    df['high_low'] = df['high'] - df['low']
    df['high_prev_close'] = abs(df['high'] - df['close'].shift(1))
    df['low_prev_close'] = abs(df['low'] - df['close'].shift(1))
    df['true_range'] = df[['high_low', 'high_prev_close', 'low_prev_close']].max(axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    # Thought 8.1: Calculate the daily price change
    df['price_change'] = df['close'] - df['close'].shift(1)
    
    # Thought 8.2: Calculate the daily volume change
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Thought 9.1: Calculate the 5-day moving average of Close prices
    df['ma_5_close'] = df['close'].rolling(window=5).mean()
    
    # Thought 9.2: Calculate the 5-day moving average of Volume
    df['ma_5_volume'] = df['volume'].rolling(window=5).mean()
    
    # Thought 10.1: Calculate the standard deviation of daily returns over the last 5 days
    df['std_5_returns'] = df['daily_return_close'].rolling(window=5).std()
    
    # Thought 10.2: Calculate the standard deviation of daily volume over the last 5 days
    df['std_5_volume'] = df['volume'].rolling(window=5).std()
    
    # Thought 11.1: Create a final composite factor using a weighted sum of all the above factors
    weights = {
        'daily_return_close': 0.1,
        'daily_return_open_close': 0.1,
        'volume_to_price': 0.1,
        'intraday_momentum': 0.1,
        'price_gap': 0.1,
        'macd_histogram': 0.1,
        'atr_14': 0.1,
        'price_change': 0.1,
        'volume_change': 0.1,
        'ma_5_close': 0.05,
        'ma_5_volume': 0.05,
        'std_5_returns': 0.05,
        'std_5_volume': 0.05
    }
    
    df['composite_factor'] = sum(df[feature] * weight for feature, weight in weights.items())
    
    return df['composite_factor']
```
