```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return based on Close-to-Close
    df['daily_return_close'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate daily return based on Open-to-Close
    df['daily_return_open'] = (df['close'] - df['open']) / df['open']
    
    # Calculate volume-to-price ratio
    df['volume_to_price'] = df['volume'] / df['close']
    
    # Calculate intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Calculate the gap between today's Open and yesterday's Close
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Calculate the daily price change
    df['daily_price_change'] = df['close'] - df['close'].shift(1)
    
    # Calculate the daily volume change
    df['daily_volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate the 5-day moving average of Close prices
    df['ma_5_close'] = df['close'].rolling(window=5).mean()
    
    # Calculate the 5-day moving average of Volume
    df['ma_5_volume'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the standard deviation of daily returns over the last 5 days
    df['std_5_daily_returns'] = df['daily_return_close'].rolling(window=5).std()
    
    # Calculate the standard deviation of daily volume over the last 5 days
    df['std_5_volume'] = df['volume'].rolling(window=5).std()
    
    # Create a composite factor using a weighted sum of the above factors
    weights = {
        'daily_return_close': 0.2,
        'daily_return_open': 0.1,
        'volume_to_price': 0.1,
        'intraday_momentum': 0.1,
        'price_gap': 0.1,
        'daily_price_change': 0.1,
        'daily_volume_change': 0.1,
        'ma_5_close': 0.05,
        'ma_5_volume': 0.05,
        'std_5_daily_returns': 0.05,
        'std_5_volume': 0.05
    }
    
    df['composite_factor'] = sum(df[col] * weight for col, weight in weights.items())
    
    # Return the composite factor as a pandas Series
    return df['composite_factor']
```
