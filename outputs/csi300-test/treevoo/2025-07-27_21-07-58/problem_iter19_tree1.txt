```txt
Improved Price and Volume Momentum Factor with Enhanced Trend Detection
├── Calculate Daily Price Change
│   ├── Use Close price
│   └── Subtract Previous Day's Close Price
├── Compute Weighted Average Price Momentum over 5 Days
│   ├── Use Daily Price Change
│   └── Apply Weights: (1, 2, 3, 4, 5)
├── Calculate Daily Volume Change
│   ├── Use Volume
│   └── Subtract Previous Day's Volume
├── Compute Weighted Average Volume Change over 10 Days
│   ├── Use Daily Volume Change
│   └── Apply Weights: (1, 2, ..., 10)
├── Combine Price Momentum and Volume Surge
│   ├── Multiply Weighted 5-Day Moving Average Price Momentum by Weighted 10-Day Moving Average Volume Change
└── Adjust by Exponential Moving Average of Volume
    ├── Calculate Exponential Moving Average of Volume over n periods
    │   ├── Use Volume from period t to t-n+1
    │   └── Use Smoothing Factor (α = 2 / (n + 1))
    └── Compare with Recent Volume
        ├── Use Volume for period t (Volume_t)
        └── Use Exponential Moving Average Volume
    ├── Volume Ratio = Volume_t / Exponential Moving Average Volume
└── Final Combined Alpha Factor
    ├── Add (Weighted 5-Day Moving Average Price Momentum * Weighted 10-Day Moving Average Volume Change) to (Daily Price Change * Volume Ratio)
```
