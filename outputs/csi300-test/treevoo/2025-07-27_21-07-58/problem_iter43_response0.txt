```python
import pandas as pd

def heuristics_v2(data):
    # Compute the difference between current close and previous close
    data['close_diff'] = data['close'].diff()

    # Compute the average of (current close - previous close) over a 5-day window
    data['price_momentum_5d'] = data['close_diff'].rolling(window=5).mean()

    # Count the number of days with positive price changes in the last 10 days
    data['positive_price_changes_10d'] = (data['close_diff'] > 0).rolling(window=10).sum()

    # Calculate the standard deviation of daily returns over a 20-day period
    data['daily_returns'] = data['close'].pct_change()
    data['volatility_20d'] = data['daily_returns'].rolling(window=20).std()

    # Compute the ratio of current volume to the 10-day moving average volume
    data['volume_ma_10d'] = data['volume'].rolling(window=10).mean()
    data['volume_ratio'] = data['volume'] / data['volume_ma_10d']

    # Calculate the 5-day moving sum of amount
    data['amount_ma_5d'] = data['amount'].rolling(window=5).sum()

    # Compare the current day's amount to the 5-day moving sum
    data['amount_ratio'] = data['amount'] / data['amount_ma_5d']

    # Generate a composite factor
    data['composite_factor'] = (data['price_momentum_5d'] 
                                + data['positive_price_changes_10d'] 
                                - data['volatility_20d'] 
                                + data['volume_ratio'] 
                                + data['amount_ratio'])

    return data['composite_factor']
```
