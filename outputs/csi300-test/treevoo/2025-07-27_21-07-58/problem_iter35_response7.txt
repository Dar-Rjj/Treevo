```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily price range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate daily return based on Close-to-Close
    df['daily_return_close'] = df['close'].pct_change()
    
    # Calculate daily return based on Open-to-Close
    df['daily_return_open_close'] = (df['close'] - df['open']) / df['open']
    
    # Calculate volume-to-price ratio
    df['volume_to_price'] = df['volume'] / df['close']
    
    # Calculate the average volume-to-price ratio over the last 5 days
    df['avg_volume_to_price_5d'] = df['volume_to_price'].rolling(window=5).mean()
    
    # Calculate intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Calculate the average intraday momentum over the last 5 days
    df['avg_intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=5).mean()
    
    # Calculate the gap between today's Open and yesterday's Close
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Calculate the average gap over the last 5 days
    df['avg_gap_5d'] = df['price_gap'].rolling(window=5).mean()
    
    # Calculate the daily price change
    df['daily_price_change'] = df['close'] - df['close'].shift(1)
    
    # Calculate the average daily price change over the last 5 days
    df['avg_daily_price_change_5d'] = df['daily_price_change'].rolling(window=5).mean()
    
    # Calculate the daily volume change
    df['daily_volume_change'] = df['volume'] - df['volume'].shift(1)
    
    # Calculate the average daily volume change over the last 5 days
    df['avg_daily_volume_change_5d'] = df['daily_volume_change'].rolling(window=5).mean()
    
    # Calculate the 5-day moving average of Close prices
    df['ma_close_5d'] = df['close'].rolling(window=5).mean()
    
    # Calculate the 5-day moving average of Volume
    df['ma_volume_5d'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the 5-day moving average of the volume-to-price ratio
    df['ma_volume_to_price_5d'] = df['volume_to_price'].rolling(window=5).mean()
    
    # Calculate the standard deviation of daily returns over the last 5 days
    df['std_daily_return_5d'] = df['daily_return_close'].rolling(window=5).std()
    
    # Calculate the standard deviation of daily volume over the last 5 days
    df['std_daily_volume_5d'] = df['volume'].rolling(window=5).std()
    
    # Calculate the daily price change as a percentage of the high price
    df['daily_price_change_percent_high'] = (df['close'] - df['close'].shift(1)) / df['high'].shift(1)
    
    # Calculate the daily volume change as a percentage of the previous day's volume
    df['daily_volume_change_percent'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Calculate the 5-day momentum of the price range
    df['momentum_price_range_5d'] = df['price_range'] - df['price_range'].shift(5)
    
    # Calculate the 5-day RSI of the close price
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=5).mean()
    avg_loss = loss.rolling(window=5).mean()
    rs = avg_gain / avg_loss
    df['rsi_close_5d'] = 100 - (100 / (1 + rs))
    
    # Create a sophisticated composite factor using a weighted sum of all factors
    weights = {
        'price_range': 0.1,
        'daily_return_close': 0.1,
        'daily_return_open_close': 0.1,
        'avg_volume_to_price_5d': 0.1,
        'avg_intraday_momentum_5d': 0.1,
        'avg_gap_5d': 0.1,
        'avg_daily_price_change_5d': 
