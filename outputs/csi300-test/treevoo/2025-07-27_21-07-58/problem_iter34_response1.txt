```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return based on Close-to-Close
    df['daily_return_close'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate the daily return based on Open-to-Close
    df['daily_return_open_close'] = (df['close'] - df['open']) / df['open']
    
    # Calculate the volume-to-price ratio
    df['volume_to_price_ratio'] = df['volume'] / df['close']
    
    # Calculate the intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Calculate the gap between today's Open and yesterday's Close
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Create a composite factor using a weighted sum of the factors
    weights = {
        'daily_return_close': 0.3,
        'daily_return_open_close': 0.2,
        'volume_to_price_ratio': 0.1,
        'intraday_momentum': 0.2,
        'price_gap': 0.2
    }
    
    # Sum the weighted factors to create a single composite factor
    df['composite_factor'] = (
        df['daily_return_close'] * weights['daily_return_close'] +
        df['daily_return_open_close'] * weights['daily_return_open_close'] +
        df['volume_to_price_ratio'] * weights['volume_to_price_ratio'] +
        df['intraday_momentum'] * weights['intraday_momentum'] +
        df['price_gap'] * weights['price_gap']
    )
    
    # Return the composite factor as a pandas Series
    return df['composite_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
```
