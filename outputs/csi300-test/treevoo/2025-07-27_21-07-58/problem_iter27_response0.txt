```python
import pandas as pd

def heuristics_v2(df):
    # Thought 1.1: Calculate the difference between high and low prices (Price Range)
    df['price_range'] = df['high'] - df['low']
    df['avg_price_range_5'] = df['price_range'].rolling(window=5).mean()
    df['avg_price_range_20'] = df['price_range'].rolling(window=20).mean()

    # Thought 1.2: Analyze Open and Close prices
    df['close_to_close_return'] = df['close'].pct_change()
    df['open_to_close_return'] = (df['close'] - df['open']) / df['open']

    # Thought 1.3: Analyze Volume
    df['volume_change'] = df['volume'].diff()
    df['avg_volume_5'] = df['volume'].rolling(window=5).mean()
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()

    # Thought 2.1: Calculate the ratio of volume to price
    df['volume_to_price'] = df['volume'] / df['close']
    df['avg_volume_to_price_5'] = df['volume_to_price'].rolling(window=5).mean()
    df['avg_volume_to_price_20'] = df['volume_to_price'].rolling(window=20).mean()

    # Thought 3.1: Calculate the intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    df['avg_intraday_momentum_5'] = df['intraday_momentum'].rolling(window=5).mean()
    df['avg_intraday_momentum_20'] = df['intraday_momentum'].rolling(window=20).mean()

    # Thought 4.1: Calculate the gap between today's Open and yesterday's Close
    df['gap'] = df['open'] - df['close'].shift(1)
    df['avg_gap_5'] = df['gap'].rolling(window=5).mean()
    df['avg_gap_20'] = df['gap'].rolling(window=20).mean()

    # Thought 5.1: Create a composite factor using a weighted sum of the above factors
    weights = {
        'avg_price_range_20': 0.1,
        'avg_volume_20': 0.1,
        'avg_volume_to_price_20': 0.1,
        'avg_intraday_momentum_20': 0.2,
        'avg_gap_20': 0.1,
        'close_to_close_return': 0.2,
        'open_to_close_return': 0.2
    }

    df['composite_factor'] = (df['avg_price_range_20'] * weights['avg_price_range_20'] +
                              df['avg_volume_20'] * weights['avg_volume_20'] +
                              df['avg_volume_to_price_20'] * weights['avg_volume_to_price_20'] +
                              df['avg_intraday_momentum_20'] * weights['avg_intraday_momentum_20'] +
                              df['avg_gap_20'] * weights['avg_gap_20'] +
                              df['close_to_close_return'] * weights['close_to_close_return'] +
                              df['open_to_close_return'] * weights['open_to_close_return'])

    return df['composite_factor']
```
