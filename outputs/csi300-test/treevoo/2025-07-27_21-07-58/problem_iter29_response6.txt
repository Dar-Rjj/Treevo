```python
import pandas as pd
import numpy as np
from talib import abstract

def heuristics_v2(df):
    # Calculate technical indicators
    df['SMA_20'] = abstract.SMA(df, timeperiod=20)
    df['SMA_50'] = abstract.SMA(df, timeperiod=50)
    df['EMA_20'] = abstract.EMA(df, timeperiod=20)
    df['EMA_50'] = abstract.EMA(df, timeperiod=50)
    df['RSI_14'] = abstract.RSI(df, timeperiod=14)
    df['ROC_12'] = abstract.ROC(df, timeperiod=12)

    # Volume-based indicators
    df['OBV'] = abstract.OBV(df)
    df['CMF_20'] = abstract.CMF(df, timeperiod=20)

    # Volatility indicators
    bbands = abstract.BBANDS(df, timeperiod=20, nbdevup=2, nbdevdn=2, matype=0)
    df['ATR_14'] = abstract.ATR(df, timeperiod=14)
    df['BBANDS_Upper'] = bbands['upperband']
    df['BBANDS_Lower'] = bbands['lowerband']

    # Price patterns
    def inside_bar(open, high, low, close):
        return (high < high.shift(1)) & (low > low.shift(1))
    df['Inside_Bar'] = df.apply(lambda x: inside_bar(x['open'], x['high'], x['low'], x['close']), axis=1)

    def outside_bar(open, high, low, close):
        return (high > high.shift(1)) & (low < low.shift(1))
    df['Outside_Bar'] = df.apply(lambda x: outside_bar(x['open'], x['high'], x['low'], x['close']), axis=1)

    # Custom factors
    df['Price_Volatility_Ratio'] = df['close'] / df['ATR_14']
    df['Volume_Weighted_Close'] = (df['close'] * df['volume']) / df['volume'].rolling(window=20).sum()
    df['Momentum_Volume_Composite'] = (df['ROC_12'] + df['OBV']) / 2

    # Create a combined alpha factor
    df['Alpha_Factor'] = (
        0.3 * df['SMA_20'] +
        0.2 * df['EMA_50'] +
        0.1 * df['RSI_14'] +
        0.1 * df['ROC_12'] +
        0.1 * df['OBV'] +
        0.1 * df['CMF_20'] +
        0.1 * df['Price_Volatility_Ratio'] +
        0.1 * df['Volume_Weighted_Close'] +
        0.1 * df['Momentum_Volume_Composite']
    )
    
    return df['Alpha_Factor'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
```
