```python
import pandas as pd

def heuristics_v2(df):
    # Factor1: Price change relative to opening price, weighted by volume
    df['Factor1'] = (df['close'] - df['open']) / df['open'] * df['volume']
    
    # Factor2: Trend in highs over the last 5 days
    df['Factor2'] = df['high'] - df['high'].rolling(window=5).max().shift(1)
    
    # Factor3: Trend in lows over the last 5 days
    df['Factor3'] = df['low'] - df['low'].rolling(window=5).min().shift(1)
    
    # Factor4: Amount transacted compared to the 10-day moving average of amount
    df['Factor4'] = df['amount'] / df['amount'].rolling(window=10).mean()
    
    # Factor5: Momentum in closing prices relative to recent high and low over 20 days
    recent_min = df['low'].rolling(window=20).min()
    recent_max = df['high'].rolling(window=20).max()
    df['Factor5'] = (df['close'] - recent_min) / (recent_max - recent_min)
    
    # Composite factor, equal weights for simplicity
    w1, w2, w3, w4, w5 = 0.2, 0.2, 0.2, 0.2, 0.2
    df['Composite_Factor'] = (w1 * df['Factor1'] + w2 * df['Factor2'] 
                            + w3 * df['Factor3'] + w4 * df['Factor4'] + w5 * df['Factor5'])
    
    return df['Composite_Factor']

# Example usage:
# Assuming df is a pandas DataFrame with the required columns
# composite_factor = heuristics_v2(df)
```
