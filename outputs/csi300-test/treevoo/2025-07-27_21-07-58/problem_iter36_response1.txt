```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the price change factor weighted by volume
    df['price_change_vol_weighted'] = (df['close'] - df['open']) / df['open'] * df['volume']
    
    # Calculate the trend in highs over the past 5 days
    df['high_trend'] = (df['high'] - df['high'].rolling(window=5).max().shift(1)) / df['high'].rolling(window=5).max().shift(1)
    
    # Calculate the trend in lows over the past 5 days
    df['low_trend'] = (df['low'] - df['low'].rolling(window=5).min().shift(1)) / df['low'].rolling(window=5).min().shift(1)
    
    # Compute the ratio of the current day's traded amount to the moving average of the amount over the past 9 days
    df['amount_ratio'] = df['amount'] / df['amount'].rolling(window=9).mean().shift(1)
    
    # Determine the stock's closing position relative to its recent high and low over the past 20 days
    df['momentum_factor'] = (df['close'] - df['low'].rolling(window=20).min()) / (df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min())
    
    # Combine the factors to create a composite alpha factor
    weights = [0.3, 0.1, 0.1, 0.2, 0.3]  # Example weights
    df['composite_factor'] = (weights[0] * df['price_change_vol_weighted'] +
                              weights[1] * df['high_trend'] +
                              weights[2] * df['low_trend'] +
                              weights[3] * df['amount_ratio'] +
                              weights[4] * df['momentum_factor'])
    
    # Return the composite factor as a pandas Series
    return df['composite_factor']
```
