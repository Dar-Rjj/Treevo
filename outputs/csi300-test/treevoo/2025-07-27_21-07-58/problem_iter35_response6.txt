```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily price range (High - Low)
    df['price_range'] = df['high'] - df['low']
    
    # Calculate daily return based on Close-to-Close
    df['close_to_close_return'] = (df['close'].diff() / df['close'].shift(1)).fillna(0)
    
    # Calculate daily return based on Open-to-Close
    df['open_to_close_return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate the average volume over the last 5 days
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    
    # Calculate the sum of the daily price range over the last 5 days
    df['sum_price_range_5d'] = df['price_range'].rolling(window=5).sum()
    
    # Calculate the volume-to-price ratio
    df['volume_to_price_ratio'] = df['volume'] / df['close']
    
    # Calculate the average volume-to-price ratio over the last 5 days
    df['avg_volume_to_price_ratio_5d'] = df['volume_to_price_ratio'].rolling(window=5).mean()
    
    # Calculate the cumulative volume-to-price ratio over the last 5 days
    df['cumulative_volume_to_price_ratio_5d'] = df['volume_to_price_ratio'].rolling(window=5).sum()
    
    # Calculate the intraday momentum
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Calculate the average intraday momentum over the last 5 days
    df['avg_intraday_momentum_5d'] = df['intraday_momentuM'].rolling(window=5).mean()
    
    # Calculate the cumulative intraday momentum over the last 5 days
    df['cumulative_intraday_momentum_5d'] = df['intraday_momentum'].rolling(window=5).sum()
    
    # Calculate the gap between today's Open and yesterday's Close
    df['gap'] = df['open'] - df['close'].shift(1)
    
    # Calculate the average gap over the last 5 days
    df['avg_gap_5d'] = df['gap'].rolling(window=5).mean()
    
    # Calculate the cumulative gap over the last 5 days
    df['cumulative_gap_5d'] = df['gap'].rolling(window=5).sum()
    
    # Calculate short-term and medium-term price momentum
    df['short_term_momentum'] = (df['close'] / df['close'].shift(5)) - 1
    df['medium_term_momentum'] = (df['close'] / df['close'].shift(20)) - 1
    
    # Calculate weighted average of high and low prices
    df['weighted_avg_high_low'] = (df['high'] + df['low']) / 2 * df['volume']
    
    # Calculate 5-day moving average of weighted avg. H/L
    df['avg_weighted_avg_high_low_5d'] = df['weighted_avg_high_low'].rolling(window=5).mean()
    
    # Calculate cumulative volume-adjusted return
    df['cumulative_volume_adjusted_return_5d'] = (df['close'] - df['open']) * df['volume']
    df['cumulative_volume_adjusted_return_5d'] = df['cumulative_volume_adjusted_return_5d'].rolling(window=5).sum()
    
    # Calculate ratio of today's volume to 5-day average volume
    df['volume_ratio_5d'] = df['volume'] / df['avg_volume_5d']
    
    # Calculate trend in volume
    df['volume_trend_5d'] = (df['volume'] - df['volume'].shift(5)) / 5
    
    # Calculate 5-day moving average of daily price range
    df['avg_price_range_5d'] = df['price_range'].rolling(window=5).mean()
    
    # Calculate relative daily range
    df['relative_daily_range'] = df['price_range'] / df['close'].shift(1)
    
    # Calculate standard deviation of close prices over 20 days
    df['std_dev_close_20d'] = df['close'].rolling(window=20).std()
    
    # Calculate volume-weighted close price
    df['volume_weighted_close'] = df['close'] * df['volume']
    
    # Calculate 5-day moving average of volume-weighted close price
    df['avg_volume_weighted_close_5d'] = df['volume_weighted_close'].rolling(window=5).mean()
    
    # Calculate price change with volume influence

