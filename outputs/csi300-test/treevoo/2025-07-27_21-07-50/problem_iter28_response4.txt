```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum Factors
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['ROC_20'] = df['close'].pct_change(20)
    df['ROC_60'] = df['close'].pct_change(60)
    
    # Volume Factors
    df['VWAP_30'] = (df['amount'] / df['volume']).rolling(window=30).mean()
    df['VWAP_90'] = (df['amount'] / df['volume']).rolling(window=90).mean()
    obv = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    df['OBV'] = obv
    
    # Volatility Factors
    df['ATR_14'] = df[['high', 'low']].apply(lambda x: x.diff().abs().max(axis=1), axis=1).rolling(window=14).mean()
    std_dev = df['close'].rolling(window=20).std()
    df['Upper_Band_20'] = df['close'].rolling(window=20).mean() + 2 * std_dev
    df['Lower_Band_20'] = df['close'].rolling(window=20).mean() - 2 * std_dev
    
    # Trend Strength and Direction
    df['DMI_14'] = (df['high'] - df['low']).rolling(window=14).mean() / (df['high'] + df['low']).rolling(window=14).mean()
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI_14'] = 100 - (100 / (1 + rs))
    
    # Reversal Patterns
    df['Bearish_Engulfing'] = ((df['open'] > df['close']) & (df['open'].shift(-1) < df['close'].shift(-1)) & (df['close'].shift(-1) > df['open']) & (df['open'].shift(-1) > df['close']))
    df['Bullish_Engulfing'] = ((df['open'] < df['close']) & (df['open'].shift(-1) > df['close'].shift(-1)) & (df['close'].shift(-1) < df['open']) & (df['open'].shift(-1) < df['close']))
    df['Doji_Star'] = (df['high'] - df['low']) / (df['high'] - df['low']).rolling(window=30).mean() < 0.1
    
    # Liquidity Factors
    df['High_Low_Spread'] = df['high'] - df['low']
    df['Average_High_Low_Spread_30'] = df['High_Low_Spread'].rolling(window=30).mean()
    df['Open_Close_Spread'] = df['open'] - df['close']
    df['Average_Open_Close_Spread_30'] = df['Open_Close_Spread'].rolling(window=30).mean()
    
    # Breakout Factors
    df['52_Week_High'] = df['high'].rolling(window=252).max()
    df['52_Week_Low'] = df['low'].rolling(window=252).min()
    df['Gap_Up'] = (df['open'] > df['high'].shift(1))
    df['Gap_Down'] = (df['open'] < df['low'].shift(1))
    df['Number_of_Gaps_30'] = df['Gap_Up'] + df['Gap_Down']
    
    # Market Sentiment
    # Put-Call Ratio and Short Interest Ratio are not directly calculable from the given data.
    
    # Earnings Factors
    # Earnings Surprise and Earnings Growth are not directly calculable from the given data.
    
    # Financial Health
    # Debt-to-Equity Ratio and Current Ratio are not directly calculable from the given data.
    
    # Technical Indicators
    df['%K_14'] = 100 * (df['close'] - df['low'].rolling(window=14).min()) / (df['high'].rolling(window=14).max() - df['
