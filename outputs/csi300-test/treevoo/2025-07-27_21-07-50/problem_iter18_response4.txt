```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum and Trend Analysis
    df['weighted_avg_close'] = (df['close'] * np.arange(1, 11)[::-1]).rolling(window=10).sum() / np.sum(np.arange(1, 11))
    df['roc_adj_volume'] = (df['close'].pct_change(periods=5) * df['volume']) / df['volume'].rolling(window=5).mean()
    df['cum_sum_returns'] = (df['close'].pct_change().rolling(window=20).sum()).rolling(window=20).mean()

    # Volume Anomaly and Surge Detection
    df['vol_30_ma'] = df['volume'].rolling(window=30).mean()
    df['vol_ratio_max_40'] = df['volume'] / df['volume'].rolling(window=40).max()
    df['vol_dec_price_inc'] = ((df['volume'] > df['volume'].shift(1)) & (df['close'] < df['close'].shift(1))).rolling(window=20).sum() / df['volume'].rolling(window=20).std()

    # Price Volatility and Stability
    df['std_close_20'] = df['close'].rolling(window=20).std()
    df['atr'] = df[['high', 'low', 'close']].apply(lambda x: x.diff().abs().max(axis=1), axis=1).rolling(window=14).mean()
    df['atr_ratio'] = df['atr'] / df['atr'].shift(14)
    df['high_low_ratio_20'] = df['high'].rolling(window=20).max() / df['low'].rolling(window=20).min()
    df['high_low_ratio_10'] = df['high'].rolling(window=10).max() / df['low'].rolling(window=10).min()

    # Reversal and Continuation Patterns
    df['bearish_engulfing'] = ((df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & (df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1)))
    df['bullish_engulfing'] = ((df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & (df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1)))
    df['hammer_hanging_man'] = ((df['close'] - df['low']) / (df['high'] - df['low']) > 0.66) & ((df['high'] - df['close']) / (df['high'] - df['low']) > 0.66)

    # Liquidity and Trading Activity
    df['vol_amount_ratio'] = df['volume'] / df['amount']
    df['vol_amount_ratio_20_ma'] = df['vol_amount_ratio'].rolling(window=20).mean()
    df['down_vol_up_vol_ratio'] = df.apply(lambda x: x['volume'] if x['close'] > x['close'].shift(1) else 0, axis=1).rolling(window=20).sum() / \
                                  df.apply(lambda x: x['volume'] if x['close'] < x['close'].shift(1) else 0, axis=1).rolling(window=20).sum()

    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['weighted_avg_close'] + 
                          df['roc_adj_volume'] + 
                          df['cum_sum_returns'] + 
                          df['vol_ratio_max_40'] + 
                          df['vol_dec_price_inc'] + 
                          df['std_close_20'] + 
                          df['atr_ratio'] + 
                          df['high_low_ratio_10'] + 
                          df['bearish_engulfing'] + 
                          df['bullish_engulfing'] + 
                          df['hammer_hanging_man'] + 
                          df['vol_amount_ratio_20_ma'] + 
                          df['down_vol_up_vol_ratio'])

    return df['alpha_factor']
```
