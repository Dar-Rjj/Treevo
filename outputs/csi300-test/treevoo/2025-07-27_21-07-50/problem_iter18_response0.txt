```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate 5-day and 20-day EMA of Close Price
    df['ema_5_close'] = df['close'].ewm(span=5, adjust=False).mean()
    df['ema_20_close'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Determine the relationship between 5-day and 20-day EMA of Close Price
    df['ema_trend_strength'] = df['ema_5_close'] - df['ema_20_close']
    
    # Calculate 5-day EMA of Volume
    df['ema_5_volume'] = df['volume'].ewm(span=5, adjust=False).mean()
    
    # Evaluate the change in 5-day EMA of Volume
    df['ema_5_volume_change'] = df['ema_5_volume'].pct_change()
    
    # Calculate Daily Price Range (High - Low)
    df['daily_price_range'] = df['high'] - df['low']
    
    # Compute the Median Daily Price Range over the past 20 days
    df['median_daily_price_range'] = df['daily_price_range'].rolling(window=20).median()
    
    # Calculate the ratio of today's Daily Price Range to the 20-day Median Daily Price Range
    df['price_range_ratio'] = df['daily_price_range'] / df['median_daily_price_range']
    
    # Assess the gap between Open and Close Prices
    df['open_close_gap'] = df['open'] - df['close']
    
    # Analyze the distribution and frequency of positive versus negative gaps
    df['gap_sign'] = np.sign(df['open_close_gap'])
    
    # Calculate the Volume-Weighted Average Price (VWAP) for each day
    df['vwap'] = (df['amount'] / df['volume']).cumsum() / (df['volume'].cumsum())
    
    # Use VWAP to identify significant deviations from the average price
    df['vwap_deviation'] = df['close'] - df['vwap']
    
    # Compare VWAP trends with exponential moving averages
    df['vwap_ema_5_diff'] = df['vwap'] - df['ema_5_close']
    
    # Compute the 14-day Commodity Channel Index (CCI)
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    mean_typical_price = typical_price.rolling(window=14).mean()
    mad_typical_price = typical_price.rolling(window=14).apply(lambda x: pd.Series(x).mad(), raw=True)
    df['cci'] = (typical_price - mean_typical_price) / (0.015 * mad_typical_price)
    
    # Evaluate overbought and oversold conditions using CCI
    df['cci_signal'] = df['cci'].apply(lambda x: 1 if x > 100 else (-1 if x < -100 else 0))
    
    # Integrate CCI with EMA signals to filter out potential false breakout signals
    df['cci_ema_signal'] = np.where((df['cci_signal'] == 1) & (df['ema_trend_strength'] > 0), 1,
                                     np.where((df['cci_signal'] == -1) & (df['ema_trend_strength'] < 0), -1, 0))
    
    # Calculate the standard deviation of high, low, and close prices over the last 30 days
    df['std_dev_high_low_close'] = df[['high', 'low', 'close']].std(axis=1).rolling(window=30).mean()
    
    # Examine the ratio of the 30-day standard deviation to the daily return
    df['std_dev_daily_return_ratio'] = df['std_dev_high_low_close'] / df['close'].pct_change()
    
    # Track the net amount traded at the bid versus the ask
    df['net_amount_bid_ask'] = df['amount'].diff()
    
    # Measure the imbalance ratio over a specific period
    df['imbalance_ratio'] = df['net_amount_bid_ask'].rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    
    # Calculate the 14-day Rate of Change (ROC) of Close Price
    df['roc_14'] = df['close'].pct_change(periods=14)
    
    # Calculate the 10-day Accumulation/Distribution Line (ADL)
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] -
