```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the momentum factor using closing prices
    df['return_10'] = df['close'].pct_change(10)
    df['return_20'] = df['close'].pct_change(20)
    df['return_50'] = df['close'].pct_change(50)
    df['momentum'] = 0.5 * df['return_10'] + 0.3 * df['return_20'] + 0.2 * df['return_50']

    # Calculate the price-volume trend
    df['avg_volume_10'] = df['volume'].rolling(window=10).mean()
    df['price_change'] = df['close'].pct_change()
    df['price_volume_indicator'] = df['price_change'] * (df['volume'] / df['avg_volume_10'])

    # Calculate the volatility factor
    df['log_return'] = df['close'].apply(lambda x: np.log(x))
    df['volatility'] = df['log_return'].rolling(window=30).std()

    # Calculate the relative strength index (RSI)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi'] = 100 - (100 / (1 + rs))

    # Calculate the money flow index (MFI)
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    positive_money_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_money_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)
    positive_sum = positive_money_flow.rolling(window=14).sum()
    negative_sum = negative_money_flow.rolling(window=14).sum()
    money_flow_ratio = positive_sum / negative_sum
    df['mfi'] = 100 - (100 / (1 + money_flow_ratio))

    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['momentum'] + df['price_volume_indicator'] - df['volatility'] +
                          (df['rsi'] - 50) + (df['mfi'] - 50)) / 5

    return df['alpha_factor']

# Example usage:
# df = pd.DataFrame(index=pd.date_range(start='2023-01-01', periods=100), 
#                   data={'open': np.random.randn(100).cumsum() + 100,
#                         'high': np.random.randn(100).cumsum() + 105,
#                         'low': np.random.randn(100).cumsum() + 95,
#                         'close': np.random.randn(100).cumsum() + 100,
#                         'amount': np.random.randint(100, 1000, size=100),
#                         'volume': np.random.randint(1000, 5000, size=100)})
# alpha_factor = heuristics_v2(df)
```
