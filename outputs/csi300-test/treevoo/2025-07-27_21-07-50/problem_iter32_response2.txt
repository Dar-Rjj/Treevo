```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Ensure the DataFrame is sorted by date
    df = df.sort_index()
    
    # Calculate the basic price differences
    df['price_diff'] = df['close'] - df['close'].shift(1)
    
    # Calculate the deviation from the 5-day average
    df['price_deviation_5d_avg'] = df['close'] - df['close'].rolling(window=5).mean()
    
    # Calculate the difference from the 10-day high-low range
    df['high_low_range_10d'] = df['close'] - (df['close'].rolling(window=10).max() - df['close'].rolling(window=10).min())
    
    # Calculate the daily high-low spread
    df['daily_high_low_spread'] = df['high'] - df['low']
    
    # Calculate the 14-day average of intraday volatility measures
    df['intraday_volatility'] = (df['high'] - df['low']).rolling(window=14).mean()
    df['avg_intraday_volatility_measures'] = ((df['high'] - df['low']) + 
                                               abs(df['high'] - df['close'].shift(1)) + 
                                               abs(df['low'] - df['close'].shift(1))).rolling(window=14).mean()
    
    # Calculate the change in daily high-low spread
    df['change_in_daily_high_low_spread'] = abs((df['high'] - df['low']) - (df['high'].shift(1) - df['low'].shift(1)))
    
    # Calculate the volume ratio to 20-day average
    df['volume_ratio_to_20d_avg'] = df['volume'] / (df['volume'].rolling(window=20).mean())
    
    # Calculate the volume change ratio
    df['volume_change_ratio'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Calculate the volume deviation from 20-day average
    df['volume_deviation_from_20d_avg'] = df['volume'] - df['volume'].rolling(window=20).mean()
    
    # Calculate the money flow
    df['money_flow'] = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    
    # Calculate the money flow index over 14 days
    positive_money_flow = df['money_flow'].where(df['close'] > df['close'].shift(1), 0)
    negative_money_flow = df['money_flow'].where(df['close'] < df['close'].shift(1), 0)
    df['positive_money_flow_sum'] = positive_money_flow.rolling(window=14).sum()
    df['negative_money_flow_sum'] = negative_money_flow.rolling(window=14).sum()
    df['money_flow_index'] = df['positive_money_flow_sum'] / df['negative_money_flow_sum']
    
    # Calculate the volatility of money flow over 14 days
    df['money_flow_volatility'] = df['money_flow'].rolling(window=14).std()
    
    # Construct the final alpha factor
    alpha_factor = (
        df['price_diff'] + 
        df['price_deviation_5d_avg'] + 
        df['high_low_range_10d'] + 
        df['daily_high_low_spread'] + 
        df['avg_intraday_volatility_measures'] + 
        df['change_in_daily_high_low_spread'] + 
        df['volume_ratio_to_20d_avg'] + 
        df['volume_change_ratio'] + 
        df['volume_deviation_from_20d_avg'] + 
        df['money_flow_index'] + 
        df['money_flow_volatility']
    )
    
    return alpha_factor
```
