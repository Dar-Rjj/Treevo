```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the price change and volume change
    df['price_change'] = df['close'].pct_change()
    df['volume_change'] = df['volume'].pct_change()
    
    # Calculate the average true range
    df['true_range'] = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    df['avg_true_range'] = df['true_range'].rolling(window=14).mean()
    
    # Calculate the money flow index
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    positive_flow = [0]
    negative_flow = [0]

    for i in range(1, len(typical_price)):
        if typical_price[i] > typical_price[i-1]:
            positive_flow.append(raw_money_flow[i])
            negative_flow.append(0)
        elif typical_price[i] < typical_price[i-1]:
            positive_flow.append(0)
            negative_flow.append(raw_money_flow[i])
        else:
            positive_flow.append(0)
            negative_flow.append(0)

    df['positive_money_flow'] = positive_flow
    df['negative_money_flow'] = negative_flow
    
    # Calculate the 14-period MFI
    n_positive = df['positive_money_flow'].rolling(window=14).sum()
    n_negative = df['negative_money_flow'].rolling(window=14).sum()
    mfi = 100 * (n_positive / (n_positive + n_negative))
    
    # Combine the factors into a final score
    factor_value = df['price_change'] * df['volume_change'] * mfi / (df['avg_true_range'] + 1)
    
    return factor_value
```
