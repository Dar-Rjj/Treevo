```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Integrated Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    
    # Integrate Volume into Intraday Return
    df['volume_adjusted_intraday_return'] = df['intraday_return'] * df['volume']
    
    # Calculate Intraday Range
    df['intraday_range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate Price Volatility
    df['price_volatility'] = df['close'].pct_change().rolling(window=5).std()
    
    # Calculate Volume Volatility
    df['volume_volatility'] = df['volume'].pct_change().rolling(window=5).std()
    
    # Combine Adjusted Intraday Returns and Volatility
    df['corrected_intraday_momentum'] = df['volume_adjusted_intraday_return'] - df['price_volatility'] - df['volume_volatility']
    
    # Calculate Integrated Momentum
    df['momentum'] = df['close'].pct_change(periods=5)
    
    # Integrate Volume into Momentum
    df['volume_adjusted_momentum'] = df['momentum'] * df['volume']
    
    # Calculate Intraday Volatility
    df['abs_daily_return'] = abs(df['close'].pct_change())
    df['intraday_volatility'] = df['abs_daily_return'].rolling(window=20).sum() / 20
    
    # Calculate Volume Thrust
    df['volume_thrust'] = (df['volume'] > df['volume'].shift(1)).astype(int)
    
    # Combine Adjusted Momentum and Intraday Factors
    df['combined_factor'] = df['volume_adjusted_momentum'] - df['intraday_volatility'] + df['corrected_intraday_momentum']
    
    # Calculate High-Low Spread Ratio
    df['high_low_spread_ratio'] = (df['high'] - df['low']) / (df['high'] + df['low'])
    
    # Calculate Volume-Weighted Close-Open Difference
    df['volume_weighted_close_open_diff'] = (df['close'] - df['open']) * df['volume']
    
    # Integrate Both Factors
    df['integrated_factor'] = df['high_low_spread_ratio'] * df['volume_weighted_close_open_diff']
    
    # Final Factor Integration
    df['final_factor'] = df['combined_factor'] * df['volume_thrust'] * df['integrated_factor']
    
    return df['final_factor']
```
