```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']
    
    # Volume-Weighted Intraday Return
    vol_weighted_intraday_return = (df['close'] - df['open']) * np.sqrt(df['volume'])
    
    # Price Volatility and Volume Volatility
    price_volatility = df['close'].pct_change().rolling(window=22).std()
    volume_volatility = df['volume'].rolling(window=22).std()
    
    # Volatility Correction
    volatility_correction = price_volatility + volume_volatility
    corrected_intraday_momentum = vol_weighted_intraday_return / volatility_correction
    
    # Composite Alpha Factor
    vol_weighted_close_open_diff = (df['close'] - df['open']) * df['volume']
    ema_21_close = df['close'].ewm(span=21, adjust=False).mean()
    volume_weighted_close = df['close'] * df['volume']
    subtract_sma = volume_weighted_close - ema_21_close
    vami = (df['close'] - df['open']) * df['volume'] / df['volume'].ewm(span=20, adjust=False).mean()
    short_term_reversal = df['close'].pct_change().rolling(window=5).sum()
    
    composite_alpha_factor = (vol_weighted_close_open_diff + 
                              subtract_sma + 
                              vami + 
                              short_term_reversal)
    
    # Final Integration
    combined_factors = corrected_intraday_momentum + composite_alpha_factor
    long_term_trend = df['close'].rolling(window=100).mean()
    short_term_trend = df['close'].ewm(span=20, adjust=False).mean()
    
    trend_adjustment = np.where(short_term_trend > long_term_trend, 1.75, 0.75)
    final_factor = combined_factors * trend_adjustment
    
    return final_factor
```
