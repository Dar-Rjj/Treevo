```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the momentum factor using closing prices
    returns_10 = df['close'].pct_change(10)
    returns_20 = df['close'].pct_change(20)
    returns_50 = df['close'].pct_change(50)
    momentum_score = 0.4 * returns_10 + 0.35 * returns_20 + 0.25 * returns_50

    # Calculate Volume-Weighted Close-Open Difference
    close_open_diff = (df['close'] - df['open']) * df['volume']

    # Integrate Momentum and Volume-Weighted Close-Open Difference
    integrated_factor = momentum_score * close_open_diff

    # Subtract EMA from volume-weighted close
    ema_close = df['close'].ewm(span=21, adjust=False).mean()
    volume_weighted_close = df['close'] * df['volume']
    ema_diff = volume_weighted_close - ema_close

    # Add medium-term reversal
    daily_returns = df['close'].pct_change()
    medium_term_reversal = daily_returns.rolling(window=10).sum()

    # Generate Adjusted Return
    intraday_log_return = np.log(df['close'] / df['open'])
    true_range = df[['high', 'low']].diff(axis=1).iloc[:, 0].abs() + \
                 (df['high'] - df['low']).shift().abs() + \
                 (df['close'].shift() - df['high']).abs() + \
                 (df['close'].shift() - df['low']).abs()
    intraday_volatility_adjusted_return = intraday_log_return / true_range
    average_volume = df['volume'].rolling(window=21).mean()
    volume_change = (df['volume'] - df['volume'].shift()) / df['volume'].shift()
    adjusted_return = intraday_volatility_adjusted_return * volume_change

    # Composite Alpha Factor with Intraday Volatility and Medium-Term Reversal
    composite_alpha_factor = ema_diff + medium_term_reversal + adjusted_return

    # Final Integration
    final_factor = integrated_factor + composite_alpha_factor

    return final_factor
```
