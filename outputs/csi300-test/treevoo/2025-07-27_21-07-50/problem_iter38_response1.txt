```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum and Volume-Weighted Close-Open Difference Integration
    df['14_day_SMA'] = df['close'].rolling(window=14).mean()
    df['50_day_SMA'] = df['close'].rolling(window=50).mean()
    df['momentum'] = df['14_day_SMA'] - df['50_day_SMA']
    df['volume_weighted_close_open_diff'] = (df['close'] - df['open']) * df['volume']
    df['integrated_momentum_volume'] = df['momentum'] + df['volume_weighted_close_open_diff']

    # Composite Alpha Factor with Intraday Volatility and Medium-Term Reversal
    df['EMA_21'] = df['close'].ewm(span=21, adjust=False).mean()
    df['volume_weighted_close'] = df['close'] * df['volume']
    df['vol_adjusted_close'] = df['volume_weighted_close'] - df['EMA_21']
    df['daily_returns'] = df['close'].pct_change()
    df['medium_term_reversal'] = df['daily_returns'].rolling(window=10).sum()
    df['intraday_log_return'] = np.log(df['close'] / df['open'])
    df['true_range'] = df[['high', 'low']].diff(axis=1).iloc[:, 1].abs()  # True Range: High - Low
    df['log_return_scaled'] = df['intraday_log_return'] / df['true_range']
    df['avg_volume'] = df['volume'].rolling(window=21).mean()
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['adjusted_return'] = df['log_return_scaled'] * df['volume_change']
    
    # Money Flow Index and Relative Strength Analysis
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['raw_money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df['raw_money_flow'].where(df['typical_price'] > df['typical_price'].shift(), 0).rolling(window=14).sum()
    df['negative_money_flow'] = df['raw_money_flow'].where(df['typical_price'] < df['typical_price'].shift(), 0).rolling(window=14).sum()
    df['money_flow_ratio'] = df['positive_money_flow'] / df['negative_money_flow']
    df['MFI'] = 100 - (100 / (1 + df['money_flow_ratio']))
    df['14_day_EMA'] = df['close'].ewm(span=14, adjust=False).mean()
    df['200_day_EMA'] = df['close'].ewm(span=200, adjust=False).mean()
    df['relative_strength'] = df['14_day_EMA'] / df['200_day_EMA']

    # Final Integration
    df['composite_alpha'] = df['vol_adjusted_close'] + df['medium_term_reversal'] + df['adjusted_return']
    df['final_factor'] = df['integrated_momentum_volume'] + df['composite_alpha'] + df['MFI'] + df['relative_strength']

    return df['final_factor']
```
