```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the percentage change in close price
    df['pct_change_close'] = df['close'].pct_change()
    
    # Calculate the relative range (high - low) / close
    df['relative_range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate the money flow by multiplying volume with typical price
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['money_flow'] = df['volume'] * df['typical_price']
    
    # Calculate the cumulative money flow over the last 5 days
    df['cum_money_flow_5d'] = df['money_flow'].rolling(window=5).sum()
    
    # Generate the factor: (Cumulative Money Flow / Average Volume) * Relative Range
    df['avg_volume_5d'] = df['volume'].rolling(window=5).mean()
    alpha_factor = (df['cum_money_flow_5d'] / df['avg_volume_5d']) * df['relative_range']
    
    return alpha_factor
```
