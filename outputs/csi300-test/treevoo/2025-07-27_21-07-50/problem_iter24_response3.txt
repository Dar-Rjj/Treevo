```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Spread Ratio
    df['high_low_spread_ratio'] = (df['high'] - df['low']) / (df['high'] + df['low'])

    # Calculate Volume-Weighted Close-Open Difference
    df['volume_weighted_close_open_diff'] = (df['close'] - df['open']) * df['volume']

    # Integrate Both Factors
    df['integrated_factor'] = df['high_low_spread_ratio'] * df['volume_weighted_close_open_diff']

    # Composite Alpha Factor
    ema_period = 21
    df['ema_close'] = df['close'].ewm(span=ema_period, adjust=False).mean()
    df['volume_weighted_close'] = df['close'] * df['volume']
    df['composite_alpha'] = df['volume_weighted_close'] - df['ema_close'] + df['close'].pct_change(10).fillna(0)

    # Generate Adjusted Return
    df['intraday_log_return'] = np.log(df['close'] / df['open'])
    
    # Compute True Range
    df['true_range'] = df['high'] - df['low']
    df['prev_close'] = df['close'].shift(1)
    df.loc[df['prev_close'] > df['high'], 'true_range'] = df['prev_close'] - df['low']
    df.loc[df['prev_close'] < df['low'], 'true_range'] = df['high'] - df['prev_close']
    df['true_range'].fillna(df['high'] - df['low'], inplace=True)
    
    df['intraday_volatility'] = df['true_range'] / df['prev_close']
    df['adjusted_return'] = df['intraday_log_return'] / df['intraday_volatility']

    # Incorporate Volume Impact
    avg_volume_window = 20
    df['avg_volume'] = df['volume'].rolling(window=avg_volume_window).mean()
    df['volume_change'] = df['volume'] / df['volume'].shift(1) - 1
    df['volume_impact'] = df['volume_change'] * df['adjusted_return']

    # Final Integration
    df['final_factor'] = df['integrated_factor'] + df['composite_alpha'] + df['volume_impact']

    return df['final_factor']
```
