```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Open-Close Spread
    open_close_spread = df['close'] - df['open']
    
    # Combine Spreads and Multiply by Volume
    combined_spread = (high_low_spread + open_close_spread) / 2 * df['volume']
    
    # 5-day and 20-day SMA of Close Price
    sma_5 = df['close'].rolling(window=5).mean()
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Relationship between 5-day and 20-day SMA
    sma_crossover = sma_5 > sma_20
    
    # Daily Price Range
    daily_price_range = df['high'] - df['low']
    
    # 20-day Average Daily Price Range
    avg_daily_price_range_20 = daily_price_range.rolling(window=20).mean()
    
    # Ratio of today's Daily Price Range to the 20-day Average
    price_range_ratio = daily_price_range / avg_daily_price_range_20
    
    # Volume-Adjusted Momentum and Reversal
    daily_price_change = df['close'] - df['open']
    volume_adjusted_price_change = daily_price_change * df['volume']
    
    # 20-day Moving Average of Volume
    ma_volume_20 = df['volume'].rolling(window=20).mean()
    
    # Volume-Adjusted Momentum Indicator (VAMI)
    vami = volume_adjusted_price_change / ma_volume_20
    
    # Volume-Weighted Close
    volume_weighted_close = df['close'] * df['volume']
    
    # 21-day EMA of Close
    ema_21 = df['close'].ewm(span=21, adjust=False).mean()
    
    # 5-day SMA of Volume
    sma_volume_5 = df['volume'].rolling(window=5).mean()
    
    # Volume-Weighted Average Price (VWAP)
    vwap = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    
    # 14-day RSI based on close prices
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    
    # Composite Alpha Factor
    composite_factor = (volume_weighted_close - ema_21) + vami + df['close'].pct_change().rolling(window=5).sum()
    
    # Integrate RSI with SMA signals
    overbought = rsi > 70
    oversold = rsi < 30
    composite_factor[overbought] *= 0.5  # Reduce factor for overbought conditions
    composite_factor[oversold] *= 1.5  # Increase factor for oversold conditions
    
    return composite_factor
```
