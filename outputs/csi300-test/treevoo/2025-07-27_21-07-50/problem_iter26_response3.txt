```python
import pandas as pd
import numpy as np

def heuristics_v2(df, lookback=30, long_trend_lookback=200, short_trend_lookback=50):
    # Calculate Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']
    
    # Incorporate Volume into Intraday Return
    volume_adjusted_intraday_return = intraday_return * np.sqrt(df['volume'])
    
    # Enhance Volatility Correction
    price_volatility = df['close'].pct_change().rolling(window=lookback).std()
    volume_volatility = df['volume'].rolling(window=lookback).std()
    corrected_momentum = volume_adjusted_intraday_return - price_volatility - volume_volatility
    
    # Integrate High-Low Spread and Open-Close Spread
    spread = (df['high'] - df['low'] + df['close'] - df['open']) * np.sqrt(df['volume'])
    
    # Combine Enhanced Spread with Corrected Momentum
    combined_factor = spread + corrected_momentum
    
    # Intraday Log-Return Scaled by True Range
    log_return = np.log(df['close'] / df['open'])
    true_range = pd.concat([df['high'] - df['low'], 
                            (df['close'] - df['close'].shift(1)).abs(), 
                            (df['open'] - df['close'].shift(1)).abs()], axis=1).max(axis=1)
    scaled_log_return = log_return / true_range
    
    # Volume-Weighted Price Movement and Momentum Adjustment
    daily_price_change = (df['close'] - df['open']) * np.sqrt(df['volume'])
    volume_weighted_price_change_sum = daily_price_change.rolling(window=lookback).sum()
    ma_volume = np.sqrt(df['volume']).rolling(window=lookback).mean()
    vami = volume_weighted_price_change_sum / ma_volume
    thirty_day_momentum = (df['close'] - df['close'].shift(lookback)) / df['close'].pct_change().rolling(window=lookback).std()
    
    # Composite Alpha Factor Integration
    ema_close = df['close'].ewm(span=21).mean()
    volume_weighted_close = df['close'] * df['volume']
    composite_alpha = (volume_weighted_close - ema_close) + thirty_day_momentum
    
    # Add medium-term reversal
    daily_returns = df['close'].pct_change()
    medium_term_reversal = daily_returns.rolling(window=10).sum()
    composite_alpha += medium_term_reversal
    
    # Generate Adjusted Return
    average_volume = df['volume'].rolling(window=lookback).mean()
    volume_change = df['volume'] - df['volume'].shift(1)
    adjusted_return = scaled_log_return + volume_change / average_volume
    
    # Final Composite Alpha Factor
    final_factor = combined_factor + adjusted_return + composite_alpha
    
    # Trend Adjustment
    long_trend = df['close'].rolling(window=long_trend_lookback).mean()
    short_trend = df['close'].ewm(span=short_trend_lookback).mean()
    trend_difference = long_trend - short_trend
    trend_adjustment = np.where(trend_difference > 0, 1.2, 0.8)
    final_factor = final_factor * trend_adjustment
    
    return final_factor
```
