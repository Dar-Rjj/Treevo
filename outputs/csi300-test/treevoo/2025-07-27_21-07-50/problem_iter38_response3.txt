```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Short-Term Momentum
    short_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    
    # Medium-Term Trend
    medium_trend = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    
    # Volatility and Mean Reversion Indicator
    avg_daily_range = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Institutional Activity Indicator (20-day VWAP)
    vwap = (df['close'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Liquidity Proxy
    avg_daily_amount = df['amount'].rolling(window=20).mean()
    
    # Corrected Intraday Momentum with Adjustments
    intraday_return = (df['close'] - df['open']) * np.sqrt(df['volume'])
    price_volatility = df['close'].pct_change().rolling(window=20).std()
    volume_volatility = df['volume'].pct_change().rolling(window=20).std()
    adjusted_intraday_momentum = intraday_return - price_volatility - volume_volatility
    
    # High-Low Spread Ratio
    high_low_ratio = (df['high'] - df['low']) / (df['high'] + df['low'])
    
    # Composite Alpha Factor Components
    volume_weighted_diff = (df['close'] - df['open']) * df['volume']
    ema_21 = df['close'].ewm(span=21, adjust=False).mean()
    ema_adjusted = (df['close'] - ema_21) * df['volume']
    past_10_day_returns = df['close'].pct_change().rolling(window=10).sum()
    
    composite_factor = (
        volume_weighted_diff +
        ema_adjusted +
        past_10_day_returns
    )
    
    # Combined Alpha Factor
    core_factors = (
        short_momentum +
        medium_trend +
        avg_daily_range +
        vwap +
        avg_daily_amount +
        adjusted_intraday_momentum +
        high_low_ratio +
        composite_factor
    )
    
    # Trend-Adjusted Final Alpha Factor
    long_term_trend = df['close'].rolling(window=100).mean()
    short_term_trend = df['close'].ewm(span=20, adjust=False).mean()
    trend_adjustment = 1.5 if (short_term_trend - long_term_trend).iloc[-1] > 0 else 0.5
    
    final_alpha_factor = core_factors * trend_adjustment
    
    return final_alpha_factor
```
