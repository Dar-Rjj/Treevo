```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum and Trend Analysis
    df['10_day_avg_close'] = df['close'].rolling(window=10).mean()
    df['momentum_10_day'] = df['close'] - df['10_day_avg_close']
    df['roc_5_day'] = df['close'].pct_change(periods=5)
    df['daily_return'] = df['close'].pct_change()
    df['cumulative_return_20_day'] = df['daily_return'].rolling(window=20).sum()

    # Volume Anomaly and Surge Detection
    df['volume_20_day_ma'] = df['volume'].rolling(window=20).mean()
    df['volume_ratio_to_ma'] = df['volume'] / df['volume_20_day_ma']
    df['max_volume_30_day'] = df['volume'].rolling(window=30).max()
    df['volume_ratio_to_max_30_day'] = df['volume'] / df['max_volume_30_day']
    df['vol_up_price_down'] = ((df['volume'] > df['volume_20_day_ma']) & (df['close'] < df['close'].shift(1))).astype(int)

    # Price Volatility and Stability
    df['std_dev_20_day'] = df['close'].rolling(window=20).std()
    df['true_range'] = df[['high', 'low', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['avg_true_range_14'] = df['true_range'].rolling(window=14).mean()
    df['high_low_ratio_20_day'] = df['high'].rolling(window=20).max() / df['low'].rolling(window=20).min()

    # Reversal and Continuation Patterns
    def engulfing_pattern(row):
        if row['close'] > row['open'] and row['open'].shift(1) > row['close'].shift(1):
            return 1  # Bullish Engulfing
        elif row['close'] < row['open'] and row['open'].shift(1) < row['close'].shift(1):
            return -1  # Bearish Engulfing
        else:
            return 0

    def hammer_hanging_man(row):
        body_size = abs(row['close'] - row['open'])
        upper_shadow = row['high'] - max(row['close'], row['open'])
        lower_shadow = min(row['close'], row['open']) - row['low']
        if (lower_shadow > 2 * body_size) and (upper_shadow < 0.5 * body_size):
            return 1  # Hammer or Hanging Man
        else:
            return 0

    def harami_pattern(row):
        prev_body_size = abs(row['close'].shift(1) - row['open'].shift(1))
        curr_body_size = abs(row['close'] - row['open'])
        if (prev_body_size > curr_body_size) and (row['open'] > row['close'].shift(1)) and (row['close'] < row['open'].shift(1)):
            return 1  # Bearish Harami
        elif (prev_body_size > curr_body_size) and (row['open'] < row['close'].shift(1)) and (row['close'] > row['open'].shift(1)):
            return -1  # Bullish Harami
        else:
            return 0

    df['engulfing'] = df.apply(engulfing_pattern, axis=1)
    df['hammer_hanging_man'] = df.apply(hammer_hanging_man, axis=1)
    df['harami'] = df.apply(harami_pattern, axis=1)

    # Liquidity and Trading Activity
    df['liquidity_ratio'] = df['volume'] / df['amount']
    df['vol_up_price_down'] = ((df['volume'] > df['volume'].shift(1)) & (df['close'] < df['close'].shift(1))).astype(int)
    df['up_day_vol'] = df['volume'] * (df['close'] > df['close'].shift(1)).astype(int)
    df['down_day_vol'] = df['volume'] * (df['close'] < df['close'].shift(1)).astype(int)
    df['vol_up_down_ratio'] = df['up_day_vol'] / df['down_day_vol'].replace(0, np.nan).fillna(1)

    # Combine all factors into a single alpha factor
    alpha_factor = (
        df['momentum_10_day'] + 
        df['roc
