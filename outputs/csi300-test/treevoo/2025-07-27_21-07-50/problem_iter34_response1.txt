```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Volume-Weighted Intraday Return
    volume_weighted_intraday_return = (df['close'] - df['open']) * np.sqrt(df['volume'])
    
    # Price Volatility
    price_volatility = df['close'].pct_change().rolling(window=20).std()
    
    # Volume Volatility
    volume_volatility = df['volume'].rolling(window=20).std()
    
    # Corrected Intraday Momentum
    corrected_intraday_momentum = volume_weighted_intraday_return - price_volatility - volume_volatility
    
    # High-Low Spread Ratio
    high_low_spread_ratio = (df['high'] - df['low']) / (df['high'] + df['low'])
    
    # Volume-Weighted Close-Open Difference
    volume_weighted_close_open_diff = (df['close'] - df['open']) * df['volume']
    
    # Subtract EMA from volume-weighted close
    ema_21 = df['close'].ewm(span=21, adjust=False).mean()
    subtract_ema = (df['close'] - ema_21) * df['volume']
    
    # Add medium-term reversal
    past_10_days_returns = df['close'].pct_change().rolling(window=10).sum()
    
    # Composite Alpha Factor
    composite_alpha_factor = volume_weighted_close_open_diff + subtract_ema + past_10_days_returns
    
    # Trend Adjustment
    long_term_trend = df['close'].rolling(window=100).mean()
    short_term_trend = df['close'].ewm(span=20, adjust=False).mean()
    trend_difference = short_term_trend - long_term_trend
    
    trend_adjustment = 1.5 if trend_difference.iloc[-1] > 0 else 0.5
    
    # Combine Factors
    combined_factors = corrected_intraday_momentum + high_low_spread_ratio + composite_alpha_factor
    
    # Apply Trend Adjustment
    final_factor = combined_factors * trend_adjustment
    
    return final_factor
```
