```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum and Trend Analysis
    df['weighted_close'] = (df['close'] * 10).rolling(window=10).sum() / (55)
    df['volume_adjusted_roc'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5) * df['volume'] / df['volume'].rolling(window=5).mean()

    # Volume Anomaly and Surge Detection
    df['volume_change_ratio'] = (df['volume'] - df['volume'].rolling(window=30).mean()) / df['volume'].rolling(window=30).mean()
    df['volume_to_max_ratio'] = df['volume'] / df['volume'].rolling(window=40).max()

    # Price Volatility and Stability
    df['recent_volatility'] = df['close'].rolling(window=10).std()
    df['atr'] = df[['high', 'low', 'close']].rolling(window=14).apply(lambda x: np.max(x) - np.min(x), raw=True)
    df['atr_change'] = df['atr'] / df['atr'].shift(14) - 1

    # Reversal and Continuation Patterns
    df['bearish_engulfing'] = ((df['close'] < df['open']) & (df['close'].shift(-1) > df['open'].shift(-1)) & 
                               (df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1)))
    df['bullish_engulfing'] = ((df['close'] > df['open']) & (df['close'].shift(-1) < df['open'].shift(-1)) &
                               (df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1)))
    df['gap_confirmation'] = (np.abs(df['open'].shift(-1) - df['close']) > 0.01 * df['close'])
    
    df['hammer_or_hanging_man'] = ((df['high'] - df['low']) > 3 * (df['open'] - df['close']).abs()) & (
        (df['close'] - df['low']) / (0.001 + df['high'] - df['low']) > 0.6) & (
        (df['open'] - df['low']) / (0.001 + df['high'] - df['low']) > 0.6)
    df['next_day_close_diff'] = (df['close'].shift(-1) - df['close']) / df['close']

    # Liquidity and Trading Activity
    df['volume_to_amount_ratio'] = df['volume'] / df['amount']
    df['volume_to_amount_moving_avg'] = df['volume_to_amount_ratio'].rolling(window=20).mean()
    df['up_down_volume_ratio'] = df.apply(
        lambda x: (x['volume'] if x['close'] > x['open'] else 0) / (x['volume'] if x['close'] < x['open'] else 0), axis=1)
    df['up_down_volume_ratio_moving_avg'] = df['up_down_volume_ratio'].rolling(window=20).mean()

    # Alpha Factor
    alpha_factor = (df['weighted_close'] + df['volume_adjusted_roc'] + df['volume_change_ratio'] + df['volume_to_max_ratio'] +
                    df['recent_volatility'] + df['atr_change'] + df['gap_confirmation'].astype(int) + df['next_day_close_diff'] +
                    df['volume_to_amount_ratio'] / df['volume_to_amount_moving_avg'] + df['up_down_volume_ratio'] / df['up_down_volume_ratio_moving_avg'])

    return alpha_factor
```
