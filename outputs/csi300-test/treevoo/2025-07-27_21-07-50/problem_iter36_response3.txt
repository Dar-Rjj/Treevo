```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the price and volume features
    df['Close_lag1'] = df['close'].shift(1)
    df['Close_lag4_to_t_mean'] = df['close'].rolling(window=5).mean()
    df['Close_lag10_to_t_max_min_diff'] = df['close'].rolling(window=10).max() - df['close'].rolling(window=10).min()
    df['Close_lag20_to_t_mean'] = df['close'].rolling(window=21).mean()
    df['High_Low_range'] = df['high'] - df['low']
    df['Intraday_avg_range'] = (df['high'] - df['low']).rolling(window=14).mean() + \
                               (df['high'] - df['close'].shift(1)).abs().rolling(window=14).mean() + \
                               (df['low'] - df['close'].shift(1)).abs().rolling(window=14).mean()
    df['High_lag1'] = df['high'].shift(1)
    df['High_lag10_to_t_mean'] = df['high'].rolling(window=10).mean()
    df['Volume_lag1'] = df['volume'].shift(1)
    df['Volume_lag20_to_t_mean'] = df['volume'].rolling(window=20).mean()
    df['Volume_lag39_to_t_mean'] = df['volume'].rolling(window=40).mean()
    df['Money_Flow'] = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    df['Positive_Money_Flow'] = df[df['Money_Flow'] > 0]['Money_Flow']
    df['Negative_Money_Flow'] = df[df['Money_Flow'] < 0]['Money_Flow']
    df['Money_Flow_Index'] = df['Positive_Money_Flow'].rolling(window=14).sum() / df['Negative_Money_Flow'].rolling(window=14).abs().sum()
    df['Money_Flow_Volatility'] = df['Money_Flow'].rolling(window=14).std()
    df['Money_Flow_Ratio_7d'] = df['Positive_Money_Flow'].rolling(window=7).sum() / df['Negative_Money_Flow'].rolling(window=7).abs().sum()
    df['Price_Momentum'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    df['Volume_Momentum'] = (df['volume'] - df['volume'].shift(20)) / df['volume'].shift(20)
    df['Combined_Momentum'] = df['Price_Momentum'] + df['Volume_Momentum']

    # Calculate the alpha factor
    alpha_factor = (
        (df['close'] - df['Close_lag1']) +
        (df['close'] - df['Close_lag4_to_t_mean']) +
        (df['close'] - df['Close_lag10_to_t_max_min_diff']) +
        (df['close'] - df['Close_lag20_to_t_mean']) +
        (df['High_Low_range']) +
        (df['Intraday_avg_range']) +
        (df['high'] - df['High_lag1']) +
        (df['high'] - df['High_lag10_to_t_mean']) +
        (df['volume'] / (df['volume'].rolling(window=20).mean())) +
        ((df['volume'] - df['Volume_lag1']) / df['Volume_lag1']) +
        (df['volume'] - df['Volume_lag20_to_t_mean']) +
        (df['volume'] - df['Volume_lag39_to_t_mean']) +
        (df['Money_Flow_Index']) +
        (df['Money_Flow_Volatility']) +
        (df['Money_Flow_Ratio_7d']) +
        (df['Price_Momentum']) +
        (df['Volume_Momentum']) +
        (df['Combined_Momentum'])
    )

    return alpha_factor
```
