```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Short-Term Momentum
    short_mom = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)

    # Medium-Term Trend
    med_trend = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)

    # Volatility and Mean Reversion Indicator
    avg_range = (df['high'] - df['low']).rolling(window=20).mean()

    # Institutional Activity Indicator (20-day VWAP)
    vwap = (df['close'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()

    # Liquidity Proxy
    avg_amount = df['amount'].rolling(window=20).mean()

    # Volume-Weighted Intraday Return
    intraday_return_vol_adj = (df['close'] - df['open']) * np.sqrt(df['volume'])

    # Price Volatility
    price_volatility = df['close'].pct_change().rolling(window=20).std()

    # Volume Volatility
    volume_volatility = df['volume'].rolling(window=20).std()

    # Adjusted Intraday Momentum
    adjusted_intraday_momentum = intraday_return_vol_adj - price_volatility - volume_volatility

    # High-Low Spread Ratio
    high_low_spread_ratio = (df['high'] - df['low']) / (df['high'] + df['low'])

    # Volume-Weighted Close-Open Difference
    vol_weighted_close_open_diff = (df['close'] - df['open']) * df['volume']

    # Subtract EMA from volume-weighted close
    ema_21 = df['close'].ewm(span=21, adjust=False).mean()
    vol_weighted_close_ema_diff = (df['close'] - ema_21) * df['volume']

    # Add medium-term reversal
    med_term_reversal = df['close'].pct_change(10).rolling(window=10).mean()

    # Composite Alpha Factor Components
    composite_alpha_factor = (
        vol_weighted_close_open_diff +
        vol_weighted_close_ema_diff +
        med_term_reversal
    )

    # Combine Core Factors
    core_factors = (
        short_mom +
        med_trend +
        avg_range +
        vwap +
        avg_amount +
        adjusted_intraday_momentum +
        high_low_spread_ratio +
        composite_alpha_factor
    )

    # Apply Long-Term and Short-Term Trend Adjustment
    long_term_trend = df['close'].rolling(window=100).mean()
    short_term_trend = df['close'].ewm(span=20, adjust=False).mean()
    trend_adjustment = np.where(
        short_term_trend > long_term_trend,
        1.5,
        0.5
    )
    final_alpha_factor = core_factors * trend_adjustment

    return final_alpha_factor
```
