```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=20):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Calculate VWAP
    typical_price = (df['open'] + df['high'] + df['low'] + df['close']) / 4
    vwap = (df['volume'] * typical_price).cumsum() / df['volume'].cumsum()
    
    # Combine Intraday Range and VWAP
    high_vwap_diff = df['high'] - vwap
    vwap_low_diff = vwap - df['low']
    combined_diff = high_vwap_diff + vwap_low_diff
    
    # Calculate Intraday Price Changes
    log_open_close_change = np.log(df['close'] / df['open'])
    log_high_low_change = np.log(df['high'] / df['low'])
    aggregated_intraday_changes = log_open_close_change + log_high_low_change
    
    # Volume Adjusted Synchrony
    n_day_median_volume = df['volume'].rolling(window=n).median()
    daily_volume_deviation = df['volume'] - n_day_median_volume
    
    # Integrate Combined Intraday Range-VWAP and Aggregated Price Changes with Volume Adjusted Synchrony
    integrated_factor = (combined_diff * aggregated_intraday_changes) * daily_volume_deviation
    
    # Apply a weighted moving average to smooth the factor
    ema_factor = integrated_factor.ewm(span=n, adjust=False).mean()
    
    return ema_factor
```
