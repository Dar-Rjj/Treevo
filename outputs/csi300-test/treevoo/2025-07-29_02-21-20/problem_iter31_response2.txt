```python
import pandas as pd

def heuristics_v2(df):
    # Price Momentum
    daily_change = df['close'] - df['close'].shift(1)
    avg_7d_daily_change = daily_change.rolling(window=7).mean()
    avg_21d_daily_change = daily_change.rolling(window=21).mean()

    # Volume-Adjusted Momentum
    long_term_momentum = (df['close'] - df['close'].shift(21)) / df['close'].shift(21)
    volume_ratio = df['volume'] / df['volume'].shift(21)
    vol_adjusted_momentum = long_term_momentum * volume_ratio

    # Intraday Momentum
    high_price_indicator = df['high'] - df['open']
    low_price_indicator = df['open'] - df['low']
    avg_intraday_range = (high_price_indicator + low_price_indicator) / 2
    moving_avg_vol = df['volume'].rolling(window=21).mean()
    dynamic_vol_adjustment = (df['volume'] / moving_avg_vol) * avg_intraday_range

    # Gaps and Breakouts
    up_gap = df['open'] - df['close'].shift(1)
    down_gap = df['close'].shift(1) - df['open']
    upper_breakout = (df['high'] > df['high'].rolling(window=21).max()).astype(int)
    lower_breakout = (df['low'] < df['low'].rolling(window=21).min()).astype(int)

    # Intraday Patterns
    intraday_range = df['high'] - df['low']
    intraday_momentum = df['close'] - df['open']
    strength_relative_to_open = intraday_momentum / intraday_range

    # Volume Spike Filter
    volume_spike = df['volume'] / df['volume'].shift(1)
    threshold = 5  # Example threshold, can be adjusted
    volume_spike_filter = (volume_spike < threshold).astype(int)

    # Consolidate All Factors
    factor_value = (
        daily_change + 
        avg_7d_daily_change + 
        avg_21d_daily_change + 
        vol_adjusted_momentum + 
        dynamic_vol_adjustment + 
        up_gap + 
        down_gap + 
        upper_breakout + 
        lower_breakout + 
        intraday_range + 
        intraday_momentum + 
        strength_relative_to_open
    ) / df['open']

    return factor_value
```
