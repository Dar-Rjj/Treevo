```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=5):
    # Calculate Intraday Volatility
    intraday_volatility = df['high'] - df['low']
    
    # Calculate Typical Price
    typical_price = (df['high'] + df['low'] + 2 * df['close']) / 4
    
    # Calculate Volume-Adjusted Typical Price (VATP)
    adjusted_typical_price = typical_price * np.sqrt(df['volume'])
    total_adjusted_price = (adjusted_typical_price * df['volume']).sum()
    total_volume = df['volume'].sum()
    vatp = total_adjusted_price / total_volume
    
    # Combine Intraday Volatility and VATP
    diff_high_vatp = df['high'] - vatp
    diff_low_vatp = vatp - df['low']
    combined_factor = intraday_volatility + diff_high_vatp + diff_low_vatp
    
    # Apply a weighted moving average to smooth the factor
    volumes = df['volume'].rolling(window=n).sum()
    weights = df['volume'] / volumes
    smoothed_factor = (combined_factor * weights).rolling(window=n).sum()
    
    return smoothed_factor
```
