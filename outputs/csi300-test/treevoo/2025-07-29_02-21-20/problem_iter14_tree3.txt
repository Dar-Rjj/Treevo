```txt
Intraday and Long-Term Momentum with Volume-Adjusted Enhancements and Price Spike Filtering
├── Calculate Intraday Volatility
│   ├── Use High price
│   └── Use Low price
│       └── Subtract Low from High
├── Calculate Volume-Adjusted Typical Price (VATP)
│   ├── Use Open, High, Low, and Close prices
│   │   └── Calculate Typical Price: (High + Low + 2 * Close) / 4
│   └── Use Volume
│       └── Multiply each typical price by the square root of corresponding volume
│           └── Sum all (volume-adjusted typical price) and divide by sum of volumes
├── Calculate Short-Term Momentum
│   ├── Use Close Price (t) and Close Price (t-n)
│   │   ├── Subtract Close Price (t) from Close Price (t-n)
│   │   └── Divide by Close Price (t-n)
│   └── Define n as a Lookback Period
├── Adjust for Volume Changes in Short-Term Momentum
│   ├── Calculate Volume Ratio
│   │   ├── Use Volume (t) and Volume (t-n)
│   │   └── Divide by Volume (t-n)
│   └── Combine Momentum and Volume Ratio
│       ├── Multiply Short-Term Momentum by Volume Ratio
│       └── Add to the Original Short-Term Momentum
├── Enhanced Intraday Momentum
│   ├── High Price Indicator: (High - Open)
│   └── Low Price Indicator: (Open - Low)
│   └── Average: (High Price Indicator + Low Price Indicator) / 2
├── Adjust for Dynamic Volume Impact on Enhanced Intraday Momentum
│   ├── Moving Average of Volume
│   │   ├── Define Lookback Period
│   │   └── Compute Moving Average
│   └── Normalized Volume: Volume / Moving Average of Volume
│   └── Adjusted Intraday Momentum: Enhanced Intraday Momentum * Normalized Volume
├── Longer-Term Momentum Adjusted for Volume
    ├── Long-Term Momentum: (Close(t) - Close(t-n)) / Close(t-n)
    │   ├── Define n as a Lookback Period
    └── Volume Ratio: Volume(t) / Volume(t-n)
    └── Final Long-Term Factor: Long-Term Momentum * (1 + Volume Ratio)
├── Combine Intraday Volatility, VATP, and Enhanced Intraday Momentum
│   ├── Calculate difference between High and VATP
│   ├── Calculate difference between VATP and Low
│   └── Sum the two differences
│   └── Add the Enhanced Intraday Momentum
├── Consolidate All Factors
    ├── Sum: Adjusted Intraday Momentum + Final Long-Term Factor + Combined Intraday Factors
    └── Divide by Open Price
├── Daily Price Return
│   ├── Use Close price
│   └── Subtract Previous Day's Close price
├── Significant Price Increase
│   ├── Compare Daily Price Return to Positive Threshold
│   └── Output 1 if Above, 0 Otherwise
├── Volume Spike Indicator
│   ├── Use Today's Volume
│   ├── Compare to Average of Past Week Volumes
│   └── Output 1 if Above, 0 Otherwise
├── Weighted Price Momentum
│   ├── Multiply Daily Price Return by Significant Price Increase Indicator
├── Apply Volume Spike Filter
│   ├── Multiply Weighted Price Momentum by Volume Spike Indicator
├── Final Alpha Factor Synthesis
│   ├── Sum of Consolidated Initial Factors and Volume Spike Filtered Momentum
│   └── Multiply by Volume Spike Indicator
└── Apply an exponential moving average to smooth the factor
    ├── Use factor values from the previous n days
    └── Calculate the exponential moving average with a smoothing factor alpha
```
