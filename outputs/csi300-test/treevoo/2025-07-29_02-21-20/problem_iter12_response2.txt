```python
import pandas as pd

def heuristics_v2(df):
    # Calculate high-low spread
    df['high_low_spread'] = df['high'] - df['low']
    
    # Compute close-to-close return
    df['close_to_close_return'] = df['close'].pct_change()
    
    # Compute open-to-close return
    df['open_to_close_return'] = (df['close'] / df['open']) - 1
    
    # Calculate volume momentum
    df['volume_momentum'] = df['volume'].pct_change()
    
    # Calculate amount-to-volume ratio
    df['amount_to_volume_ratio'] = df['amount'] / df['volume']
    
    # Integrated Momentum Indicator
    df['integrated_momentum'] = df['close_to_close_return'] * df['volume_momentum']
    
    # Combined Price and Volume Volatility
    df['combined_volatility'] = df['high_low_spread'] * df['volume_momentum']
    
    # Simple Moving Average of Close Prices (SMA(Close, n))
    n = 5
    df['sma_close_5'] = df['close'].rolling(window=n).mean()
    
    # Exponential Moving Average of Close Prices (EMA(Close, n))
    df['ema_close_5'] = df['close'].ewm(span=n, adjust=False).mean()
    
    # SMA Crossover
    short_n = 5
    long_n = 20
    df['sma_short'] = df['close'].rolling(window=short_n).mean()
    df['sma_long'] = df['close'].rolling(window=long_n).mean()
    df['sma_crossover'] = df['sma_short'] - df['sma_long']
    
    # RSI based on Close-to-Close Returns
    def rsi(series, periods=14):
        delta = series.diff(1)
        gain = (delta.where(delta > 0, 0)).fillna(0)
        loss = (-delta.where(delta < 0, 0)).fillna(0)
        avg_gain = gain.rolling(window=periods).mean()
        avg_loss = loss.rolling(window=periods).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))
    
    df['rsi'] = rsi(df['close_to_close_return'])
    
    # MACD
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = ema_12 - ema_26
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Bullish Engulfing Pattern
    df['bullish_engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] > df['open'].shift(1))).astype(int)
    
    # Bearish Engulfing Pattern
    df['bearish_engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] < df['open'].shift(1))).astype(int)
    
    # Trend Direction Indicator
    n = 10
    df['trend_direction_indicator'] = (df['sma_close_5'] - df['sma_close_10']) / df['sma_close_5']
    
    # Select the final alpha factor
    alpha_factor = df['integrated_momentum']
    
    return alpha_factor
```
