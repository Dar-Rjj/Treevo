```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily price changes
    df['daily_close_change'] = df['close'].diff()
    df['daily_high_change'] = df['high'].diff()
    df['daily_low_change'] = df['low'].diff()
    
    # Calculate multi-day price trends
    df['3d_close_trend'] = df['daily_close_change'].rolling(window=3).mean()
    df['7d_close_trend'] = df['daily_close_change'].rolling(window=7).mean()
    df['21d_close_trend'] = df['daily_close_change'].rolling(window=21).mean()
    
    # Measure volatility
    df['21d_volatility'] = df['daily_close_change'].rolling(window=21).std()
    df['21d_high_low_volatility'] = (df['high'] - df['low']).rolling(window=21).std()
    
    # Calculate daily volume changes
    df['daily_volume_change'] = df['volume'].diff()
    
    # Calculate multi-day volume trends
    df['3d_volume_trend'] = df['daily_volume_change'].rolling(window=3).mean()
    df['7d_volume_trend'] = df['daily_volume_change'].rolling(window=7).mean()
    df['21d_volume_trend'] = df['daily_volume_change'].rolling(window=21).mean()
    
    # Measure liquidity
    df['21d_avg_amount'] = df['amount'].rolling(window=21).mean()
    df['21d_total_volume'] = df['volume'].rolling(window=21).sum()
    
    # Identify daily gaps
    df['up_gap'] = (df['open'] - df['close'].shift(1)) > 0
    df['down_gap'] = (df['open'] - df['close'].shift(1)) < 0
    
    # Measure gap intensity
    df['up_gap_size'] = df['open'] - df['close'].shift(1)
    df['down_gap_size'] = df['open'] - df['close'].shift(1)
    
    # Identify breakouts
    df['upper_breakout'] = df['high'] > df['high'].rolling(window=21).max().shift(1)
    df['lower_breakout'] = df['low'] < df['low'].rolling(window=21).min().shift(1)
    
    # Measure breakout intensity
    df['upper_breakout_size'] = df['high'] - df['high'].rolling(window=21).max().shift(1)
    df['lower_breakout_size'] = df['low'].rolling(window=21).min().shift(1) - df['low']
    
    # Measure intraday momentum
    df['intraday_range'] = df['high'] - df['low']
    df['intraday_momentum'] = df['close'] - df['open']
    
    # Measure intraday strength
    df['intraday_strength'] = (df['close'] - df['open']) / df['intraday_range']
    
    # Measure intraday volatility
    df['21d_intraday_volatility'] = (df['high'] - df['low']).rolling(window=21).std()
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        df['21d_close_trend'] + 
        df['21d_volatility'] + 
        df['21d_high_low_volatility'] + 
        df['21d_avg_amount'] + 
        df['21d_total_volume'] + 
        df['up_gap_size'] * df['up_gap'] + 
        df['down_gap_size'] * df['down_gap'] + 
        df['upper_breakout_size'] * df['upper_breakout'] + 
        df['lower_breakout_size'] * df['lower_breakout'] + 
        df['intraday_range'] + 
        df['intraday_momentum'] + 
        df['intraday_strength'] + 
        df['21d_intraday_volatility']
    )
    
    return alpha_factor
```
