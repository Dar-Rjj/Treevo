```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Define lookback periods and smoothing factors
    price_lookback = 20
    volume_lookback = 20
    ema_smoothing = 2 / (price_lookback + 1)
    sma_length = volume_lookback
    
    # Calculate Price Momentum
    df['price_diff'] = df['close'] - df['close'].shift(1)
    
    # Smooth the momentum with Exponential Moving Average (EMA)
    df['price_momentum_ema'] = df['price_diff'].ewm(alpha=ema_smoothing, adjust=False).mean()
    
    # Calculate Volume Ratio
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    
    # Smooth the volume ratio with Simple Moving Average (SMA)
    df['volume_ratio_sma'] = df['volume_ratio'].rolling(window=sma_length, min_periods=1).mean()
    
    # Combine Momentum and Volume Ratio
    df['combined_momentum'] = df['price_momentum_ema'] * df['volume_ratio_sma']
    
    # Calculate High-Low Price Difference
    df['high_low_diff'] = df['high'] - df['low']
    
    # Compute Volume Influence Ratio
    df['upward_volume'] = np.where(df['close'] > df['open'], df['volume'], 0)
    df['downward_volume'] = np.where(df['close'] < df['open'], df['volume'], 0)
    df['upward_volume_sum'] = df['upward_volume'].rolling(window=volume_lookback, min_periods=1).sum()
    df['downward_volume_sum'] = df['downward_volume'].rolling(window=volume_lookback, min_periods=1).sum()
    df['volume_influence_ratio'] = df['upward_volume_sum'] / (df['downward_volume_sum'] + 1e-6)  # Avoid division by zero
    
    # Integrate Combined Momentum, Volume Ratio, and Directional Volume Impact
    df['alpha_factor'] = df['combined_momentum'] * df['volume_influence_ratio'] * df['high_low_diff']
    
    return df['alpha_factor']
```
