```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    df['price_momentum'] = df['close'].diff()
    
    # Smooth the momentum with Exponential Moving Average (EMA)
    ema_smoothing_factor = 0.9
    df['smoothed_momentum'] = df['price_momentum'].ewm(alpha=ema_smoothing_factor, adjust=False).mean()
    
    # Adjust by Volume Change
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    
    # Smooth the volume ratio with Simple Moving Average (SMA)
    sma_length = 5
    df['smoothed_volume_ratio'] = df['volume_ratio'].rolling(window=sma_length, min_periods=1).mean()
    
    # Combine Momentum and Volume Ratio
    df['combined_momentum'] = df['smoothed_momentum'] * df['smoothed_volume_ratio']
    
    # Compute Volume Influence Ratio
    df['upward_volume'] = df.apply(lambda x: x['volume'] if x['close'] > x['open'] else 0, axis=1)
    df['downward_volume'] = df.apply(lambda x: x['volume'] if x['close'] < x['open'] else 0, axis=1)
    
    upward_vol_sum = df['upward_volume'].rolling(window=sma_length, min_periods=1).sum()
    downward_vol_sum = df['downward_volume'].rolling(window=sma_length, min_periods=1).sum()
    
    df['volume_influence_ratio'] = upward_vol_sum / downward_vol_sum
    
    # Integrate Combined Momentum, Volume Ratio, and Directional Volume Impact
    df['alpha_factor'] = df['combined_momentum'] * df['volume_influence_ratio']
    
    return df['alpha_factor']
```
