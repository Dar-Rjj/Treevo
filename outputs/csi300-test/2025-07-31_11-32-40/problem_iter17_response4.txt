```python
import pandas as pd

def heuristics_v2(df):
    # Define lookback periods
    price_momentum_lookback = 20
    volume_ratio_lookback = 10
    daily_volume_surprise_lookback = 10
    daily_price_momentum_lookback = 10

    # Calculate Price Momentum with EMA
    df['Price_Momentum'] = df['close'].pct_change(periods=price_momentum_lookback)
    df['Smoothed_Price_Momentum'] = df['Price_Momentum'].ewm(span=price_momentum_lookback, adjust=False).mean()

    # Calculate Volume Ratio with SMA
    df['Volume_Ratio'] = df['volume'].rolling(window=volume_ratio_lookback).mean() / df['volume'].shift(volume_ratio_lookback)
    df['Smoothed_Volume_Ratio'] = df['Volume_Ratio'].rolling(window=volume_ratio_lookback).mean()

    # Combine Momentum and Volume Ratio
    df['Combined_Momentum_Volume'] = df['Smoothed_Price_Momentum'] * df['Smoothed_Volume_Ratio']

    # Compute High-Low Price Difference
    df['High_Low_Price_Difference'] = df['high'] - df['low']

    # Compute Volume Influence Ratio
    df['Upward_Volume'] = df.apply(lambda row: row['volume'] if row['close'] > row['open'] else 0, axis=1).rolling(window=volume_ratio_lookback).sum()
    df['Downward_Volume'] = df.apply(lambda row: row['volume'] if row['close'] < row['open'] else 0, axis=1).rolling(window=volume_ratio_lookback).sum()
    df['Volume_Influence_Ratio'] = df['Upward_Volume'] / (df['Downward_Volume'] + 1e-6)  # Add small constant to avoid division by zero

    # Calculate Intraday Return
    df['Intraday_Return'] = (df['close'] - df['open']) / df['open']

    # Identify Volume Trend
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Volume_Trend_Strength'] = df['Volume_Change'].apply(lambda x: 1 if x > 0 else -1)

    # Integrate Core Components into Intermediate Alpha Factor
    df['Intermediate_Alpha_Factor'] = df['Combined_Momentum_Volume'] * df['High_Low_Price_Difference'] * df['Volume_Influence_Ratio'] * df['Intraday_Return'] * df['Volume_Trend_Strength']

    # Combine High-Low Spread and Close-Open Return for Intraday Momentum
    df['Intraday_Momentum'] = df['High_Low_Price_Difference'] * df['Intraday_Return']

    # Calculate Intraday Reversal
    df['Intraday_Reversal'] = 2 * (df['high'] - df['low']) / (df['close'] + df['open'])

    # Adjust for Open Interest
    df['Adjusted_Intraday_Reversal'] = df['Intraday_Reversal'] * (1 + (df['volume'] - df['volume'].shift(1)) / (df['volume'].shift(1) + 1e-6))

    # Consider Day-to-Day Open Price Change
    df['Day_to_Day_Open_Price_Change'] = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)

    # Final Alpha Factor Components
    df['Preliminary_Alpha_Factor'] = df['Intermediate_Alpha_Factor'] + df['Intraday_Momentum'] * df['Volume_Influence_Ratio'] + df['Adjusted_Intraday_Reversal'] + df['Day_to_Day_Open_Price_Change']

    # Calculate Daily Volume Surprise
    df['Daily_Volume_Surprise'] = df['volume'] - df['volume'].rolling(window=daily_volume_surprise_lookback).mean()

    # Calculate Daily Price Momentum
    df['Daily_Price_Momentum'] = df['close'] - df['close'].shift(daily_price_momentum_lookback)

    # Combine Price Momentum and Volume Surprise
    df['Combined_Price_Momentum_Volume_Surprise'] = df['Daily_Price_Momentum'] * df['Daily_Volume_Surprise']

    # Intermediate Alpha Factor Synthesis
    df['Synthesized_Intermediate_Alpha_Factor'] = df['Combined_Price_Momentum_Volume_Surprise'] * df['High_Low_Price_Difference']

    # Final Alpha Factor
    df['Final_Alpha_Factor'] = df['Preliminary_Alpha_Factor'] * df['Synthesized_Intermediate_Alpha_Factor']
