```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Price and Intraday Momentum Components
    df['price_diff'] = df['close'].diff()
    df['intraday_high_low_spread'] = df['high'] - df['low']

    # Smoothing Mechanisms
    ema_span = 5
    df['price_momentum_ema'] = df['price_diff'].ewm(span=ema_span, adjust=False).mean()
    df['intraday_close_open_return'] = (df['close'] - df['open']) / df['open']

    # Volume Influence and Surge
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    df['volume_surge'] = df['volume'] - df['volume'].shift(1)

    # Accumulate Volume on Upward and Downward Days
    df['upward_volume'] = df.apply(lambda row: row['volume'] if row['close'] > row['open'] else 0, axis=1).cumsum()
    df['downward_volume'] = df.apply(lambda row: row['volume'] if row['close'] < row['open'] else 0, axis=1).cumsum()

    # Integration of Intraday Range and Midpoint Deviation
    df['intraday_range'] = df['high'] - df['low']
    df['midpoint_deviation'] = df['close'] - (df['high'] + df['low']) / 2

    # Combine Momentum and Intraday Patterns
    df['combined_momentum_intraday_pattern'] = df['price_momentum_ema'] * df['intraday_high_low_spread']

    # Integrate Volume Ratio and Volume Surge
    df['volume_adjustment'] = df['volume_ratio'] + df['volume_surge']

    # Incorporate Intraday Range and Midpoint Deviation
    df['intraday_range_midpoint_deviation'] = df['intraday_range'] * df['midpoint_deviation']

    # Final Factor Composition
    df['volume_influence'] = df['upward_volume'] / (df['downward_volume'] + 1e-6)  # Avoid division by zero
    df['alpha_factor'] = (df['combined_momentum_intraday_pattern'] * df['volume_influence'] +
                          df['volume_adjustment'] +
                          df['intraday_range_midpoint_deviation'])

    return df['alpha_factor']
```
