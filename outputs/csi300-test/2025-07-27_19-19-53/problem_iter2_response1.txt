```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    import pandas as pd
    import numpy as np

    # Calculate price range
    price_range = df['high'] - df['low']
    
    # Calculate the weighted average of volume
    weighted_volume = (df['close'] - df['low']) / (df['high'] - df['low'] + 1e-7) * df['volume']
    
    # Calculate the moving average of the weighted volume over a dynamic window size
    window_size = np.round((df['high'].rolling(window=5).std() / df['high']).fillna(1) * 5).astype(int)
    ma_weighted_volume = weighted_volume.rolling(window=window_size, min_periods=1).mean()
    
    # Calculate the factor as the ratio of the current weighted volume to its moving average
    factor = weighted_volume / (ma_weighted_volume + 1e-7)
    
    # Incorporate trend
    trend = df['close'].pct_change().rolling(window=20).mean()
    factor_with_trend = factor * (1 + trend)
    
    # Incorporate volatility
    volatility = df['close'].rolling(window=20).std()
    factor_with_volatility = factor_with_trend * (1 + volatility)
    
    return factor_with_volatility
```
