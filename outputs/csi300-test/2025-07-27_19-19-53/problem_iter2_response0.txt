```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the relative strength factor comparing the current close to the 10-day moving average of the close
    ma_close_10 = df['close'].rolling(window=10).mean()
    relative_strength = df['close'] / (ma_close_10 + 1e-7)
    
    # Calculate the price range and its moving average over a 5-day window
    price_range = df['high'] - df['low']
    ma_price_range_5 = price_range.rolling(window=5).mean()
    
    # Calculate the weighted volume, using the percentage of the day's range that the close is above the low
    weighted_volume = ((df['close'] - df['low']) / (price_range + 1e-7)) * df['volume']
    
    # Calculate the moving average of the weighted volume over a 5-day window
    ma_weighted_volume_5 = weighted_volume.rolling(window=5).mean()
    
    # Calculate the factor as the product of the relative strength and the ratio of the current weighted volume to its moving average
    factor = relative_strength * (weighted_volume / (ma_weighted_volume_5 + 1e-7))
    
    return factor
```
