```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the relative strength factor comparing the current close to the 14-day moving average of the close
    ma_close_14 = df['close'].rolling(window=14).mean()
    relative_strength = df['close'] / (ma_close_14 + 1e-7)
    
    # Calculate the price range and its moving average over a 5-day window
    price_range = df['high'] - df['low']
    ma_price_range_5 = price_range.rolling(window=5).mean()
    
    # Calculate the weighted volume, using the percentage of the day's range that the close is above the low
    weighted_volume = ((df['close'] - df['low']) / (price_range + 1e-7)) * df['volume']
    
    # Calculate the moving average of the weighted volume over a 5-day window
    ma_weighted_volume_5 = weighted_volume.rolling(window=5).mean()
    
    # Calculate the adaptive volatility factor as the standard deviation of the close over a 20-day period
    adaptive_volatility = df['close'].rolling(window=20).std()
    
    # Calculate the liquidity factor as the ratio of volume to the 5-day moving average of volume
    ma_volume_5 = df['volume'].rolling(window=5).mean()
    liquidity_factor = df['volume'] / (ma_volume_5 + 1e-7)
    
    # Combine all factors: relative strength, adaptive volatility, and liquidity
    factor = relative_strength * (weighted_volume / (ma_weighted_volume_5 + 1e-7)) * (1 / (adaptive_volatility + 1e-7)) * liquidity_factor
    
    return factor
```
