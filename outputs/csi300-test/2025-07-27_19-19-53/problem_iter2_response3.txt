```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Dynamic lookback period based on recent market volatility
    volatility = df['close'].rolling(window=30).std()
    lookback_period = (volatility / volatility.rolling(window=90).mean() * 14).clip(lower=7, upper=21).astype(int)

    typical_price = (df['high'] + df['low'] + df['close']) / 3
    money_flow_multiplier = (typical_price - df['close'].shift(1)) / (df['high'] - df['low'] + 1e-7)
    money_flow_volume = money_flow_multiplier * df['volume']

    def rolling_sum_adjusted(series, window):
        return series.rolling(window=window).sum().reset_index(level=0, drop=True)

    positive_money_flow = money_flow_volume.where(money_flow_volume > 0, 0).groupby(level=0).apply(
        lambda x: rolling_sum_adjusted(x, window=lookback_period.loc[x.index.get_level_values('date')[0]]))

    negative_money_flow = money_flow_volume.where(money_flow_volume < 0, 0).groupby(level=0).apply(
        lambda x: rolling_sum_adjusted(x.abs(), window=lookback_period.loc[x.index.get_level_values('date')[0]]))

    money_ratio = positive_money_flow / negative_money_flow
    money_flow_index = 100 - (100 / (1 + money_ratio))

    return money_flow_index
```
