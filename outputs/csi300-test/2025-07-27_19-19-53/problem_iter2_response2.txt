```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price momentum
    momentum = df['close'] / df['close'].shift(14) - 1
    
    # Calculate volatility
    volatility = df['close'].rolling(window=20).std()
    
    # Calculate volume trend
    volume_trend = (df['volume'] - df['volume'].shift(5)) / (df['volume'].shift(5) + 1e-7)
    
    # Calculate market depth as the ratio of amount to volume
    market_depth = df['amount'] / (df['volume'] + 1e-7)
    
    # Calculate liquidity as the ratio of volume to price range
    liquidity = df['volume'] / (df['high'] - df['low'] + 1e-7)
    
    # Calculate a dynamic window based on the volatility
    dynamic_window = (volatility * 10).astype(int)
    dynamic_window = dynamic_window.where(dynamic_window > 1, 1)
    
    # Calculate the weighted average of volume with a dynamic window
    weighted_volume = (df['close'] - df['low']) / (df['high'] - df['low'] + 1e-7) * df['volume']
    ma_weighted_volume = weighted_volume.rolling(window=dynamic_window).mean()
    
    # Calculate the factor as a combination of the above metrics
    factor = (momentum + (volatility / (ma_weighted_volume + 1e-7)) + volume_trend + market_depth + liquidity) / 5
    
    return factor
```
