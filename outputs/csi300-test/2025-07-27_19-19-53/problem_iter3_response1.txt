```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Adaptive moving average length based on volatility, using a 10-day and 20-day standard deviation comparison
    vol_10 = df['close'].rolling(window=10).std()
    vol_20 = df['close'].rolling(window=20).std()
    adapt_window = np.where(vol_10 > vol_20, 10, 20)
    
    # Calculate the adaptive moving average of the close
    ma_close_adapt = df['close'].rolling(window=adapt_window, min_periods=1).mean()
    relative_strength = df['close'] / (ma_close_adapt + 1e-7)
    
    # Dynamic price range factor, using high-low range and its moving average over a 5-day window
    price_range = df['high'] - df['low']
    ma_price_range_5 = price_range.rolling(window=5, min_periods=1).mean()
    
    # Weighted volume, adjusted by the percentage of the day's range that the close is above the low
    weighted_volume = ((df['close'] - df['low']) / (price_range + 1e-7)) * df['volume']
    
    # Moving average of the weighted volume over a 5-day window
    ma_weighted_volume_5 = weighted_volume.rolling(window=5, min_periods=1).mean()
    
    # Factor combining relative strength and the ratio of the current weighted volume to its moving average
    factor = relative_strength * (weighted_volume / (ma_weighted_volume_5 + 1e-7))
    
    return factor
```
