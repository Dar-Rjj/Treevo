```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Adaptive Log Returns
    df['log_returns'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Calculate Realized Volatility (20-day SMA of squared log returns)
    df['realized_volatility'] = df['log_returns'].pow(2).rolling(window=20).mean()
    
    # Determine Adaptive Windows
    short_term_window = 10 / (df['realized_volatility'] + 1e-6)  # Adjust window length based on volatility
    long_term_window = 30 / (df['realized_volatility'] + 1e-6)  # Adjust window length based on volatility
    
    # Apply Adaptive Windows
    df['short_term_avg_log_returns'] = df['log_returns'].ewm(span=short_term_window, min_periods=5).mean()
    df['long_term_avg_log_returns'] = df['log_returns'].ewm(span=long_term_window, min_periods=10).mean()
    
    # Determine Trend Strength
    df['trend_strength'] = np.where(df['short_term_avg_log_returns'] > df['long_term_avg_log_returns'], 1, 0)
    
    # Integrate Mean Reversion
    df['short_term_deviation'] = (df['short_term_avg_log_returns'] - df['long_term_avg_log_returns']) / df['realized_volatility']
    df['mean_reversion_signal'] = np.where(df['short_term_deviation'] > 0, -1, 1)
    
    # Combine Momentum, Volatility, and Mean Reversion
    df['factor'] = (df['trend_strength'] * df['short_term_avg_log_returns'] + df['mean_reversion_signal']) / (df['realized_volatility'] + 1e-6)
    
    return df['factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
