```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate the daily range
    df['daily_range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate the relative strength
    df['rs'] = (df['close'] - df['open']) / df['open']
    
    # Calculate the average price
    df['avg_price'] = (df['high'] + df['low'] + df['close'] + df['open']) / 4
    
    # Calculate the volume weighted average price
    df['vwap'] = (df['volume'] * df['avg_price']).cumsum() / df['volume'].cumsum()
    
    # Calculate the money flow
    df['mf'] = df['amount'] / df['volume']
    
    # Calculate the alpha factor
    df['alpha_factor'] = (df['daily_return'] * df['daily_range'] * 
                          df['rs'] * (df['avg_price'] - df['vwap']) / df['mf'])
    
    return df['alpha_factor']

# Example usage:
# prices_df = pd.read_csv('prices.csv', parse_dates=True, index_col='date')
# alpha_factor_series = heuristics_v2(prices_df)
```
