```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Spread
    high_low_spread = df['high'] - df['low']

    # Calculate Daily Volume Trend
    volume_20_day_ma = df['volume'].rolling(window=20).mean()
    volume_trend = df['volume'] - volume_20_day_ma
    volume_trend_sign = np.sign(volume_trend)

    # Calculate Long-Term Price Trend
    close_30_day_ema = df['close'].ewm(span=30, adjust=False).mean()
    long_term_price_trend = df['close'] - close_30_day_ema
    long_term_price_trend_sign = np.sign(long_term_price_trend)

    # Calculate Volatility
    volatility = df['close'].rolling(window=20).std()

    # Combine Spread, Volume, Long-Term Price Trends, and Volatility
    adjusted_high_low_spread = high_low_spread * volume_trend
    adjusted_high_low_spread = adjusted_high_low_spread.where(
        volume_trend_sign > 0, 
        adjusted_high_low_spread * 0.5
    ).where(
        volume_trend_sign <= 0, 
        adjusted_high_low_spread * 1.5
    )

    adjusted_long_term_trend = adjusted_high_low_spread.where(
        long_term_price_trend_sign > 0, 
        adjusted_high_low_spread * 0.8
    ).where(
        long_term_price_trend_sign <= 0, 
        adjusted_high_low_spread * 1.2
    )

    percentile_50_volatility = volatility.quantile(0.5)
    final_alpha_factor = adjusted_long_term_trend.where(
        volatility > percentile_50_volatility, 
        adjusted_long_term_trend * 0.7
    ).where(
        volatility <= percentile_50_volatility, 
        adjusted_long_term_trend * 1.3
    )

    return final_alpha_factor
```
