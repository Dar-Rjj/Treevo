```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=10, P=30, M=20, momentum_weight=0.7, volatility_weight=0.3):
    # Calculate Momentum
    close_prices = df['close']
    log_returns = np.log(close_prices).diff()
    momentum = log_returns.rolling(window=N).sum()

    # Adjust for Volume
    volume = df['volume']
    avg_volume = volume.rolling(window=P).mean()
    volume_ratio = volume / avg_volume
    adjusted_momentum = momentum * volume_ratio

    # Incorporate Price Change Volatility
    abs_price_changes = close_prices.diff().abs()
    price_change_volatility = abs_price_changes.rolling(window=M).std()

    # Final Factor Calculation
    factor = (momentum_weight * adjusted_momentum) + (volatility_weight * price_change_volatility)

    return factor

# Example usage:
# Assuming df is a pandas DataFrame with columns ['open', 'high', 'low', 'close', 'amount', 'volume']
# and the index is the date.
# factor_values = heuristics_v2(df)
```
