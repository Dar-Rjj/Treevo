```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=10, momentum_thresholds=(-0.05, 0.05), volume_weight=0.3, volatility_weights=[0.25, 0.25, 0.25, 0.25]):
    # Calculate Log Returns
    close_prices = df['close']
    log_returns = np.log(close_prices).diff().fillna(0)
    
    # Compute Momentum
    cumulative_log_returns = log_returns.rolling(window=N).sum()
    upper_threshold, lower_threshold = momentum_thresholds
    clipped_momentum = np.clip(cumulative_log_returns, a_min=lower_threshold, a_max=upper_threshold)
    
    # Adjust for Volume
    volumes = df['volume']
    volume_relative_to_mean = volumes / volumes.rolling(window=N).mean()
    volume_adjusted_momentum = clipped_momentum * volume_relative_to_mean
    
    # Determine Absolute Price Changes
    abs_price_changes = close_prices.diff().abs()
    
    # Calculate Advanced Volatility Measures
    std_dev = abs_price_changes.rolling(window=M).std()
    ema = abs_price_changes.ewm(span=M, adjust=False).mean()
    iqr = abs_price_changes.rolling(window=M).quantile(0.75) - abs_price_changes.rolling(window=M).quantile(0.25)
    high_low_range = df['high'] - df['low']
    
    # Combine Volatility Measures
    combined_volatility = (std_dev * volatility_weights[0] + 
                           ema * volatility_weights[1] + 
                           iqr * volatility_weights[2] + 
                           high_low_range * volatility_weights[3])
    
    # Final Factor Calculation
    factor = (volume_adjusted_momentum * (1 - volume_weight) + 
              combined_volatility * volume_weight)
    
    return factor
```
