```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=20):
    # Obtain Close Prices
    close_prices = df['close']
    
    # Calculate Log Returns
    log_returns = np.log(close_prices).diff()
    
    # Compute Cumulative Sum of Log Returns
    momentum = log_returns.rolling(window=N).sum()
    
    # Apply Dynamic Thresholds
    upper_threshold = 0.1
    lower_threshold = -0.1
    momentum = np.clip(momentum, lower_threshold, upper_threshold)
    
    # Adjust for Volume
    volume = df['volume']
    mean_volume = volume.rolling(window=N).mean()
    volume_adjusted_momentum = momentum * (volume / mean_volume)
    
    # Determine Absolute Price Changes
    abs_price_changes = close_prices.diff().abs()
    
    # Calculate Advanced Volatility Measures
    std_dev = abs_price_changes.rolling(window=M).std()
    ema_abs_price_changes = abs_price_changes.ewm(span=M, adjust=False).mean()
    iqr = abs_price_changes.rolling(window=M).quantile(0.75) - abs_price_changes.rolling(window=M).quantile(0.25)
    
    # Combine Volatility Measures
    volatility = (std_dev + ema_abs_price_changes + iqr) / 3
    
    # Integrate Sentiment Analysis (Assuming sentiment scores are available in the DataFrame)
    positive_sentiment = df['positive_sentiment_score']
    negative_sentiment = df['negative_sentiment_score']
    neutral_sentiment = df['neutral_sentiment_score']
    weighted_sentiment = (positive_sentiment - negative_sentiment + neutral_sentiment) / 3
    
    # Integrate Sector Performance (Assuming sector data is available in the DataFrame)
    sector_data = df['sector_returns']
    sector_momentum = sector_data.rolling(window=N).sum()
    sector_volatility = sector_data.rolling(window=M).std()
    
    # Machine Learning for Dynamic Weight Adjustments (Simplified)
    # Assuming we have a trained model and features
    weights = np.array([0.4, 0.3, 0.2, 0.1])  # Example weights: [momentum, volatility, sentiment, sector]
    
    # Final Factor Calculation
    factor = (
        weights[0] * volume_adjusted_momentum +
        weights[1] * volatility +
        weights[2] * weighted_sentiment +
        weights[3] * (sector_momentum - sector_volatility)
    )
    
    return factor
```
