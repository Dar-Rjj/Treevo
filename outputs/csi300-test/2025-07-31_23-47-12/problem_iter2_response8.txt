```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N1=10, N2=20, N3=30, P=5, M=20, threshold=0.1):
    # Obtain Close Prices
    close_prices = df['close']
    
    # Compute Log Return over Multiple Periods (N1, N2, N3)
    log_returns = np.log(close_prices).diff()
    momentum_N1 = log_returns.rolling(window=N1).sum()
    momentum_N2 = log_returns.rolling(window=N2).sum()
    momentum_N3 = log_returns.rolling(window=N3).sum()
    
    # Retrieve Volumes
    volumes = df['volume']
    
    # Compute Volume Change over P Days
    volume_change = volumes.pct_change(periods=P)
    
    # Determine if Volume Change Exceeds Threshold (e.g., 10%)
    volume_exceeds_threshold = (volume_change.abs() > threshold).astype(int)
    
    # If Volume Change Exceeds Threshold, Multiply by Momentum
    weighted_momentum_N1 = momentum_N1 * volume_exceeds_threshold
    weighted_momentum_N2 = momentum_N2 * volume_exceeds_threshold
    weighted_momentum_N3 = momentum_N3 * volume_exceeds_threshold
    
    # Sum of Weighted Momentum
    total_weighted_momentum = weighted_momentum_N1 + weighted_momentum_N2 + weighted_momentum_N3
    
    # Determine Absolute Price Changes and Calculate Standard Deviation over M Days
    abs_price_changes = close_prices.diff().abs()
    volatility = abs_price_changes.rolling(window=M).std()
    
    # Final Factor Calculation
    factor = total_weighted_momentum - volatility
    
    return factor
```
