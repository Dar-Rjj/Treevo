```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n_days=30, m_days=20, momentum_threshold=0.05, volume_weight=0.5, volatility_weight=0.3):
    # Calculate Log Returns
    df['log_return'] = np.log(df['close']).diff()
    
    # Compute Momentum
    df['cumulative_log_return'] = df['log_return'].rolling(window=n_days).sum()
    df['momentum'] = df['cumulative_log_return'].clip(lower=-momentum_threshold, upper=momentum_threshold)
    
    # Adjust for Volume
    mean_volume = df['volume'].mean()
    df['volume_adjusted_momentum'] = df['momentum'] * (df['volume'] / mean_volume)
    
    # Determine Absolute Price Changes
    df['abs_price_change'] = df['close'].diff().abs()
    
    # Calculate Advanced Volatility Measures
    df['volatility_std'] = df['abs_price_change'].rolling(window=m_days).std()
    df['volatility_ema'] = df['abs_price_change'].ewm(span=m_days, adjust=False).mean()
    df['volatility_iqr'] = df['abs_price_change'].rolling(window=m_days).quantile(0.75) - df['abs_price_change'].rolling(window=m_days).quantile(0.25)
    
    # Combine Weighted Momentum, Volume, and Volatility Components
    df['factor'] = (df['volume_adjusted_momentum'] * (1 - (volume_weight + volatility_weight)) +
                    df['volume'] * volume_weight +
                    df[['volatility_std', 'volatility_ema', 'volatility_iqr']].mean(axis=1) * volatility_weight)
    
    # Ensure Weights Sum to 1
    assert (1 - (volume_weight + volatility_weight)) + volume_weight + volatility_weight == 1.0
    
    # Final Factor Calculation
    return df['factor']
```
