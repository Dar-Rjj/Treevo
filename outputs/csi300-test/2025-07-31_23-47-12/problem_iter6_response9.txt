```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, P=10, M=10, weight_momentum=0.7, weight_volatility=0.3):
    """
    Calculate a Volume Adjusted Momentum with Price Change Volatility factor.
    
    Parameters:
    - df: DataFrame with columns ['open', 'high', 'low', 'close', 'amount', 'volume'] and index as date.
    - N: Number of days to compute the log return for momentum.
    - P: Number of days to compute the moving average volume.
    - M: Number of days to compute the standard deviation of price changes.
    - weight_momentum: Weight assigned to the momentum component.
    - weight_volatility: Weight assigned to the volatility component.
    
    Returns:
    - A Series with the calculated factor values, indexed by date.
    """
    
    # Obtain close prices
    close_prices = df['close']
    
    # Compute log return over N days
    log_returns = np.log(close_prices).diff(N)
    
    # Retrieve volumes
    volumes = df['volume']
    
    # Calculate moving average volume over P days
    avg_volume = volumes.rolling(window=P).mean()
    
    # Calculate volume ratio (current volume / moving average volume)
    volume_ratio = volumes / avg_volume
    
    # Incorporate volume into momentum
    volume_adjusted_momentum = log_returns * volume_ratio
    
    # Determine absolute price changes
    price_changes = close_prices.diff().abs()
    
    # Calculate standard deviation of price changes over M days
    price_change_volatility = price_changes.rolling(window=M).std()
    
    # Ensure weights are positive and sum to 1
    assert weight_momentum > 0 and weight_volatility > 0 and weight_momentum + weight_volatility == 1, "Weights must be positive and sum to 1."
    
    # Combine weighted momentum and volatility component
    factor = (weight_momentum * volume_adjusted_momentum) + (weight_volatility * price_change_volatility)
    
    return factor
```
