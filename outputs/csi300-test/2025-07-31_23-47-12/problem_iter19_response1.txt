```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=20, momentum_weight=0.5, volume_weight=0.3, volatility_weight=0.2):
    # Calculate Log Returns
    close_prices = df['close']
    log_returns = np.log(close_prices).diff().dropna()
    
    # Compute Momentum
    cumulative_log_returns = log_returns.rolling(window=N).sum()
    upper_threshold = cumulative_log_returns.quantile(0.75)
    lower_threshold = cumulative_log_returns.quantile(0.25)
    clipped_momentum = cumulative_log_returns.clip(lower=lower_threshold, upper=upper_threshold)
    
    # Adjust for Volume
    volumes = df['volume']
    mean_volume = volumes.rolling(window=N).mean()
    volume_adjusted_momentum = (volumes / mean_volume) * clipped_momentum
    
    # Determine Absolute Price Changes
    abs_price_changes = close_prices.diff().abs()
    
    # Calculate Advanced Volatility Measures
    std_dev_volatility = abs_price_changes.rolling(window=M).std()
    ema_volatility = abs_price_changes.ewm(span=M, adjust=False).mean()
    iqr_volatility = abs_price_changes.rolling(window=M).quantile(0.75) - abs_price_changes.rolling(window=M).quantile(0.25)
    
    # Combine all components
    factor = (
        momentum_weight * volume_adjusted_momentum +
        volume_weight * (volumes / mean_volume) +
        volatility_weight * (std_dev_volatility + ema_volatility + iqr_volatility)
    )
    
    # Ensure weights sum to 1
    total_weight = momentum_weight + volume_weight + volatility_weight
    factor /= total_weight
    
    return factor.dropna()

# Example usage
df = pd.DataFrame({
    'open': [100, 101, 99, 102, 103, 104, 105, 106, 107, 108],
    'high': [101, 102, 100, 103, 104, 106, 107, 108, 109, 110],
    'low': [99, 100, 98, 101, 102, 104, 105, 106, 107, 108],
    'close': [100, 101, 99, 102, 103, 104, 105, 106, 107, 108],
    'amount': [1000, 1100, 990, 1020, 1030, 1040, 1050, 1060, 1070, 1080],
    'volume': [10000, 11000, 9900, 10200, 10300, 10400, 10500, 10600, 10700, 10800]
}, index=pd.date_range(start='2023-01-01', periods=10))

factor_values = heuristics_v2(df)
print(factor_values)
```
