```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n_days_momentum=10, n_days_volume_mean=20, m_days_volatility=30):
    # Obtain Close Prices
    close_prices = df['close']
    
    # Compute Log Return over N Days
    log_returns = np.log(close_prices) - np.log(close_prices.shift(n_days_momentum))
    
    # Retrieve Volumes and Calculate Volume Ratio
    volumes = df['volume']
    volume_ratio = volumes / volumes.rolling(window=n_days_volume_mean).mean()
    
    # Incorporate Volume into Momentum
    weighted_momentum = log_returns * volume_ratio
    
    # Determine Absolute Price Changes
    abs_price_changes = (close_prices - close_prices.shift(1)).abs()
    
    # Calculate Standard Deviation of Absolute Price Changes over M Days
    volatility = abs_price_changes.rolling(window=m_days_volatility).std()
    
    # Combine Weighted Momentum and Volatility Component
    final_factor = weighted_momentum + volatility
    
    return final_factor
```
