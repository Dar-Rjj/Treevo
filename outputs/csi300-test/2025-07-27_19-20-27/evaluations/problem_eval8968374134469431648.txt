def heuristics_v2(df):
    # Calculate the exponential moving average of the ratio of close to open prices
    close_open_ratio = df['close'] / df['open']
    ema_ratio = close_open_ratio.ewm(span=5, adjust=False).mean()
    
    # Calculate the logarithm of the difference between high and low prices
    high_low_diff_log = (df['high'] - df['low']).apply(np.log)
    
    # Composite factor: product of EMA of the ratio and log of high-low difference
    heuristics_matrix = ema_ratio * high_low_diff_log
    
    return heuristics_matrix
