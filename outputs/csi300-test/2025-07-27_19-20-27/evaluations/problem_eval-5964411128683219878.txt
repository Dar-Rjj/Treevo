def heuristics_v2(df):
    # Calculate the 20-day cumulative difference between close and open prices
    price_diff = (df['close'] - df['open']).rolling(window=20).sum()
    
    # Normalize the price difference by dividing by the average price over the same window
    avg_price = (df['close'] + df['open']) / 2
    norm_price_diff = price_diff / avg_price.rolling(window=20).mean()
    
    # Calculate the 20-day standard deviation of daily log-returns as a measure of volatility
    log_returns = np.log(df['close'] / df['close'].shift(1))
    vol = log_returns.rolling(window=20).std()
    
    # Combine the normalized price difference and volatility to form the heuristic factor
    heuristics_matrix = norm_price_diff / vol
    
    return heuristics_matrix
