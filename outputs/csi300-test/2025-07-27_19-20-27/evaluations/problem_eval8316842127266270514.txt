import pandas as pd

def heuristics_v2(df):
    momentum_window = 10
    ma_window = 20
    vol_adjust_window = 30
    
    # Calculate the price-to-moving-average ratio
    ma_close = df['close'].rolling(window=ma_window).mean()
    price_to_ma_ratio = df['close'] / ma_close
    
    # Calculate the percentage change in the price-to-MA ratio
    pct_change_price_to_ma = price_to_ma_ratio.pct_change()
    
    # Calculate the momentum of the trading volume
    vol_momentum = df['volume'].pct_change().rolling(window=momentum_window).sum()
    
    # Adjust the volume momentum by the change in price-to-MA ratio
    adjusted_vol_momentum = vol_momentum * pct_change_price_to_ma
    
    # Normalize by the closing price's rolling standard deviation (volatility)
    close_volatility = df['close'].rolling(window=vol_adjust_window).std()
    
    heuristics_matrix = adjusted_vol_momentum / close_volatility
    return heuristics_matrix
