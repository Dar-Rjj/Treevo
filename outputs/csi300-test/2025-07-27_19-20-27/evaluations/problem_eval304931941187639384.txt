def heuristics_v2(df):
    # Calculate 20-day moving average
    ma_20 = df['close'].rolling(window=20).mean()
    # Calculate 20-day standard deviation
    std_20 = df['close'].rolling(window=20).std()
    # Calculate upper and lower Bollinger Bands
    upper_band = ma_20 + 2 * std_20
    lower_band = ma_20 - 2 * std_20

    # Calculate Typical Price
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    # Calculate Raw Money Flow
    raw_money_flow = typical_price * df['volume']
    # Determine positive and negative money flow
    pos_money_flow = np.where(typical_price > typical_price.shift(1), raw_money_flow, 0)
    neg_money_flow = np.where(typical_price < typical_price.shift(1), raw_money_flow, 0)

    # Calculate Money Flow Ratio
    mfr = pos_money_flow.rolling(window=14).sum() / neg_money_flow.rolling(window=14).sum()
    # Calculate Money Flow Index
    mfi = 100 - (100 / (1 + mfr))

    # Combine Bollinger Band Width and MFI
    bollinger_width = (upper_band - lower_band) / ma_20
    heuristics_matrix = mfi / bollinger_width

    return heuristics_matrix
