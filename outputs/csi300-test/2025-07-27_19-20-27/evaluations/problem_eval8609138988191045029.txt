import pandas as pd

def heuristics_v2(df):
    short_window = 5
    long_window = 20
    very_long_window = 60
    
    # Calculate the difference between high and low prices
    short_diff = df['high'].rolling(window=short_window).mean() - df['low'].rolling(window=short_window).mean()
    long_diff = df['high'].rolling(window=long_window).mean() - df['low'].rolling(window=long_window).mean()

    # Calculate short-term and long-term volume
    short_volume = df['volume'].rolling(window=short_window).mean()
    long_volume = df['volume'].rolling(window=long_window).mean()

    # Dynamic weighting based on the ratio of short-term to long-term volume
    weight_factor = short_volume / (short_volume + long_volume)
    diff_factor = (weight_factor * short_diff + (1 - weight_factor) * long_diff)

    # Calculate the historical average true range
    tr = df['high'] - df['low']
    atr = tr.rolling(window=long_window).mean()

    heuristics_matrix = diff_factor / atr
    return heuristics_matrix
