import pandas as pd
import numpy as np

def heuristics_v2(df):
    window = 30
    # Calculate the high-low range
    hl_range = df['high'].rolling(window=window).max() - df['low'].rolling(window=window).min()
    # Sum the volume over the same window
    vol_sum = df['volume'].rolling(window=window).sum()
    # Calculate the intensity factor
    intensity_factor = hl_range / vol_sum
    return heuristics_matrix
