def heuristics_v2(df):
    # Calculate the 12-period and 26-period Exponential Moving Averages (EMA)
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()

    # Calculate the MACD line and the Signal line
    macd_line = ema_12 - ema_26
    signal_line = macd_line.ewm(span=9, adjust=False).mean()

    # Calculate the Bollinger Bands
    middle_band = df['close'].rolling(window=20).mean()
    std_dev = df['close'].rolling(window=20).std()
    upper_band = middle_band + 2 * std_dev
    lower_band = middle_band - 2 * std_dev

    # Combine MACD and Bollinger Bands to form the heuristic factor
    heuristics_matrix = (macd_line - signal_line) + ((df['close'] - lower_band) / (upper_band - lower_band))

    return heuristics_matrix
