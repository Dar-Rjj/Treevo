import pandas as pd
import numpy as np

def heuristics_v2(df):
    short_window = 5
    long_window = 20
    very_long_window = 60
    
    # Compute moving averages
    short_ma = df['close'].rolling(window=short_window).mean()
    long_ma = df['close'].rolling(window=long_window).mean()
    very_long_ma = df['close'].rolling(window=very_long_window).mean()

    # Calculate the relative strength of the closing price compared to its moving averages
    rel_strength_short = (df['close'] - short_ma) / short_ma
    rel_strength_long = (df['close'] - long_ma) / long_ma
    rel_strength_very_long = (df['close'] - very_long_ma) / very_long_ma

    # Aggregate the relative strengths with different weights
    weighted_strength = (0.5 * rel_strength_short + 0.3 * rel_strength_long + 0.2 * rel_strength_very_long)

    # Calculate the historical volatility of the relative strength
    vol_weighted_strength = weighted_strength.rolling(window=long_window).std().fillna(0)

    heuristics_matrix = weighted_strength / vol_weighted_strength
    return heuristics_matrix
