def heuristics_v2(df):
    # Calculate the moving average of the ratio of close to open prices
    close_open_ratio = df['close'] / df['open']
    ma_ratio = close_open_ratio.rolling(window=5).mean()
    
    # Calculate the difference between high and low prices
    high_low_diff = df['high'] - df['low']
    
    # Composite factor: sum of moving average of the ratio and high-low difference
    heuristics_matrix = ma_ratio + high_low_diff
    
    return heuristics_matrix
