import pandas as pd
import numpy as np

def heuristics_v2(df):
    medium_window = 30
    ema_span = 10
    
    # Calculate the cumulative return over the medium term
    cumulative_return = (df['close'].pct_change().fillna(0) + 1).rolling(window=medium_window).agg(lambda x: (x+1).prod() - 1)
    
    # Calculate the exponential moving average of volume
    ema_volume = df['volume'].ewm(span=ema_span, adjust=False).mean()
    
    # Combine the two metrics into a single heuristics matrix
    heuristics_matrix = cumulative_return / ema_volume
    return heuristics_matrix
