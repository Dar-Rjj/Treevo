import pandas as pd
import numpy as pd

def heuristics_v2(df):
    short_window = 10
    medium_window = 30
    long_window = 50
    
    short_ema = df['close'].ewm(span=short_window, adjust=False).mean()
    long_ema = df['close'].ewm(span=long_window, adjust=False).mean()
    
    # Momentum factor based on the difference between short and long EMAs
    momentum_factor = short_ema - long_ema
    
    # Volatility adjustment using the standard deviation of daily returns over the medium window
    df['return'] = df['close'].pct_change()
    volatility_adjustment = df['return'].rolling(window=medium_window).std()
    
    heuristics_matrix = momentum_factor / volatility_adjustment
    return heuristics_matrix
