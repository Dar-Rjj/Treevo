def heuristics_v2(df):
    # Calculate the 5-day, 10-day, and 20-day percentage changes in close prices
    change_5 = df['close'].pct_change(5).fillna(0)
    change_10 = df['close'].pct_change(10).fillna(0)
    change_20 = df['close'].pct_change(20).fillna(0)

    # Calculate the average volume over 5, 10, and 20 days
    avg_vol_5 = df['volume'].rolling(window=5).mean().fillna(0)
    avg_vol_10 = df['volume'].rolling(window=10).mean().fillna(0)
    avg_vol_20 = df['volume'].rolling(window=20).mean().fillna(0)

    # Compute the weight as the ratio of today's volume to the average volume
    weight_5 = df['volume'] / avg_vol_5
    weight_10 = df['volume'] / avg_vol_10
    weight_20 = df['volume'] / avg_vol_20

    # Calculate the weighted sum of price changes
    heuristics_matrix = (change_5 * weight_5) + (change_10 * weight_10) + (change_20 * weight_20)

    return heuristics_matrix
