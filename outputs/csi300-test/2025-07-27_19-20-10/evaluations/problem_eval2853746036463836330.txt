def heuristics_v2(df):
    # Calculate simple moving averages for closing prices over 5 and 20 days to assess short-term and long-term trends
    sma_5 = df['close'].rolling(window=5).mean()
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Price Momentum: difference between the current close and the 20-day SMA
    price_momentum = df['close'] - sma_20
    
    # Volume Change: daily percentage change in volume
    volume_change = df['volume'].pct_change()
    
    # Amount Pattern: difference between current amount and 5-day SMA of amount
    sma_amount_5 = df['amount'].rolling(window=5).mean()
    amount_pattern = df['amount'] - sma_amount_5
    
    # Volatility as standard deviation of log returns
    log_returns = np.log(df['close'] / df['close'].shift(1))
    volatility = log_returns.rolling(window=20).std()
    
    # Weights (inverse of volatility, high volatility reduces weight) with a small constant to avoid division by zero
    weights = 1 / (volatility + 1e-6)
    
    # Normalize weights to sum to 1 within their respective time frame
    weights = weights / weights.sum()
    
    # Calculate the heuristic factor
    heuristics_matrix = weights * (price_momentum + volume_change.fillna(0) + amount_pattern)
    
    return heuristics_matrix
