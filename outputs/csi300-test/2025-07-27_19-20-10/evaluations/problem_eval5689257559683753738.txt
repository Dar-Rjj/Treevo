import pandas as pd

def heuristics_v2(df):
    # Calculate percentage change in close price
    pct_change_close = df['close'].pct_change().fillna(0)
    
    # Calculate the ratio of current amount to its moving average
    amount_ma_ratio = df['amount'] / df['amount'].rolling(window=20).mean()
    log_amount_ma_ratio = amount_ma_ratio.apply(lambda x: 0 if x == 0 else math.log(x))
    
    # Calculate the standard deviation of daily returns
    daily_returns = df['close'].pct_change().fillna(0)
    std_dev_daily_returns = daily_returns.rolling(window=20).std()
    
    # Heuristic factor
    heuristics_matrix = (pct_change_close * log_amount_ma_ratio) * (1 / (1 + std_dev_daily_returns))
    
    return heuristics_matrix
