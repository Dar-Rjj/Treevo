def heuristics_v2(df):
    # Calculate On-Balance Volume (OBV)
    obv = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    
    # Calculate 50-day and 200-day Simple Moving Averages (SMA)
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    
    # SMA difference
    sma_diff = sma_50 - sma_200
    
    # Heuristic factor
    heuristics_matrix = obv + sma_diff
    
    return heuristics_matrix
