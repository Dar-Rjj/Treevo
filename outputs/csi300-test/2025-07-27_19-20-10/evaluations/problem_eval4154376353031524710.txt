import pandas as pd

def heuristics_v2(df):
    # Calculate the average of the last 10 days' high and low prices
    avg_high_low_10 = (df['high'].rolling(window=10).mean() + df['low'].rolling(window=10).mean()) / 2
    
    # Price Ratio: the ratio of today's close price to the average of the last 10 days' high and low prices
    price_ratio = df['close'] / avg_high_low_10
    
    # Amount Difference: difference between today's and yesterday's trade amount
    amount_diff = df['amount'].diff().fillna(0)
    
    # Volume Proportion: the proportion of the current day's volume to the maximum volume over the past 30 days
    max_volume_30 = df['volume'].rolling(window=30).max()
    volume_proportion = df['volume'] / max_volume_30.fillna(0)
    
    # Weights: based on the volume proportion
    weights = {'price_ratio': volume_proportion, 'amount_diff': 1 - volume_proportion}
    
    # Calculate the heuristic factor
    heuristics_matrix = (price_ratio * weights['price_ratio'] +
                         amount_diff * weights['amount_diff'])
    
    return heuristics_matrix
