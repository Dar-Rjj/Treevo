import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the momentum of close price over 20 days
    momentum_close = df['close'] / df['close'].shift(20) - 1
    
    # Calculate the z-score of the trading volume
    volume_zscore = (df['volume'] - df['volume'].rolling(window=20).mean()) / df['volume'].rolling(window=20).std()
    
    # Calculate the average true range
    tr = df[['high', 'low']].diff().abs().max(axis=1)
    atr = tr.rolling(window=20).mean()
    
    # Heuristic factor
    heuristics_matrix = (momentum_close * volume_zscore) / (1 + atr)
    
    return heuristics_matrix
