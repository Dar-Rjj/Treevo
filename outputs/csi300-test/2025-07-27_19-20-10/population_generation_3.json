[
     {
          "algorithm": "The new algorithm calculates a factor by combining the exponential moving average of price changes with the money flow index (MFI) of trading volume, integrating both trend and momentum indicators.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate the exponential moving average of price changes\n    ema_price_change = df['close'].diff().ewm(span=14, adjust=False).mean()\n    \n    # Calculate the Money Flow Index (MFI) of trading volume\n    typical_price = (df['high'] + df['low'] + df['close']) / 3\n    raw_money_flow = typical_price * df['volume']\n    positive_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)\n    negative_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)\n    money_flow_ratio = positive_flow.rolling(window=14).sum() / negative_flow.rolling(window=14).sum()\n    mfi_volume = 100 - (100 / (1 + money_flow_ratio))\n    \n    # Heuristic factor\n    heuristics_matrix = ema_price_change * mfi_volume\n    \n    return heuristics_matrix",
          "objective": -0.11936,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a factor by combining the exponential moving average of price returns with the accumulation/distribution line, integrating both trend and momentum indicators.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate the exponential moving average of price returns\n    ema_price_return = df['close'].pct_change().ewm(span=14, adjust=False).mean()\n    \n    # Calculate the accumulation/distribution line\n    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])\n    money_flow_volume = money_flow_multiplier * df['volume']\n    ad_line = money_flow_volume.cumsum()\n    \n    # Heuristic factor\n    heuristics_matrix = ema_price_return * ad_line\n    \n    return heuristics_matrix",
          "objective": -0.07592,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm calculates a factor by combining the weighted moving average of price changes with the relative strength index (RSI) of trading volume, integrating both trend and momentum indicators.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate the weighted moving average of price changes\n    wma_price_change = df['close'].diff().rolling(window=14).apply(lambda x: np.dot(x, np.arange(1, len(x)+1)), raw=True)\n    \n    # Calculate the RSI of trading volume\n    delta_volume = df['volume'].diff()\n    gain = (delta_volume.where(delta_volume > 0, 0)).fillna(0)\n    loss = (-delta_volume.where(delta_volume < 0, 0)).fillna(0)\n    avg_gain = gain.rolling(window=14).mean()\n    avg_loss = loss.rolling(window=14).mean()\n    rs = avg_gain / avg_loss\n    rsi_volume = 100 - (100 / (1 + rs))\n    \n    # Heuristic factor\n    heuristics_matrix = wma_price_change * rsi_volume\n    \n    return heuristics_matrix",
          "objective": -0.0222,
          "other_inf": null
     },
     {
          "algorithm": "The new algorithm computes a factor by integrating the percentage change in closing prices with the ratio of current trading amount to its moving average, adjusted by the standard deviation of daily returns to capture volatility.",
          "code": "import pandas as pd\n\ndef heuristics_v2(df):\n    # Calculate percentage change in close price\n    pct_change_close = df['close'].pct_change().fillna(0)\n    \n    # Calculate the ratio of current amount to its moving average\n    amount_ma_ratio = df['amount'] / df['amount'].rolling(window=20).mean()\n    \n    # Calculate the standard deviation of daily returns\n    daily_returns = df['close'].pct_change().fillna(0)\n    std_dev_daily_returns = daily_returns.rolling(window=20).std()\n    \n    # Heuristic factor\n    heuristics_matrix = (pct_change_close * amount_ma_ratio) / (1 + std_dev_daily_returns)\n    \n    return heuristics_matrix",
          "objective": -0.02217,
          "other_inf": null
     }
]