```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Volume-Weighted Daily Returns
    df['Daily_Return'] = df['close'].pct_change()
    df['Volume_Weighted_Return'] = df['Daily_Return'] * df['volume']

    # Compute Intraday Return
    df['Intraday_Return'] = (df['high'] - df['low']) / df['close']

    # Calculate Close-to-Open Return
    df['Close_to_Open_Return'] = (df['close'] - df['open']) / df['close']

    # Calculate Logarithmic Volume Difference
    df['Log_Volume'] = np.log(df['volume'])
    df['Log_Volume_Diff'] = df['Log_Volume'].diff().fillna(0)
    df['Smoothed_Volume_Diff'] = df['Log_Volume_Diff'].ewm(alpha=0.2).mean()

    # Calculate Intraday High-Low Spread
    df['Intraday_High_Low_Spread'] = df['high'] - df['low']

    # Weigh by Intraday Volume Activity
    df['Volume_MA_20'] = df['volume'].rolling(window=20).mean()
    df['Volume_Ratio'] = df['volume'] / df['Volume_MA_20']
    df['Intraday_High_Low_Spread_Weighted'] = df['Intraday_High_Low_Spread'] * df['Volume_Ratio']

    # Combine Intraday and Close-to-Open Returns
    df['Intraday_Return_Weighted'] = df['Intraday_Return'] * abs(df['Intraday_Return'])
    df['Close_to_Open_Return_Weighted'] = df['Close_to_Open_Return'] * abs(df['Close_to_Open_Return'])

    # Integrate Volume Change and Intraday Volatility
    df['Intraday_Return_Weighted_Adjusted'] = df['Intraday_Return_Weighted'] * df['Smoothed_Volume_Diff'] * df['Intraday_High_Low_Spread_Weighted']
    df['Close_to_Open_Return_Weighted_Adjusted'] = df['Close_to_Open_Return_Weighted'] * df['Smoothed_Volume_Diff'] * df['Intraday_High_Low_Spread_Weighted']

    # Calculate Raw Returns
    df['Raw_Returns'] = df['close'].pct_change()

    # Momentum Component
    df['EMA_5'] = df['Raw_Returns'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['Raw_Returns'].ewm(span=10, adjust=False).mean()
    df['Momentum'] = df['EMA_5'] - df['EMA_10']

    # Reversal Component
    df['WMA_21'] = df['Raw_Returns'].rolling(window=21).apply(lambda x: np.average(x, weights=np.arange(1, 22)))
    df['Reversal'] = -df['WMA_21']

    # Combine Components
    df['Combined_Components'] = (df['Momentum'] + df['Reversal']) * np.sqrt(df['volume'])

    # Combine Volume-Weighted Momentum with Price Range
    df['Raw_Momentum'] = df['close'] / df['close'].shift(5) - 1
    df['Cumulative_Volume'] = df['volume'].rolling(window=5).sum()
    df['Volume_Weighted_Momentum'] = df['Raw_Momentum'] / df['Cumulative_Volume']
    df['Price_Range'] = df['high'] - df['low']
    df['Combined_Momentum'] = df['Volume_Weighted_Momentum'] + df['Price_Range']

    # Weigh Combined Momentum by Intraday Volume Activity
    df['Combined_Momentum_Weighted'] = df['Combined_Momentum'] * df['Volume_Ratio']

    # Apply 5-Day Exponential Moving Average
    df['Final_Factor'] = df['Combined_Momentum_Weighted'].ewm(alpha=0.2, adjust=False).mean()

    return df['Final_Factor']
```
