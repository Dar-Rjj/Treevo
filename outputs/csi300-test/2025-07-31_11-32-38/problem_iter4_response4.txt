```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Raw Returns
    df['raw_returns'] = df['close'].pct_change()
    
    # Momentum Component
    df['10_day_moving_sum'] = df['raw_returns'].rolling(window=10).sum()
    df['5_day_moving_sum'] = df['raw_returns'].rolling(window=5).sum()
    df['momentum_component'] = df['10_day_moving_sum'] - df['5_day_moving_sum']
    
    # Reversal Component
    df['21_day_moving_avg'] = df['raw_returns'].rolling(window=21).mean()
    df['reversal_component'] = -df['21_day_moving_avg']
    
    # Combine Momentum and Reversal
    df['combined_factor'] = (df['momentum_component'] + df['reversal_component']) * df['volume']
    
    return df['combined_factor'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# factor_values = heuristics_v2(df)
# print(factor_values)
```
