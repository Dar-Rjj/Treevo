```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Raw Returns
    df['raw_returns'] = df['close'].pct_change()
    
    # Momentum Component
    ema_5 = df['raw_returns'].ewm(span=5, adjust=False).mean()
    ema_10 = df['raw_returns'].ewm(span=10, adjust=False).mean()
    momentum = ema_5 - ema_10
    
    # Reversal Component
    weights = np.arange(1, 22)
    wma_21 = df['raw_returns'].rolling(window=21).apply(lambda x: np.dot(x, weights)/weights.sum(), raw=True)
    reversal = -wma_21
    
    # Combine Components
    combined_factor = (momentum + reversal) * np.sqrt(df['volume'])
    
    return combined_factor
```
