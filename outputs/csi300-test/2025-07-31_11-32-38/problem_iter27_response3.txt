```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Change
    df['Daily_Price_Change'] = df['close'].diff()
    
    # Sum the Daily Price Changes over a 10-day lookback window for short-term momentum
    df['Short_Term_Momentum'] = df['Daily_Price_Change'].rolling(window=10).sum()
    
    # Calculate the cumulative sum of daily price changes over a 50-day period for medium-term trends
    df['Medium_Term_Trend'] = df['Daily_Price_Change'].rolling(window=50).sum()
    
    # Calculate daily range (High - Low) to measure volatility
    df['Daily_Range'] = df['high'] - df['low']
    
    # Compute the average daily range over a recent 20-day period for a smoother volatility metric
    df['Average_Daily_Range'] = df['Daily_Range'].rolling(window=20).mean()
    
    # Determine the ratio of the current day's range to the average range over the past 20 days (Volatility Ratio)
    df['Volatility_Ratio'] = df['Daily_Range'] / df['Average_Daily_Range']
    
    # Determine if the close is higher or lower than the open (Directional Move)
    df['Directional_Move'] = (df['close'] > df['open']).astype(int) * 2 - 1
    
    # Track the net number of upward and downward moves over a 30-day period as a sentiment indicator
    df['Net_Directional_Moves'] = df['Directional_Move'].rolling(window=30).sum()
    
    # Calculate the average directional move over a 60-day period to gauge persistent trends
    df['Average_Directional_Move'] = df['Directional_Move'].rolling(window=60).mean()
    
    # Evaluate the ratio of volume on up days to down days (Volume Ratio)
    df['Volume_Up'] = df.loc[df['close'] > df['open'], 'volume']
    df['Volume_Down'] = df.loc[df['close'] <= df['open'], 'volume']
    df['Volume_Up'] = df['Volume_Up'].fillna(0)
    df['Volume_Down'] = df['Volume_Down'].fillna(0)
    df['Volume_Ratio'] = df['Volume_Up'].rolling(window=20).sum() / df['Volume_Down'].rolling(window=20).sum()
    
    # Calculate the total volume over a 50-day period to gauge interest and liquidity
    df['Total_Volume_50'] = df['volume'].rolling(window=50).sum()
    
    # Identify the number of days with volume above the 20-day average to measure strong trading activity
    df['Volume_Above_Avg'] = (df['volume'] > df['volume'].rolling(window=20).mean()).rolling(window=20).sum()
    
    # Measure the amount change from one day to the next (Amount Change)
    df['Amount_Change'] = df['amount'].diff()
    
    # Calculate the cumulative amount change over a 60-day lookback period to assess capital flow trends
    df['Cumulative_Amount_Change'] = df['Amount_Change'].rolling(window=60).sum()
    
    # Determine the ratio of the current day's amount to the average amount over the past 20 days (Amount Ratio)
    df['Average_Amount'] = df['amount'].rolling(window=20).mean()
    df['Amount_Ratio'] = df['amount'] / df['Average_Amount']
    
    # Create a composite score by weighting and summing the momentum, volatility, directional moves, and volume indicators
    df['Composite_Score'] = (
        0.3 * df['Short_Term_Momentum'] + 
        0.2 * df['Volatility_Ratio'] + 
        0.2 * df['Average_Directional_Move'] + 
        0.1 * df['Volume_Ratio'] + 
        0.1 * df['Cumulative_Amount_Change'] + 
        0.1 * df['Volume_Above_Avg']
    )
    
    # Rank stocks based on the composite score to identify potential outperformers
    df['Rank'] = df['Composite_Score'].rank(ascending=False)
    
    # Drop unnecessary columns
    df.drop(columns=[
        'Daily_Price_Change', 'Daily_Range', 'Average_Daily_Range', 'Directional_Move',
        'Volume_Up', 'Volume_Down', 'Average_Amount'
    ], inplace=True)
    
    return df['Rank']
```
