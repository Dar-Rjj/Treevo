```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate momentum as the 10-day return
    df['momentum_10'] = df['close'].pct_change(periods=10)
    
    # Calculate volatility as the standard deviation of daily returns over the last 30 days
    df['volatility_30'] = df['close'].pct_change().rolling(window=30).std()
    
    # Volume-weighted close price
    df['volume_weighted_close'] = df['close'] * df['volume']
    
    # Shift the volume weighted close price for 1 day to represent past value
    df['volume_weighted_close_lag1'] = df['volume_weighted_close'].shift(1)
    
    # Calculate today's return based on the volume weighted close
    df['ret_today_volume_weighted'] = (df['volume_weighted_close'] - df['volume_weighted_close_lag1']) / df['volume_weighted_close_lag1']
    
    # Calculate the difference between high and low, smoothed by closing price to reduce noise impact
    df['price_range_smoothed'] = (df['high'] - df['low']) * (1 + df['close'].pct_change())
    
    # Heuristic factor is a combination of momentum, smoothed price range, and volume-weighted returns, adjusted by volatility
    heuristic_factor = (df['close'] - df['open']) / (df['price_range_smoothed'] + 1e-7) * df['ret_today_volume_weighted'] * df['momentum_10'] / (df['volatility_30'] + 1e-7)

    return heuristic_factor
```
