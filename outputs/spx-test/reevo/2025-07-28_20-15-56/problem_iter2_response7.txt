```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between today's close and yesterday's close (momentum)
    df['close_diff'] = df['close'].diff()
    
    # Calculate the average of the high and low price
    df['avg_price'] = (df['high'] + df['low']) / 2
    
    # Calculate the volume weighted by the relative close price
    df['rel_close'] = (df['close'] - df['open']) / df['open']
    df['vol_weighted_rel_close'] = df['rel_close'] * df['volume']
    
    # Calculate the volatility as the standard deviation of the close price over a rolling window
    df['volatility'] = df['close'].rolling(window=5).std().fillna(0)
    
    # Calculate the market sentiment as the sum of the close to open ratio and the volume change
    df['volume_change'] = df['volume'].pct_change().fillna(0)
    df['market_sentiment'] = (df['close'] / df['open']) + df['volume_change']
    
    # The heuristic factor is the sum of the close difference, the volume-weighted relative close, 
    # and the market sentiment adjusted by the inverse of the volatility
    df['factor'] = (df['close_diff'] + df['vol_weighted_rel_close'] + df['market_sentiment']) / (1 + df['volatility'])
    
    return df['factor']
```
