```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day and 20-day moving averages of the closing price
    df['ma_5_close'] = df['close'].rolling(window=5).mean()
    df['ma_20_close'] = df['close'].rolling(window=20).mean()

    # Calculate the difference between the closing price and the 5-day and 20-day moving averages
    df['diff_close_ma_5'] = df['close'] - df['ma_5_close']
    df['diff_close_ma_20'] = df['close'] - df['ma_20_close']

    # Calculate the exponential moving average of volume with a span of 7 days
    df['ema_7_vol'] = df['volume'].ewm(span=7, adjust=False).mean()

    # Calculate the ratio of the difference between close and MA(5 close) to EMA(7 volume)
    alpha_factor_1 = df['diff_close_ma_5'] / (df['ema_7_vol'] + 1e-7)

    # Calculate the ratio of the difference between close and MA(20 close) to EMA(7 volume)
    alpha_factor_2 = df['diff_close_ma_20'] / (df['ema_7_vol'] + 1e-7)

    # Combine the two alpha factors using an exponential weighted average
    df['combined_alpha_factor'] = (alpha_factor_1.ewm(span=7, adjust=False).mean() + alpha_factor_2.ewm(span=7, adjust=False).mean()) / 2

    return df['combined_alpha_factor']
```
