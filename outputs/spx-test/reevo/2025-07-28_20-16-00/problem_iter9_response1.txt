```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Adaptive ATR - Calculate the Average True Range over different periods and take a weighted average
    true_range = df[['high', 'low', 'close']].apply(lambda x: max(x[0], x[2]) - min(x[1], x[2]), axis=1)
    atr_7 = true_range.rolling(window=7).mean()
    atr_14 = true_range.rolling(window=14).mean()
    atr_21 = true_range.rolling(window=21).mean()
    adaptive_atr = (atr_7 * 0.5 + atr_14 * 0.3 + atr_21 * 0.2) / (df['close'].rolling(window=21).std() + 1e-7)

    # Multi-period momentum - Combine short-term, medium-term, and long-term momentum
    sma_5 = df['close'].rolling(window=5).mean()
    sma_20 = df['close'].rolling(window=20).mean()
    sma_60 = df['close'].rolling(window=60).mean()
    momentum_5 = (df['close'] > sma_5).astype(int)
    momentum_20 = (df['close'] > sma_20).astype(int)
    momentum_60 = (df['close'] > sma_60).astype(int)
    combined_momentum = (momentum_5 * 0.4 + momentum_20 * 0.3 + momentum_60 * 0.3)

    # Volume shocks - Identify days with significant volume changes
    avg_volume_14 = df['volume'].rolling(window=14).mean()
    volume_shock = (df['volume'] / avg_volume_14 - 1).abs()

    # Mean reversion and trend strength - Use RSI and ATR to balance mean reversion and trend strength
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    trend_strength = 1 / (adaptive_atr + 1e-7)

    # Volume-weighted return of the last 3 days
    weighted_return = (df['close'].pct_change().fillna(0) * df['volume']).rolling(window=3).sum() / df['volume'].rolling(window=3).sum()

    # Dynamic weighting based on the ratio of the current day's volume to the 14-day average volume
    volume_ratio = df['volume'] / avg_volume_14

    # Create a factor combining adaptive ATR, multi-period momentum, RSI, trend strength, volume shock, and weighted return
    factor = (1 / (adaptive_atr + 1e-7)) * combined_momentum * (rsi / 100) * trend_strength * (1 - volume_shock) * weighted_return * volume_ratio

    return factor
```
