```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the volatility as the standard deviation of the last 5 days' close prices
    df['volatility'] = df['close'].rolling(window=5).std(ddof=0)
    
    # Calculate the trend strength as the difference between today's close and the 5-day moving average of close prices
    df['trend_strength'] = df['close'] - df['close'].rolling(window=5).mean()
    
    # Calculate the volume-weighted price change
    df['price_change'] = df['close'] - df['open']
    df['volume_weighted_price_change'] = df['price_change'] * df['volume']
    
    # Calculate the 5-day moving average of the volume-weighted price change
    df['ma_volume_weighted_price_change'] = df['volume_weighted_price_change'].rolling(window=5).mean()
    
    # Calculate the ratio of the current day's high to the 5-day moving average of the highs
    df['high_ma_high'] = df['high'] / df['high'].rolling(window=5).mean()
    
    # Combine the factors to create the final alpha factor
    alpha_factor = (df['trend_strength'] * df['ma_volume_weighted_price_change'] * df['high_ma_high']) / (df['volatility'] + 1e-7)
    
    return alpha_factor
```
