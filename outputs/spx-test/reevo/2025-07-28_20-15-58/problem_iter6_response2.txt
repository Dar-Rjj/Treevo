```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the log returns for smoother calculations
    df['log_returns'] = np.log(df['close'] / df['close'].shift(1))
    
    # Calculate the 5-day moving average of log returns
    df['ma_log_returns_5'] = df['log_returns'].rolling(window=5).mean()
    
    # Calculate the 20-day moving average of the closing price
    df['ma_close_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate the 10-day and 30-day volatility (standard deviation of log returns)
    df['volatility_10'] = df['log_returns'].rolling(window=10).std()
    df['volatility_30'] = df['log_returns'].rolling(window=30).std()
    
    # Calculate the volume-weighted close price
    df['volume_weighted_close'] = df['close'] * df['volume']
    
    # Calculate the 5-day moving average of the volume-weighted close price
    df['ma_volume_weighted_close_5'] = df['volume_weighted_close'].rolling(window=5).mean()
    
    # Calculate the high-to-low ratio
    df['high_low_ratio'] = df['high'] / df['low']
    
    # Calculate the 10-day moving average of the high-to-low ratio
    df['ma_high_low_ratio_10'] = df['high_low_ratio'].rolling(window=10).mean()
    
    # Calculate the trend strength as the difference between the current close and the 20-day moving average
    df['trend_strength'] = df['close'] - df['ma_close_20']
    
    # Incorporate a dynamic volatility measure
    df['dynamic_volatility'] = (df['volatility_10'] + df['volatility_30']) / 2
    
    # Calculate the sentiment factor using the high-to-low ratio
    df['sentiment_factor'] = df['ma_high_low_ratio_10'] - df['ma_high_low_ratio_10'].shift(1)
    
    # Combine the factors to create the final alpha factor
    alpha_factor = (
        (df['ma_log_returns_5'] + df['ma_volume_weighted_close_5']) 
        * df['sentiment_factor'] 
        * (1 + df['trend_strength']) 
        / (1 + df['dynamic_volatility'])
    )
    
    return alpha_factor
```
