```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price and volume momentum
    df['price_momentum'] = df['close'].pct_change()
    df['volume_momentum'] = df['volume'].pct_change()
    
    # Calculate price volatility over the past 5 days
    df['price_volatility_5d'] = df['close'].rolling(window=5).std()
    
    # Calculate 10-day moving average of close price
    df['ma_close_10d'] = df['close'].rolling(window=10).mean()
    
    # Calculate 3-day exponential moving average (EMA) of volume
    df['ema_volume_3d'] = df['volume'].ewm(span=3, adjust=False).mean()
    
    # Combine the factors: 
    # 1. Price momentum weighted by the inverse of 5-day price volatility
    # 2. Volume momentum weighted by the 3-day EMA of volume
    # 3. Subtract the 10-day moving average of close to capture deviation from trend
    factor = (df['price_momentum'] / (df['price_volatility_5d'] + 1e-7)) * df['volume_momentum'] * df['ema_volume_3d'] - df['ma_close_10d']
    
    return factor
```
