```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate 30-day and 90-day moving averages to capture longer-term trends
    df['MA_30'] = df['close'].rolling(window=30).mean()
    df['MA_90'] = df['close'].rolling(window=90).mean()
    
    # Calculate the ratio of the 30-day moving average to the 90-day moving average
    df['MA_Ratio'] = df['MA_30'] / df['MA_90']
    
    # Calculate the 30-day and 90-day standard deviation to measure volatility
    df['Volatility_30'] = df['close'].rolling(window=30).std(ddof=0)
    df['Volatility_90'] = df['close'].rolling(window=90).std(ddof=0)
    
    # Adjust the MA Ratio for volatility by dividing by the 30-day and 90-day volatility
    df['MA_Vol_Adjusted'] = df['MA_Ratio'] / (df['Volatility_30'] + 1e-7) / (df['Volatility_90'] + 1e-7)
    
    # Calculate the volume-weighted price change
    price_change = df['close'] - df['open']
    df['Volume_Weighted_Price_Change'] = price_change * df['volume']
    
    # Calculate the 30-day and 90-day standard deviation of the volume-weighted price change
    df['Volatility_30_WPC'] = df['Volume_Weighted_Price_Change'].rolling(window=30).std(ddof=0)
    df['Volatility_90_WPC'] = df['Volume_Weighted_Price_Change'].rolling(window=90).std(ddof=0)
    
    # Adjust the volume-weighted price change for volatility
    df['WPC_Vol_Adjusted'] = df['Volume_Weighted_Price_Change'] / (df['Volatility_30_WPC'] + 1e-7) / (df['Volatility_90_WPC'] + 1e-7)
    
    # Combine the adjusted MA ratio with the adjusted volume-weighted price change
    return df['MA_Vol_Adjusted'] + df['WPC_Vol_Adjusted']
```
