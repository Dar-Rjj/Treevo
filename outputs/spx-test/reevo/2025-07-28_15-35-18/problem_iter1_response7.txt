```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between today's close and yesterday's close
    daily_return = df['close'].diff()
    
    # Compute the positive and negative return masks
    pos_return = (daily_return > 0).astype(int)
    neg_return = (daily_return < 0).astype(int)
    
    # Sum of positive and negative returns in the last 5 days
    sum_pos_return = pos_return.rolling(window=5).sum()
    sum_neg_return = neg_return.rolling(window=5).sum()
    
    # Calculate the factor as the ratio of positive to negative returns in the last 5 days
    factor = (sum_pos_return - sum_neg_return) / (sum_pos_return + sum_neg_return + 1e-7)
    return factor
```
