```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # EMA for smoothing
    df['ema_10d'] = df['close'].ewm(span=10, adjust=False).mean()
    df['ema_30d'] = df['close'].ewm(span=30, adjust=False).mean()

    # Momentum as the difference between the two EMAs
    df['momentum'] = df['ema_10d'] - df['ema_30d']

    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()

    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()

    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - Calculate the 10-day exponential moving average of the high and low prices
    df['ema_high_10d'] = df['high'].ewm(span=10, adjust=False).mean()
    df['ema_low_10d'] = df['low'].ewm(span=10, adjust=False).mean()
    df['market_sentiment'] = df['ema_high_10d'] - df['ema_low_10d']

    # Adaptive Weights - Use a simple EMA cross-over to determine the trend direction
    df['trend_direction'] = (df['ema_10d'] > df['ema_30d']).astype(int)

    # Dynamic Price-Volume Interaction - Adjust relative strength based on the trend direction
    df['dynamic_relative_strength'] = df['relative_strength'] * (1 + 0.5 * (df['trend_direction'] - 0.5))

    # Advanced Volatility Regime - Use Bollinger Bands to identify high and low volatility regimes
    df['bb_upper'], df['bb_middle'], df['bb_lower'] = talib.BBANDS(df['close'], timeperiod=20, nbdevup=2, nbdevdn=2, matype=0)
    df['bb_width'] = df['bb_upper'] - df['bb_lower']
    df['vol_regime'] = (df['bb_width'] > df['bb_width'].quantile(0.5)).astype(int)

    # Regime-Based Adjustments - Apply different weights based on the advanced volatility regime
    df['weight_momentum'] = 0.4 + 0.1 * (df['vol_regime'] - 0.5)
    df['weight_volatility'] = 0.2 - 0.05 * (df['vol_regime'] - 0.5)
    df['weight_dynamic_relative_strength'] = 0.2 + 0.1 * (df['vol_regime'] - 0.5)
    df['weight_volume_change'] = 0.1 - 0.05 * (df['vol_regime'] - 0.5)
    df['weight_market_sentiment'] = 0.1 + 0.05 * (df['vol_regime'] - 0.5)

    # Composite Factor - Combine momentum, volatility, dynamic relative strength, and market sentiment with adaptive weights
    df['composite_factor'] = (
        df['momentum'] * df['weight_momentum'] -
        df['volatility'] * df['weight_volatility'] +
        df['dynamic_relative_strength'] * df['weight_dynamic_relative_strength'] +
        df['volume_change_10d'] * df['weight_volume_change'] +
        df['market_sentiment'] * df['weight_market_sentiment']
    )

    # Return the composite factor
    return df['composite_factor']
```
