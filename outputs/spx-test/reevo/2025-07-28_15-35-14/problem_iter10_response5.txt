```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    df['momentum'] = df['ma_10d'] - df['ma_30d']
    
    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    
    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)
    
    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)
    
    # Trend - Calculate the 60-day linear regression slope on the close price
    df['trend'] = df['close'].rolling(window=60).apply(lambda x: np.polyfit(range(60), x, 1)[0], raw=False)
    
    # Candlestick Patterns - Bearish Engulfing, Bullish Engulfing, and Hammer patterns
    df['bearish_engulfing'] = ((df['open'] < df['close'].shift(1)) & 
                               (df['close'] > df['open'].shift(1)) & 
                               (df['open'] >= df['close']) & 
                               (df['high'] == df['open']) & 
                               (df['low'] == df['close']))
    df['bullish_engulfing'] = ((df['open'] > df['close'].shift(1)) & 
                               (df['close'] < df['open'].shift(1)) & 
                               (df['open'] <= df['close']) & 
                               (df['high'] == df['open'].shift(1)) & 
                               (df['low'] == df['close'].shift(1)))
    df['hammer'] = ((df['close'] - df['open']) > 0) & ((df['high'] - df['close']) < 0.5 * (df['close'] - df['low'])) & ((df['high'] - df['low']) > 2 * (df['close'] - df['open']))
    
    df['bearish_engulfing'] = df['bearish_engulfing'].astype(int)
    df['bullish_engulfing'] = df['bullish_engulfing'].astype(int)
    df['hammer'] = df['hammer'].astype(int)
    
    # Adaptive Weights - Use a simple exponential smoothing to adaptively weight the factors
    alpha = 0.5  # Smoothing factor
    weights = {
        'momentum': 0.2,
        'volatility': 0.1,
        'relative_strength': 0.2,
        'volume_change_10d': 0.1,
        'trend': 0.3,
        'bearish_engulfing': -0.05,
        'bullish_engulfing': 0.05,
        'hammer': 0.05
    }
    
    for factor, weight in weights.items():
        df[f'{factor}_ewm'] = df[factor].ewm(alpha=alpha).mean() * weight
    
    # New Technical Indicators
    df['rsi'] = ta.momentum.RSIIndicator(df['close'], window=14).rsi()  # RSI
    df['macd'] = ta.trend.MACD(df['close']).macd()  # MACD
    df['stoch_k'], df['stoch_d'] = ta.momentum.StochasticOscillator(df['high'], df['low'], df['close']).stoch()  # Stochastic Oscillator
    df['bb_upper'], df['bb_middle'], df['bb_lower'] = ta.volatility.BollingerBands(df['close']).bollinger_hband(), ta.volatility.BollingerBands(df['close']).bollinger_mavg(), ta.volatility.BollingerBands(df['close']).bollinger_lband()  # Bollinger Bands
