```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    import pandas as pd

    # Adaptive Momentum - Calculate the adaptive 10-day and 30-day moving averages of the close price
    def adaptive_moving_average(series, window):
        return series.rolling(window=window, min_periods=1).mean()

    df['ma_10d'] = adaptive_moving_average(df['close'], 10)
    df['ma_30d'] = adaptive_moving_average(df['close'], 30)
    df['momentum'] = df['ma_10d'] - df['ma_30d']

    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30, min_periods=1).std()

    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = adaptive_moving_average(df['volume'], 20)

    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - Calculate the 10-day moving average of the high and low prices
    df['ma_high_10d'] = adaptive_moving_average(df['high'], 10)
    df['ma_low_10d'] = adaptive_moving_average(df['low'], 10)
    df['market_sentiment'] = df['ma_high_10d'] - df['ma_low_10d']

    # Adaptive Weights - Use a simple moving average cross-over to determine the trend direction
    df['trend_direction'] = (df['ma_10d'] > df['ma_30d']).astype(int)

    # Dynamic Price-Volume Interaction - Adjust relative strength based on the trend direction
    df['dynamic_relative_strength'] = df['relative_strength'] * (1 + 0.5 * (df['trend_direction'] - 0.5))

    # Regime-Based Adjustments - Apply different weights based on the volatility regime
    df['vol_regime'] = (df['volatility'] > df['volatility'].quantile(0.5)).astype(int)
    df['composite_factor'] = (
        df['momentum'] * (0.4 + 0.1 * (df['vol_regime'] - 0.5)) -
        df['volatility'] * (0.2 - 0.05 * (df['vol_regime'] - 0.5)) +
        df['dynamic_relative_strength'] * (0.2 + 0.1 * (df['vol_regime'] - 0.5)) +
        df['volume_change_10d'] * (0.1 - 0.05 * (df['vol_regime'] - 0.5)) +
        df['market_sentiment'] * (0.1 + 0.05 * (df['vol_regime'] - 0.5))
    )

    # Additional Factor - Trend Strength Indicator
    df['trend_strength'] = (df['ma_10d'] - df['ma_30d']) / df['close']
    df['composite_factor'] += df['trend_strength'] * (0.1 + 0.05 * (df['vol_regime'] - 0.5))

    # Machine Learning for Dynamic Factor Weighting
    from sklearn.linear_model import LinearRegression

    # Prepare the feature matrix and target variable
    X = df[['momentum', 'volatility', 'dynamic_relative_strength', 'volume_change_10d', 'market_sentiment']].dropna()
    y = df['close'].pct_change()[X.index].shift(-1).dropna()

    # Train the linear regression model
    model = LinearRegression()
    model.fit(X, y)

    # Predict the factor weights
    df['predicted_factors'] = model.predict(X)
    df['composite_factor'] *= df['predicted_factors']

    # Return the composite factor
    return df['composite_factor']
```
