```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    # Calculate the momentum as the difference between the two moving averages
    df['momentum'] = df['ma_10d'] - df['ma_30d']
    
    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    
    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)
    
    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)
    
    # Trend - Calculate the 60-day linear regression slope on the close price
    df['trend'] = df['close'].rolling(window=60).apply(lambda x: np.polyfit(range(60), x, 1)[0], raw=False)
    
    # Candlestick Pattern - Bearish Engulfing pattern
    df['bearish_engulfing'] = ((df['open'] < df['close'].shift(1)) & 
                               (df['close'] > df['open'].shift(1)) & 
                               (df['open'] >= df['close']) & 
                               (df['high'] == df['open']) & 
                               (df['low'] == df['close']))
    df['bearish_engulfing'] = df['bearish_engulfing'].astype(int)
    
    # Adaptive Weights - Calculate the exponential moving average of the recent returns
    df['ema_returns_10d'] = df['close'].pct_change().ewm(span=10, adjust=False).mean()
    df['ema_returns_30d'] = df['close'].pct_change().ewm(span=30, adjust=False).mean()
    df['adaptive_weight_momentum'] = df['ema_returns_10d'] / (df['ema_returns_10d'] + df['ema_returns_30d'] + 1e-7)
    df['adaptive_weight_volatility'] = 1 - df['adaptive_weight_momentum']
    
    # Additional Technical Indicators
    df['rsi_14d'] = talib.RSI(df['close'], timeperiod=14)
    df['macd'], df['macd_signal'], _ = talib.MACD(df['close'], fastperiod=12, slowperiod=26, signalperiod=9)
    df['atr_14d'] = talib.ATR(df['high'], df['low'], df['close'], timeperiod=14)
    
    # Sentiment Analysis (Placeholder for actual sentiment data)
    df['sentiment_score'] = 0.5  # Replace with real sentiment data if available
    
    # Adaptive Weights for all factors
    df['adaptive_weight_volatility'] = 1 - df['adaptive_weight_momentum']
    df['adaptive_weight_liquidity'] = df['avg_vol_20d'].ewm(span=20, adjust=False).mean() / (df['avg_vol_20d'].ewm(span=20, adjust=False).mean() + 1e-7)
    df['adaptive_weight_relative_strength'] = df['close_diff'].ewm(span=10, adjust=False).mean() / (df['close_diff'].ewm(span=10, adjust=False).mean() + 1e-7)
    df['adaptive_weight_trend'] = df['trend'].ewm(span=60, adjust=False).mean() / (df['trend'].ewm(span=60, adjust=False).mean() + 1e-7)
    df['adaptive_weight_bearish_engulfing'] = 1 - df['bearish_engulfing'].ewm(span=10, adjust=False).mean()
    df['adaptive_weight_rsi'] = df['rsi_14d'].ewm(span=14
