```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    
    # Calculate the momentum as the difference between the two moving averages
    df['momentum'] = df['ma_10d'] - df['ma_30d']
    
    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    
    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)
    
    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)
    
    # Trend Reversal - Calculate the bearish and bullish candlestick patterns
    df['bearish_pattern'] = ((df['open'] > df['close']) & (df['high'] - df['low'] > 0.01 * df['close'])).astype(int)
    df['bullish_pattern'] = ((df['open'] < df['close']) & (df['high'] - df['low'] > 0.01 * df['close'])).astype(int)
    
    # Calculate the net trend reversal score
    df['trend_reversal'] = df['bullish_pattern'] - df['bearish_pattern']
    
    # Market Sentiment - Calculate the RSI (Relative Strength Index) with a 14-day window
    df['rsi'] = 100 - (100 / (1 + (df['close'].diff(1).clip(lower=0).rolling(window=14).mean() / df['close'].diff(1).clip(upper=0).rolling(window=14).mean().abs())))
    
    # Moving Average Convergence Divergence (MACD)
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']
    
    # Composite Factor - Combine all factors with adjusted weights
    df['composite_factor'] = (
        0.3 * df['momentum'] - 
        0.2 * df['volatility'] + 
        0.2 * df['relative_strength'] + 
        0.1 * df['volume_change_10d'] +
        0.1 * df['trend_reversal'] +
        0.1 * (df['rsi'] - 50) / 50 +
        0.1 * df['macd_histogram']
    )
    
    # Return the composite factor
    return df['composite_factor']
```
