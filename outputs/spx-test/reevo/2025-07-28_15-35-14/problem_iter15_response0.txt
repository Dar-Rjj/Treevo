```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:

    # Momentum - Calculate the 10-day and 30-day Exponential Moving Averages of the close price
    df['ema_10d'] = df['close'].ewm(span=10, adjust=False).mean()
    df['ema_30d'] = df['close'].ewm(span=30, adjust=False).mean()
    # Calculate the momentum as the difference between the two EMAs
    df['momentum'] = df['ema_10d'] - df['ema_30d']

    # Volatility - Calculate the Average True Range (ATR) over the last 14 days
    high_low = df['high'] - df['low']
    high_close = np.abs(df['high'] - df['close'].shift())
    low_close = np.abs(df['low'] - df['close'].shift())
    tr = np.maximum(high_low, np.maximum(high_close, low_close))
    df['atr_14d'] = tr.rolling(window=14).mean()

    # Volatility - Calculate the Average Directional Index (ADX) over the last 14 days
    up_move = df['high'].diff()
    down_move = -df['low'].diff()
    plus_dm = np.where((up_move > down_move) & (up_move > 0), up_move, 0)
    minus_dm = np.where((down_move > up_move) & (down_move > 0), down_move, 0)
    tr = high_low.combine(high_close, max).combine(low_close, max)
    df['plus_di'] = 100 * (plus_dm.rolling(window=14).sum() / tr.rolling(window=14).sum())
    df['minus_di'] = 100 * (minus_dm.rolling(window=14).sum() / tr.rolling(window=14).sum())
    df['adx_14d'] = 100 * (np.abs(df['plus_di'] - df['minus_di']) / (df['plus_di'] + df['minus_di'])).rolling(window=14).mean()

    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()

    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Calculate the ratio of the daily log return to the average volume
    df['log_returns'] = np.log(df['close']).diff()
    df['relative_strength'] = df['log_returns'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - Calculate the 10-day moving average of the high and low prices
    df['ma_high_10d'] = df['high'].rolling(window=10).mean()
    df['ma_low_10d'] = df['low'].rolling(window=10).mean()
    df['market_sentiment'] = df['ma_high_10d'] - df['ma_low_10d']

    # Trend Direction - Use a simple EMA cross-over to determine the trend direction
    df['trend_direction'] = (df['ema_10d'] > df['ema_30d']).astype(int)

    # Dynamic Price-Volume Interaction - Adjust relative strength based on the trend direction
    df['dynamic_relative_strength'] = df['relative_strength'] * (1 + 0.5 * (df['trend_direction'] - 0.5))

    # Regime-Based Adjustments - Apply different weights based on the volatility regime
    df['vol_regime'] = (df['atr_14d'] > df['atr_14d'].median()).astype(int)
    df['composite_factor'] = (
        df['momentum'] * (0.4 + 0.1 * (df['vol_regime'] - 0.5)) -
        df['atr_14d'] * (0.2 - 0.05 * (df['vol_regime'] - 0.5)) +
        df['adx_14d'] * (0.1 + 0.05 * (df['vol_regime'] - 0.5)) +
        df['dynamic_relative_strength'] * (0.2 + 0.1 * (df['vol_regime'] - 0.5)) +
        df['volume_change_10d'] * (0.1 - 0.05 * (df['
