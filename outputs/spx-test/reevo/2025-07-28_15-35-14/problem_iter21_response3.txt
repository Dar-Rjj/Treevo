```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    import numpy as np
    import pandas as pd

    # Hull Moving Averages with adaptive windows
    def hull_moving_average(data, window):
        half_window = int(window / 2)
        wma = data.rolling(window=window).mean()
        wma_half = data.rolling(window=half_window).mean()
        return 2 * wma_half - wma

    df['hma_10d'] = hull_moving_average(df['close'], 10)
    df['hma_30d'] = hull_moving_average(df['close'], 30)
    df['momentum_hma'] = df['hma_10d'] - df['hma_30d']

    # Log returns
    df['log_returns'] = np.log(df['close']).diff()

    # Volatility - Average True Range (ATR)
    df['high_low'] = df['high'] - df['low']
    df['high_close'] = np.abs(df['high'] - df['close'].shift())
    df['low_close'] = np.abs(df['low'] - df['close'].shift())
    df['tr'] = df[['high_low', 'high_close', 'low_close']].max(axis=1)
    df['atr_30d'] = df['tr'].ewm(span=30, adjust=False).mean()

    # Liquidity - Average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()

    # Price-Volume Relationship - 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Ratio of daily log return to average volume
    df['relative_strength'] = df['log_returns'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - 10-day moving average of high and low prices
    df['ma_high_10d'] = df['high'].rolling(window=10).mean()
    df['ma_low_10d'] = df['low'].rolling(window=10).mean()
    df['market_sentiment'] = df['ma_high_10d'] - df['ma_low_10d']

    # Adaptive Weights - EMA cross-over for trend direction
    df['trend_direction'] = (df['hma_10d'] > df['hma_30d']).astype(int)

    # Dynamic Price-Volume Interaction - Adjust relative strength based on trend direction
    df['dynamic_relative_strength'] = df['relative_strength'] * (1 + 0.5 * (df['trend_direction'] - 0.5))

    # Regime-Based Adjustments - Different weights based on volatility regime
    df['vol_regime'] = (df['atr_30d'] > df['atr_30d'].quantile(0.5)).astype(int)
    
    momentum_weight = 0.4 + 0.1 * (df['vol_regime'] - 0.5)
    atr_weight = 0.2 - 0.05 * (df['vol_regime'] - 0.5)
    dynamic_relative_strength_weight = 0.2 + 0.1 * (df['vol_regime'] - 0.5)
    volume_change_weight = 0.1 - 0.05 * (df['vol_regime'] - 0.5)
    market_sentiment_weight = 0.1 + 0.05 * (df['vol_regime'] - 0.5)

    df['composite_factor'] = (
        df['momentum_hma'] * momentum_weight -
        df['atr_30d'] * atr_weight +
        df['dynamic_relative_strength'] * dynamic_relative_strength_weight +
        df['volume_change_10d'] * volume_change_weight +
        df['market_sentiment'] * market_sentiment_weight
    )

    # Non-linear transformations
    df['composite_factor'] = df['composite_factor'].apply(lambda x: np.tanh(x))
    df['composite_factor'] = df['composite_factor'].apply(lambda x: np.sign(x) * np.sqrt(np.abs(x)))

    # Incorporate higher moments
    df['skewness'] = df['log_returns'].rolling(window=30).skew()
    df['kurtosis'] = df['log_returns'].rolling(window=30).kurt()

    df['composite_factor'] += df['skewness'] * 0.1
    df['composite_factor'] -= df['kurtosis'] * 
