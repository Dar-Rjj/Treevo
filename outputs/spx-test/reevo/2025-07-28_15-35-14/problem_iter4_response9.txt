```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    # Calculate the momentum as the difference between the two moving averages
    df['momentum'] = df['ma_10d'] - df['ma_30d']
    
    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    
    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)
    
    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)
    
    # Trend Following - Calculate the 50-day and 200-day moving averages
    df['ma_50d'] = df['close'].rolling(window=50).mean()
    df['ma_200d'] = df['close'].rolling(window=200).mean()
    df['trend_signal'] = df['ma_50d'] - df['ma_200d']
    
    # Candlestick Pattern - Bullish Engulfing
    df['prev_open'] = df['open'].shift(1)
    df['prev_close'] = df['close'].shift(1)
    df['bullish_engulfing'] = ((df['open'] > df['prev_close']) & 
                               (df['close'] < df['prev_open']) & 
                               (df['close'] > df['prev_close']) & 
                               (df['open'] < df['prev_open']))
    df['bullish_engulfing'] = df['bullish_engulfing'].astype(int)
    
    # RSI - Calculate the 14-day Relative Strength Index
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / (loss + 1e-7)
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Market Sentiment - Simple Moving Average of RSI
    df['rsi_sma_14d'] = df['rsi'].rolling(window=14).mean()
    
    # Dynamic Factor Weighting - Use a simple linear model for dynamic weighting
    from sklearn.linear_model import LinearRegression
    X = df[['momentum', 'volatility', 'relative_strength', 'trend_signal', 'bullish_engulfing', 'rsi']].dropna()
    y = df['close'].pct_change().shift(-1).dropna()  # Predict future return
    X, y = X.align(y, join='inner')
    model = LinearRegression().fit(X, y)
    weights = model.coef_
    
    # Composite Factor - Combine factors with dynamic weights
    df['composite_factor'] = (df['momentum'] * weights[0] - 
                              df['volatility'] * weights[1] + 
                              df['relative_strength'] * weights[2] + 
                              df['trend_signal'] * weights[3] + 
                              df['bullish_engulfing'] * weights[4] + 
                              df['rsi'] * weights[5])
    
    # Return the composite factor
    return df['composite_factor']
```
