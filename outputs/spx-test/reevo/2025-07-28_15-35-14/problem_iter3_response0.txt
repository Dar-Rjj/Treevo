```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    # Calculate the momentum as the difference between the two moving averages
    df['momentum'] = df['ma_10d'] - df['ma_30d']
    
    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()
    
    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()
    
    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)
    
    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)
    
    # Trend - Calculate the 50-day and 200-day moving averages of the close price
    df['ma_50d'] = df['close'].rolling(window=50).mean()
    df['ma_200d'] = df['close'].rolling(window=200).mean()
    # Calculate the long-term trend as the difference between the two moving averages
    df['long_term_trend'] = df['ma_50d'] - df['ma_200d']
    
    # Candlestick Pattern - Calculate the Body Difference (Open - Close) and normalize by the High-Low range
    df['body_difference'] = (df['open'] - df['close']) / (df['high'] - df['low'] + 1e-7)
    
    # Composite Factor - Combine momentum, volatility, liquidity, relative strength, long-term trend, and body difference
    df['composite_factor'] = (
        df['momentum'] - df['volatility'] * 2 + 
        df['relative_strength'] + 
        df['volume_change_10d'] + 
        df['long_term_trend'] + 
        df['body_difference']
    ) / 6
    
    # Return the composite factor
    return df['composite_factor']
```
