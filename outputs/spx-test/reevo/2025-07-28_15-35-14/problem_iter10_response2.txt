```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day moving averages of the close price
    df['ma_10d'] = df['close'].rolling(window=10).mean()
    df['ma_30d'] = df['close'].rolling(window=30).mean()
    # Calculate the momentum as the difference between the two moving averages
    df['momentum'] = df['ma_10d'] - df['ma_30d']

    # Volatility - Calculate the standard deviation of the daily close price over the last 30 days
    df['volatility'] = df['close'].pct_change().rolling(window=30).std()

    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()

    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Calculate the ratio of the daily close difference to the average volume
    df['close_diff'] = df['close'].diff()
    df['relative_strength'] = df['close_diff'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - Calculate the 10-day moving average of the high and low prices
    df['ma_high_10d'] = df['high'].rolling(window=10).mean()
    df['ma_low_10d'] = df['low'].rolling(window=10).mean()
    df['market_sentiment'] = df['ma_high_10d'] - df['ma_low_10d']

    # Adaptive Weights - Adjust weights based on recent volatility
    df['weight_momentum'] = 0.4 / (df['volatility'] + 1)
    df['weight_volatility'] = 0.2 / (df['volatility'] + 1)
    df['weight_relative_strength'] = 0.2 / (df['volatility'] + 1)
    df['weight_volume_change'] = 0.1 / (df['volatility'] + 1)
    df['weight_market_sentiment'] = 0.1 / (df['volatility'] + 1)

    # Non-linear Transformations for Factor Combination
    df['transformed_momentum'] = df['momentum'] ** 2
    df['transformed_volatility'] = 1 / (df['volatility'] + 1e-7)
    df['transformed_relative_strength'] = df['relative_strength'] ** 1.5
    df['transformed_volume_change'] = df['volume_change_10d'] ** 0.5
    df['transformed_market_sentiment'] = df['market_sentiment'] ** 1.2

    # Composite Factor - Combine transformed factors with adaptive weights
    df['composite_factor'] = (
        df['transformed_momentum'] * df['weight_momentum'] 
        - df['transformed_volatility'] * df['weight_volatility'] 
        + df['transformed_relative_strength'] * df['weight_relative_strength'] 
        + df['transformed_volume_change'] * df['weight_volume_change'] 
        + df['transformed_market_sentiment'] * df['weight_market_sentiment']
    )

    # Return the composite factor
    return df['composite_factor']
```
