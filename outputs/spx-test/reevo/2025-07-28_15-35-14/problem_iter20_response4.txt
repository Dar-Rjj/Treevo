```python
import numpy as np
import pandas as pd

def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Momentum - Calculate the 10-day and 30-day Hull Moving Averages of the close price
    hma_10d = (2 * df['close'].ewm(span=10, adjust=False).mean() - df['close'].ewm(span=int(10/2), adjust=False).mean()).ewm(span=int(np.sqrt(10)), adjust=False).mean()
    hma_30d = (2 * df['close'].ewm(span=30, adjust=False).mean() - df['close'].ewm(span=int(30/2), adjust=False).mean()).ewm(span=int(np.sqrt(30)), adjust=False).mean()
    df['momentum'] = hma_10d - hma_30d

    # Volatility - Calculate the Parkinson's volatility over the last 30 days
    df['log_high_low'] = np.log(df['high'] / df['low'])
    df['parkinson_volatility'] = np.sqrt((df['log_high_low'].rolling(window=30).sum()**2) / (4 * 30 * np.log(2)))

    # Liquidity - Calculate the average volume over the last 20 days
    df['avg_vol_20d'] = df['volume'].rolling(window=20).mean()

    # Price-Volume Relationship - Calculate the 10-day change in volume
    df['volume_change_10d'] = df['volume'].pct_change(periods=10)

    # Relative Strength - Calculate the ratio of the daily log return to the average volume
    df['log_returns'] = np.log(df['close']).diff()
    df['relative_strength'] = df['log_returns'] / (df['avg_vol_20d'] + 1e-7)

    # Market Sentiment - Calculate the 10-day moving average of the high and low prices
    df['ma_high_10d'] = df['high'].rolling(window=10).mean()
    df['ma_low_10d'] = df['low'].rolling(window=10).mean()
    df['market_sentiment'] = df['ma_high_10d'] - df['ma_low_10d']

    # Adaptive Weights - Use a simple Hull Moving Average cross-over to determine the trend direction
    df['trend_direction'] = (hma_10d > hma_30d).astype(int)

    # Dynamic Price-Volume Interaction - Adjust relative strength based on the trend direction
    df['dynamic_relative_strength'] = df['relative_strength'] * (1 + 0.5 * (df['trend_direction'] - 0.5))

    # Regime-Based Adjustments - Apply different weights based on the volatility regime
    df['vol_regime'] = (df['parkinson_volatility'] > df['parkinson_volatility'].quantile(0.5)).astype(int)
    
    # Non-linear transformations for robustness
    df['composite_factor'] = (
        df['momentum'] * (0.4 + 0.1 * (df['vol_regime'] - 0.5)) -
        df['parkinson_volatility'] * (0.2 - 0.05 * (df['vol_regime'] - 0.5)) +
        df['dynamic_relative_strength'] * (0.2 + 0.1 * (df['vol_regime'] - 0.5)) +
        df['volume_change_10d'] * (0.1 - 0.05 * (df['vol_regime'] - 0.5)) +
        df['market_sentiment'] * (0.1 + 0.05 * (df['vol_regime'] - 0.5))
    )
    
    # Additional non-linear transformations
    df['composite_factor'] = df['composite_factor'].apply(lambda x: np.tanh(x))
    df['composite_factor'] = df['composite_factor'].apply(lambda x: np.sign(x) * np.sqrt(np.abs(x)))
    
    # Final dynamic weighting adjustment based on the trend direction
    df['final_composite_factor'] = (
        df['composite_factor'] * (1 + 0.05 * (df['trend_direction'] - 0.5))
    )

    # Return the final composite factor
    return df['final_composite_factor']
```
