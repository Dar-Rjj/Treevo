```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the 50-day Simple Moving Average (SMA) of Closing Prices
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    
    # Base Alpha Factor: Difference Between the Current Day's Close Price and the 50-day SMA
    df['Base_Alpha_Factor'] = df['close'] - df['SMA_50']
    
    # Calculate the 20-day Exponential Moving Average (EMA) of Volume
    df['EMA_Volume_20'] = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Volume-Based Alpha Factor: Divide Today's Volume by the 20-day EMA of Volume
    df['Volume_Factor'] = df['volume'] / df['EMA_Volume_20']
    
    # Combine the SMA and Volume Factors
    df['SMA_Volume_Factor'] = df['Base_Alpha_Factor'] * df['Volume_Factor']
    
    # Intraday High-Low Range
    df['High_Low_Range'] = df['high'] - df['low']
    
    # Open to Close Movement
    df['Open_Close_Movement'] = df['close'] - df['open']
    
    # Volume-Weighted Average Price (VWAP)
    df['Typical_Price'] = (df['high'] + df['low'] + df['close']) / 3
    df['VWAP'] = (df['volume'] * df['Typical_Price']).cumsum() / df['volume'].cumsum()
    
    # Weighted Ratio of High-Low to Open-Close
    df['HL_OC_Ratio'] = df['High_Low_Range'] / df['Open_Close_Movement'].abs()
    
    # VWAP Deviation from Close
    df['VWAP_Deviation'] = df['close'] - df['VWAP']
    
    # Closing Position in Intraday Range
    df['Close_Position'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Intraday Volume Intensity
    df['Median_Volume_10'] = df['volume'].rolling(window=10).median()
    df['Volume_Intensity'] = df['volume'] / df['Median_Volume_10']
    
    # Adjust for Recent Price Trend
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Trend_Adjustment'] = df['close'] - df['EMA_20']
    
    # Short-Term Price Momentum
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['Short_Term_Momentum'] = df['EMA_5'] - df['EMA_10']
    
    # Composite Alpha Factor
    weighted_sum = 0.3 * df['HL_OC_Ratio'] + 0.3 * df['VWAP_Deviation'] + 0.2 * df['Volume_Intensity'] + 0.2 * df['Close_Position']
    
    # Incorporate Recent Volatility
    df['Volatility_20'] = df['close'].rolling(window=20).std()
    trend_adjustment_volatility = df['Trend_Adjustment'] / df['Volatility_20']
    
    # Final Alpha Factor
    df['Alpha_Factor'] = weighted_sum + trend_adjustment_volatility + df['Short_Term_Momentum']
    
    return df['Alpha_Factor']
```
