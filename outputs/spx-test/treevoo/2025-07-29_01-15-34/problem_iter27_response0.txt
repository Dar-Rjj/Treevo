```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 50-day weighted moving average (WMA) of closing prices
    weights = np.arange(1, 51)
    wma_50_close = df['close'].rolling(window=50).apply(lambda x: np.average(x, weights=weights), raw=True)
    
    # Raw alpha factor (difference between current day's close price and 50-day WMA)
    raw_alpha_factor = df['close'] - wma_50_close
    
    # Calculate the 20-day Exponential Moving Average (EMA) of volume
    ema_20_volume = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Volume-based alpha factor (today's volume / 20-day EMA of volume)
    volume_factor = df['volume'] / ema_20_volume
    
    # Composite alpha factor (raw alpha factor * volume factor)
    composite_alpha_factor = raw_alpha_factor * volume_factor
    
    # Calculate the 10-day Average True Range (ATR)
    true_range = np.maximum(
        (df['high'] - df['low']), 
        np.maximum(abs(df['high'] - df['close'].shift()), abs(df['low'] - df['close'].shift()))
    )
    atr_10 = true_range.rolling(window=10).mean()
    
    # Volatility-based alpha factor (current day's range / 10-day ATR)
    volatility_factor = (df['high'] - df['low']) / atr_10
    
    # Final comprehensive composite alpha factor (composite alpha factor * volatility factor)
    final_composite_alpha_factor = composite_alpha_factor * volatility_factor
    
    return final_composite_alpha_factor
```
