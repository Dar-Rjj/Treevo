```txt
Volume-Weighted Price Momentum with Volume Impact
├── Calculate Volume-Weighted Price
│   ├── Sum of (Close * Volume)
│   └── Divide by Total Volume
├── Calculate Short-Term Price Trend
│   ├── Use Volume-Weighted Price
│   │   ├── From t-1 to t-3
│   └── Subtract Previous Day's Volume-Weighted Price
│       ├── At t-3
├── Calculate Long-Term Price Trend
│   ├── Use Volume-Weighted Price
│   │   ├── From t-5 to t-20
│   └── Subtract Previous Day's Volume-Weighted Price
│       ├── At t-20
├── Reversal Momentum
│   ├── Subtract Short-Term Trend from Long-Term Trend
│   └── Multiply by Volume-Weighted Price
│       ├── At t
├── Calculate Daily Log Return
│   ├── Use Close price (t) - Close price (t-1)
│   └── Compute log((Close price (t) / Close price (t-1)))
├── Calculate Volume Change
│   ├── Use Volume (t)
│   └── Use Volume (t-1)
│       └── Compute Volume (t) - Volume (t-1)
├── Combine Price Momentum and Volume Change
│   ├── Use Daily Log Return
│   └── Use Volume Change
│       └── Compute (Daily Log Return * Volume Change)
└── Combined Factor
    ├── Add Reversal Momentum and Combined Factor
    └── Compute Average over 10 Days
        ├── Use Last 10 days' Combined Factor
        └── Sum the values and divide by 10
```
