```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # 5-day and 20-day Simple Moving Averages (SMA)
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()

    # 12-day Rate of Change (RoC) of Close Prices
    df['ROC_12'] = df['close'].pct_change(periods=12)

    # On-Balance Volume (OBV)
    obv = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    df['OBV'] = obv
    df['OBV_Slope_14'] = df['OBV'].diff(periods=14)

    # Volume-Price Trend (VPT)
    vpt = ((df['close'] - df['close'].shift(1)) / df['close'].shift(1)) * df['volume']
    vpt = vpt.cumsum().fillna(0)
    df['VPT'] = vpt
    df['VPT_MA_10'] = df['VPT'].rolling(window=10).mean()
    df['VPT_Diff_20_from_MA_10'] = df['VPT'].diff(periods=20) - df['VPT_MA_10']

    # 21-day Chaikin Money Flow (CMF)
    mfv = (df['close'] - df['low']) - (df['high'] - df['close']) / (df['high'] - df['low'])
    mfv *= df['volume']
    cmf = mfv.rolling(window=21).sum() / df['volume'].rolling(window=21).sum()
    df['CMF_21'] = cmf

    # Counting consecutive inside bars within a 5-day window
    df['Inside_Bar'] = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))
    df['Consecutive_Inside_Bars_5'] = df['Inside_Bar'].rolling(window=5).sum()

    # Identifying bullish and bearish engulfing patterns in the last 3 days
    def is_engulfing(row, prev_row):
        if row['close'] > row['open'] and prev_row['close'] < prev_row['open']:
            return row['close'] > prev_row['open'] and row['open'] < prev_row['close']
        elif row['close'] < row['open'] and prev_row['close'] > prev_row['open']:
            return row['close'] < prev_row['open'] and row['open'] > prev_row['close']
        return False

    df['Engulfing_Pattern'] = [is_engulfing(df.iloc[i], df.iloc[i-1]) for i in range(len(df))]
    df['Bullish_Engulfing_3'] = df['Engulfing_Pattern'].rolling(window=3).apply(lambda x: any(x), raw=True)
    df['Bearish_Engulfing_3'] = df['Engulfing_Pattern'].rolling(window=3).apply(lambda x: all(x == False for x in x), raw=True)

    # 14-day Average True Range (ATR)
    tr = np.maximum(np.maximum(df['high'] - df['low'], np.abs(df['high'] - df['close'].shift())), np.abs(df['low'] - df['close'].shift()))
    df['ATR_14'] = tr.rolling(window=14).mean()

    # 20-day Bollinger Bands Width
    df['BB_Middle_20'] = df['close'].rolling(window=20).mean()
    df['BB_STD_20'] = df['close'].rolling(window=20).std()
    df['BB_Upper_20'] = df['BB_Middle_20'] + 2 * df['BB_STD_20']
    df['BB_Lower_20'] = df['BB_Middle_20'] - 2 * df['BB_STD_20']
    df['BB_Width_20'] = (df['BB_Upper_20'] - df['BB_Lower_20']) / df['BB_Middle_20']

    # Alpha Factor
    alpha_factor = (
        (df['SMA_5'] - df['SMA_20']) +
        df['ROC_12'] +
        df['OBV_Slope_14'] +
        df['VPT_Diff_20
