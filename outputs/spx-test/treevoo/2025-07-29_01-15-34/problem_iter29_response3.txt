```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate Open to Close Movement
    df['open_close_movement'] = df['close'] - df['open']
    
    # Calculate Volume-Weighted Average Price (VWAP)
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['vwap'] = (df['volume'] * df['typical_price']).cumsum() / df['volume'].cumsum()
    
    # Weighted Ratio of High-Low to Open-Close
    df['hl_oc_ratio'] = df['high_low_range'] / df['open_close_movement'].abs()
    
    # VWAP Deviation from Close
    df['vwap_deviation'] = df['vwap'] - df['close']
    
    # Identify Trend Strength and Reversal Signals
    df['positive_momentum'] = (df['high_low_range'] > 1.5 * df['open_close_movement']).astype(int)
    df['potential_reversal'] = ((df['open_close_movement'] > 0.8 * df['high_low_range']) & (df['vwap_deviation'] < 0) & (df['open_close_movement'] < 0)).astype(int)
    df['momentum_continuation'] = ((df['high_low_range'] > 2 * df['open_close_movement']) & (df['vwap'] > df['close'])).astype(int)
    df['reversal_confirmation'] = ((df['open_close_movement'] < -0.5 * df['high_low_range']) & (df['vwap'] < df['close'])).astype(int)
    
    # Calculate Intraday Range Percentage
    df['intraday_range_percentage'] = (df['high'] - df['low']) / df['close']
    
    # Calculate Closing Position in Intraday Range
    df['closing_position_in_range'] = (df['close'] - df['open']) / (df['high'] - df['low'])
    
    # Integrate Volume Activity Ratio
    N = 10
    df['volume_trend'] = df['volume'].rolling(window=N).sum()
    df['avg_volume'] = df['volume'].rolling(window=N).mean()
    df['volume_activity_ratio'] = df['volume_trend'] / df['avg_volume']
    
    # Intraday Volume Intensity
    df['intraday_volume_intensity'] = df['volume'] / df['volume'].rolling(window=10).sum()
    
    # Adjust for Recent Price Trend
    df['ema_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['recent_trend_adjustment'] = df['close'] - df['ema_20']
    
    # Incorporate Recent Volatility
    df['std_20'] = df['close'].rolling(window=20).std()
    df['trend_volatility_adjustment'] = df['recent_trend_adjustment'] / df['std_20']
    
    # Daily Return Volatility
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['std_daily_return'] = df['daily_return'].rolling(window=N).std()
    df['daily_return_volatility'] = df['daily_return'] / df['std_daily_return']
    
    # Trend Reversal Potential
    df['rsi_14'] = 100 - (100 / (1 + df['close'].diff().fillna(0).ewm(com=13, adjust=False).mean() / df['close'].diff().fillna(0).ewm(com=13, adjust=False).mean().abs()))
    df['overbought'] = (df['rsi_14'] > 70).astype(int)
    df['oversold'] = (df['rsi_14'] < 30).astype(int)
    df['roc_14'] = (df['close'] - df['close'].shift(14)) / df['close'].shift(14)
    df['trend_reversal_potential'] = (df['overbought'] & (df['roc_14'] < 0)).astype(int) - (df['oversold'] & (df['roc_14'] > 0)).astype(int)
    
    # Momentum Reversal Factor
    df['sma_5'] = df['close'].rolling(window=5).mean()
   
