```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Volume-Weighted Price
    df['Volume_Weighted_Price'] = (df['close'] * df['volume']).rolling(window=1, min_periods=1).sum() / df['volume'].rolling(window=1, min_periods=1).sum()
    
    # Calculate Short-Term Price Trend
    df['Short_Term_Price_Trend'] = df['Volume_Weighted_Price'].shift(3) - df['Volume_Weighted_Price'].shift(4)
    
    # Calculate Long-Term Price Trend
    df['Long_Term_Price_Trend'] = df['Volume_Weighted_Price'].shift(20) - df['Volume_Weighted_Price'].shift(21)
    
    # Reversal Momentum
    df['Reversal_Momentum'] = (df['Short_Term_Price_Trend'] - df['Long_Term_Price_Trend']) * df['Volume_Weighted_Price']
    
    # Calculate Daily Log Return
    df['Daily_Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Calculate Volume Change
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    
    # Combine Price Momentum and Volume Change
    df['Combined_Factor'] = df['Daily_Log_Return'] * df['Volume_Change']
    
    # Integrated Combined Factor
    df['Integrated_Combined_Factor'] = (df['Reversal_Momentum'] + df['Combined_Factor']).rolling(window=10, min_periods=1).mean()
    
    # Calculate Intraday Range Percentage
    df['Intraday_Range_Percentage'] = (df['high'] - df['low']) / df['close']
    
    # Calculate Close-to-Open Momentum Shift
    df['Close_to_Open_Momentum_Shift'] = (df['close'] - df['open']) / df['open']
    
    # Integrate Volume Activity Ratio
    df['Volume_Trend'] = df['volume'].rolling(window=10, min_periods=1).sum()
    df['Average_Volume'] = df['volume'].rolling(window=10, min_periods=1).mean()
    df['Volume_Activity_Ratio'] = df['Volume_Trend'] / df['Average_Volume']
    
    # Final alpha factor
    df['Alpha_Factor'] = df['Integrated_Combined_Factor'] + df['Intraday_Range_Percentage'] + df['Close_to_Open_Momentum_Shift'] + df['Volume_Activity_Ratio']
    
    return df['Alpha_Factor']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
