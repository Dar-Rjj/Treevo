```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Returns
    df['Daily_Return'] = df['close'].pct_change()
    
    # Compute Moving Average of Returns (20 days)
    df['MA_Returns'] = df['Daily_Return'].rolling(window=20).mean()
    
    # Calculate Volatility (20 days)
    df['Volatility'] = df['Daily_Return'].rolling(window=20).std()
    
    # Determine Momentum Strength
    df['Momentum_Strength'] = df['MA_Returns'] / df['Volatility']
    
    # Calculate Price Momentum Score
    # Short-term Price Movement
    df['Short_Term_Return'] = df['Daily_Return'].rolling(window=5).sum()
    df['Short_Term_Score'] = 100 * (df['Short_Term_Return'] - df['Short_Term_Return'].min()) / (df['Short_Term_Return'].max() - df['Short_Term_Return'].min())
    
    # Long-term Price Movement (Weekly Return)
    df['Weekly_Return'] = df['close'].pct_change(periods=5)
    df['Long_Term_Score'] = 100 * (df['Weekly_Return'] - df['Weekly_Return'].min()) / (df['Weekly_Return'].max() - df['Weekly_Return'].min())
    
    # Combine Price Momentum Scores
    df['Price_Momentum_Score'] = 0.6 * df['Short_Term_Score'] + 0.4 * df['Long_Term_Score']
    
    # Calculate Intraday Range Percentage
    df['Intraday_Range'] = (df['high'] - df['low']) / df['close']
    
    # Calculate Close-to-Open Momentum Shift
    df['Close_Open_Momentum'] = (df['close'] - df['open']) / df['open']
    
    # Integrate Volume Activity Ratio
    # Summarize Volume Trend (N-period Sum)
    df['Volume_Trend'] = df['volume'].rolling(window=20).sum()
    # Average Volume (N-period Moving Average)
    df['Average_Volume'] = df['volume'].rolling(window=20).mean()
    # Volume Activity Ratio
    df['Volume_Activity_Ratio'] = df['Volume_Trend'] / df['Average_Volume']
    
    # Calculate Volume Activity Score
    # Short-term Volume Change
    df['Daily_Volume_Change'] = df['volume'].pct_change()
    df['Avg_Daily_Volume_Change'] = df['Daily_Volume_Change'].rolling(window=5).mean()
    df['Volume_Change_Score'] = 100 * (df['Avg_Daily_Volume_Change'] - df['Avg_Daily_Volume_Change'].min()) / (df['Avg_Daily_Volume_Change'].max() - df['Avg_Daily_Volume_Change'].min())
    
    # Long-term Volume Activity
    df['Long_Term_Volume'] = df['volume'].rolling(window=20).sum()
    df['Volume_Activity_Score'] = 100 * (df['Long_Term_Volume'] - df['Long_Term_Volume'].min()) / (df['Long_Term_Volume'].max() - df['Long_Term_Volume'].min())
    
    # Apply Adaptive Weighting
    df['Adaptive_Weight'] = df['Momentum_Strength'] * df['Volume_Activity_Score']
    df['Smoothed_Adaptive_Weight'] = df['Adaptive_Weight'].rolling(window=5).mean()
    
    # Composite Alpha Factor
    df['Weighted_Scores'] = 0.6 * df['Price_Momentum_Score'] + 0.4 * df['Volume_Activity_Score']
    df['Alpha_Factor'] = df['Weighted_Scores'] + df['Smoothed_Adaptive_Weight']
    
    return df['Alpha_Factor']
```
