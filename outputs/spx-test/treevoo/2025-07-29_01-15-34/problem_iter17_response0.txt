```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Calculate Closing Position in Intraday Range
    df['close_position'] = (df['close'] - df['open']) / df['intraday_range']
    
    # Calculate Intraday Volume Intensity
    sum_volume = df['volume'].rolling(window=10).sum()
    median_volume = df['volume'].rolling(window=10).median()
    df['volume_intensity'] = df['volume'] / ((sum_volume + median_volume) / 2)
    
    # Calculate Daily Return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Identify Local Peaks and Troughs
    df['peak'] = df['close'].rolling(window=10).max()
    df['trough'] = df['close'].rolling(window=10).min()
    
    # Measure From High Point
    df['from_high'] = df['close'] - df['peak']
    
    # Measure From Low Point
    df['from_low'] = df['close'] - df['trough']
    
    # Average Trading Volume
    df['avg_volume'] = df['volume'].rolling(window=10).mean()
    
    # Volume Anomaly Factor
    df['vol_anomaly'] = df['volume'] / df['avg_volume']
    
    # Money Flow Analysis
    positive_flow = (df['daily_return'] > 0) * (df['volume'] * df['daily_return'])
    negative_flow = (df['daily_return'] < 0) * (df['volume'] * df['daily_return'])
    df['positive_money_flow'] = positive_flow.rolling(window=10).sum()
    df['negative_money_flow'] = negative_flow.abs().rolling(window=10).sum()
    df['money_flow_ratio'] = df['positive_money_flow'] / df['negative_money_flow']
    
    # Integrate Volume Activity Ratio
    df['volume_trend'] = df['volume'].rolling(window=10).sum()
    df['volume_diff'] = df['volume_trend'] - df['avg_volume']
    
    # Combine Factors
    df['combined_factor'] = (df['volume_intensity'] * df['close_position']) + \
                             (df['close'] - df['close'].ewm(span=20).mean()) + \
                             df['daily_return'] + \
                             df['from_high'] + \
                             df['from_low'] + \
                             df['vol_anomaly'] + \
                             df['money_flow_ratio']
    
    # Compound Factor
    df['momentum_vol_anomaly'] = df['daily_return'] * (df['volume'] / df['avg_volume'])
    df['value_change'] = (df['close'] - df['trough'].rolling(window=10).min()) / \
                         (df['peak'].rolling(window=10).max() - df['trough'].rolling(window=10).min()) * \
                         (df['volume'] / df['avg_volume'])
    df['intraday_range_pct'] = (df['high'] - df['low']) / df['open']
    df['close_open_momentum'] = (df['close'] - df['open']) / df['close']
    df['compound_factor'] = df['intraday_range_pct'] + df['close_open_momentum']
    
    return df['combined_factor']
```
