```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    intraday_range = df['high'] - df['low']
    
    # Calculate Open to Close Movement
    open_close_movement = df['close'] - df['open']
    
    # Calculate Volume-Weighted Average Price (VWAP)
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    vwap = (typical_price * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Closing Position in Intraday Range
    closing_position = (df['close'] - df['open']) / intraday_range
    
    # Intraday Volume Intensity
    volume_intensity = df['volume'] / df['volume'].rolling(window=10).median()
    
    # Combine Intraday Components
    combined_intraday = (volume_intensity * closing_position + 
                         open_close_movement + 
                         df['close'] - df['open'])
    
    # Recent Price Trend
    ema_20 = df['close'].ewm(span=20, adjust=False).mean()
    recent_trend = ema_20 - df['close']
    
    # Daily Return Volatility
    daily_return = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    return_volatility = daily_return / daily_return.rolling(window=20).std()
    
    # Adjust Combined Intraday Components
    adjusted_intraday = combined_intraday * return_volatility + recent_trend
    
    # Trend Reversal Potential
    rsi = df['close'].rolling(window=14).apply(lambda x: compute_rsi(x))
    overbought = (rsi > 70).astype(int)
    oversold = (rsi < 30).astype(int)
    roc = df['close'].pct_change(periods=14)
    reversal_potential = (overbought * (roc < 0) - oversold * (roc > 0)).astype(float)
    
    # Momentum Reversal Factor
    sma_5 = df['close'].rolling(window=5).mean()
    momentum_reversal = (df['close'] - sma_5) / sma_5
    
    # Additional Factors
    positive_momentum = (intraday_range > 1.5 * np.abs(open_close_movement)).astype(int)
    potential_reversal = ((np.abs(open_close_movement) > 0.8 * intraday_range) & 
                          (vwap - df['close'] < 0) & (open_close_movement < 0)).astype(int)
    momentum_continuation = ((intraday_range > 2 * np.abs(open_close_movement)) & 
                            (vwap > df['close'])).astype(int)
    reversal_confirmation = ((open_close_movement < -0.5 * intraday_range) & 
                            (vwap < df['close'])).astype(int)
    
    # Weighted Ratio of High-Low to Open-Close
    weighted_ratio = intraday_range / np.abs(open_close_movement)
    
    # VWAP Deviation from Close
    vwap_deviation = vwap - df['close']
    
    # Composite Alpha Factor
    composite_alpha = (weighted_ratio * 0.3 + 
                       vwap_deviation * 0.3 + 
                       volume_intensity * 0.2 + 
                       closing_position * 0.2)
    
    # Trend Adjustment
    trend_adjustment = (recent_trend / df['close'].rolling(window=20).std())
    
    # Final Alpha Factor
    final_alpha = (adjusted_intraday + 
                   reversal_potential + 
                   momentum_reversal + 
                   composite_alpha + 
                   trend_adjustment)
    
    return final_alpha

def compute_rsi(prices, window_length=14):
    diff = prices.diff(1)
    up, down = diff.copy(), diff.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    roll_up = up.rolling(window_length).mean()
    roll_down = down.rolling(window_length).abs().mean()
    rs = roll_up / roll_down
    rsi = 100.0 - (100.0 / (1.0 + rs))
    return rsi
```
