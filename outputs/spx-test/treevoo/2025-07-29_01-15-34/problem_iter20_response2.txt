```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday High-Low Range
    df['high_low_range'] = df['high'] - df['low']
    
    # Calculate Closing Position in Intraday Range
    df['close_pos'] = (df['close'] - df['open']) / df['high_low_range']
    
    # Calculate Intraday Volume Intensity
    sum_vol_10d = df['volume'].rolling(window=10).sum()
    median_vol_10d = df['volume'].rolling(window=10).median()
    df['vol_intensity'] = df['volume'] / ((sum_vol_10d + median_vol_10d) / 2)
    
    # Calculate Daily Return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Identify Local Peaks and Troughs
    lookback_window = 10
    df['peak'] = df['close'].rolling(window=lookback_window, min_periods=1).max()
    df['trough'] = df['close'].rolling(window=lookback_window, min_periods=1).min()
    
    # Measure From High Point and Low Point
    df['from_high'] = df['close'] - df['peak']
    df['from_low'] = df['close'] - df['trough']
    
    # Average Trading Volume
    avg_vol = df['volume'].rolling(window=20).mean()
    
    # Volume Anomaly Factor
    df['vol_anomaly'] = df['volume'] / avg_vol
    
    # Money Flow Analysis
    positive_flow = (df[df['daily_return'] > 0]['volume'] * df[df['daily_return'] > 0]['daily_return']).rolling(window=20).sum()
    negative_flow = (df[df['daily_return'] < 0]['volume'] * df[df['daily_return'] < 0]['daily_return']).rolling(window=20).sum().abs()
    df['money_flow_ratio'] = positive_flow / negative_flow
    
    # Integrate Volume Activity Ratio
    trend_vol = df['volume'].rolling(window=20).sum()
    avg_vol_20d = df['volume'].rolling(window=20).mean()
    df['vol_activity_ratio'] = trend_vol - avg_vol_20d
    
    # Combine Factors
    combined_factor = (df['vol_intensity'] * df['close_pos']) + \
                      (df['close'] - df['close'].ewm(span=20, adjust=False).mean()) + \
                      df['daily_return'] + df['from_high'] + df['from_low'] + \
                      df['vol_anomaly'] + df['money_flow_ratio']
    
    # Compound Factor
    momentum_volume_factor = df['daily_return'] * df['vol_anomaly']
    value_change_factor = (df['close'] - df['trough']) / (df['peak'] - df['trough']) * df['vol_anomaly']
    intraday_momentum_factor = (df['high'] - df['low']) / df['open'] + (df['close'] - df['open']) / df['close']
    
    # Final Alpha Factor
    alpha_factor = combined_factor + momentum_volume_factor + value_change_factor + intraday_momentum_factor
    return alpha_factor
```
