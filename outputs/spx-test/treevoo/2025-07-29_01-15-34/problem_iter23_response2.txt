```python
import pandas as pd

def heuristics_v2(df):
    # Intraday Range Intensity
    df['intraday_range'] = df['high'] - df['low']
    df['intraday_range_intensity'] = df['intraday_range'] / ((df['high'] + df['low']) / 2)
    
    # Open-to-Close Momentum Shift
    df['open_close_momentum'] = (df['close'] - df['open']) / df['close'].shift(1)
    
    # Volume Activity Ratio
    n = 10
    df['volume_n_sum'] = df['volume'].rolling(n).sum()
    df['volume_ema'] = df['volume'].ewm(span=n, adjust=False).mean()
    df['volume_activity_ratio'] = df['volume_n_sum'] / df['volume_ema']
    
    # Daily Return Volatility Adjusted
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    df['atr'] = df['high'] - df['low']
    df['daily_return_vol_adj'] = df['log_return'] / df['atr'].rolling(n).mean()
    
    # Price Volatility Factor
    df['log_return_std'] = df['log_return'].rolling(n).std()
    gain = (df['close'] - df['close'].shift(1)).clip(lower=0)
    loss = (df['close'].shift(1) - df['close']).clip(upper=0)
    avg_gain = gain.rolling(n).mean()
    avg_loss = abs(loss.rolling(n).mean())
    rs = avg_gain / avg_loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Intraday High-Low Range
    df['intraday_high_low_range'] = df['high'] - df['low']
    
    # Open to Close Movement
    df['open_to_close_movement'] = df['close'] - df['open']
    
    # Volume-Weighted Average Price (VWAP)
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['vwap'] = (df['volume'] * df['typical_price']).cumsum() / df['volume'].cumsum()
    
    # Combine Indicators for Predictive Factor
    df['high_low_to_open_close_ratio'] = df['intraday_high_low_range'] / abs(df['open_to_close_movement'])
    df['vwap_deviation_from_close'] = df['close'] - df['vwap']
    
    # Intraday Range Percentage
    df['intraday_range_percentage'] = (df['high'] - df['low']) / df['close']
    
    # Closing Position in Intraday Range
    df['closing_position_in_intraday_range'] = (df['close'] - df['open']) / df['intraday_high_low_range']
    
    # Intraday Volume Intensity
    df['intraday_volume_intensity'] = df['volume'] / df['volume'].rolling(10).median()
    
    # Adjust for Recent Price Trend
    df['ema_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['price_trend_adjustment'] = df['close'] - df['ema_20']
    
    # Composite Alpha Factor
    df['weighted_sum'] = (
        0.3 * df['high_low_to_open_close_ratio'] +
        0.4 * df['vwap_deviation_from_close'] +
        0.1 * df['intraday_volume_intensity'] +
        0.2 * df['closing_position_in_intraday_range']
    )
    
    df['trend_adjustment'] = df['price_trend_adjustment'] / df['close'].rolling(20).std()
    df['recent_volatility'] = df['close'].pct_change().rolling(20).std()
    
    df['composite_alpha_factor'] = df['weighted_sum'] + df['trend_adjustment'] + df['recent_volatility']
    
    # Recent Price Trend Strength
    df['recent_price_trend_strength'] = df['close'].pct_change(periods=5)
    
    return df['composite_alpha_factor']
```
