```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Averages
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_100'] = df['close'].rolling(window=100).mean()

    # Calculate Exponential Moving Averages
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    df['EMA_100'] = df['close'].ewm(span=100, adjust=False).mean()

    # Calculate the difference between SMA and EMA
    df['SMA_EMA_diff_5'] = df['SMA_5'] - df['EMA_5']
    df['SMA_EMA_diff_10'] = df['SMA_10'] - df['EMA_10']
    df['SMA_EMA_diff_20'] = df['SMA_20'] - df['EMA_20']
    df['SMA_EMA_diff_50'] = df['SMA_50'] - df['EMA_50']
    df['SMA_EMA_diff_100'] = df['SMA_100'] - df['EMA_100']

    # Identify Bullish and Bearish Engulfing Patterns
    df['Engulfing_Bullish'] = (df['high'].shift(1) < df['high']) & (df['low'].shift(1) > df['low'])
    df['Engulfing_Bearish'] = (df['high'].shift(1) > df['high']) & (df['low'].shift(1) < df['low'])

    # Identify Hammer and Hanging Man Patterns
    body_size = (df['close'] - df['open']).abs()
    total_range = df['high'] - df['low']
    df['Hammer_Hanging_Man'] = body_size / total_range < 0.3

    # Calculate On-Balance Volume (OBV)
    df['OBV'] = ((df['close'] > df['close'].shift(1)) * df['volume'] - (df['close'] < df['close'].shift(1)) * df['volume']).cumsum()

    # Calculate Volume-Weighted Average Price (VWAP)
    df['VWAP'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()

    # Analyze Volume Trends
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    df['Volume_Ratio_20'] = df['volume'] / avg_volume_20

    # Calculate True Range
    df['True_Range'] = df[['high', 'low']].apply(lambda x: max(x['high'] - x['low'], 
                                                                abs(x['high'] - df['close'].shift(1)), 
                                                                abs(x['low'] - df['close'].shift(1))), axis=1)

    # Calculate Average True Range (ATR)
    df['ATR_14'] = df['True_Range'].rolling(window=14).mean()

    # Calculate the Percentage Price Oscillator (PPO)
    df['PPO_12_26'] = (df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()) / df['close'].ewm(span=26, adjust=False).mean()

    # Create a combined factor using the above calculations
    df['Factor'] = (df['SMA_EMA_diff_20'] + df['Engulfing_Bullish'] - df['Engulfing_Bearish'] + 
                    df['Hammer_Hanging_Man'] + df['OBV'] + df['VWAP'] + df['Volume_Ratio_20'] + 
                    df['ATR_14'] + df['PPO_12_26'])

    return df['Factor']
```
