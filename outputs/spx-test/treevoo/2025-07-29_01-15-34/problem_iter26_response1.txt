```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the 50-day SMA of closing prices
    sma_50 = df['close'].rolling(window=50).mean()
    
    # Create the raw alpha factor (close price - 50-day SMA)
    raw_alpha_factor = df['close'] - sma_50
    
    # Calculate the 20-day EMA of volume
    ema_volume_20 = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Create the volume-based alpha factor (volume / 20-day EMA)
    volume_factor = df['volume'] / ema_volume_20
    
    # Generate the composite alpha factor by multiplying the two sub-factors
    composite_alpha_factor = raw_alpha_factor * volume_factor
    
    # Calculate the 30-day EMA of high and low prices
    ema_high_30 = df['high'].ewm(span=30, adjust=False).mean()
    ema_low_30 = df['low'].ewm(span=30, adjust=False).mean()
    
    # Create the trend-following alpha factor (30-day EMA of high - 30-day EMA of low)
    trend_following_alpha_factor = ema_high_30 - ema_low_30
    
    # Generate the enhanced composite alpha factor by adding the two sub-factors
    enhanced_composite_alpha_factor = composite_alpha_factor + trend_following_alpha_factor
    
    return enhanced_composite_alpha_factor
```
