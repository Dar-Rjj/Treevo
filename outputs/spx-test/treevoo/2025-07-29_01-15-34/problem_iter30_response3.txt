```python
import pandas as pd

def heuristics_v2(df):
    # 5-day SMA - 20-day SMA
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_Diff'] = df['SMA_5'] - df['SMA_20']
    
    # 12-day Rate of Change (RoC) of Close Prices
    df['RoC_12'] = df['close'].pct_change(periods=12)
    
    # On-Balance Volume (OBV) and its 14-day EMA
    obv = (df['close'] > df['close'].shift(1)).astype(int) * df['volume']
    obv -= (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    df['OBV'] = obv.cumsum()
    df['OBV_EMA_14'] = df['OBV'].ewm(span=14, adjust=False).mean()
    
    # Volume-Price Trend (VPT) 20-day Difference from its 10-day moving average
    vpt = df['volume'] * ((df['close'] - df['close'].shift(1)) / df['close'].shift(1))
    df['VPT'] = vpt.cumsum()
    df['VPT_MA_10'] = df['VPT'].rolling(window=10).mean()
    df['VPT_20_Diff'] = df['VPT'] - df['VPT_MA_10'].shift(20)
    
    # 21-day Chaikin Money Flow (CMF)
    mfv = (df['close'] - df['low']) - (df['high'] - df['close']) / (df['high'] - df['low'])
    mfv *= df['volume']
    df['CMF_21'] = mfv.rolling(window=21).sum() / df['volume'].rolling(window=21).sum()
    
    # Consecutive inside bars within a 5-day window
    df['Inside_Bar'] = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))
    df['Consecutive_Inside_Bars'] = df['Inside_Bar'].rolling(window=5).sum()
    
    # Bullish and bearish engulfing patterns in the last 3 days
    df['Bullish_Engulfing'] = (df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1))
    df['Bearish_Engulfing'] = (df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1))
    df['Engulfing_Pattern'] = df['Bullish_Engulfing'].fillna(0) - df['Bearish_Engulfing'].fillna(0)
    
    # 14-day Average True Range (ATR)
    tr = pd.concat([df['high'] - df['low'], abs(df['high'] - df['close'].shift()), abs(df['low'] - df['close'].shift())], axis=1).max(axis=1)
    df['ATR_14'] = tr.rolling(window=14).mean()
    
    # 20-day Bollinger Band (BB) Width
    df['BB_Middle'] = df['close'].rolling(window=20).mean()
    df['BB_Upper'] = df['BB_Middle'] + 2 * df['close'].rolling(window=20).std()
    df['BB_Lower'] = df['BB_Middle'] - 2 * df['close'].rolling(window=20).std()
    df['BB_Width'] = (df['BB_Upper'] - df['BB_Lower']) / df['BB_Middle']
    
    # 10-day Standard Deviation of Close Prices
    df['StdDev_10'] = df['close'].rolling(window=10).std()
    
    # 20-day Klinger Oscillator
    ema_vol_34 = df['volume'].ewm(com=33, adjust=False).mean()
    ema_vol_55 = df['volume'].ewm(com=54, adjust=False).mean()
    kvo = ema_vol_34 - ema_vol_55
    df['KVO'] = kvo.ewm(com=12, adjust=False).mean()
    
   
