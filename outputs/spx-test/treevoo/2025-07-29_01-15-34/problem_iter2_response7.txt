```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Returns
    df['daily_return'] = df['close'].pct_change()
    
    # Compute Moving Average of Returns (20 days)
    df['ma_returns'] = df['daily_return'].rolling(window=20).mean()
    
    # Calculate Volatility (20 days)
    df['volatility'] = df['daily_return'].rolling(window=20).std()
    
    # Determine Momentum Strength
    df['momentum_strength'] = df['ma_returns'] / df['volatility']
    
    # Calculate Price Momentum Score
    # Short-term Price Movement
    df['short_term_price_move'] = df['daily_return'].rolling(window=5).sum()
    df['price_momentum_short'] = (df['short_term_price_move'] - df['short_term_price_move'].min()) / (df['short_term_price_move'].max() - df['short_term_price_move'].min()) * 100
    
    # Long-term Price Movement
    df['weekly_return'] = df['close'].pct_change(periods=5)
    df['price_momentum_long'] = (df['weekly_return'] - df['weekly_return'].min()) / (df['weekly_return'].max() - df['weekly_return'].min()) * 100
    
    # Combine short and long-term price momentum scores
    df['price_momentum_score'] = 0.6 * df['price_momentum_short'] + 0.4 * df['price_momentum_long']
    
    # Calculate Volume Activity Score
    # Short-term Volume Change
    df['daily_volume_change'] = df['volume'].pct_change()
    df['avg_daily_volume_change'] = df['daily_volume_change'].rolling(window=5).mean()
    df['volume_activity_short'] = (df['avg_daily_volume_change'] - df['avg_daily_volume_change'].min()) / (df['avg_daily_volume_change'].max() - df['avg_daily_volume_change'].min()) * 100
    
    # Long-term Volume Activity
    df['sum_volume_20_days'] = df['volume'].rolling(window=20).sum()
    df['volume_activity_long'] = (df['sum_volume_20_days'] - df['sum_volume_20_days'].min()) / (df['sum_volume_20_days'].max() - df['sum_volume_20_days'].min()) * 100
    
    # Combine short and long-term volume activity scores
    df['volume_activity_score'] = 0.6 * df['volume_activity_short'] + 0.4 * df['volume_activity_long']
    
    # Apply Adaptive Weighting
    df['adaptive_weighted_momentum'] = df['momentum_strength'] * df['volume_activity_score']
    df['smoothed_adaptive_weights'] = df['adaptive_weighted_momentum'].rolling(window=5).mean()
    
    # Composite Alpha Factor
    df['composite_alpha_factor'] = (0.6 * df['price_momentum_score'] + 0.4 * df['volume_activity_score']) + df['smoothed_adaptive_weights']
    
    return df['composite_alpha_factor'].dropna()
```
