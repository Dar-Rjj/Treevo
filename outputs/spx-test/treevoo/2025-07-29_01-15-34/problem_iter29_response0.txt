```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Price Movement and WMA Analysis
    high_low_range = df['high'] - df['low']
    open_close_movement = df['close'] - df['open']
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    vwap = (df['volume'] * typical_price).cumsum() / df['volume'].cumsum()
    close_50wma = df['close'].rolling(window=50, min_periods=1).apply(lambda x: np.average(x, weights=np.arange(1, len(x)+1)))
    
    raw_alpha_factor = (df['close'] - close_50wma) * (high_low_range / open_close_movement.abs()) * (df['close'] - vwap)
    raw_alpha_factor[high_low_range > 1.5 * open_close_movement] *= 1.5
    raw_alpha_factor[(open_close_movement > 0.8 * high_low_range) & (df['close'] < vwap)] *= -2
    
    # Intraday Range and Volatility Analysis
    range_percentage = high_low_range / df['close']
    closing_position = open_close_movement / high_low_range
    tr = df[['high', 'low']].diff(axis=1).iloc[:, 1].abs()
    atr = tr.rolling(window=10, min_periods=1).mean()
    volatility_factor = (df['high'] - df['low']) / atr
    
    # Volume Analysis
    volume_intensity = df['volume'] / df['volume'].rolling(window=10, min_periods=1).sum()
    ema_volume_20 = df['volume'].ewm(span=20, adjust=False).mean()
    volume_factor = (df['volume'] / ema_volume_20) * volume_intensity
    
    # Recent Price Trend Adjustment
    ema_close_20 = df['close'].ewm(span=20, adjust=False).mean()
    trend_adjustment = ema_close_20 - df['close']
    
    # Close-to-Open Momentum Shift
    momentum_shift = (df['close'] - df['open']).shift(-1) / df['open']
    
    # Intraday Range Percentage Enhanced
    intraday_range_enhanced = (df['high'] - df['low']) / df['close']
    
    # Adjust for Recent Price Trend
    recent_trend_adjustment = ema_close_20 - df['close']
    
    # Composite Alpha Factor
    price_momentum_score = 0.6 * (df['close'].pct_change().rolling(window=5, min_periods=1).sum() + df['close'].pct_change(periods=5).fillna(0))
    volume_activity_score = 0.4 * (df['volume'].pct_change().rolling(window=5, min_periods=1).mean() + df['volume'].rolling(window=20, min_periods=1).sum())
    composite_alpha = raw_alpha_factor + volume_factor + volatility_factor
    
    # Incorporate Recent Volatility
    recent_volatility = df['close'].rolling(window=20, min_periods=1).std()
    final_alpha_factor = composite_alpha + trend_adjustment / recent_volatility
    
    return final_alpha_factor
```
