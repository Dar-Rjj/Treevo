```txt
Volume-Adjusted Short-Term and Long-Term Momentum with Price Range Filter and Volume Surge Weighting
├── Calculate Short-Term Price Momentum
│   ├── Use Close prices
│   │   ├── Day t Close price
│   │   ├── Day (t-1) Close price
│   │   ├── ...
│   │   └── Day (t-5) Close price
│   └── Calculate Average
├── Adjust for Volume Fluctuations
│   ├── Calculate Average Volume of last 5 days
│   ├── Calculate Relative Volume
│   │   ├── Use Volume of current day (Vol_t)
│   │   └── Divide by Average Volume of last 5 days
│   └── Multiply Short-Term Price Momentum by Relative Volume
├── Calculate Long-Term Price Momentum
│   ├── Use Close prices
│   │   ├── Day t Close price
│   │   ├── Day (t-1) Close price
│   │   ├── ...
│   │   └── Day (t-20) Close price
│   └── Calculate Average
├── Calculate Price Momentum Oscillator
│   ├── Subtract Long-Term Price Momentum from Short-Term Price Momentum
│   └── Output the difference
├── Weight by Volume Surge
│   ├── Calculate 10-Day Volume Average
│   │   ├── Use Volume
│   │   │   ├── Day t Volume
│   │   │   ├── Day (t-1) Volume
│   │   │   ├── ...
│   │   │   └── Day (t-9) Volume
│   │   └── Calculate Average
│   └── Compare with Previous 10-Day Volume Average
│       ├── If current volume is more than 1.5 times the previous 10-day average, assign a weight of 1.5
│       ├── If current volume is less than 1.5 but more than the previous 10-day average, assign a weight of 1.2
│       └── If current volume is less than or equal to the previous 10-day average, assign a weight of 1
├── Combine Indicators
│   ├── Multiply Price Momentum Oscillator by Volume Weight
│   └── Multiply by Adjusted Short-Term Price Momentum
└── Apply Price Range Filter
    ├── Calculate Daily Price Range
    │   ├── Use High price on day t (High_t)
    │   └── Subtract Low price on day t (Low_t)
    └── Compare with Historical Price Range
        ├── Calculate Average Daily Price Range over past 20 days (AvgRange_20)
        │   ├── Sum of Daily Price Ranges over past 20 days
        │   └── Divide by 20
        └── Exclude Stocks with Excessive Volatility
            └── If (Price Range on day t > 1.5 * AvgRange_20), set factor value to 0; otherwise, use the Combined Indicator Value
```
