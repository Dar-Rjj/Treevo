```python
import pandas as pd

def heuristics_v2(df, n=5):
    # Calculate Intraday Returns
    intraday_returns = (df['high'] - df['low']) / df['open']
    
    # Calculate Open-to-Close Returns
    open_to_close_returns = (df['close'] - df['open']) / df['open']
    
    # Combine Intraday and Open-to-Close Returns
    combined_returns = intraday_returns + open_to_close_returns
    
    # Analyze Volume Change
    volume_ratio = df['volume'] / df['volume'].shift(1)
    
    # Classify Volume Trend
    volume_trend = pd.Series(index=df.index)
    volume_trend[volume_ratio > 1.5] = 2
    volume_trend[(volume_ratio >= 0.5) & (volume_ratio <= 1.5)] = 0
    volume_trend[volume_ratio < 0.5] = -2
    
    # Adjust Combined Returns Based on Volume Classification
    adjusted_returns = combined_returns * volume_trend
    
    # Apply Weighted Moving Average
    weights = list(range(n, 0, -1))
    weighted_factors = adjusted_returns.rolling(window=n).apply(
        lambda x: (x * weights[:len(x)]).sum() / sum(weights[:len(x)]), raw=False)
    
    return weighted_factors
```
