```python
import pandas as pd
import numpy as np

def heuristics_v2(df, n=10, m=5, p=30, k=10, q=14, r=10):
    # Calculate daily return
    df['daily_return'] = df['close'].diff()
    
    # Develop factors based on trading volume
    weights = np.arange(1, n+1) / sum(np.arange(1, n+1))  # Weights for n-day moving average
    df['n_day_weighted_avg_volume'] = df['volume'].rolling(window=n).apply(lambda x: np.sum(x * weights), raw=True)
    df['volume_ratio'] = df['volume'] / df['n_day_weighted_avg_volume']
    df['volume_pct_change'] = df['volume'].pct_change()
    
    # Analyze intraday price movements
    df['intraday_volatility'] = df['high'] - df['low']
    df['pct_change_open_close'] = (df['close'] - df['open']) / df['open']
    df['intraday_range_rel_close'] = (df['high'] - df['low']) / df['close']
    
    # Investigate price patterns
    df['consecutive_positive_closes'] = (df['close'] > df['open']).astype(int).groupby((df['close'] < df['open']).cumsum()).cumsum()
    df['positive_returns_last_m_days'] = df['daily_return'].rolling(window=m).apply(lambda x: (x > 0).sum(), raw=True)
    df['cumulative_sum_positive_returns'] = df['daily_return'].where(df['daily_return'] > 0, 0).rolling(window=m).sum()
    df['cumulative_sum_negative_returns'] = df['daily_return'].where(df['daily_return'] < 0, 0).rolling(window=m).sum()
    
    # Explore relationship between volume and price
    df['corr_return_volume'] = df[['daily_return', 'volume']].rolling(window=m).corr().unstack().iloc[::2]['daily_return']
    df['cumulative_volume_up'] = df['volume'].where(df['daily_return'] > 0, 0).rolling(window=n).sum()
    df['cumulative_volume_down'] = df['volume'].where(df['daily_return'] < 0, 0).rolling(window=n).sum()
    df['volume_ratio_up_down'] = df['cumulative_volume_up'] / df['cumulative_volume_down']
    
    # Analyze momentum
    df['moving_avg_daily_returns'] = df['daily_return'].rolling(window=p).mean()
    df['trend_strength'] = df['close'] / df['close'].rolling(window=p).mean()
    df['rate_of_change_moving_avg'] = df['moving_avg_daily_returns'].diff(k) / k
    
    # Evaluate market sentiment
    df['rsi'] = 100 - (100 / (1 + (df['daily_return'].where(df['daily_return'] > 0, 0).rolling(window=q).mean() / \
                                     -df['daily_return'].where(df['daily_return'] < 0, 0).rolling(window=q).mean())))
    df['days_since_significant_move'] = (np.abs(df['daily_return']) >= 0.05).astype(int).replace(0, np.nan).fillna(method='bfill').cumcount()
    df['percentage_higher_highs_lows'] = ((df['high'] > df['high'].shift()) & (df['low'] < df['low'].shift())).rolling(window=r).mean()
    
    # Generate the alpha factor
    alpha_factor = (df['volume_ratio'] + 
                    df['pct_change_open_close'] +
                    df['trend_strength'] +
                    df['rsi'] +
                    df['rate_of_change_moving_avg'] +
                    df['volume_ratio_up_down'] +
                    df['positive_returns_last_m_days'] +
                    df['percentage_higher_highs_lows'])
    
    return alpha_factor
```
