```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily close-open difference
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate 10-day EMA of the close-open difference
    df['close_open_ema'] = df['close_open_diff'].ewm(span=10, adjust=False).mean()
    
    # Calculate the ratio of the current day's close-open difference to its EMA
    df['ratio_to_ema'] = df['close_open_diff'] / df['close_open_ema']
    
    # Calculate the high-low spread
    df['high_low_spread'] = df['high'] - df['low']
    
    # Adjust the ratio with the high-low spread
    df['adjusted_ratio'] = df['ratio_to_ema'] / df['high_low_spread']
    
    # Consider the volume in relation to the adjusted ratio
    df['vol_adj_ratio_product'] = df['volume'] * df['adjusted_ratio']
    
    # Sum the product over the past 5 days
    df['sum_vol_adj_ratio'] = df['vol_adj_ratio_product'].rolling(window=5).sum()
    
    # Calculate the 20-day and 50-day SMAs of the closing prices
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['sma_50'] = df['close'].rolling(window=50).mean()
    
    # Calculate the difference between the 20-day and 50-day SMAs
    df['sma_diff'] = df['sma_20'] - df['sma_50']
    
    # Integrate the SMA difference as a multiplier
    df['trend_strength_score'] = df['sum_vol_adj_ratio'] * df['sma_diff']
    
    # Apply conditional element based on the 20-day SMA vs 50-day SMA
    df['final_factor'] = df.apply(lambda row: row['trend_strength_score'] * 1.5 if row['sma_20'] > row['sma_50'] else row['trend_strength_score'] * -1.5, axis=1)
    
    return df['final_factor']

# Example usage:
# factor_values = heuristics_v2(market_data)
```
