```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the relative position of the close price within the day's range
    df['day_range'] = df['high'] - df['low']
    df['close_position'] = (df['close'] - df['low']) / df['day_range']
    
    # Calculate the money flow index, which considers both price and volume
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df['money_flow'].where(df['close'] > df.shift(1)['close'], 0)
    df['negative_money_flow'] = df['money_flow'].where(df['close'] < df.shift(1)['close'], 0)
    positive_money_flow_sum = df['positive_money_flow'].rolling(window=14).sum()
    negative_money_flow_sum = df['negative_money_flow'].rolling(window=14).sum()
    df['money_ratio'] = positive_money_flow_sum / negative_money_flow_sum
    df['money_flow_index'] = 100 - (100 / (1 + df['money_ratio']))
    
    # Combine the two components into a single factor
    df['factor'] = df['close_position'] * df['money_flow_index']
    
    return df['factor']
```
