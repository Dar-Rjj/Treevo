```python
import pandas as pd

def heuristics_v2(df):
    # Calculate short-term and medium-term percentage change in closing price
    df['close_pct_change_5d'] = df['close'].pct_change(5)
    df['close_pct_change_20d'] = df['close'].pct_change(20)
    
    # Calculate the range (high - low) and its ratio to the previous close
    df['range'] = df['high'] - df['low']
    df['range_to_prev_close_ratio'] = df['range'] / df['close'].shift(1)
    
    # Calculate the gap (open - close of the previous day) and its absolute value
    df['gap'] = df['open'] - df['close'].shift(1)
    df['abs_gap'] = df['gap'].abs()
    
    # Calculate the percentage change in volume over a short term
    df['volume_pct_change_5d'] = df['volume'].pct_change(5)
    
    # Calculate the average volume over a longer period and compare it to the current day's volume
    df['avg_volume_20d'] = df['volume'].rolling(window=20).mean()
    df['volume_to_avg_vol_ratio'] = df['volume'] / df['avg_volume_20d']
    
    # Create composite factors
    df['composite_factor_1'] = df['close_pct_change_5d'] * df['volume_pct_change_5d']
    df['composite_factor_2'] = (df['range_to_prev_close_ratio'] + df['abs_gap'] + df['volume_to_avg_vol_ratio']) / 3
    
    # Return the composite factor 2 as the final alpha factor
    return df['composite_factor_2']
```
