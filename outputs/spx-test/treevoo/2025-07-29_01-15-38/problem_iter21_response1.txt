```python
import pandas as pd

def heuristics_v2(df):
    # Moving Averages
    short_sma = df['close'].rolling(window=5).mean()
    long_sma = df['close'].rolling(window=20).mean()
    short_ema = df['close'].ewm(span=5, adjust=False).mean()
    long_ema = df['close'].ewm(span=20, adjust=False).mean()
    
    # Momentum Indicators
    roc = (df['close'] - df['close'].shift(12)) / df['close'].shift(12) * 100
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    # Volume Analysis
    obv = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0).cumsum() * df['volume']
    volume_trend = df['volume'] - df['volume'].shift(1)
    
    # Volatility Analysis
    tr = df.apply(lambda x: max(x['high'] - x['low'], abs(x['high'] - x['close'].shift(1)), abs(x['low'] - x['close'].shift(1))), axis=1)
    atr = tr.rolling(window=14).mean()
    
    # Price Pattern Analysis
    inside_bar = (df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1))
    outside_bar = (df['high'] > df['high'].shift(1)) & (df['low'] < df['low'].shift(1))
    
    # Order Flow Analysis
    ad = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']
    mfi = (df['close'] - df['low'].rolling(window=14).min()) / (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min()) * df['volume']
    cmf = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume'] / df['volume'].rolling(window=20).sum()
    vwap = (df['volume'] * (df['high'] + df['low'] + df['close']) / 3).cumsum() / df['volume'].cumsum()
    
    # Sentiment Analysis
    bullish_candlestick = (df['close'] > df['open'])
    bearish_candlestick = (df['close'] < df['open'])
    engulfing_pattern = ((df['high'] > df['high'].shift(1)) & (df['low'] < df['low'].shift(1)) & (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1)))
    harami_pattern = ((df['high'] < df['high'].shift(1)) & (df['low'] > df['low'].shift(1)) & (abs(df['close'] - df['open']) < abs(df['close'].shift(1) - df['open'].shift(1))))
    
    # Market Strength Analysis
    k = 100 * (df['close'] - df['low'].rolling(window=14).min()) / (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min())
    d = k.rolling(window=3).mean()
    williams_r = -100 * (df['high'].rolling(window=14).max() - df['close']) / (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min())
    
    # New Analysis
    price_velocity = df['close'].pct_change(periods=3)
    volume_price_corr = df['volume'].rolling(window=10).corr(df['close'])
    
    # Intraday Sentiment
    intraday_range = df['high'] - df['low']
    gap_analysis = (df['open'] - df['close'].shift(1)).abs()
    
    # Composite Factors
    enhanced_composite_score = (short_s
