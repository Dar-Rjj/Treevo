```python
import pandas as pd

def heuristics_v2(df, m, p, n):
    # Calculate Intraday High-Low Spread and Range
    intraday_range = df['high'] - df['low']
    
    # Calculate Open-to-Close Momentum
    open_to_close_momentum = df['close'] - df['open']
    
    # Determine Volume Trend
    volume_sum_last_m_days = df['volume'].rolling(window=m).sum()
    volume_sum_previous_m_days = df['volume'].shift(m).rolling(window=m).sum()
    volume_trend = (volume_sum_last_m_days > volume_sum_previous_m_days).astype(int) * 2 - 1
    
    # Calculate Price Momentum
    close_prices_sum_last_p_days = df['close'].rolling(window=p).sum()
    average_close_price_last_p_days = close_prices_sum_last_p_days / p
    price_momentum = df['close'] - average_close_price_last_p_days
    
    # Combine Indicators
    combined_indicator = (intraday_range * open_to_close_momentum + open_to_close_momentum) * volume_trend + price_momentum
    
    # Final Adjustment with Weighted Average
    weights = 1 / (n + 1 - pd.Series(range(1, n + 1), index=df.index[-n:]))
    weighted_average = (df['close'][-n:] * weights).sum()
    alpha_factor = combined_indicator - weighted_average
    
    return alpha_factor
```
