```python
import pandas as pd

def heuristics_v2(df, n=14):
    # Intraday Return
    intraday_return = df['close'] / df['open'] - 1
    
    # Intraday Volatility
    high_low_diff = df['high'] - df['low']
    mean_high_low_diff = high_low_diff.rolling(window=n).mean()
    std_high_low_diff = high_low_diff.rolling(window=n).std()
    intraday_volatility = (high_low_diff - mean_high_low_diff) / std_high_low_diff
    
    # Adjust Intraday Return by Intraday Volatility
    adjusted_intraday_return = intraday_return / intraday_volatility
    
    # Weighted by Volume
    volume_weighted_return = adjusted_intraday_return * df['volume']
    
    # Calculate Daily Price Range
    daily_price_range = df['high'] - df['low']
    
    # Calculate N-Day Moving Average of Price Range
    moving_avg_price_range = daily_price_range.rolling(window=n).mean()
    
    # Calculate N-Day Relative Strength Index (RSI)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=n).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=n).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    # Detect Volume and Amount Shock
    volume_change = df['volume'].pct_change()
    amount_change = df['amount'].pct_change()
    volume_shock = (volume_change > 0.5).astype(int)
    amount_shock = (amount_change > 0.5).astype(int)
    
    # Calculate N-Day Moving Average of Volume
    moving_avg_volume = df['volume'].rolling(window=n).mean()
    
    # Calculate Volume Trend
    volume_trend = (df['volume'] > moving_avg_volume).astype(int) - (df['volume'] < moving_avg_volume).astype(int)
    
    # Adjust Momentum Factors with Volume and Amount Shock
    volume_adjusted_moving_avg_price_range = moving_avg_price_range * volume_shock
    volume_adjusted_rsi = rsi * volume_shock
    volume_adjusted_intraday_return = intraday_return * volume_shock
    amount_adjusted_intraday_return = intraday_return * amount_shock
    
    # Combine All Adjusted Momentum Factors
    combined_factors = (
        volume_adjusted_moving_avg_price_range +
        volume_adjusted_rsi +
        volume_adjusted_intraday_return +
        amount_adjusted_intraday_return
    ) * volume_trend
    
    return combined_factors
```
