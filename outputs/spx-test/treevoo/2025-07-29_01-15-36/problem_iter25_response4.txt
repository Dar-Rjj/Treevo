```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Adjusted Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    df['high_low_diff'] = df['high'] - df['low']
    recent_high_low_mean = df['high_low_diff'].rolling(window=20).mean()
    recent_high_low_std = df['high_low_diff'].rolling(window=20).std()
    df['adjusted_intraday_return'] = df['intraday_return'] / (recent_high_low_std + 1e-8)

    # Determine Adjusted Range-to-Range Ratio
    df['range_to_range_ratio'] = df['high_low_diff'] / df['high_low_diff'].shift(1)
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    df['adjusted_range_to_range_ratio'] = df['range_to_range_ratio'] * df['volume_ratio']

    # Detect Sudden Increase in Volume
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    threshold = 2 * df['volume'].mean()
    df['sudden_volume_increase'] = (df['volume_change'] > threshold).astype(int)

    # Calculate N-Day Relative Strength Index (RSI)
    n = 14
    df['price_change'] = df['close'].diff()
    df['upward_change'] = df['price_change'].apply(lambda x: x if x > 0 else 0)
    df['downward_change'] = df['price_change'].apply(lambda x: -x if x < 0 else 0)
    avg_upward = df['upward_change'].rolling(window=n).mean()
    avg_downward = df['downward_change'].rolling(window=n).mean()
    rs = avg_upward / (avg_downward + 1e-8)
    df['rsi'] = 100 - (100 / (1 + rs))

    # Calculate Exponential Moving Average (EMA) of Close prices
    ema = df['close'].ewm(span=20, adjust=False).mean()
    df['momentum_factor'] = df['close'] - ema

    # Calculate On-Balance Volume (OBV)
    df['obv'] = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    df['obv'] = df['obv'].cumsum()

    # Combined Weighted Momentum
    combined_volatility = (df['volume'].rolling(window=20).mean() + df['high_low_diff'].rolling(window=20).mean()) / 2
    df['combined_weighted_momentum'] = (df['rsi'] * df['volume'] + 
                                        df['adjusted_intraday_return'] * df['volume_ratio'] + 
                                        df['momentum_factor'] * combined_volatility + 
                                        df['obv'] * df['adjusted_range_to_range_ratio'])

    # Final Factor Calculation
    df['final_factor'] = df['combined_weighted_momentum'] * df['adjusted_intraday_return']

    return df['final_factor']
```
