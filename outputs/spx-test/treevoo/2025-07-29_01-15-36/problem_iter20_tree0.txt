```txt
Crossover of Weighted Momentum, Volume-Weighted Intraday, Breakout Momentum, and Volume and Price Shock-Adjusted Momentum with Intraday Range, Volume Trend, and Trade Imbalance
├── Calculate Simple Moving Average (SMA) of Close Prices
│   ├── Use Last 20 Day's Close Prices
└── Calculate Momentum Factor
    ├── Subtract Latest Close Price from SMA
    └── Weight by Combined Volume & Price Volatility
        ├── Calculate Average Volume Over 20 Days
        │   ├── Use Volume Data
        ├── Calculate Average High-Low Range Over 20 Days
        │   ├── Use High and Low Prices
        └── Combine Volume and Price Volatility
            ├── Multiply Average Volume by Average High-Low Range
├── Calculate Daily Price Range
│   ├── Subtract Low price from High price
├── Calculate N-Day Moving Average of Price Range
│   ├── Sum Daily Price Ranges over 20 days
│   └── Divide by 20
├── Calculate N-Day Relative Strength Index (RSI)
│   ├── Determine Upward and Downward Price Changes
│   │   ├── If today's close > yesterday's close, upward change = today's close - yesterday's close
│   │   └── If today's close < yesterday's close, downward change = yesterday's close - today's close
│   ├── Calculate Average Upward and Downward Changes
│   │   ├── Sum Upward Price Changes over 14 days
│   │   ├── Sum Downward Price Changes over 14 days
│   │   ├── Average Upward Change: Sum Upward / 14
│   │   └── Average Downward Change: Sum Downward / 14
│   ├── Compute RS (Relative Strength)
│   │   ├── Divide Average Upward Change by Absolute(Average Downward Change)
│   └── Calculate RSI
│       ├── Formula: 100 - (100 / (1 + RS))
├── Calculate Intraday High-Low Spread
│   ├── Use High price
│   └── Use Low price
│       └── Subtract Low from High
├── Calculate Open-to-Close Momentum
│   ├── Use Open price
│   └── Use Close price
│       └── Subtract Open from Close
├── Combine Intraday Indicators
│   ├── Multiply High-Low Spread by Open-to-Close Momentum
│   └── Add Open-to-Close Momentum
├── Detect Volume and Amount Shock
│   ├── Calculate Volume Change
│   │   ├── Use Current Volume
│   │   └── Use Previous Volume
│   └── Calculate Amount Change
│       ├── Use Current Amount
│       └── Use Previous Amount
│   └── Identify Sudden Increase in Volume and Amount
│       ├── Set a Threshold for Volume Increase
│       ├── Set a Threshold for Amount Increase
│       ├── Compare Current Volume to Previous Volume
│       └── Compare Current Amount to Previous Amount
├── Calculate N-Day Exponential Moving Average of Volume
│   ├── Apply Exponential Smoothing to Volume over 20 days
├── Calculate Volume Trend
│   ├── If today's volume > N-Day Exponential Moving Average of Volume
│   └── Assign a positive value (e.g., 1)
│   ├── If today's volume < N-Day Exponential Moving Average of Volume
│   └── Assign a negative value (e.g., -1)
├── Adjust Momentum Factors with Volume and Amount Shock
│   ├── Multiply N-Day Moving Average of Price Range by Volume Shock Indicator
│   ├── Multiply N-Day RSI by Volume Shock Indicator
│   ├── Multiply Intraday Range by Volume Shock Indicator
│   ├── Multiply Intraday Range by Amount Shock Indicator
├── Calculate N-Day Trade Imbalance
│   ├── Calculate N-Day Buy Volume
│   │   ├── Sum up the volume of trades where the trade price is greater than or equal to the midpoint between the high and low
│   └── Calculate N-Day Sell Volume
│       ├── Sum up the volume of trades where the trade price is less than the midpoint between the high and low
│   ├── Calculate Trade Imbalance
│       ├── Subtract N-Day Sell Volume from N-Day Buy Volume
├── Volume-Adjusted Momentum
│   ├── Multiply 20-Day Moving Average of Price Range by Volume
│   ├── Multiply N-Day RSI by Volume
│   └── Add both results
├── Calculate Close-to-Range Ratio
│   ├── Use Close price
│   ├── Use Intraday High-Low Spread
│   └── Divide Close by Intraday High-Low Spread
├── Calculate Volume-Weighted Close-to-Range
