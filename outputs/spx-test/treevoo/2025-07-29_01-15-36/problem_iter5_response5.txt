```python
import pandas as pd

def heuristics(df, n=14, p=5):
    # Calculate Daily Price Range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate N-Day Moving Average of Price Range
    df['avg_price_range'] = df['price_range'].rolling(window=n).mean()
    
    # Calculate N-Day Relative Strength Index (RSI)
    df['price_change'] = df['close'].diff()
    df['upward_change'] = df['price_change'].apply(lambda x: x if x > 0 else 0)
    df['downward_change'] = df['price_change'].apply(lambda x: -x if x < 0 else 0)
    df['avg_upward_change'] = df['upward_change'].rolling(window=n).mean()
    df['avg_downward_change'] = df['downward_change'].rolling(window=n).mean()
    df['rs'] = df['avg_upward_change'] / df['avg_downward_change'].abs()
    df['rsi'] = 100 - (100 / (1 + df['rs']))
    
    # Calculate Volume Adjusted Momentum
    df['vol_adj_avg_price_range'] = df['avg_price_range'] * df['volume']
    df['vol_adj_rsi'] = df['rsi'] * df['volume']
    df['vol_adj_momentum'] = df['vol_adj_avg_price_range'] + df['vol_adj_rsi']
    
    # Calculate Intraday Momentum
    df['intraday_range'] = df['high'] - df['low']
    
    # Detect Volume and Amount Shock
    df['volume_change'] = df['volume'].pct_change().abs()
    df['amount_change'] = df['amount'].pct_change().abs()
    volume_shock_threshold = 2.0
    amount_shock_threshold = 2.0
    df['volume_shock'] = df['volume_change'] > volume_shock_threshold
    df['amount_shock'] = df['amount_change'] > amount_shock_threshold
    df['volume_shock_indicator'] = df['volume_shock'].astype(int)
    df['amount_shock_indicator'] = df['amount_shock'].astype(int)
    
    # Combine Intraday Momentum and Volume/Amount Shock
    df['intraday_vol_shock'] = df['intraday_range'] * df['volume_shock_indicator']
    df['intraday_amount_shock'] = df['intraday_range'] * df['amount_shock_indicator']
    df['combined_intraday_momentum'] = df['intraday_vol_shock'] + df['intraday_amount_shock']
    
    # Final Factor Combination
    df['high_low_range'] = df['high'] - df['low']
    df['avg_true_range'] = df['high_low_range'].rolling(window=n).mean()
    df['volume_trend'] = df['volume'].pct_change().apply(lambda x: 1 if x > 0 else -1)
    df['price_momentum'] = df['close'] - df['close'].rolling(window=p).mean()
    
    df['final_factor'] = (
        df['high_low_range'] * df['avg_true_range'] * df['volume_trend'] +
        df['vol_adj_momentum'] +
        df['combined_intraday_momentum'] +
        df['price_momentum']
    )
    
    return df['final_factor']
```
