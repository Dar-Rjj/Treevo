```txt
Volume and Price Shock-Adjusted Momentum with Intraday Range, Volatility, and Volume-Weighted Adjustments
├── Calculate Daily Price Range
│   ├── Use High price
│   └── Subtract Low price
├── Calculate N-Day Moving Average of Price Range
│   ├── Aggregate Daily Price Range over N days
│   └── Divide by N
├── Calculate N-Day Relative Strength Index (RSI)
│   ├── Determine Upward Price Change
│   │   ├── If today's close > yesterday's close
│   │   └── Then use today's close - yesterday's close
│   └── Determine Downward Price Change
│       ├── If today's close < yesterday's close
│       └── Then use yesterday's close - today's close
│   ├── Calculate Average Upward Change
│   │   ├── Sum Upward Price Changes over N days
│   │   └── Divide by N
│   └── Calculate Average Downward Change
│       ├── Sum Downward Price Changes over N days
│       └── Divide by N
│   ├── Compute RS (Relative Strength)
│   │   ├── Divide Average Upward Change by Absolute(Average Downward Change)
│   └── Calculate RSI
│       ├── Formula: 100 - (100 / (1 + RS))
├── Calculate Intraday Return
│   ├── Use Close price
│   └── Use Open price
├── Calculate Intraday Volatility
│   ├── Calculate High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   └── Use Recent Intraday High-Low Differences
│       ├── Calculate Mean of High-Low Differences
│       └── Calculate Standard Deviation of High-Low Differences
├── Adjust Intraday Return by Intraday Volatility
│   ├── Use Intraday Return
│   └── Use Intraday Volatility
├── Calculate Intraday Momentum
│   ├── Use High price
│   ├── Use Low price
│   └── Compute Intraday Range as (High - Low)
├── Detect Volume and Amount Shock
│   ├── Calculate Volume Change
│   │   ├── Use Current Volume
│   │   └── Use Previous Volume
│   └── Calculate Amount Change
│       ├── Use Current Amount
│       └── Use Previous Amount
│   └── Identify Sudden Increase in Volume and Amount
│       ├── Set a Threshold for Volume Increase
│       ├── Set a Threshold for Amount Increase
│       ├── Compare Current Volume to Previous Volume
│       └── Compare Current Amount to Previous Amount
├── Calculate N-Day Moving Average of Volume
│   ├── Aggregate Volume over N days
│   └── Divide by N
├── Calculate Volume Trend
│   ├── If today's volume > N-Day Moving Average of Volume
│   └── Assign a positive value (e.g., 1)
│   ├── If today's volume < N-Day Moving Average of Volume
│   └── Assign a negative value (e.g., -1)
├── Weight by Volume
│   ├── Use Volume
│   └── Multiply by Adjusted Intraday Return
├── Calculate Momentum
│   ├── Calculate 5-Day Moving Average of Intraday Returns
│   ├── Calculate 20-Day Moving Average of Intraday Returns
│   └── Subtract 20-Day Moving Average from 5-Day Moving Average
│       ├── Use 5-Day Moving Average
│       └── Use 20-Day Moving Average
├── Adjust Momentum Factors with Volume and Amount Shock
│   ├── Multiply N-Day Moving Average of Price Range by Volume Shock Indicator
│   ├── Multiply N-Day RSI by Volume Shock Indicator
│   ├── Multiply Intraday Range by Volume Shock Indicator
│   ├── Multiply Intraday Range by Amount Shock Indicator
└── Combine All Adjusted Momentum Factors
    ├── Add Volume-Adjusted N-Day Moving Average of Price Range
    ├── Add Volume-Adjusted N-Day RSI
    ├── Add Volume-Adjusted Intraday Range
    ├── Add Amount-Adjusted Intraday Range
    ├── Incorporate Volume-Weighted Momentum
        ├── Use Weighted Intraday Return
    └── Incorporate Volume Trend
        ├── Multiply combined results by Volume Trend
```
