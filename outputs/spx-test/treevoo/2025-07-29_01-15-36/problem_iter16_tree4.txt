```txt
Volume and Price Shock-Adjusted Momentum with Intraday Range, Volume Trend, and Trade Imbalance
├── Calculate Daily Price Range
│   ├── High - Low
├── N-Day Moving Average of Price Range
│   ├── Sum(Daily Price Range over N days) / N
├── N-Day Relative Strength Index (RSI)
│   ├── Upward Price Change: If(Close(t) > Close(t-1), Close(t) - Close(t-1), 0)
│   └── Downward Price Change: If(Close(t) < Close(t-1), Close(t-1) - Close(t), 0)
│   ├── Smoothed Avg Upward Change: Sum(Upward Price Changes over N days) / N
│   ├── Smoothed Avg Downward Change: Sum(Downward Price Changes over N days) / N
│   ├── RS: Smoothed Avg Upward Change / Abs(Smoothed Avg Downward Change)
│   └── RSI: 100 - (100 / (1 + RS))
├── Intraday Momentum
│   ├── Intraday Range: High - Low
├── Detect Volume and Amount Shock
│   ├── Volume Change: Volume(t) - Volume(t-1)
│   ├── Amount Change: Amount(t) - Amount(t-1)
│   └── Identify Sudden Increase: If(Volume Change > Threshold AND Amount Change > Threshold, 1, 0)
├── N-Day Exponential Moving Average of Volume
│   ├── Apply Exponential Smoothing to Volume over N days
├── Volume Trend
│   ├── If(Volume(t) > N-Day EMA of Volume, 1, -1)
├── Adjust Momentum Factors with Volume and Amount Shock
│   ├── N-Day MA of Price Range * Volume Shock Indicator
│   ├── N-Day RSI * Volume Shock Indicator
│   ├── Intraday Range * Volume Shock Indicator
│   ├── Intraday Range * Amount Shock Indicator
├── N-Day Trade Imbalance
│   ├── N-Day Buy Volume: Sum(volume where trade price >= (High + Low) / 2)
│   ├── N-Day Sell Volume: Sum(volume where trade price < (High + Low) / 2)
│   └── Trade Imbalance: N-Day Buy Volume - N-Day Sell Volume
├── Combine All Adjusted Momentum Factors
    ├── Add(N-Day MA of Price Range * Volume Shock, N-Day RSI * Volume Shock, Intraday Range * Volume Shock, Intraday Range * Amount Shock)
    ├── Multiply combined results by Volume Trend
    └── Multiply combined results by Trade Imbalance
```
