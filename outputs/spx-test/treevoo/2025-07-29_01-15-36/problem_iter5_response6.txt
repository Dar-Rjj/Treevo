```python
import pandas as pd

def heuristics_v2(df, n=14):
    # Calculate Daily Price Range
    df['price_range'] = df['high'] - df['low']
    
    # Calculate N-Day Moving Average of Price Range
    df['ma_price_range'] = df['price_range'].rolling(window=n).mean()
    
    # Calculate N-Day Relative Strength Index (RSI)
    df['delta'] = df['close'].diff(1)
    df['gain'] = df['delta'].apply(lambda x: max(x, 0))
    df['loss'] = df['delta'].apply(lambda x: max(-x, 0))
    
    avg_gain = df['gain'].rolling(window=n).mean()
    avg_loss = df['loss'].rolling(window=n).mean()
    
    rs = avg_gain / avg_loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Calculate Intraday Momentum
    df['intraday_momentum'] = df['high'] - df['low']
    
    # Detect Volume and Amount Shock
    df['volume_change'] = df['volume'].pct_change()
    df['amount_change'] = df['amount'].pct_change()
    
    volume_shock_threshold = 1.5  # Threshold for volume shock
    amount_shock_threshold = 1.5  # Threshold for amount shock
    
    df['volume_shock'] = (df['volume_change'] > volume_shock_threshold).astype(int)
    df['amount_shock'] = (df['amount_change'] > amount_shock_threshold).astype(int)
    
    # Calculate N-Day Moving Average of Volume
    df['ma_volume'] = df['volume'].rolling(window=n).mean()
    
    # Calculate Volume Trend
    df['volume_trend'] = (df['volume'] > df['ma_volume']).astype(int) * 2 - 1
    
    # Adjust Momentum Factors with Volume and Amount Shock
    df['volume_adjusted_ma_price_range'] = df['ma_price_range'] * df['volume_shock']
    df['volume_adjusted_rsi'] = df['rsi'] * df['volume_shock']
    df['volume_adjusted_intraday_momentum'] = df['intraday_momentum'] * df['volume_shock']
    df['amount_adjusted_intraday_momentum'] = df['intraday_momentum'] * df['amount_shock']
    
    # Combine All Adjusted Momentum Factors
    df['combined_factor'] = (
        df['volume_adjusted_ma_price_range'] +
        df['volume_adjusted_rsi'] +
        df['volume_adjusted_intraday_momentum'] +
        df['amount_adjusted_intraday_momentum']
    )
    
    # Incorporate Volume Trend
    df['final_factor'] = df['combined_factor'] * df['volume_trend']
    
    return df['final_factor']

# Example usage:
# df = pd.DataFrame({
#     'open': [...],
#     'high': [...],
#     'low': [...],
#     'close': [...],
#     'volume': [...],
#     'amount': [...]
# }, index=pd.date_range(start='2023-01-01', periods=len(...), freq='D'))
# factor = heuristics_v2(df)
```
