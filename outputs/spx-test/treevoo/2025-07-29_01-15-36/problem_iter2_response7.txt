```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 20-day Simple Moving Average (SMA) of Close prices
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate Momentum Factor: Latest Close Price - SMA
    df['momentum'] = df['close'] - df['SMA_20']
    
    # Calculate Intraday Volatility (High - Low)
    df['intraday_volatility'] = df['high'] - df['low']
    
    # Detect Volume Shock
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    volume_shock_threshold = df['volume'].quantile(0.95)  # Set a threshold for volume increase
    df['volume_shock'] = (df['volume_change'] > volume_shock_threshold).astype(int)
    
    # Combine Intraday Volatility and Volume Shock
    df['combined_factor'] = df['intraday_volatility'] * df['volume_shock']
    
    # Weight the Momentum Factor by the Combined Factor
    df['weighted_momentum'] = df['momentum'] * df['combined_factor']
    
    return df['weighted_momentum']
```
