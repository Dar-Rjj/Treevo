```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Average (SMA) of Close prices
    sma_20 = df['close'].rolling(window=20).mean()
    
    # Calculate Momentum Factor
    momentum_factor = df['close'] - sma_20
    
    # Weight by Combined Volume & Price Volatility
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    avg_high_low_range_20 = (df['high'] - df['low']).rolling(window=20).mean()
    volume_weight = avg_volume_20 * avg_high_low_range_20
    momentum_factor = momentum_factor * volume_weight
    
    # Calculate Intraday High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Calculate Open-to-Close Momentum
    open_close_momentum = df['close'] - df['open']
    
    # Combine Intraday Indicators
    intraday_indicator = (high_low_spread * open_close_momentum) + open_close_momentum
    
    # Calculate N-Day Moving Average of Price Range
    n_day_price_range_ma = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Calculate N-Day RSI
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss.abs()
    rsi = 100 - (100 / (1 + rs))
    
    # Detect Volume and Amount Shock
    volume_change = df['volume'].pct_change()
    amount_change = (df['close'] * df['volume']).pct_change()
    
    volume_shock = (volume_change > 0.2).astype(int)
    amount_shock = (amount_change > 0.2).astype(int)
    
    # Calculate N-Day Exponential Moving Average of Volume
    ema_volume_20 = df['volume'].ewm(span=20, adjust=False).mean()
    
    # Calculate Volume Trend
    volume_trend = (df['volume'] > ema_volume_20).astype(int) - (df['volume'] < ema_volume_20).astype(int)
    
    # Adjust Momentum Factors with Volume and Amount Shock
    adjusted_n_day_price_range = n_day_price_range_ma * volume_shock
    adjusted_rsi = rsi * volume_shock
    adjusted_intraday_spread = intraday_indicator * volume_shock
    adjusted_intraday_spread_amount = intraday_indicator * amount_shock
    
    # Calculate N-Day Trade Imbalance
    midpoint = (df['high'] + df['low']) / 2
    buy_volume = (df['close'] >= midpoint) * df['volume']
    sell_volume = (df['close'] < midpoint) * df['volume']
    trade_imbalance = buy_volume - sell_volume
    
    # Combine All Adjusted Momentum Factors
    combined_factors = (
        adjusted_n_day_price_range +
        adjusted_rsi +
        adjusted_intraday_spread +
        adjusted_intraday_spread_amount
    ) * volume_trend * trade_imbalance
    
    # Integrate RSI and SMA Momentum
    volume_adjusted_momentum = (n_day_price_range_ma * df['volume']) + (rsi * df['volume'])
    final_momentum = combined_factors * volume_adjusted_momentum + momentum_factor
    
    return final_momentum
```
