```txt
Volume and Price Shock-Adjusted Momentum with Intraday Range, Volatility, and Volume-Weighted Adjustments
├── Calculate Daily Price Range
│   ├── High - Low
├── N-Day Moving Average of Price Range
│   ├── Aggregate Daily Price Range over N days
│   └── Divide by N
├── N-Day Relative Strength Index (RSI)
│   ├── Upward Price Change: If today's close > yesterday's close, then today's close - yesterday's close
│   └── Downward Price Change: If today's close < yesterday's close, then yesterday's close - today's close
│   ├── Average Upward Change: Sum Upward Price Changes over N days / N
│   └── Average Downward Change: Sum Downward Price Changes over N days / N
│   ├── RS = Average Upward Change / |Average Downward Change|
│   └── RSI = 100 - (100 / (1 + RS))
├── Intraday Return
│   ├── Close - Open
├── Intraday Volatility
│   ├── High-Low Difference
│   │   ├── High - Low
│   └── Recent Intraday High-Low Differences
│       ├── Mean and Standard Deviation
├── Adjusted Intraday Return
│   ├── Intraday Return / Intraday Volatility
├── Intraday Range
│   ├── High - Low
├── Detect Volume and Amount Shock
│   ├── Volume Change: Current Volume - Previous Volume
│   └── Amount Change: Current Amount - Previous Amount
│   ├── Sudden Increase in Volume and Amount
│       ├── Threshold for Volume Increase
│       └── Threshold for Amount Increase
├── N-Day Moving Average of Volume
│   ├── Aggregate Volume over N days
│   └── Divide by N
├── Volume Trend
│   ├── If today's volume > N-Day Moving Average, assign 1
│   └── If today's volume < N-Day Moving Average, assign -1
├── Volume-Weighted Intraday Return
│   ├── Volume * Adjusted Intraday Return
├── Momentum
│   ├── 5-Day Moving Average of Intraday Returns
│   ├── 20-Day Moving Average of Intraday Returns
│   └── 5-Day MA - 20-Day MA
├── Adjust Momentum Factors
│   ├── N-Day Moving Average of Price Range * Volume Shock Indicator
│   ├── N-Day RSI * Volume Shock Indicator
│   ├── Intraday Range * Volume Shock Indicator
│   ├── Intraday Range * Amount Shock Indicator
└── Combine Adjusted Momentum Factors
    ├── Add all adjusted factors
    ├── Incorporate Volume-Weighted Intraday Return
    └── Multiply combined results by Volume Trend
```
