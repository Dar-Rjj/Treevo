```python
import pandas as pd

def heuristics_v2(df, n=14):
    # Calculate Intraday High-Low Spread
    high_low_spread = df['high'] - df['low']
    
    # Calculate Open-to-Close Momentum
    open_close_momentum = df['close'] - df['open']
    
    # Combine Intraday Indicators
    intraday_indicator = (high_low_spread * open_close_momentum) + open_close_momentum
    
    # Calculate N-Day Moving Average of Price Range
    price_range = df['high'] - df['low']
    moving_avg_price_range = price_range.rolling(window=n).mean()
    
    # Calculate N-Day RSI
    delta = df['close'].diff()
    up, down = delta.copy(), delta.copy()
    up[up < 0] = 0
    down[down > 0] = 0
    avg_gain = up.rolling(window=n).mean()
    avg_loss = down.abs().rolling(window=n).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    
    # Detect Volume and Amount Shock
    volume_change = df['volume'].pct_change()
    amount_change = (df['close'] * df['volume']).pct_change()
    volume_shock = (volume_change > 1.5) & (amount_change > 1.5)
    
    # Calculate N-Day Exponential Moving Average of Volume
    ema_volume = df['volume'].ewm(span=n, adjust=False).mean()
    
    # Calculate Volume Trend
    volume_trend = (df['volume'] > ema_volume).astype(int) - (df['volume'] < ema_volume).astype(int)
    
    # Adjust Momentum Factors with Volume and Amount Shock
    adjusted_moving_avg_price_range = moving_avg_price_range * volume_shock
    adjusted_rsi = rsi * volume_shock
    adjusted_intraday_spread = intraday_indicator * volume_shock
    adjusted_amount_intraday_spread = intraday_indicator * amount_change
    
    # Calculate N-Day Trade Imbalance
    midpoint = (df['high'] + df['low']) / 2
    buy_volume = df[df['close'] >= midpoint]['volume'].rolling(window=n).sum()
    sell_volume = df[df['close'] < midpoint]['volume'].rolling(window=n).sum()
    trade_imbalance = buy_volume - sell_volume
    
    # Combine All Adjusted Momentum Factors
    combined_momentum = (adjusted_moving_avg_price_range + 
                         adjusted_rsi + 
                         adjusted_intraday_spread + 
                         adjusted_amount_intraday_spread) * volume_trend * trade_imbalance
    
    # Calculate Simple Moving Average (SMA) of Close prices
    sma_close = df['close'].rolling(window=20).mean()
    
    # Calculate SMA Momentum
    sma_momentum = df['close'] - sma_close
    
    # Integrate RSI and SMA Momentum
    volume_adjusted_momentum = (moving_avg_price_range * df['volume']) + (rsi * df['volume'])
    final_momentum = combined_momentum * volume_adjusted_momentum + sma_momentum
    
    # Weight by Combined Volume & Price Volatility
    avg_volume = df['volume'].rolling(window=20).mean()
    avg_high_low_range = (df['high'] - df['low']).rolling(window=20).mean()
    combined_volatility = avg_volume * avg_high_low_range
    
    # Final Alpha Factor
    alpha_factor = final_momentum / combined_volatility
    return alpha_factor
```
