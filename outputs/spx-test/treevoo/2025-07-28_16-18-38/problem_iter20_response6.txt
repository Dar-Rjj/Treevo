```python
import pandas as pd

def heuristics_v2(df):
    # Daily return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Intraday volatility
    df['intraday_volatility'] = (df['high'] - df['low']) / df['open']
    
    # Simple Moving Average (SMA) of Close prices over 14 days
    df['sma_close_14'] = df['close'].rolling(window=14).mean()
    df['sma_ratio'] = df['close'] / df['sma_close_14']
    
    # Exponential Moving Average (EMA) of Close prices over 14 days
    df['ema_close_14'] = df['close'].ewm(span=14, adjust=False).mean()
    df['ema_ratio'] = df['close'] / df['ema_close_14']
    
    # Volume ratio
    df['sma_volume_14'] = df['volume'].rolling(window=14).mean()
    df['volume_ratio'] = df['volume'] / df['sma_volume_14']
    
    # Price-volume momentum
    df['price_volume_momentum'] = (df['close'] - df['open']) * df['volume']
    
    # Large trade indicator
    df['large_trade_indicator'] = (df['volume'] > 2 * df['sma_volume_14']).astype(int)
    
    # Volume-Weighted High and Low
    lookback_period = 14
    df['volume_weighted_high'] = (df['high'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    df['volume_weighted_low'] = (df['low'] * df['volume']).rolling(window=lookback_period).sum() / df['volume'].rolling(window=lookback_period).sum()
    df['volume_weighted_high_low_diff'] = (df['volume_weighted_high'] - df['volume_weighted_low'])
    
    # Dynamic Momentum
    df['high_low_diff'] = df['high'] - df['low']
    df['sma_high_low_diff_14'] = df['high_low_diff'].rolling(window=lookback_period).mean()
    df['raw_momentum'] = df['high_low_diff'] - df['sma_high_low_diff_14']
    smoothing_factor = 0.2
    df['dynamic_momentum'] = df['raw_momentum'].ewm(alpha=smoothing_factor, adjust=False).mean()
    
    # Combine Volume-Weighted High-Low Range and Dynamic Momentum
    scaling_factor = 0.5
    df['combined_factor'] = (df['volume_weighted_high_low_diff'] + df['dynamic_momentum']) * scaling_factor
    
    # Composite factor
    df['composite_factor'] = (df['sma_ratio'] + df['ema_ratio'] + df['intraday_volatility'] + df['volume_ratio'] + df['price_volume_momentum'] + df['large_trade_indicator'] + df['volume_weighted_high_low_diff'] + df['dynamic_momentum']) / 8
    
    # EMA Components
    df['7_day_ema'] = df['composite_factor'].ewm(span=7, adjust=False).mean()
    df['21_day_ema'] = df['composite_factor'].ewm(span=21, adjust=False).mean()
    
    # Ratio of EMAs
    df['ema_ratio_final'] = df['7_day_ema'] / df['21_day_ema']
    
    # Amount-Adjusted Return
    df['amount_adjusted_return'] = df['daily_return'] * df['amount']
    df['sma_amount_adjusted_return_5'] = df['amount_adjusted_return'].rolling(window=5).mean()
    
    # Final Alpha Factor
    df['final_alpha_factor'] = df['ema_ratio_final'] * df['sma_amount_adjusted_return_5']
    
    return df['final_alpha_factor']
```
