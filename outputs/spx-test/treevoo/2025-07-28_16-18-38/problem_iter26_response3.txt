```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Daily Return
    df['daily_return'] = (df['close'] - df['open']) / df['open']
    
    # Intraday Volatility
    df['intraday_volatility'] = (df['high'] - df['low']) / df['open']
    
    # Combined Intraday Indicator
    df['combined_intraday'] = (df['high'] - df['low']) + (df['close'] - df['open'])
    
    # Price Direction
    df['price_direction'] = np.where(df['close'] > df['open'], 1, -1)
    
    # Simple Moving Average (SMA) of Close prices over a certain period
    df['sma_close_20'] = df['close'].rolling(window=20).mean()
    df['sma_ratio'] = df['close'] / df['sma_close_20']
    
    # Exponential Moving Average (EMA) of Close prices
    df['ema_close_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['ema_ratio'] = df['close'] / df['ema_close_20']
    
    # 7-day EMA of High-to-Low Range
    df['ema_high_low_7'] = (df['high'] - df['low']).ewm(span=7, adjust=False).mean()
    
    # 21-day EMA of High-to-Low Range
    df['ema_high_low_21'] = (df['high'] - df['low']).ewm(span=21, adjust=False).mean()
    
    # Momentum Ratio
    df['momentum_ratio'] = df['ema_high_low_7'] / df['ema_high_low_21']
    
    # Adjusted Momentum Factor
    df['adjusted_momentum'] = df['momentum_ratio'] * (df['high'] - df['low'])
    
    # Volume Ratio
    df['sma_volume_20'] = df['volume'].rolling(window=20).mean()
    df['volume_ratio'] = df['volume'] / df['sma_volume_20']
    
    # Price-Volume Momentum
    df['price_volume_momentum'] = (df['close'] - df['open']) * df['volume']
    
    # Volume Change
    df['volume_change'] = df['volume'].pct_change()
    
    # Volume Spike: Identify days where volume is significantly higher than a recent average
    df['volume_spike'] = np.where(df['volume'] > 1.5 * df['sma_volume_20'], 1, 0)
    
    # Transaction Value: Ratio of amount traded to volume
    df['transaction_value'] = df['amount'] / df['volume']
    
    # Volume-Weighted High-Low Difference
    df['volume_weighted_high_low'] = (df['high'] - df['low']) * df['volume']
    
    # Subtract: Current Day's Volume-Weighted High-Low Diff - 14-day SMA
    df['sma_volume_weighted_high_low_14'] = df['volume_weighted_high_low'].rolling(window=14).mean()
    df['volume_weighted_diff'] = df['volume_weighted_high_low'] - df['sma_volume_weighted_high_low_14']
    
    # Composite factor
    df['composite_factor'] = df['sma_ratio'] + df['ema_ratio'] + df['intraday_volatility'] + df['volume_ratio'] + df['price_volume_momentum']
    
    # Final Alpha Factor
    df['final_alpha_factor'] = 0.5 * df['adjusted_momentum'] + 0.5 * df['volume_weighted_diff']
    df['final_alpha_factor'] *= df['price_direction'] * (1 + df['volume_spike'])
    
    return df['final_alpha_factor']
```
