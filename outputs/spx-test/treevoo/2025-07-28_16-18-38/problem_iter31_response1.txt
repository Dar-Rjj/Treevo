```python
import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Measure volatility
    df['volatility'] = df['daily_return'].rolling(window=20).std()
    
    # Investigate momentum
    df['momentum_5'] = df['daily_return'].rolling(window=5).mean()
    df['momentum_20'] = df['daily_return'].rolling(window=20).mean()
    
    # Analyze price gaps
    df['price_gap'] = df['open'] - df['close'].shift(1)
    
    # Evaluate volume trends
    df['volume_ma_20'] = df['volume'].rolling(window=20).mean()
    df['volume_ratio'] = df['volume'] / df['volume_ma_20']
    
    # Identify support and resistance levels
    df['high_50'] = df['high'].rolling(window=50).max()
    df['low_50'] = df['low'].rolling(window=50).min()
    
    # Assess market sentiment
    df['up_days'] = df['daily_return'].apply(lambda x: 1 if x > 0 else 0)
    df['down_days'] = df['daily_return'].apply(lambda x: 1 if x < 0 else 0)
    df['sentiment_score'] = df['up_days'].rolling(window=20).sum() - df['down_days'].rolling(window=20).sum()
    
    # Construct the alpha factor
    alpha_factor = (
        df['daily_return'] * 0.3 +
        df['volatility'] * 0.2 +
        df['momentum_5'] * 0.1 +
        df['momentum_20'] * 0.1 +
        df['price_gap'] * 0.1 +
        df['volume_ratio'] * 0.05 +
        (df['high_50'] - df['low_50']) * 0.05 +
        df['sentiment_score'] * 0.05
    )
    
    return alpha_factor
```
