```python
import pandas as pd

def heuristics_v2(df):
    # 1.1.1: Calculate the Range (High - Low)
    df['range'] = df['high'] - df['low']
    
    # 1.1.2: Determine if the stock closed higher or lower than it opened
    df['close_open_diff'] = df['close'] - df['open']
    df['price_movement'] = df['close_open_diff'].apply(lambda x: 1 if x > 0 else -1)
    
    # 1.2.1: Calculate the percentage change in volume from one day to the next
    df['volume_change'] = df['volume'].pct_change()
    
    # 1.2.2: Identify days with significantly higher volume compared to a recent average
    df['avg_volume_30'] = df['volume'].rolling(window=30).mean()
    df['volume_spike'] = df['volume'] > df['avg_volume_30']
    
    # 1.3.1: Calculate Simple Moving Averages (SMA)
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['sma_200'] = df['close'].rolling(window=200).mean()
    
    # 1.3.2: Identify when the 50-day SMA crosses above or below the 200-day SMA
    df['sma_crossover'] = (df['sma_50'] > df['sma_200']) & (df['sma_50'].shift(1) <= df['sma_200'].shift(1))
    df['sma_crossunder'] = (df['sma_50'] < df['sma_200']) & (df['sma_50'].shift(1) >= df['sma_200'].shift(1))
    
    # 2.1.1: Calculate the average amount traded over a certain period (e.g., 30 days)
    df['avg_amount_30'] = df['amount'].rolling(window=30).mean()
    df['amount_deviation'] = df['amount'] - df['avg_amount_30']
    
    # 2.1.2: Create a ratio of the amount traded to the volume
    df['amount_to_volume_ratio'] = df['amount'] / df['volume']
    
    # 3.1.1: Design a simple momentum factor using the past 5-day returns
    df['returns_5d'] = df['close'].pct_change(periods=5)
    
    # 3.1.2: Measure the number of up (or down) days in the last 5 trading days
    df['up_days_5'] = (df['close'] > df['close'].shift(1)).rolling(window=5).sum()
    
    # 3.2.1: Calculate the distance between the current close and the 200-day moving average
    df['distance_from_sma_200'] = df['close'] - df['sma_200']
    
    # 3.2.2: Compute the z-score of the current close relative to the 200-day mean
    df['z_score_200'] = (df['close'] - df['sma_200']) / df['close'].rolling(window=200).std()
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['range'] +
        df['price_movement'] * df['volume_change'] +
        df['volume_spike'].astype(int) +
        df['sma_crossover'].astype(int) - df['sma_crossunder'].astype(int) +
        df['amount_deviation'] * df['amount_to_volume_ratio'] +
        df['returns_5d'] * df['up_days_5'] +
        df['distance_from_sma_200'] + df['z_score_200']
    )
    
    return df['alpha_factor']
```
