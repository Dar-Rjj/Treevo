```python
import pandas as pd

def heuristics_v2(df):
    # Daily return
    df['Daily_Return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Intraday volatility
    df['Intraday_Volatility'] = (df['high'] - df['low']) / df['open']
    
    # Short-term trend: 5-day MA of close prices
    df['5_day_MA_Close'] = df['close'].rolling(window=5).mean()
    df['Short_term_SMA_ratio'] = df['close'] / df['5_day_MA_Close']
    
    # Long-term trend: 20-day MA of close prices
    df['20_day_MA_Close'] = df['close'].rolling(window=20).mean()
    df['Long_term_SMA_ratio'] = df['close'] / df['20_day_MA_Close']
    
    # Trend indicator: 5-day MA - 20-day MA
    df['Trend_Indicator'] = df['5_day_MA_Close'] - df['20_day_MA_Close']
    
    # Volume ratio
    df['14_day_SMA_Volume'] = df['volume'].rolling(window=14).mean()
    df['Volume_Ratio'] = df['volume'] / df['14_day_SMA_Volume']
    
    # Price-volume momentum
    df['Price_Volume_Momentum'] = df['Daily_Return'] * (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Large trade indicator
    df['Large_Trade_Indicator'] = (df['volume'] > 2 * df['14_day_SMA_Volume']).astype(int)
    
    # Analyze dynamic momentum using high and low prices
    df['High_Low_Difference'] = df['high'] - df['low']
    df['14_day_SMA_High_Low'] = df['High_Low_Difference'].rolling(window=14).mean()
    df['Raw_Momentum'] = df['High_Low_Difference'] - df['14_day_SMA_High_Low']
    df['Smoothed_Momentum'] = df['Raw_Momentum'].ewm(alpha=0.2, adjust=False).mean()
    df['Dynamic_Momentum'] = (df['Smoothed_Momentum'] + df['High_Low_Difference'].min()) / (df['High_Low_Difference'].max() - df['High_Low_Difference'].min()) * 100
    
    # Composite factor
    df['Composite_Factor'] = (df['Short_term_SMA_ratio'] + df['Long_term_SMA_ratio'] + 
                              df['Intraday_Volatility'] + df['Volume_Ratio'] +
                              df['Price_Volume_Momentum'] + df['Large_Trade_Indicator'] +
                              df['Dynamic_Momentum']) / 7
    
    # Weighted composite factor
    weights = {
        'Short_term_SMA_ratio': 0.2,
        'Long_term_SMA_ratio': 0.2,
        'Intraday_Volatility': 0.1,
        'Volume_Ratio': 0.15,
        'Price_Volume_Momentum': 0.15,
        'Large_Trade_Indicator': 0.1,
        'Dynamic_Momentum': 0.1
    }
    df['Weighted_Composite_Factor'] = (
        df['Short_term_SMA_ratio'] * weights['Short_term_SMA_ratio'] +
        df['Long_term_SMA_ratio'] * weights['Long_term_SMA_ratio'] +
        df['Intraday_Volatility'] * weights['Intraday_Volatility'] +
        df['Volume_Ratio'] * weights['Volume_Ratio'] +
        df['Price_Volume_Momentum'] * weights['Price_Volume_Momentum'] +
        df['Large_Trade_Indicator'] * weights['Large_Trade_Indicator'] +
        df['Dynamic_Momentum'] * weights['Dynamic_Momentum']
    )
    
    # Trend confirmation
    df['Trend_Confirmation'] = df['Trend_Indicator'] * (df['close'] * df['volume'] - df['close'].shift(1) * df['volume'].shift(1)) / (df['close'].shift(1) * df['volume'].shift(1))
    
    return df['Weighted_Composite_Factor']
```
