```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Range
    df['daily_range'] = df['high'] - df['low']
    
    # Flag Up and Down Days
    df['up_day'] = (df['close'] > df['open']).astype(int)
    df['down_day'] = (df['close'] < df['open']).astype(int)
    
    # Simple Moving Averages
    df['5_day_SMA'] = df['close'].rolling(window=5).mean()
    df['20_day_SMA'] = df['close'].rolling(window=20).mean()
    df['sma_diff'] = df['5_day_SMA'] - df['20_day_SMA']
    
    # Daily Volume Change
    df['volume_change'] = df['volume'].pct_change()
    
    # Significant Volume Changes
    df['significant_volume_increase'] = (df['volume_change'] > 0.5) & (df['up_day'] == 1)
    df['significant_volume_decrease'] = (df['volume_change'] < -0.5) & (df['down_day'] == 1)
    
    # Average True Range (ATR)
    df['tr'] = df[['high', 'low']].apply(lambda x: max(x[0], df['close'].shift(1)) - min(x[1], df['close'].shift(1)), axis=1)
    df['atr_14'] = df['tr'].rolling(window=14).mean()
    
    # Directional Movement Indicators
    df['dm_pos'] = df['high'].diff().clip(lower=0)
    df['dm_neg'] = df['low'].diff().clip(upper=0)
    df['+di_14'] = df['dm_pos'].rolling(window=14).sum() / df['atr_14']
    df['-di_14'] = df['dm_neg'].rolling(window=14).sum() / df['atr_14']
    df['di_diff'] = df['+di_14'] - df['-di_14']
    
    # On-Balance Volume (OBV)
    df['obv'] = (df['close'] - df['close'].shift(1)).apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0))
    df['obv'] = (df['obv'] * df['volume']).cumsum()
    
    # Breakout Patterns
    df['20_day_high'] = df['high'].rolling(window=20).max()
    df['20_day_low'] = df['low'].rolling(window=20).min()
    df['breakout_up'] = (df['close'] > df['20_day_high']).astype(int)
    df['breakout_down'] = (df['close'] < df['20_day_low']).astype(int)
    
    # Momentum Indicators
    df['roc_12'] = df['close'].pct_change(periods=12)
    df['rsi_14'] = 100 - (100 / (1 + (df['close'].diff(1).clip(lower=0).rolling(window=14).mean() / df['close'].diff(1).clip(upper=0).abs().rolling(window=14).mean())))
    df['overbought'] = (df['rsi_14'] > 70).astype(int)
    df['oversold'] = (df['rsi_14'] < 30).astype(int)
    
    # Volume-Weighted Average Price (VWAP)
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['cum_volume'] = df['volume'].cumsum()
    df['cum_typical_price_volume'] = (df['typical_price'] * df['volume']).cumsum()
    df['vwap'] = df['cum_typical_price_volume'] / df['cum_volume']
    df['vwap_crossover_up'] = (df['close'] > df['vwap']) & (df['close'].shift(1) < df['vwap'].shift(1))
    df['vwap_crossover_down'] = (df['close'] < df['vwap']) & (df['close'].shift(1) > df['vwap'].shift(1))
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['up_day'] - df['down_day'] +
        df['sma_diff'] +
        df['significant_volume_increase'].astype(int) - df['significant
