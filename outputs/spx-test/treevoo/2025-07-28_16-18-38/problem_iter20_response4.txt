```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Thought 1.1: Enhanced Intraday Movement and Price Direction
    df['HighLowSpread'] = df['high'] - df['low']
    df['CloseOpenSpread'] = df['close'] - df['open']
    df['CombinedIntradayIndicator'] = df['HighLowSpread'] + df['CloseOpenSpread']
    df['PriceDirection'] = np.where(df['close'] > df['open'], 1, -1)
    
    # Thought 1.2: Momentum Indicators with Volume Influence
    df['7dayEMA_HighLow'] = df['HighLowSpread'].ewm(span=7).mean()
    df['21dayEMA_HighLow'] = df['HighLowSpread'].ewm(span=21).mean()
    df['MomentumRatio'] = df['7dayEMA_HighLow'] / df['21dayEMA_HighLow']
    df['AdjustedMomentumFactor'] = df['MomentumRatio'] * df['HighLowSpread']
    df['VolumeWeightedHighLowDiff'] = (df['high'] - df['low']) * df['volume']
    df['14daySMA_VolumeWeightedHighLowDiff'] = df['VolumeWeightedHighLowDiff'].rolling(window=14).mean()
    df['SubtractionResult'] = df['VolumeWeightedHighLowDiff'] - df['14daySMA_VolumeWeightedHighLowDiff']
    df['SmoothedMomentum'] = df['SubtractionResult'].ewm(alpha=0.2).mean()
    
    # Thought 1.3: Volume and Amount Analysis for Alpha Generation
    df['VolumeChange'] = df['volume'].pct_change()
    df['30dayAvgAmount'] = df['amount'].rolling(window=30).mean()
    df['TransactionValue'] = df['amount'] / df['volume']
    df['AmountDeviation'] = df['amount'] - df['30dayAvgAmount']
    
    # Identify volume spike: days where volume is significantly higher than a recent average
    df['VolumeSpike'] = np.where(df['volume'] > df['volume'].rolling(window=5).mean() * 2, 1, 0)
    
    # Volume-Weighted Momentum
    df['VolumeWeightedMomentum'] = df['SmoothedMomentum'] * df['VolumeSpike']
    
    # Final Alpha Factor
    df['FinalAlphaFactor'] = (
        0.4 * df['MomentumRatio'] +
        0.3 * df['AdjustedMomentumFactor'] +
        0.3 * df['VolumeWeightedMomentum']
    ) * df['PriceDirection'] * df['VolumeSpike']
    
    return df['FinalAlphaFactor']

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=True, index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
