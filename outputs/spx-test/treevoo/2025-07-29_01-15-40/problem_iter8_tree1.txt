```txt
Integrated Intraday and Historical Momentum with Volume-Weighted Directional Movement
├── Calculate Log Return
│   ├── Current Day Close
│   └── Previous Day Close
├── EWMA of Log Return
│   └── 21-day Lookback Period
├── Integrate Price and Volume
│   ├── Volume Change
│   │   ├── Current Day Volume
│   │   └── Previous Day Volume
│   └── Combined Momentum
│       ├── Multiply EWMA Log Return by Volume Change
│       ├── High Value: Strong Trend, Increasing Volume
│       └── Low/Negative Value: Weakening/Reversing Trend
├── Calculate Intraday Price Movements and Directional Changes
│   ├── Use High and Low Prices
│   │   ├── Calculate Range (High - Low)
│   └── Use Open and Close Prices
│       └── Calculate Spread (Close - Open)
│   ├── Compute High Minus Prior High
│   └── Compute Low Minus Prior Low
├── Determine Net Intraday and Directional Movements
│   ├── Compare Upward and Downward Movements
│   │   ├── If Upward > Downward, Use Upward
│   │   └── Otherwise, Use Downward
│   ├── Store Net Movements
│   └── Combine Intraday Movements with Net Movements
│       ├── Weight by Average Volume
│       └── Sum of Range, Spread, and Net Movements
├── Adjust for Volume Activity
    ├── Use Volume
    └── Compare to Previous Day's Volume
        ├── If Volume > Previous Day's Volume
        │   └── Increase Combined Momentum Score Proportionally
        └── If Volume < Previous Day's Volume
            └── Decrease Combined Momentum Score Proportionally
├── Calculate Upward and Downward Movements
│   ├── Compute High Minus Prior Close
│   └── Compute Low Minus Prior Close
├── Determine Net Directional Movement
│   ├── If Upward > Downward, Assign Value = 1
│   ├── If Upward < Downward, Assign Value = -1
│   └── Otherwise, Assign Value = 0
├── Calculate Adjusted Cumulative Directional Movement
│   ├── Sum Net Directional Movements Over a Period
│   └── Multiply by Volume
└── Integrated Factor
    ├── Add Combined Momentum and Adjusted Cumulative Directional Movement
    ├── High Value: Strong Trend, Consistent Direction with Volume
    └── Low/Negative Value: Weak Trend, Inconsistent Direction or Decreasing Volume
└── Calculate CIMVDMI
    ├── Sum Weighted Combined Movements Over a Period
    └── Use Cumulative Sum as Factor
```
