```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Ratio Momentum
    df['High_Low_Ratio'] = df['high'] / df['low']
    df['HL_Ratio_Momentum'] = df['High_Low_Ratio'].rolling(window=10).mean()

    # Calculate Intraday High-Low Spread
    df['Intraday_High_Low_Spread'] = df['high'] - df['low']

    # Compute High-Low Momentum Score
    df['High_Low_Momentum_Score'] = (df['Intraday_High_Low_Spread'] > df['HL_Ratio_Momentum']).astype(int) * 2 - 1
    df['High_Low_Momentum_Score'] *= df['volume']

    # Calculate Price Momentum
    price_change = df['close'].pct_change()
    df['Price_Momentum'] = price_change.rolling(window=5).sum()

    # Integrate Volume into Momentum
    df['VWAP'] = (df[['open', 'close']].mean(axis=1) * df['volume']).cumsum() / df['volume'].cumsum()
    df['SMA_VWAP'] = (df['close'].rolling(window=5).mean() + df['VWAP']) / 2

    # Calculate Volume Trend
    volume_change = df['volume'].pct_change()
    df['Volume_Trend'] = volume_change.rolling(window=5).sum()

    # Enhance Market Sentiment Analysis
    df['Daily_Range'] = df['high'] - df['low']
    avg_daily_range = df['Daily_Range'].rolling(window=5).mean()
    df['Range_Momentum_Score'] = (df['Daily_Range'] > avg_daily_range).astype(int) * 2 - 1
    df['Open_Close_Diff'] = df['close'] - df['open']
    df['Open_Close_Sum'] = df['Open_Close_Diff'].rolling(window=5).sum()

    # Calculate Price Reversal Indicator
    df['Reversal_Indicator'] = (df['high'] - df['low']) - (df['open'] - df['close'])

    # Calculate Upward and Downward Movements
    df['Upward_Movement'] = df['high'] - df['close'].shift(1)
    df['Downward_Movement'] = df['low'] - df['close'].shift(1)

    # Determine Net Directional Movement
    df['Net_Directional_Movement'] = 0
    df.loc[df['Upward_Movement'] > df['Downward_Movement'], 'Net_Directional_Movement'] = 1
    df.loc[df['Upward_Movement'] < df['Downward_Movement'], 'Net_Directional_Movement'] = -1

    # Calculate Cumulative Directional Movement Adjusted (CDMA)
    df['CDMA'] = (df['Net_Directional_Movement'] * df['volume']).rolling(window=5).sum()

    # Composite Factor Construction
    composite_factor = (df['HL_Ratio_Momentum'] + 
                        df['Price_Momentum'] + 
                        df['High_Low_Momentum_Score'] + 
                        df['Range_Momentum_Score']) * df['CDMA']

    return pd.Series(composite_factor, name='Composite_Factor')
```
