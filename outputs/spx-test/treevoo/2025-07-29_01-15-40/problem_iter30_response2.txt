```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 10-day RSI
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=10).mean()
    avg_loss = loss.rolling(window=10).mean()
    rs = avg_gain / avg_loss
    rsi_10 = 100 - (100 / (1 + rs))
    
    # Calculate Williams %R for a 21-day period
    hh = df['high'].rolling(window=21).max()
    ll = df['low'].rolling(window=21).min()
    williams_r = -100 * (hh - df['close']) / (hh - ll)
    
    # Calculate 9-day and 21-day EMAs and MACD
    ema_9 = df['close'].ewm(span=9, adjust=False).mean()
    ema_21 = df['close'].ewm(span=21, adjust=False).mean()
    macd = ema_9 - ema_21
    
    # Calculate 10-day ATR
    tr1 = df['high'] - df['low']
    tr2 = abs(df['high'] - df['close'].shift(1))
    tr3 = abs(df['low'] - df['close'].shift(1))
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    atr_10 = true_range.rolling(window=10).mean()
    
    # Calculate Bollinger Bands
    sma_30 = df['close'].rolling(window=30).mean()
    std_30 = df['close'].rolling(window=30).std()
    upper_band = sma_30 + 2 * std_30
    lower_band = sma_30 - 2 * std_30
    bollinger_bandwidth = (upper_band - lower_band) / sma_30
    
    # Calculate Parabolic SAR
    sar = df['close'].copy()  # Placeholder for the actual SAR calculation
    sar_high = df['high'].rolling(window=2).max()
    sar_low = df['low'].rolling(window=2).min()
    sar_step = 0.02
    sar_max = 0.2
    af = sar_step
    is_up_trend = True
    for i in range(2, len(sar)):
        if is_up_trend:
            sar[i] = sar[i-1] + af * (sar_high[i-1] - sar[i-1])
            if df['low'][i] < sar[i]:
                is_up_trend = False
                sar[i] = sar_high[i-1]
                af = sar_step
        else:
            sar[i] = sar[i-1] + af * (sar_low[i-1] - sar[i-1])
            if df['high'][i] > sar[i]:
                is_up_trend = True
                sar[i] = sar_low[i-1]
                af = sar_step
        if is_up_trend:
            if sar_high[i] > sar_high[i-1]:
                af = min(af + sar_step, sar_max)
        else:
            if sar_low[i] < sar_low[i-1]:
                af = min(af + sar_step, sar_max)
    
    # Calculate 50-day and 150-day SMAs
    sma_50 = df['close'].rolling(window=50).mean()
    sma_150 = df['close'].rolling(window=150).mean()
    sma_crossover = sma_50 - sma_150
    
    # Calculate On-Balance Volume (OBV)
    obv = (df['close'].diff() / df['close'].abs()).fillna(0) * df['volume']
    obv = obv.cumsum()
    
    # Calculate Chaikin Money Flow (CMF) over 14 days
    mfv = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    cmf = (mfv * df['volume']).rolling(window=14).sum() / df['volume'].rolling(window=14).sum()
    
    # Calculate Commodity Channel Index (CCI) over 14 periods
    tp = (df['high'] + df['low'] + df['close
