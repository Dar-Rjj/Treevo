```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Price Movement and Upward/Downward Movements
    df['Range'] = df['high'] - df['low']
    df['Spread'] = df['close'] - df['open']
    
    # Compute High Minus Prior High and Low Minus Prior Low
    df['High_Minus_Prior_High'] = df['high'] - df['high'].shift(1)
    df['Low_Minus_Prior_Low'] = df['low'] - df['low'].shift(1)
    
    # Determine Net Intraday and Directional Movements
    df['Upward_Movement'] = df[['Range', 'Spread', 'High_Minus_Prior_High']].max(axis=1)
    df['Downward_Movement'] = df[['Range', 'Spread', 'Low_Minus_Prior_Low']].min(axis=1)
    df['Net_Movement'] = df.apply(lambda row: row['Upward_Movement'] if row['Upward_Movement'] > abs(row['Downward_Movement']) else row['Downward_Movement'], axis=1)
    
    # Combine Intraday Movements with Net Movements, weighted by average volume
    df['Avg_Volume'] = (df['volume'] + df['volume'].shift(1)) / 2
    df['Combined_Movements'] = (df['Range'] + df['Spread'] + df['Net_Movement']) * df['Avg_Volume']
    
    # Confirm with Volume Activity
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['CIDMI_Score'] = df['Combined_Movements']
    df['CIDMI_Score'] += df['Volume_Change'].apply(lambda x: 0.5 * x if x > 0 else -0.5 * x)
    
    # Calculate CIDMI
    df['CIDMI'] = df['CIDMI_Score'].cumsum()
    
    return df['CIDMI']
```
