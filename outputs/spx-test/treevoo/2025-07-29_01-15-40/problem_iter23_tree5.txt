```txt
Integrated Volume-Weighted Intraday and Trend Momentum Composite with Enhanced Market Sentiment
├── Calculate Intraday Price Movements and Directional Changes
│   ├── Use High and Low Prices
│   │   ├── Calculate Range (High - Low)
│   └── Use Open and Close Prices
│       └── Calculate Spread (Close - Open)
├── Determine Net Intraday and Directional Movements
│   ├── Compare Upward and Downward Movements
│   │   ├── If Upward > Downward, Use Upward
│   │   └── Otherwise, Use Downward
│   ├── Store Net Movements
│   └── Combine Intraday Movements with Net Movments
│       ├── Weight by Average Volume
│       ├── Sum of Range, Spread, and Net Movements
├── Adjust for Volume Activity
    ├── Use Volume
    └── Compare to Previous Day's Volume
        ├── If Volume > Previous Day's Volume
        │   └── Increase Combined Momentum Score Proportionally
        └── If Volume < Previous Day's Volume
            └── Decrease Combined Momentum Score Proportionally
├── Calculate Daily High-Low Ratio
│   ├── Use High price
│   └── Use Low price
├── Calculate Rolling Median of High-Low Ratios
│   ├── Set Rolling Window (e.g., 10 days)
│   └── Calculate the Median of High-Low Ratios
│       ├── Use High-Low Ratios from Previous Days
│       └── Compute the Median
├── Calculate Intraday High-Low Spread
│   ├── Use High price
│   └── Subtract Low price
├── Calculate Median Intraday High-Low Spread
│   ├── Collect Intraday High-Low Spreads over past N days
│   └── Compute the median
├── Compute High-Low Momentum Score
│   ├── Compare current Intraday High-Low Spread with Median
│   │   ├── Assign a positive score if current spread > median
│   │   └── Assign a negative score if current spread < median
│   └── Adjust by Volume
│       ├── Use Volume
│       └── Multiply High-Low Momentum Score by Volume
├── Calculate Log Return
│   ├── Current Day Close
│   └── Previous Day Close
├── EWMA of Log Return
│   └── 21-day Lookback Period
├── Integrate Price and Volume
│   ├── Volume Change
│   │   ├── Current Day Volume
│   │   └── Previous Day Volume
│   └── Combined Momentum
│       ├── Multiply EWMA Log Return by Volume Change
│       ├── High Value: Strong Trend, Increasing Volume
│       └── Low/Negative Value: Weakening/Reversing Trend
├── Calculate Upward and Downward Movements
│   ├── Compute High Minus Prior Close
│   └── Compute Low Minus Prior Close
├── Determine Net Directional Movement
│   ├── If Upward > Downward, Assign Value = 1
│   ├── If Upward < Downward, Assign Value = -1
│   └── Otherwise, Assign Value = 0
├── Calculate Adjusted Cumulative Directional Movement
│   ├── Sum Net Directional Movements Over a 21-day Period
│   └── Multiply by Volume
├── Add Trend Strength Indicator
│   ├── Calculate Daily Range
│   │   ├── Current Day High
│   │   └── Current Day Low
│   ├── Compute Average Daily Range over 21 Days
│   └── Compare Daily Range to Average Daily Range
│       ├── If Daily Range > Average Daily Range, Assign Value = 1 (Strong Trend)
│       └── Otherwise, Assign Value = 0 (Weak Trend)
├── Integrate Volume into Momentum
│   ├── Compute Volume Weighted Average Price (VWAP)
│   │   ├── Use Close, Open, and Volume
│   │   └── Aggregate Volume-weighted average
│   └── Combine SMA and VWAP
│       ├── Use SMA
│       └── Use VWAP
├── Calculate Price Momentum
│   ├── Determine Period (e.g., 5 days)
│   ├── Calculate Price Change
│   │   ├── Use Close price of current day
│   │   └── Use Close price of n days ago
│   └── Sum Up the Price Changes over the Period
├── Calculate Volume Trend
│   ├── Determine Period (e.g., 5 days)
│   ├── Calculate Volume Change
│   │   ├── Use Volume of current day
│   │   └── Use Volume of
