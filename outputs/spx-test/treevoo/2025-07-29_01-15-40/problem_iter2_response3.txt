```python
import pandas as pd

def heuristics_v2(df):
    period = 5
    
    # Calculate Price Momentum
    price_changes = df['close'].pct_change(period)
    price_momentum = price_changes.rolling(window=period).sum()
    
    # Integrate Volume into Momentum
    vwap = (df[['open', 'close']] * df['volume']).sum(axis=1) / df['volume']
    integrated_momentum = price_momentum + vwap.pct_change(period)
    
    # Calculate Price Reversal Indicator
    high_low_spread = df['high'] - df['low']
    open_close_spread = df['open'] - df['close']
    reversal_indicator = high_low_spread - open_close_spread
    
    # Composite Factor Construction
    composite_factor = integrated_momentum * reversal_indicator
    high_period = df['high'].rolling(window=period).max()
    low_period = df['low'].rolling(window=period).min()
    market_sentiment = (high_period - low_period) / (high_period + low_period)
    final_factor = composite_factor * market_sentiment
    
    return final_factor
```
