```txt
Integrated Momentum and Directional Volume Signal with Enhanced Trend Detection
├── Calculate Log Return
│   ├── Current Day Close
│   └── Previous Day Close
├── EWMA of Log Return
│   └── 21-day Lookback Period
├── Integrate Price and Volume
│   ├── Volume Change
│   │   ├── Current Day Volume
│   │   └── Previous Day Volume
│   └── Combined Momentum
│       └── Multiply EWMA Log Return by Volume Change
├── Calculate Upward and Downward Movements
│   ├── Compute High Minus Prior Close
│   └── Compute Low Minus Prior Close
├── Determine Net Directional Movement
│   ├── If Upward > Downward, Assign Value = 1
│   ├── If Upward < Downward, Assign Value = -1
│   └── Otherwise, Assign Value = 0
├── Calculate Adjusted Cumulative Directional Movement
│   ├── Sum Net Directional Movements Over a 21-day Period
│   └── Multiply by Volume
├── Add Trend Strength Indicator
│   ├── Daily Range
│   │   ├── Current Day High
│   │   └── Current Day Low
│   ├── Average Daily Range over 21 Days
│   └── Compare Daily Range to Average Daily Range
│       ├── If Daily Range > Average Daily Range, Assign Value = 1 (Strong Trend)
│       └── Otherwise, Assign Value = 0 (Weak Trend)
└── Integrated Factor
    ├── Combine Combined Momentum and Adjusted Cumulative Directional Movement
    └── Multiply by Trend Strength Indicator
```
