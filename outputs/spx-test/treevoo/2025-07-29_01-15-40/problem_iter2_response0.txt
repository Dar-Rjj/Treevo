```python
import pandas as pd

def heuristics_v2(df, n_days=5, hl_coeff=0.5, price_coeff=0.3, volume_coeff=0.2):
    # Calculate Intraday High-Low Spread
    df['intraday_hl_spread'] = df['high'] - df['low']
    
    # Calculate Average Intraday High-Low Spread over past N days
    df['avg_intraday_hl_spread'] = df['intraday_hl_spread'].rolling(window=n_days).mean()
    
    # Compute High-Low Momentum Score
    df['hl_momentum_score'] = (df['intraday_hl_spread'] - df['avg_intraday_hl_spread']).apply(lambda x: 1 if x > 0 else -1)
    
    # Adjust by Volume
    df['hl_momentum_score_adjusted'] = df['hl_momentum_score'] * df['volume']
    
    # Calculate Price Momentum over a period of n_days
    df['price_change'] = df['close'] - df['close'].shift(n_days)
    df['price_momentum'] = df['price_change'].rolling(window=n_days).sum()
    
    # Calculate Volume Trend over a period of n_days
    df['volume_change'] = df['volume'] - df['volume'].shift(n_days)
    df['volume_trend'] = df['volume_change'].rolling(window=n_days).sum()
    
    # Adjust for Market Sentiment using High and Low Prices
    df['high_low_range'] = df['high'].rolling(window=n_days).max() - df['low'].rolling(window=n_days).min()
    
    # Weighted Sum of High-Low Momentum, Price Momentum, and Volume Trend
    df['weighted_sum'] = (hl_coeff * df['hl_momentum_score_adjusted'] +
                          price_coeff * df['price_momentum'] +
                          volume_coeff * df['volume_trend'])
    
    # Calculate Final Factor
    df['final_factor'] = df['weighted_sum']
    
    return df['final_factor']
```
