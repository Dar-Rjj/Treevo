```python
import pandas as pd

def heuristics_v2(df):
    # Determine Period
    period = 5
    
    # Calculate Price Momentum
    price_changes = df['close'].diff(period)
    price_momentum = price_changes.rolling(window=period).sum()
    
    # Calculate Volume Trend
    volume_changes = df['volume'].diff(period)
    volume_trend = volume_changes.rolling(window=period).sum()
    
    # Compute Volume Weighted Average Price (VWAP)
    vwap = (df[['open', 'close']].mean(axis=1) * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Combine SMA and VWAP
    sma = df['close'].rolling(window=period).mean()
    integrated_momentum = (sma + vwap) / 2
    
    # Calculate Price Reversal Indicator
    high_low_spread = df['high'] - df['low']
    open_close_spread = df['open'] - df['close']
    price_reversal = high_low_spread - open_close_spread
    
    # Calculate Upward and Downward Movements
    high_minus_prior_close = df['high'] - df['close'].shift(1)
    low_minus_prior_close = df['low'] - df['close'].shift(1)
    
    # Determine Net Directional Movement
    net_directional_movement = pd.Series(index=df.index, dtype='float64')
    net_directional_movement[high_minus_prior_close > low_minus_prior_close] = 1
    net_directional_movement[high_minus_prior_close < low_minus_prior_close] = -1
    net_directional_movement[high_minus_prior_close == low_minus_prior_close] = 0
    
    # Calculate Cumulative Directional Movement Adjusted (CDMA)
    cdma = (net_directional_movement * df['volume']).rolling(window=period).sum()
    
    # Composite Factor Construction
    weighted_sum = (price_momentum + volume_trend) / 2
    final_factor = weighted_sum * cdma
    
    return final_factor
```
