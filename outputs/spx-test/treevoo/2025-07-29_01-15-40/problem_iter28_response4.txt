```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 14-day RSI
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    
    # Calculate Williams %R for a 14-day period
    highest_high = df['high'].rolling(window=14).max()
    lowest_low = df['low'].rolling(window=14).min()
    williams_r = (highest_high - df['close']) / (highest_high - lowest_low) * -100
    
    # Compute 12-day and 26-day EMAs, then the MACD line
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12 - ema_26
    
    # Determine 14-day ATR
    tr1 = df['high'] - df['low']
    tr2 = abs(df['high'] - df['close'].shift(1))
    tr3 = abs(df['low'] - df['close'].shift(1))
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    atr = true_range.rolling(window=14).mean()
    
    # Bollinger Bands (20-day moving average with 2 standard deviations)
    sma_20 = df['close'].rolling(window=20).mean()
    std_20 = df['close'].rolling(window=20).std()
    upper_band = sma_20 + 2 * std_20
    lower_band = sma_20 - 2 * std_20
    bband_width = upper_band - lower_band
    
    # Construct Parabolic SAR
    sar = df['close'].copy()
    sar.iloc[0] = min(df['low'].iloc[:2])
    extreme_point = max(df['high'].iloc[:2])
    acceleration_factor = 0.02
    maximum_acceleration_factor = 0.2
    for i in range(1, len(df)):
        if sar.iloc[i-1] < df['low'].iloc[i]:
            extreme_point = max(extreme_point, df['high'].iloc[i])
            af = min(acceleration_factor + 0.02, maximum_acceleration_factor)
            sar.iloc[i] = sar.iloc[i-1] + af * (extreme_point - sar.iloc[i-1])
        else:
            sar.iloc[i] = extreme_point
            break
    
    # 50-day and 200-day SMA crossover
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    sma_crossover = sma_50 - sma_200
    
    # On-Balance Volume (OBV)
    obv = (df['close'].diff() / df['close'].abs()).fillna(0) * df['volume']
    obv = obv.cumsum()
    
    # Chaikin Money Flow (CMF) over 20 days
    cmf_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    cmf = (cmf_multiplier * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Commodity Channel Index (CCI) over 20 periods
    cci_typical_price = (df['high'] + df['low'] + df['close']) / 3
    mean_deviation = (cci_typical_price - cci_typical_price.rolling(window=20).mean()).abs().rolling(window=20).mean()
    cci = (cci_typical_price - cci_typical_price.rolling(window=20).mean()) / (0.015 * mean_deviation)
    
    # Custom sentiment score using RSI, %R, and CCI
    custom_sentiment = (rsi + williams_r + cci) / 3
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        rsi + 
        williams_r + 
        macd
