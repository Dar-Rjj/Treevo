```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    momentum_period = 5
    df['price_change'] = df['close'] - df['close'].shift(momentum_period)
    df['price_momentum'] = df['price_change'].rolling(window=momentum_period).sum()

    # Calculate Volume Trend
    volume_period = 5
    df['volume_change'] = df['volume'] - df['volume'].shift(volume_period)
    df['volume_trend'] = df['volume_change'].rolling(window=volume_period).sum()

    # Integrate Volume into Momentum
    df['VWAP'] = (df['close'] + df['open']) / 2 * df['volume']
    df['VWAP'] = df['VWAP'].cumsum() / df['volume'].cumsum()
    df['integrated_momentum'] = (df['price_momentum'] + df['VWAP']) / 2

    # Calculate Price Reversal Indicator
    df['high_low_spread'] = df['high'] - df['low']
    df['open_close_spread'] = abs(df['open'] - df['close'])
    df['price_reversal'] = df['high_low_spread'] - df['open_close_spread']

    # Calculate Upward and Downward Movements
    df['upward_movement'] = df['high'] - df['close'].shift(1)
    df['downward_movement'] = df['low'] - df['close'].shift(1)

    # Determine Net Directional Movement
    conditions = [
        (df['upward_movement'] > df['downward_movement']),
        (df['upward_movement'] < df['downward_movement'])
    ]
    choices = [1, -1]
    df['net_directional_movement'] = pd.np.select(conditions, choices, default=0)

    # Calculate Cumulative Directional Movement Adjusted (CDMA)
    df['CDMA'] = (df['net_directional_movement'] * df['volume']).cumsum()

    # Composite Factor Construction
    df['composite_factor'] = (df['price_momentum'] + df['volume_trend']) * df['CDMA']
    return df['composite_factor']
```
