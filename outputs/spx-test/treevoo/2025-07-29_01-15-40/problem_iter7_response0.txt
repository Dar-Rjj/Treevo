```python
import pandas as pd

def heuristics_v2(df):
    # Compute Upward and Downward Movements
    df['upward_movement'] = df['high'] - df['close'].shift(1)
    df['downward_movement'] = df['low'] - df['close'].shift(1)
    
    # Assign Net Directional Movement
    conditions = [
        (df['upward_movement'] > df['downward_movement']),
        (df['upward_movement'] < df['downward_movement'])
    ]
    choices = [1, -1]
    df['net_directional_movement'] = pd.np.select(conditions, choices, default=0)
    
    # Calculate CDMA
    period = 14  # You can adjust the period as needed
    df['CDMA'] = df['net_directional_movement'].rolling(window=period).sum() * df['volume']
    
    return df['CDMA']
```
