```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    n = 5
    df['price_change'] = df['close'].diff(n)
    df['price_momentum'] = df['price_change'].rolling(window=n).sum()

    # Calculate Volume Trend
    df['volume_change'] = df['volume'].diff(n)
    df['volume_trend'] = df['volume_change'].rolling(window=n).sum()

    # Integrate Volume into Momentum (VWAP and SMA)
    df['vwap'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    df['sma'] = df['close'].rolling(window=n).mean()
    df['momentum_with_volume'] = (df['sma'] + df['vwap']) / 2

    # Calculate Daily High-Low Ratio
    df['high_low_ratio'] = df['high'] / df['low']

    # Calculate Rolling Average of High-Low Ratios
    rolling_window = 10
    df['avg_high_low_ratio'] = df['high_low_ratio'].rolling(window=rolling_window).mean()

    # Incorporate Volume Weighted Factor
    df['daily_volume_weight'] = df['volume'] / df['close']
    df['volume_weighted_high_low_ratio'] = (df['high_low_ratio'] * df['daily_volume_weight']).rolling(window=rolling_window).mean()

    # Calculate Intraday High-Low Spread
    df['intraday_high_low_spread'] = df['high'] - df['low']

    # Calculate Average Intraday High-Low Spread
    average_intraday_high_low_spread = df['intraday_high_low_spread'].rolling(window=n).mean()
    df['high_low_momentum_score'] = df['intraday_high_low_spread'] - average_intraday_high_low_spread
    df['high_low_momentum_score'] = df['high_low_momentum_score'] * df['volume']

    # Calculate Price Reversal Indicator
    df['reversal_indicator'] = (df['high'] - df['low']) - (df['open'] - df['close'])

    # Calculate Upward and Downward Movements
    df['upward_movement'] = df['high'] - df['close'].shift(1)
    df['downward_movement'] = df['low'] - df['close'].shift(1)

    # Determine Net Directional Movement
    conditions = [
        (df['upward_movement'] > df['downward_movement']),
        (df['upward_movement'] < df['downward_movement'])
    ]
    choices = [1, -1]
    df['net_directional_movement'] = pd.np.select(conditions, choices, default=0)

    # Calculate Cumulative Directional Movement Adjusted (CDMA)
    df['cdma'] = df['net_directional_movement'].rolling(window=n).sum() * df['volume']

    # Composite Factor Construction
    df['integrated_momentum'] = df['price_momentum'] + df['momentum_with_volume'] + df['high_low_momentum_score']
    df['final_factor'] = df['integrated_momentum'] * df['cdma']

    return df['final_factor']
```
