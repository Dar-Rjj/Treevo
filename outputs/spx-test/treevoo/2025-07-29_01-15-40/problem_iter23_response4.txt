```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the relative position of closing price within the day's range
    df['day_range'] = df['high'] - df['low']
    df['close_position'] = (df['close'] - df['low']) / df['day_range']

    # Determine if the close is in the upper half of the day's range
    df['upper_half'] = (df['close_position'] > 0.5).astype(int)

    # Calculate the factor value: Volume weighted by the upper half indicator
    factor_values = df['volume'] * df['upper_half']

    return pd.Series(factor_values, index=df.index)
```
