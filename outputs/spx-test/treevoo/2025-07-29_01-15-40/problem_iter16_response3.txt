```python
import pandas as pd

def heuristics_v2(df, N=10, M=10, price_momentum_period=5, volume_trend_period=5, open_price_period=5):
    # Intraday High-Low Spread
    intraday_spread = df['high'] - df['low']
    
    # Average Intraday High-Low Spread over the past N days
    avg_intraday_spread = intraday_spread.rolling(window=N).mean()
    
    # High-Low Momentum Score
    high_low_momentum_score = (intraday_spread - avg_intraday_spread) * df['volume']
    
    # Price Momentum
    price_momentum = df['close'].diff(price_momentum_period).rolling(window=price_momentum_period).sum()
    
    # Volume Trend
    volume_trend = df['volume'].diff(volume_trend_period).rolling(window=volume_trend_period).sum()
    
    # Enhance Market Sentiment
    daily_range = df['high'] - df['low']
    avg_daily_range = daily_range.rolling(window=M).mean()
    range_momentum = (daily_range - avg_daily_range).apply(lambda x: 1 if x > 0 else -1)
    
    # Open-Price and Close-Price Movement
    open_close_diff = df['close'] - df['open']
    open_close_movement = open_close_diff.rolling(window=price_momentum_period).sum()
    
    # Open-Price Change
    open_price_change = df['open'].diff(open_price_period).rolling(window=open_price_period).sum()
    
    # Combine Factors
    factor = (
        0.4 * high_low_momentum_score + 
        0.2 * price_momentum + 
        0.1 * volume_trend + 
        0.15 * range_momentum + 
        0.15 * open_close_movement + 
        0.1 * open_price_change
    )
    
    return factor
```
