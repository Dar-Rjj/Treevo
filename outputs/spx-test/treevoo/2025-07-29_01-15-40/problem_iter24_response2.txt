```python
import pandas as pd

def heuristics_v2(df, N=5, M=5):
    # Intraday High-Low Spread
    intraday_high_low_spread = df['high'] - df['low']
    
    # Average Intraday High-Low Spread
    avg_intraday_high_low_spread = intraday_high_low_spread.rolling(window=N).mean()
    
    # High-Low Momentum Score
    high_low_momentum_score = (intraday_high_low_spread - avg_intraday_high_low_spread).apply(lambda x: 1 if x > 0 else -1)
    high_low_momentum_score = high_low_momentum_score * df['volume']
    
    # Price Momentum
    price_momentum = df['close'].diff(periods=N).sum()
    
    # Volume Trend
    volume_trend = df['volume'].diff(periods=M).sum()
    
    # Daily Range
    daily_range = df['high'] - df['low']
    
    # Average Daily Range
    avg_daily_range = daily_range.rolling(window=M).mean()
    
    # Range Momentum
    range_momentum = (daily_range - avg_daily_range).apply(lambda x: 1 if x > 0 else -1)
    
    # Open to Close Price Difference
    open_to_close_diff = df['close'] - df['open']
    
    # Close to Open Price Ratio
    close_to_open_ratio = df['close'] / df['open']
    
    # Open to Low Price Difference
    open_to_low_diff = df['low'] - df['open']
    
    # Low to Open Price Ratio
    low_to_open_ratio = df['low'] / df['open']
    
    # Open to High Price Difference
    open_to_high_diff = df['high'] - df['open']
    
    # High to Open Price Ratio
    high_to_open_ratio = df['high'] / df['open']
    
    # Combine Factors
    factor = (
        0.2 * high_low_momentum_score +
        0.2 * price_momentum +
        0.1 * volume_trend +
        0.1 * range_momentum +
        0.1 * open_to_close_diff +
        0.1 * close_to_open_ratio +
        0.05 * open_to_low_diff +
        0.05 * low_to_open_ratio +
        0.05 * open_to_high_diff +
        0.05 * high_to_open_ratio
    )
    
    return factor
```
