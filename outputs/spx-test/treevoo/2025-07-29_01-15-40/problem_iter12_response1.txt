```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Price Momentum
    momentum_period = 5
    df['price_change'] = df['close'] - df['close'].shift(momentum_period)
    df['price_momentum'] = df['price_change'].rolling(window=momentum_period).sum()

    # Calculate Volume Trend
    volume_period = 5
    df['volume_change'] = df['volume'] - df['volume'].shift(volume_period)
    df['volume_trend'] = df['volume_change'].rolling(window=volume_period).sum()

    # Integrate Volume into Momentum
    df['vwap'] = (df['close'] + df['open']) / 2 * df['volume']
    df['vwap'] = df['vwap'].rolling(window=momentum_period).sum() / df['volume'].rolling(window=momentum_period).sum()
    df['sma'] = df['close'].rolling(window=momentum_period).mean()
    df['integrated_momentum'] = (df['price_momentum'] + (df['vwap'] - df['sma'])) / 2

    # Calculate Price Reversal Indicator
    df['high_low_spread'] = df['high'] - df['low']
    df['open_close_spread'] = df['open'] - df['close']
    df['price_reversal'] = df['high_low_spread'] - df['open_close_spread']

    # Calculate Upward and Downward Movements
    df['upward_movement'] = df['high'] - df['close'].shift(1)
    df['downward_movement'] = df['low'] - df['close'].shift(1)

    # Determine Net Directional Movement
    df['directional_movement'] = 0
    df.loc[df['upward_movement'] > df['downward_movement'], 'directional_movement'] = 1
    df.loc[df['upward_movement'] < df['downward_movement'], 'directional_movement'] = -1

    # Calculate Cumulative Directional Movement Adjusted (CDMA)
    cdma_period = 5
    df['net_directional_movement'] = df['directional_movement'] * df['volume']
    df['cdma'] = df['net_directional_movement'].rolling(window=cdma_period).sum()

    # Calculate Volume-Weighted Price Reversal
    df['volume_weighted_price_reversal'] = df['price_reversal'] * df['volume']
    df['volume_weighted_price_reversal'] = df['volume_weighted_price_reversal'].rolling(window=cdma_period).sum()

    # Composite Factor Construction
    df['composite_factor'] = (df['price_momentum'] + df['volume_trend']) / 2
    df['composite_factor'] *= df['cdma']
    df['composite_factor'] += df['volume_weighted_price_reversal']

    return df['composite_factor']
```
