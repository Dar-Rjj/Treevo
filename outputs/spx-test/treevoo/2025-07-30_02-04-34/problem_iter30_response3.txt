```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Spread
    df['High_Low_Spread'] = df['high'] - df['low']

    # Calculate Intraday Return
    df['Intraday_Return'] = (df['high'] - df['open']) / df['open']

    # Raw Momentum
    df['Raw_Momentum'] = df['close'].diff()

    # Detect Volume Spikes
    df['Volume_Change'] = df['volume'].pct_change()
    avg_vol_change = df['Volume_Change'].rolling(window=20).mean()
    std_vol_change = df['Volume_Change'].rolling(window=20).std()
    df['Vol_Spike'] = df['Volume_Change'] > 2 * avg_vol_change + 2 * std_vol_change

    # Adjust Raw Momentum
    df['Adjusted_Momentum'] = df['Raw_Momentum'] * (1 - df['Vol_Spike'] * 0.5)

    # Weighted Price Movement
    df['Weighted_Price_Movement'] = (df['close'] - df['open']) * df['volume']

    # Integrate Volume Impact
    avg_5d_volume = df['volume'].rolling(window=5).mean()
    df['Volume_Impact'] = (df['High_Low_Spread'] * df['volume']) / avg_5d_volume

    # Smooth Intraday Return
    df['Smoothed_Intraday_Return'] = df['Intraday_Return'].ewm(span=5, adjust=False).mean()
    df['Intraday_Return_Diff'] = df['Intraday_Return'] - df['Smoothed_Intraday_Return']

    # Combine Intraday Factors
    df['Combined_Intraday_Factors'] = df['High_Low_Spread'] + df['Intraday_Return']

    # Initial Alpha Signal
    df['Initial_Alpha'] = df['Adjusted_Momentum'] * df['Combined_Intraday_Factors'] * df['Weighted_Price_Movement']

    # Compute Smoothed Price Momentum
    df['Smoothed_Price_Momentum'] = df['close'].diff().rolling(window=5).mean()

    # Compute Weighted Volume Indicator
    df['Signed_Volume_Change'] = df['volume'].diff() * np.sign(df['volume'].diff())
    df['Weighted_Volume_Indicator'] = df['Signed_Volume_Change'].rolling(window=5).mean()

    # Incorporate Close Price Trend
    df['Close_Price_Change'] = df['close'].diff()
    df['Smoothed_Close_Price_Trend'] = df['Close_Price_Change'].ewm(span=7, adjust=False).mean().shift(1)
    df['Close_Price_Trend_Diff'] = df['Close_Price_Change'] - df['Smoothed_Close_Price_Trend']

    # Final Alpha Factor
    df['Final_Alpha'] = df['Initial_Alpha'] * df['Smoothed_Price_Momentum'] * df['Weighted_Volume_Indicator'] * df['Close_Price_Trend_Diff']
    
    # Adjust for Volatility
    df['Close_Volatility'] = df['close'].rolling(window=10).std()
    df['Final_Alpha'] = df['Final_Alpha'] / (1 + df['Close_Volatility'] * 1.5)

    # Introduce a New Factor: Intraday Range Expansion
    df['Range_Expansion'] = (df['high'] - df['low']) - (df['high'].shift(1) - df['low'].shift(1))
    df['Range_Expansion_Factor'] = df['Range_Expansion'] * (df['volume'] / avg_5d_volume)

    # Combine Intraday Momentum and Volume Impact
    df['Combined_Factor'] = df['Intraday_Return_Diff'] * df['Volume_Impact']
    df['Smoothed_Combined_Factor'] = df['Combined_Factor'].rolling(window=4).mean().shift(1)
    df['Final_Factor'] = df['Smoothed_Combined_Factor'] / (avg_5d_volume + 1e-6)

    # Final Alpha Factor with new factor
    df['Final_Alpha'] = df['Final_Alpha'] * df['Range_Expansion_Factor'] * df['Final_Factor']

    return df['Final_Alpha']
```
