```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday High-Low Spread
    intraday_high_low_spread = df['high'] - df['low']
    
    # Calculate Close-Open Spread
    close_open_spread = df['close'] - df['open']
    
    # Calculate Smoothed Intraday Return
    smoothed_intraday_return = (df['high'] - df['low']) / df['close']
    smoothed_intraday_return = smoothed_intraday_return.ewm(span=5, adjust=False).mean()
    smoothed_intraday_return = smoothed_intraday_return.shift(1)  # Exclude latest value for no look-ahead bias
    
    # Incorporate Volume Intensity
    avg_volume_10_days = df['volume'].rolling(window=10).mean()
    intraday_momentum_diff = (df['high'] - df['low']) / df['close']
    volume_intensity = intraday_momentum_diff * (1 / avg_volume_10_days)
    
    # Detect Volume Spikes
    volume_change = df['volume'] - df['volume'].shift(1)
    avg_vol_change_20_days = volume_change.rolling(window=20).mean()
    vol_spike = (volume_change > 3 * avg_vol_change_20_days).astype(int)
    
    # Combine Intraday Momentum and Volume Impact
    combined_factor = intraday_momentum_diff * vol_spike
    combined_factor = combined_factor.rolling(window=4).mean().shift(1)  # Exclude the most recent value to prevent future data leakage
    
    # Analyze Price and Volume Relationship
    price_change = df['close'] - df['close'].shift(1)
    volume_change = df['volume'] - df['volume'].shift(1)
    divergence = (np.sign(price_change) != np.sign(volume_change)).astype(int)
    divergence = divergence.rolling(window=10).sum()
    
    # Compute Intraday Volatility
    intraday_range = df['high'] - df['low']
    intraday_volatility = intraday_range.ewm(span=5, adjust=False).mean().shift(1)  # Exclude the most recent value to prevent look-ahead bias
    
    # Integrate Intraday Volatility with Volume Intensity
    integrated_volatility = intraday_volatility * (1 / avg_volume_10_days)
    integrated_volatility = integrated_volatility.rolling(window=4).mean()
    
    # Final Alpha Signal
    final_signal = smoothed_intraday_return + combined_factor + integrated_volatility
    threshold = 0.01  # Apply a threshold to filter out small signals
    final_signal = final_signal.where(np.abs(final_signal) > threshold, 0)
    final_signal = final_signal * (1 - divergence)  # Adjust the final signal based on identified divergences
    
    return final_signal
```
