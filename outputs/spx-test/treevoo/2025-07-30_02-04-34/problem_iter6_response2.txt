```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Reversal
    intraday_reversal = df['close'] - df['open']
    
    # Smooth Intraday Reversal with EMA (span 7) and exclude the latest value
    ema_intraday_reversal = intraday_reversal.ewm(span=7, adjust=False).mean().shift(1)
    
    # Calculate Volume Change
    avg_volume_10_days = df['volume'].rolling(window=10).mean()
    volume_change = df['volume'] / avg_volume_10_days
    
    # Identify Spike (volume change > 2 times the average of last 10 days)
    volume_spike = (volume_change > 2).astype(int)
    
    # Combine Factors
    factor = (intraday_reversal - ema_intraday_reversal) * volume_spike
    
    # Apply SMA over 5 days and exclude the most recent value
    final_factor = factor.rolling(window=5).mean().shift(1)
    
    return final_factor
```
