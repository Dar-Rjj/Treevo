```python
import pandas as pd

def heuristics_v2(df):
    # Momentum Factors
    df['SMA_10_Close'] = df['close'].rolling(window=10).mean()
    df['ROC_SMA_10_Close_30'] = (df['SMA_10_Close'] / df['SMA_10_Close'].shift(30) - 1) * 100
    
    df['SMA_10_Volume'] = df['volume'].rolling(window=10).mean()
    df['ROC_SMA_10_Volume_30'] = (df['SMA_10_Volume'] / df['SMA_10_Volume'].shift(30) - 1) * 100
    
    # Volatility Factors
    df['Prev_Close'] = df['close'].shift(1)
    df['TR'] = df[['high', 'low', 'Prev_Close']].apply(lambda x: max(x[0] - x[1], abs(x[0] - x[2]), abs(x[1] - x[2])), axis=1)
    df['ATR_20'] = df['TR'].rolling(window=20).mean()
    
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Volume_Volatility_20'] = df['Volume_Change'].rolling(window=20).std()
    
    # Trend Strength Factors
    df['+DM'] = df['high'] - df['high'].shift(1)
    df['-DM'] = df['low'].shift(1) - df['low']
    df['+DM'] = df['+DM'].apply(lambda x: x if x > 0 else 0)
    df['-DM'] = df['-DM'].apply(lambda x: x if x > 0 else 0)
    
    df['+DM_14'] = df['+DM'].rolling(window=14).sum()
    df['-DM_14'] = df['-DM'].rolling(window=14).sum()
    
    df['+DI'] = 100 * (df['+DM_14'] / df['ATR_20'])
    df['-DI'] = 100 * (df['-DM_14'] / df['ATR_20'])
    
    df['DX'] = 100 * (abs(df['+DI'] - df['-DI']) / (df['+DI'] + df['-DI']))
    df['ADX'] = df['DX'].ewm(span=20, adjust=False).mean()
    
    df['TP'] = (df['high'] + df['low'] + df['close']) / 3
    df['SMA_25_TP'] = df['TP'].rolling(window=25).mean()
    df['MAD_25_TP'] = df['TP'].rolling(window=25).apply(lambda x: x.mad())
    df['CCI'] = (df['TP'] - df['SMA_25_TP']) / (0.015 * df['MAD_25_TP'])
    
    # Market Sentiment Factors
    df['Average_Close_252'] = df['close'].rolling(window=252).mean()
    df['RSL'] = df['close'] / df['Average_Close_252']
    
    df['TP'] = (df['high'] + df['low'] + df['close']) / 3
    df['MF'] = df['TP'] * df['volume']
    df['Positive_MF'] = df['MF'].where(df['MF'] > df['MF'].shift(1), 0).rolling(window=20).sum()
    df['Negative_MF'] = df['MF'].where(df['MF'] < df['MF'].shift(1), 0).rolling(window=20).sum()
    df['MFI'] = 100 - (100 / (1 + (df['Positive_MF'] / -df['Negative_MF'])))
    
    # Liquidity Factors
    df['Avg_Volume_25'] = df['volume'].rolling(window=25).mean()
    df['Volume_Turnover_Ratio'] = df['volume'] / df['Avg_Volume_25']
    
    df['Dollar_Volume'] = df['close'] * df['volume']
    
    # Combine factors into a single alpha factor
    df['Alpha_Factor'] = (
        df['ROC_SMA_10_Close_30'] +
        df['ROC_SMA_10_Volume
