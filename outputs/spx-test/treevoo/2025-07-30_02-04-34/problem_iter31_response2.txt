```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum Factors
    df['short_term_momentum'] = (df['close'] / df['close'].shift(1)) - 1
    df['medium_term_momentum'] = (df['close'] / df['close'].shift(20)) - 1
    df['long_term_momentum'] = (df['close'] / df['close'].shift(252)) - 1
    
    # Volatility Indicators
    df['price_range'] = df['high'] - df['low']
    
    def average_true_range(data, window=14):
        tr = data['high'] - data['low']
        atr = tr.rolling(window=window).mean()
        return atr
    
    df['atr_14'] = average_true_range(df)
    
    def historical_volatility(data, window=20):
        log_returns = np.log(data['close'] / data['close'].shift(1))
        volatility = log_returns.rolling(window=window).std() * np.sqrt(252)
        return volatility
    
    df['hist_vol_20'] = historical_volatility(df)
    
    # Volume Trends
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['relative_volume'] = df['volume'] / df['volume'].rolling(window=30).mean()
    
    # Market Sentiment
    df['bullish_bearish_candles'] = (df['close'] > df['open']).astype(int)
    
    def reversal_signals(data):
        signals = pd.Series(0, index=data.index)
        signals[(data['close'] < data['open']) & (data['close'].shift(1) > data['open'].shift(1))] = -1
        signals[(data['close'] > data['open']) & (data['close'].shift(1) < data['open'].shift(1))] = 1
        return signals
    
    df['reversal_signals'] = reversal_signals(df)
    
    # Technical Indicators
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['sma_200'] = df['close'].rolling(window=200).mean()
    
    def sma_crosses(data):
        crosses = pd.Series(0, index=data.index)
        crosses[(data['sma_50'] > data['sma_200']) & (data['sma_50'].shift(1) < data['sma_200'].shift(1))] = 1
        crosses[(data['sma_50'] < data['sma_200']) & (data['sma_50'].shift(1) > data['sma_200'].shift(1))] = -1
        return crosses
    
    df['sma_crosses'] = sma_crosses(df)
    
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    
    df['bollinger_middle_band'] = df['close'].rolling(window=20).mean()
    df['bollinger_std'] = df['close'].rolling(window=20).std()
    df['bollinger_upper_band'] = df['bollinger_middle_band'] + 2 * df['bollinger_std']
    df['bollinger_lower_band'] = df['bollinger_middle_band'] - 2 * df['bollinger_std']
    df['bollinger_bandwidth'] = (df['bollinger_upper_band'] - df['bollinger_lower_band']) / df['bollinger_middle_band']
    
    # Liquidity
    df['turnover_ratio'] = df['amount'] / df['amount'].rolling(window=30).mean()
    
    # Value
    df['price_to_average_ratio'] = df['close'] / df['close'].rolling(window=20).mean()
    
    # Pattern Recognition
    df['doji'] = ((np.abs(df['close'] - df['open']) <= 0.1 * (df['high'] - df['low']))).astype(int)
    
    # Combine Factors
    factors = [
        'short_term_momentum', 'medium_term_momentum', 'long_term_momentum',
        'price_range
