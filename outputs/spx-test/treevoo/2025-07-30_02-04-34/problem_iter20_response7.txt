```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-Based Factor
    short_term_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    long_term_momentum = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    momentum_difference = short_term_momentum - long_term_momentum

    # Volume-Based Factor
    volume_change = df['volume'] - df['volume'].shift(1)
    average_volume = df['volume'].rolling(window=5).mean()
    volume_ratio = df['volume'] / df['volume'].shift(1)
    enhanced_volume_change = volume_change * volume_ratio

    # Price Action Factor
    high_low_range = df['high'] - df['low']
    open_close_spread = df['close'] - df['open']
    high_close_spread = df['high'] - df['close']
    price_action_factor = (open_close_spread / high_low_range) - high_close_spread

    # Intraday Analysis
    intraday_high_low_spread = df['high'] - df['low']
    close_open_spread = df['close'] - df['open']
    smoothed_intraday_return = (intraday_high_low_spread / df['close']).ewm(span=5, adjust=False).mean().shift(1)
    
    average_volume_5 = df['volume'].rolling(window=5).mean()
    intraday_momentum_difference = smoothed_intraday_return * (1 / average_volume_5)
    
    volume_change_last_25 = (df['volume'] - df['volume'].shift(1)).rolling(window=25).mean()
    volume_spike = (df['volume'] - df['volume'].shift(1) > 1.75 * volume_change_last_25).astype(int)
    
    combined_intraday_factor = (intraday_momentum_difference * volume_spike).rolling(window=4).mean().shift(1)

    # Composite Factor
    weighted_factors = 0.4 * momentum_difference + 0.3 * enhanced_volume_change + 0.3 * price_action_factor

    # Final Alpha Signal
    final_alpha = (short_term_momentum * long_term_momentum) * enhanced_volume_change + combined_intraday_factor

    return final_alpha
```
