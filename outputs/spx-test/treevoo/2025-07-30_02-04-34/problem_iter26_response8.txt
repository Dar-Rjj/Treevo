```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday High-Low Spread
    intraday_high_low_spread = df['high'] - df['low']
    
    # Calculate Close-Open Spread
    close_open_spread = df['close'] - df['open']
    
    # Calculate Smoothed Intraday Return
    intraday_return = (df['high'] - df['low']) / df['close']
    smoothed_intraday_return = intraday_return.ewm(span=5).mean().shift(1)
    
    # Incorporate Volume Intensity
    average_volume = df['volume'].rolling(window=10).mean()
    volume_intensity = 1 / average_volume
    intraday_momentum_with_volume = intraday_return * volume_intensity
    
    # Detect Volume Spikes
    volume_change = df['volume'].pct_change()
    average_volume_change = volume_change.rolling(window=20).mean()
    volume_spike = (volume_change > 3 * average_volume_change).astype(int)
    
    # Combine Intraday Momentum and Volume Impact
    combined_factor = intraday_momentum_with_volume * volume_spike
    smoothed_combined_factor = combined_factor.rolling(window=4).mean().shift(1)
    
    # Analyze Price and Volume Relationship
    price_change = df['close'].pct_change()
    volume_change = df['volume'].pct_change()
    divergence = (price_change * volume_change < 0).astype(int).rolling(window=10).sum()
    
    # Compute Price-Velocity Factor
    price_velocity = (df['close'] - df['open']) / (df['high'] - df['low'])
    smoothed_price_velocity = price_velocity.ewm(span=5).mean()
    
    # Evaluate Combined Momentum and Price-Velocity
    combined_momentum_price_velocity = smoothed_intraday_return * smoothed_price_velocity
    final_smoothed_momentum = combined_momentum_price_velocity.ewm(span=5).mean()
    
    # Final Alpha Signal
    final_alpha_signal = final_smoothed_momentum + smoothed_combined_factor
    threshold = 0.001
    final_alpha_signal = final_alpha_signal.where(final_alpha_signal.abs() > threshold, 0)
    final_alpha_signal -= (divergence > 2) * final_alpha_signal
    
    # Final Signal Smoothing
    final_alpha_signal = final_alpha_signal.rolling(window=3).mean().shift(1)
    
    return final_alpha_signal
```
