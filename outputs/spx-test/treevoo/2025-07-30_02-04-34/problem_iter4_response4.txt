```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    intraday_return = (df['high'] - df['low']) / df['low']
    
    # Smooth Intraday Return using EMA with span 5, excluding the latest value
    intraday_return_ema = intraday_return.ewm(span=5, adjust=False).mean().shift(1)
    
    # Calculate Volume Change
    volume_change = df['volume'].pct_change()
    
    # Identify Spike: If volume change is greater than 1.5 times average of last 20 days
    avg_volume_change = volume_change.rolling(window=20).mean()
    spike = (volume_change > 1.5 * avg_volume_change).astype(int)
    
    # Combine Factors: Multiply Intraday Momentum Difference by Volume Spike
    combined_factor = intraday_return_ema * spike
    
    # Apply Simple Moving Average (SMA) over 3 days, excluding the most recent value
    final_factor = combined_factor.rolling(window=3).mean().shift(1)
    
    return final_factor
```
