```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-Based Factor
    short_term_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    long_term_momentum = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    momentum_difference = short_term_momentum - long_term_momentum

    # Volume-Based Factor
    volume_change = df['volume'] - df['volume'].shift(1)
    average_volume_5_days = df['volume'].rolling(window=5).mean()
    volume_change_factor = volume_change / average_volume_5_days

    # Price Action Factor
    daily_range = df['high'] - df['low']
    daily_spread = df['close'] - df['open']
    price_action_factor = daily_spread / daily_range

    # Intraday Analysis
    intraday_high_low_spread = df['high'] - df['low']
    close_open_spread = df['close'] - df['open']
    smoothed_intraday_return = (intraday_high_low_spread / df['close']).ewm(span=5).mean().shift(1)
    average_volume_change = (df['volume'] - df['volume'].shift(1)).rolling(window=20).mean()
    volume_spike = (volume_change > 2 * average_volume_change).astype(int)
    smoothed_intraday_return_with_spike = smoothed_intraday_return * volume_spike.rolling(window=4).mean().shift(1)

    # Composite Factor
    composite_factor = (
        0.4 * momentum_difference +
        0.3 * volume_change_factor +
        0.1 * price_action_factor +
        0.2 * smoothed_intraday_return_with_spike
    )

    return composite_factor.dropna()
```
