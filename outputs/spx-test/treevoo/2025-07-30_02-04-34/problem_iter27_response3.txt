```python
import pandas as pd

def heuristics_v2(df):
    # Short-term and long-term momentum
    short_term_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    long_term_momentum = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    momentum_difference = short_term_momentum - long_term_momentum
    
    # Volume change and average volume
    volume_change = df['volume'] - df['volume'].shift(1)
    average_volume = df['volume'].rolling(window=5).mean()
    volume_variance = df['volume'].rolling(window=10).var()
    volume_factor = (volume_change / average_volume) - volume_variance
    
    # Price action factors
    daily_range = df['high'] - df['low']
    daily_spread = df['close'] - df['open']
    gap_up_or_down = (df['open'] - df['close'].shift(1)) / df['close'].shift(1)
    price_action_factor = (daily_spread / daily_range) + gap_up_or_down
    
    # Composite factor
    composite_factor = (0.4 * momentum_difference) + (0.3 * volume_factor) + (0.3 * price_action_factor)
    
    return composite_factor
```
