```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    intraday_return = (df['high'] - df['low']) / df['open']
    
    # Smooth Intraday Return using EMA with span of 5, excluding the latest value
    ema_intraday_return = intraday_return.ewm(span=5, adjust=False).mean().shift(1)
    intraday_momentum_diff = intraday_return - ema_intraday_return
    
    # Detect Volume Spikes
    volume_change = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    volume_spike_indicator = volume_change > 1.5 * volume_change.rolling(window=20).mean()
    
    # Combine Factors
    combined_factor = intraday_momentum_diff * volume_spike_indicator.astype(int)
    
    # Smooth the combined factor using SMA with window size of 3, excluding the most recent value
    final_factor = combined_factor.rolling(window=3).mean().shift(1)
    
    return final_factor
```
