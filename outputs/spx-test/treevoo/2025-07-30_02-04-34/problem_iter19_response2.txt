```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum Factors
    df['price_momentum'] = df['close'].pct_change(20)
    df['volume_momentum'] = df['volume'].pct_change(20)
    
    # Volatility Factors
    df['true_range'] = df[['high', 'low', 'close']].apply(
        lambda x: max(x[0] - x[1], abs(x[0] - df['close'].shift(1)), abs(x[1] - df['close'].shift(1))), axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    df['volume_volatility'] = df['volume'].diff().rolling(window=14).std()
    
    # Trend Strength Factors
    df['+dm'] = 0
    df['-dm'] = 0
    df.loc[(df['high'] > df['high'].shift(1)) & (df['high'] - df['high'].shift(1) > df['low'].shift(1) - df['low']), '+dm'] = df['high'] - df['high'].shift(1)
    df.loc[(df['low'].shift(1) > df['low']) & (df['low'].shift(1) - df['low'] > df['high'] - df['high'].shift(1)), '-dm'] = df['low'].shift(1) - df['low']
    
    df['+di'] = df['+dm'].ewm(span=14, adjust=False).mean() / df['atr_14']
    df['-di'] = df['-dm'].ewm(span=14, adjust=False).mean() / df['atr_14']
    
    df['dx'] = 100 * (abs(df['+di'] - df['-di']) / (df['+di'] + df['-di']))
    df['adx'] = df['dx'].ewm(span=14, adjust=False).mean()
    
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['sma_20_tp'] = df['typical_price'].rolling(window=20).mean()
    df['mad_20_tp'] = df['typical_price'].rolling(window=20).apply(lambda x: np.mean(np.abs(x - np.mean(x))), raw=True)
    df['cci'] = (df['typical_price'] - df['sma_20_tp']) / (0.015 * df['mad_20_tp'])
    
    # Market Sentiment Factors
    df['rsl'] = df['close'] / df['close'].rolling(window=252).mean()
    
    df['tp'] = (df['high'] + df['low'] + df['close']) / 3
    df['mf'] = df['tp'] * df['volume']
    df['positive_mf'] = df['mf'].where(df['mf'] > df['mf'].shift(1), 0).rolling(window=14).sum()
    df['negative_mf'] = df['mf'].where(df['mf'] < df['mf'].shift(1), 0).rolling(window=14).sum()
    df['mfi'] = 100 - (100 / (1 + (df['positive_mf'] / -df['negative_mf'])))
    
    # Liquidity Factors
    df['dollar_volume'] = df['close'] * df['volume']
    
    # Return the factors as a DataFrame
    return df[['price_momentum', 'volume_momentum', 'atr_14', 'volume_volatility', 'adx', 'cci', 'rsl', 'mfi', 'dollar_volume']]
```
