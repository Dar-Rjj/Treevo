```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum-Based Factor
    short_term_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    long_term_momentum = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    momentum_difference = short_term_momentum - long_term_momentum
    
    # Volume-Based Factor
    volume_change = df['volume'] - df['volume'].shift(1)
    average_volume = df['volume'].rolling(window=5).mean()
    volume_change_factor = volume_change / average_volume
    
    # Price Action Factor
    daily_range = df['high'] - df['low']
    daily_spread = df['close'] - df['open']
    price_action_factor = daily_spread / daily_range
    
    # Intraday Analysis
    intraday_return = (df['high'] - df['low']) / df['close']
    smoothed_intraday_return = intraday_return.ewm(span=5, adjust=False).mean().shift(1)
    
    average_volume_change = (df['volume'] - df['volume'].shift(1)).rolling(window=20).mean()
    volume_spike = (volume_change > 2 * average_volume_change).astype(int)
    smoothed_intraday_return_with_spike = smoothed_intraday_return * volume_spike
    smoothed_intraday_return_with_spike = smoothed_intraday_return_with_spike.rolling(window=4).mean().shift(1)
    
    next_day_open_minus_close = df['open'].shift(-1) - df['close']
    
    # Composite Factor
    composite_factor = (
        0.4 * momentum_difference + 
        0.3 * volume_change_factor + 
        0.1 * price_action_factor + 
        0.2 * smoothed_intraday_return_with_spike
    )
    
    return composite_factor

# Example usage
# df = pd.read_csv('your_data.csv', parse_dates=True, index_col='date')
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
