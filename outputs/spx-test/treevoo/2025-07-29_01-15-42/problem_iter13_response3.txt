```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the daily price change
    daily_price_change = df['close'] - df['open']
    
    # Calculate the 7-day and 21-day average of daily price changes
    avg_7day_price_change = daily_price_change.rolling(window=7).mean()
    avg_21day_price_change = daily_price_change.rolling(window=21).mean()
    
    # Combine averages to identify long-term momentum
    long_term_momentum = avg_21day_price_change - avg_7day_price_change
    
    # Measure the distance between high and low
    high_low_range = df['high'] - df['low']
    
    # Calculate the 5-day average high-low range
    avg_5day_high_low_range = high_low_range.rolling(window=5).mean()
    
    # Evaluate the ratio of today's range to its 5-day average
    reversal_signal = (high_low_range / avg_5day_high_low_range) - 1
    
    # Compute the daily return
    daily_return = (df['close'] - df['open']) / df['open']
    
    # Calculate the product of daily return and volume
    volume_impact = daily_return * df['volume']
    
    # Smooth the volume impact with a 10-day moving average
    smoothed_volume_impact = volume_impact.rolling(window=10).mean()
    
    # Create a composite score from identified signals
    composite_score = (long_term_momentum + reversal_signal + smoothed_volume_impact) / 3
    
    return composite_score
```
