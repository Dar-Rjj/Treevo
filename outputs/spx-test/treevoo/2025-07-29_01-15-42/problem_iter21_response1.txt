```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the percentage change in closing price from one day to the next
    df['close_pct_change'] = df['close'].pct_change()
    
    # Introduce a smoothing factor to the percentage change to reduce noise
    df['smoothed_close_pct_change'] = df['close_pct_change'].rolling(window=10).mean()
    
    # Examine the average of the past n days' closing prices
    df['sma_50'] = df['close'].rolling(window=50).mean()
    
    # Determine if todayâ€™s closing price is above or below the moving average
    df['above_sma'] = (df['close'] > df['sma_50']).astype(int)
    
    # Introduce a threshold to filter out minor deviations from the moving average
    df['above_sma_threshold'] = ((df['close'] - df['sma_50']) / df['sma_50'] > 0.05).astype(int)
    
    # Calculate the ratio of today's volume to the average volume over the past n days
    df['avg_vol_50'] = df['volume'].rolling(window=50).mean()
    df['vol_ratio'] = df['volume'] / df['avg_vol_50']
    
    # Consider the direction of the price change in conjunction with the volume ratio
    df['high_vol_positive'] = (df['vol_ratio'] > 2) & (df['close_pct_change'] > 0)
    df['high_vol_negative'] = (df['vol_ratio'] > 2) & (df['close_pct_change'] < 0)
    
    # Check if a high volume day is accompanied by a large price change
    df['price_vol_convergence'] = (df['vol_ratio'] > 2) & (df['close_pct_change'].abs() > 0.05)
    
    # Calculate the average true range (ATR) over the past n days
    df['tr'] = df[['high', 'low', 'close']].diff().abs().max(axis=1)
    df['atr_14'] = df['tr'].rolling(window=14).mean()
    
    # Combine ATR with the percentage change in closing price to create a volatility-adjusted momentum indicator
    df['vol_adj_momentum'] = df['close_pct_change'] / df['atr_14']
    
    # Calculate the percentage of the daily range that the closing price covers
    df['range_percent'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    
    # Introduce a threshold to categorize the relative position of the close within the range
    df['close_near_high'] = (df['range_percent'] > 0.8).astype(int)
    df['close_near_low'] = (df['range_percent'] < 0.2).astype(int)
    
    # Extend PVT to include the difference between the current day's PVT and its moving average
    df['pvt'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1) * df['volume']
    df['pvt_ma_10'] = df['pvt'].rolling(window=10).mean()
    df['pvt_diff'] = df['pvt'] - df['pvt_ma_10']
    
    # Investigate the trend of the amount by comparing it with its own moving average
    df['amount_ma_10'] = df['amount'].rolling(window=10).mean()
    df['amount_trend'] = (df['amount'] - df['amount_ma_10']) / df['amount_ma_10']
    
    # Combine multiple indicators for a more robust signal
    df['composite_score'] = (
        0.3 * df['smoothed_close_pct_change'] +
        0.2 * df['above_sma_threshold'] +
        0.1 * df['vol_adj_momentum'] +
        0.1 * df['price_vol_convergence'].astype(int) +
        0.1 * df['pvt_diff'] +
        0.1 * df['amount_trend']
    )
    
    return df['composite_score']
```
