```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the relative difference between the close and open prices
    df['close_open_diff'] = df['close'] - df['open']
    
    # Calculate the range of the high-low prices
    df['high_low_range'] = df['high'] - df['low']
    
    # Determine if the closing price is closer to the high or low
    df['close_to_high'] = (df['high'] - df['close']) / df['high_low_range']
    
    # Calculate the volume weighted by the close price
    df['volume_weighted_close'] = df['volume'] * df['close']
    
    # Generate a signal based on the combination of the above
    factor = df['close_open_diff'] * df['close_to_high'] * df['volume_weighted_close']
    
    return factor
```
