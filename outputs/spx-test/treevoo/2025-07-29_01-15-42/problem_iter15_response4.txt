```python
import pandas as pd

def heuristics_v2(df, n=10):
    # Calculate the percentage change in closing price from one day to the next
    df['close_pct_change'] = df['close'].pct_change()
    
    # Calculate the n-day moving average of the closing price
    df['ma_close'] = df['close'].rolling(window=n).mean()
    
    # Determine if todayâ€™s closing price is above or below the moving average
    df['above_ma'] = (df['close'] > df['ma_close']).astype(int)
    
    # Calculate the ratio of today's volume to the average volume over the past n days
    df['avg_vol'] = df['volume'].rolling(window=n).mean()
    df['vol_ratio'] = df['volume'] / df['avg_vol']
    
    # Check if a high volume day is accompanied by a large price change
    df['high_vol_large_change'] = ((df['vol_ratio'] > 1.5) & (df['close_pct_change'].abs() > 0.01)).astype(int)
    
    # Calculate the average true range (ATR) over the past n days
    df['tr'] = df[['high', 'low']].diff(axis=1).max(axis=1)
    df['atr'] = df['tr'].rolling(window=n).mean()
    
    # Calculate the percentage of the daily range that the closing price covers
    df['range'] = df['high'] - df['low']
    df['close_range_pct'] = (df['close'] - df['low']) / df['range']
    
    # Create a composite score based on the above indicators
    df['composite_score'] = (
        df['close_pct_change'] * 0.3 +
        df['above_ma'] * 0.2 +
        df['vol_ratio'] * 0.1 +
        df['high_vol_large_change'] * 0.1 +
        df['atr'] * 0.1 +
        df['close_range_pct'] * 0.2
    )
    
    # Return the composite score as the factor values
    return df['composite_score']

# Example usage:
# df = pd.read_csv('stock_data.csv')
# df.set_index('date', inplace=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
