```python
import pandas as pd

def heuristics_v2(df):
    # Compute simple moving averages (SMA)
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_100'] = df['close'].rolling(window=100).mean()

    # Derive momentum factors from SMAs
    df['Momentum_5_20'] = df['SMA_5'] - df['SMA_20']
    df['Momentum_10_50'] = df['SMA_10'] - df['SMA_50']
    df['Momentum_20_100'] = df['SMA_20'] - df['SMA_100']

    # Calculate true range (TR)
    df['TR'] = df[['high', 'low', 'close']].apply(lambda x: max(x[0] - x[1], abs(x[0] - df['close'].shift(1)), abs(x[1] - df['close'].shift(1))), axis=1)

    # Compute average true range (ATR) over a period
    df['ATR_14'] = df['TR'].rolling(window=14).mean()

    # Calculate on-balance volume (OBV)
    df['OBV'] = 0
    df.loc[df['close'] > df['close'].shift(1), 'OBV'] = df['volume']
    df.loc[df['close'] < df['close'].shift(1), 'OBV'] = -df['volume']
    df['OBV'] = df['OBV'].cumsum()

    # Compute volume weighted average price (VWAP)
    df['VWAP'] = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()

    # Create composite factors
    df['Composite_SMA_ATR'] = (df['Momentum_5_20']) / df['ATR_14']
    df['Composite_OBV_VWAP'] = (df['OBV'] / df['VWAP']) * (df['close'] - df['VWAP'])

    # Return the final composite factor
    return df['Composite_SMA_ATR'] + df['Composite_OBV_VWAP']
```
