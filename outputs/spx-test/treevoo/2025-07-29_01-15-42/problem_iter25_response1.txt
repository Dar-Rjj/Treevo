```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the percentage change in closing price from one day to the next
    df['close_pct_change'] = df['close'].pct_change()
    
    # Introduce a smoothing factor to the percentage change to reduce noise
    df['smoothed_close_pct_change'] = df['close_pct_change'].ewm(span=5, adjust=False).mean()
    
    # Compare today's closing price with the moving average of the past n days
    df['close_ma_10'] = df['close'].rolling(window=10).mean()
    df['close_above_ma'] = (df['close'] > df['close_ma_10']).astype(int)
    
    # Calculate the ratio of today's volume to the average volume over the past n days
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=10).mean()
    
    # Analyze the relationship between high-low range and closing price
    df['high_low_range'] = df['high'] - df['low']
    df['close_high_ratio'] = (df['close'] - df['low']) / df['high_low_range']
    
    # Calculate the average true range (ATR) over the past n days
    df['tr'] = df[['high', 'low']].apply(lambda x: max(x), axis=1) - df[['high', 'low']].apply(lambda x: min(x), axis=1)
    df['atr_10'] = df['tr'].rolling(window=10).mean()
    
    # Volatility-adjusted momentum indicator
    df['vol_adj_momentum'] = df['close_pct_change'] / df['atr_10']
    
    # Extend Price-Volume Trend (PVT)
    df['pvt'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1) * df['volume']
    df['pvt_ma_10'] = df['pvt'].rolling(window=10).mean()
    df['pvt_diff'] = df['pvt'] - df['pvt_ma_10']
    
    # Investigate the trend of the amount by comparing it with its own moving average
    df['amount_ma_10'] = df['amount'].rolling(window=10).mean()
    df['amount_trend'] = (df['amount'] > df['amount_ma_10']).astype(int)
    
    # Create a composite score based on the above indicators
    df['composite_score'] = (
        0.3 * df['smoothed_close_pct_change'] +
        0.2 * df['close_above_ma'] +
        0.1 * (df['volume_ratio'] * df['close_pct_change']) +
        0.1 * df['close_high_ratio'] +
        0.15 * df['vol_adj_momentum'] +
        0.1 * df['pvt_diff'] +
        0.05 * df['amount_trend']
    )
    
    # Momentum-based alpha factor that captures the direction and strength of the move from open to close
    df['open_close_change'] = df['close'] - df['open']
    df['composite_score'] += 0.1 * (df['open_close_change'] / df['close'])
    
    return df['composite_score']

# Example usage:
# df = pd.DataFrame(data, index=index, columns=['open', 'high', 'low', 'close', 'volume', 'amount'])
# alpha_factor = heuristics_v2(df)
```
