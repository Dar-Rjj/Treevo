```python
import pandas as pd
import numpy as np

def heuristics_v2(df, threshold=0.5, sma_window=20, rtsi_window=14):
    # Calculate Daily Price Range
    df['price_range'] = df['high'] - df['low']
    
    # Compute Moving Average Volume (Last 20 Days)
    df['avg_vol'] = df['volume'].rolling(window=sma_window).mean()
    
    # Volume-Adjusted Price Range
    df['vol_adj_price_range'] = df['price_range'] / df['avg_vol']
    
    # Identify Price-Volume Imbalances
    df['imbalance'] = np.where(df['vol_adj_price_range'] > threshold, 1,
                                np.where(df['vol_adj_price_range'] < -threshold, -1, 0))
    
    # Generate Preliminary Alpha Signal
    df['alpha_signal'] = df['imbalance'].copy()
    
    # Calculate Intraday High-Low Spread
    df['intraday_high_low_spread'] = df['high'] - df['low']
    
    # Calculate Close-to-Open Movement
    df['close_to_open'] = df['close'] - df['open'].shift(1)
    
    # Weighted Intraday Components (simple equal weights for example)
    df['weighted_intraday'] = 0.5 * df['intraday_high_low_spread'] + 0.5 * df['close_to_open']
    
    # Calculate Momentum Score
    df['momentum_score'] = df['weighted_intraday'] - df['weighted_intraday'].shift(1)
    
    # Calculate Realized Volatility (20-Day Rolling Window, Close Price)
    df['realized_volatility'] = df['close'].pct_change().rolling(window=sma_window).std() * np.sqrt(sma_window)
    
    # Median of Realized Volatility
    df['realized_vol_median'] = df['realized_volatility'].rolling(window=sma_window).median()
    
    # Final Alpha Signal
    conditions = [
        (df['imbalance'] == 1) & (df['realized_volatility'] < df['realized_vol_median']),
        (df['imbalance'] == -1) & (df['realized_volatility'] < df['realized_vol_median']),
        (df['imbalance'] == 0)
    ]
    choices = [
        df['alpha_signal'] + df['momentum_score'],
        df['alpha_signal'] - df['momentum_score'],
        df['momentum_score']
    ]
    df['final_alpha_signal'] = np.select(conditions, choices, default=0)
    
    # Adjust by Volume
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['vol_adj_high_low_range'] = df['intraday_high_low_spread'] * df['volume_change']
    
    # Relative True Strength Index (RTSI)
    df['close_diff'] = df['close'].diff()
    df['gains'] = np.where(df['close_diff'] > 0, df['close_diff'], 0)
    df['losses'] = np.where(df['close_diff'] < 0, -df['close_diff'], 0)
    df['avg_gain'] = df['gains'].rolling(window=rtsi_window).mean()
    df['avg_loss'] = df['losses'].rolling(window=rtsi_window).mean()
    df['rtsi'] = (df['avg_gain'] / (df['avg_gain'] + df['avg_loss'])) * 100
    
    # Daily Price Change (Close-to-Close Return)
    df['daily_return'] = df['close'].pct_change()
    
    # Volume-Adjusted Momentum Score
    df['summarized_volume'] = df['volume'].rolling(window=sma_window).mean()
    df['vol_adj_momentum_score'] = df['daily_return'] / df['summarized_volume']
    
    # Combine Factors
    df['combined_factor'] = (df['vol_adj_high_low_range'] * df['rtsi']) * df['vol_adj_momentum_score']
    
    return df['combined_factor']

# Example usage:
# df = pd.DataFrame({
#     'date': pd.date_range(start='2023-01-01', periods=100),
#     'open': np.random.rand(100) * 100,
#     'high': np.random.rand(100) * 110,
#     'low': np.random.rand(100) * 90,
#     'close': np.random.rand(100) * 100,
#     'volume': np.random.randint(
