def heuristics_v2(df):
    def heuristic_calculation(row, avg_high_low, prev_volume):
        return (row['close'] - avg_high_low) * (row['volume'] / prev_volume)
    
    df['avg_high_low'] = df[['high', 'low']].mean(axis=1).rolling(window=5).mean()
    df['prev_volume'] = df['volume'].shift(1)
    heuristics_matrix = df.apply(lambda row: heuristic_calculation(row, row['avg_high_low'], row['prev_volume']), axis=1)
    
    return heuristics_matrix
