def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    # Shift the daily return to align with the prediction target
    df['next_day_return'] = df['daily_return'].shift(-1)
    # Volume-weighted price change
    df['vwp_change'] = ((df['close'] - df['open']) / (df['high'] - df['low'])) * df['volume']
    # Daily return weighted by volume
    df['return_by_volume'] = df['daily_return'] * df['volume']
    # Heuristic factor: average of smoothed volume-weighted price change and return by volume
    df['heuristic_factor'] = (df['vwp_change'].rolling(window=5).mean() + df['return_by_volume'].rolling(window=5).mean()) / 2
    # Prepare the heuristics matrix
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
