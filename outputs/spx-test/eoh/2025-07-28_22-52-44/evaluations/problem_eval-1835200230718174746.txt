import pandas as pd
import numpy as np

def heuristics_v2(df):
    hl_ratio = df['high'] / df['low']
    weights = np.log(df['close'])
    weighted_hl_ratio_ema = (hl_ratio * weights).ewm(span=30).mean()
    weighted_close_ema = (df['close'] * weights).ewm(span=30).mean()
    heuristics_matrix = weighted_hl_ratio_ema / weighted_close_ema
    return heuristics_matrix
