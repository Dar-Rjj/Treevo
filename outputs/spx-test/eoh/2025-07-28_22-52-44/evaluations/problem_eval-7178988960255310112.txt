def heuristics_v2(df):
    def weighted_price_change(window):
        return (df['close'] - df['open']).rolling(window=window).mean() * (df['volume'].rolling(window=window).mean())
    
    factors = [weighted_price_change(5), weighted_price_change(10), weighted_price_change(20)]
    heuristics_matrix = pd.Series(factors[0] * 0.4 + factors[1] * 0.3 + factors[2] * 0.3, name='heuristics_factor')
    return heuristics_matrix
