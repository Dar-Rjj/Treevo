def heuristics_v2(df):
    # Calculate the absolute difference between consecutive days' close prices
    abs_diff = df['close'].diff().abs()
    # Calculate the exponential weighted average of the absolute differences with a span of 30 days
    ewm_abs_diff = abs_diff.ewm(span=30).mean()
    # Calculate the simple moving average of the close prices over a 30-day window
    sma_close = df['close'].rolling(window=30).mean()
    # Calculate the ratio of the exponential weighted average of absolute differences to the simple moving average of close prices
    heuristics_matrix = ewm_abs_diff / sma_close
    return heuristics_matrix
