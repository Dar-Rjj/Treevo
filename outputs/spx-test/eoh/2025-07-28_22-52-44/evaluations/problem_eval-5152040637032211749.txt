import numpy as np

def heuristics_v2(df):
    hl_diff = abs(df['high'] - df['low'])
    log_volume = np.log(df['volume'])
    weighted_hl_diff_sum = (hl_diff * log_volume).rolling(window=30).sum()
    weighted_volume_sum = log_volume.rolling(window=30).sum()
    heuristics_matrix = weighted_hl_diff_sum / weighted_volume_sum
    return heuristics_matrix
