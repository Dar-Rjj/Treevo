def heuristics_v2(df):
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    # Separate positive and negative returns
    pos_returns = daily_returns[daily_returns > 0]
    neg_returns = daily_returns[daily_returns < 0]
    # Calculate rolling mean of positive and negative returns
    pos_mean = pos_returns.rolling(window=20).mean().fillna(0)
    neg_mean = neg_returns.rolling(window=20).mean().fillna(0)
    # Calculate the heuristic matrix as the difference between means
    heuristics_matrix = (pos_mean - neg_mean) / 2
    return heuristics_matrix
