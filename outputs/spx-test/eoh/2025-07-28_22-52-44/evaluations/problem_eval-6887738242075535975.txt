def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    # Shift the daily return to align with the prediction target
    df['next_day_return'] = df['daily_return'].shift(-1)
    # Volume-weighted price change
    df['vwp_change'] = ((df['close'] - df['open']) / (df['high'] - df['low'])) * df['volume']
    # Heuristic factor: smoothed volume-weighted price change
    df['heuristic_factor'] = df['vwp_change'].rolling(window=5).mean()
    # Prepare the heuristics matrix
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
