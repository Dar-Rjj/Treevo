def heuristics_v2(df):
    # Calculate MACD with 12 and 26 EMAs
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12 - ema_26
    signal = macd.rolling(window=9).mean()
    
    # Calculate 10-day return standard deviation
    daily_returns = df['close'].pct_change()
    std_dev = daily_returns.rolling(window=10).std()
    
    # Calculate volume ratio
    avg_vol_5 = df['volume'].rolling(window=5).mean()
    vol_ratio = df['volume'] / avg_vol_5
    
    # Combine factors
    heuristics_matrix = 0.4 * (macd - signal) + 0.4 * std_dev + 0.2 * vol_ratio
    return heuristics_matrix
