import pandas as pd

def heuristics_v2(df):
    def macd(series, n_fast=12, n_slow=26, n_signal=9):
        exp_fast = series.ewm(span=n_fast, adjust=False).mean()
        exp_slow = series.ewm(span=n_slow, adjust=False).mean()
        macd_line = exp_fast - exp_slow
        signal_line = macd_line.ewm(span=n_signal, adjust=False).mean()
        return macd_line - signal_line
    
    def rsi(series, periods=14):
        delta = series.diff(1)
        up, down = delta.copy(), delta.copy()
        up[up < 0] = 0
        down[down > 0] = 0
        roll_up = up.rolling(window=periods, min_periods=1).mean()
        roll_down = down.abs().rolling(window=periods, min_periods=1).mean()
        rs = roll_up / roll_down
        return 100.0 - (100.0 / (1.0 + rs))
    
    macd_values = macd(df['close'])
    rsi_values = rsi(df['volume'])
    heuristics_matrix = (macd_values * (rsi_values / 100)).rename('heuristic_factor')
    return heuristics_matrix
