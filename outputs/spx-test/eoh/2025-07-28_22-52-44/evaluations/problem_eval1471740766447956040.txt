def heuristics_v2(df):
    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    # Calculate 10-day EMA of daily returns
    df['ema_10'] = df['daily_return'].ewm(span=10, adjust=False).mean()
    # Volatility measure: standard deviation of daily returns over the last 10 days
    df['volatility'] = df['daily_return'].rolling(window=10).std()
    # Heuristic factor: EMA adjusted by volatility
    df['heuristic_factor'] = df['ema_10'] / (df['volatility'] + 1e-6)  # Adding 1e-6 to avoid division by zero
    # Prepare the heuristics matrix
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
