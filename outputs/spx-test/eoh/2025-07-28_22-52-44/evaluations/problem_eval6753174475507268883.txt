def heuristics_v2(df):
    # Calculate the absolute difference between high and low prices for each day
    hl_diff = abs(df['high'] - df['low'])
    # Calculate the ratio of volume to the absolute high-low difference
    vol_ratio = df['volume'] / hl_diff
    # Apply a 30-day exponentially weighted moving average to smooth out the factor
    heuristics_matrix = vol_ratio.ewm(span=30).mean()
    return heuristics_matrix
