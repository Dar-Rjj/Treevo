def heuristics_v2(df):
    # Calculate the daily return
    daily_return = df['close'].pct_change()
    # Calculate the rolling sum of volumes
    vol_sum = df['volume'].rolling(window=30).sum()
    # Calculate the product of daily return and volume
    ret_vol_product = (daily_return * df['volume']).rolling(window=30).sum()
    # Calculate the weighted average of the daily returns
    heuristics_matrix = ret_vol_product / vol_sum
    return heuristics_matrix
