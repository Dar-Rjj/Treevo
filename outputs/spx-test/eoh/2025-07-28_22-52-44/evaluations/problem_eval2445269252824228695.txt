def heuristics_v2(df):
    # Calculate the ratio of high to low prices
    hl_ratio = df['high'] / df['low']
    # Adjust the ratio by the natural logarithm of the closing price
    adjusted_hl_ratio = hl_ratio * np.log(df['close'])
    # Calculate the 30-day exponential moving average of the adjusted ratio
    heuristics_matrix = adjusted_hl_ratio.ewm(span=30).mean()
    return heuristics_matrix
