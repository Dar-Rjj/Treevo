import pandas as pd

def heuristics_v2(df):
    # Calculate daily return
    daily_return = df['close'].pct_change()
    # Calculate the 20-day average volume
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    # Compute the volume ratio
    volume_ratio = df['volume'] / avg_volume_20
    # Combine daily return and volume ratio
    combined_factor = (daily_return + volume_ratio) / 2
    # Apply a 10-day EMA for smoothing
    heuristics_matrix = combined_factor.ewm(span=10, adjust=False).mean()
    return heuristics_matrix
