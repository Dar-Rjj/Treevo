import numpy as np

def heuristics_v2(df):
    # Calculate the difference between open and close prices for each day
    oc_diff = df['open'] - df['close']
    # Calculate the inverse of the natural logarithm of the volume as the weight
    weights = 1 / np.log(df['volume'])
    # Weighted sum of the open-close differences over a 30-day rolling window
    weighted_oc_diff_sum = (oc_diff * weights).rolling(window=30).sum()
    # Weighted sum of the high prices over the same 30-day rolling window
    weighted_high_sum = (df['high'] * weights).rolling(window=30).sum()
    # Calculate the ratio of the weighted sum of open-close differences to the weighted sum of high prices
    heuristics_matrix = weighted_oc_diff_sum / weighted_high_sum
    return heuristics_matrix
