import pandas as pd

def heuristics_v2(df):
    # Calculate simple returns
    returns = df['close'].pct_change()
    
    # Exponential decay weights for momentum
    weights = [0.15**i for i in range(30)]
    weights = [w/sum(weights) for w in weights]  # Normalize weights to sum to 1
    
    # Calculate the weighted sum of past returns (momentum)
    momentum_factor = returns.rolling(window=30).apply(lambda x: sum(w*r for r, w in zip(x, weights)), raw=False)
    
    # Volume growth rate
    volume_growth = df['volume'].pct_change()
    
    # Combine factors into heuristics matrix
    heuristics_matrix = 0.5 * momentum_factor + 0.5 * volume_growth
    
    return heuristics_matrix
