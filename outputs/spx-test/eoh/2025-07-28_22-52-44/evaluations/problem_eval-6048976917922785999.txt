def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['next_day_return'] = df['daily_return'].shift(-1)
    df['vwp_change'] = ((df['close'] - df['open']) / (df['high'] - df['low'])) * df['volume']
    df['avg_volume'] = df['volume'].rolling(window=5).mean()
    df['return_by_avg_volume'] = df['daily_return'] * df['avg_volume']
    df['ewma_vwp_change'] = df['vwp_change'].ewm(span=5).mean()
    df['heuristic_factor'] = (df['ewma_vwp_change'] + df['return_by_avg_volume'].rolling(window=5).mean()) / 2
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
