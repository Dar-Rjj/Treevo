import pandas as pd
import numpy as np
from scipy.stats import linregress

def heuristics_v2(df):
    # Calculate the 50-day simple moving average
    sma_50 = df['close'].rolling(window=50).mean()
    
    # Calculate the close-to-sma_50 ratio
    close_to_sma_50 = df['close'] / sma_50
    
    # Calculate the volume difference
    volume_diff = df['volume'].diff(1)
    
    # Calculate the slope of the linear regression of the last 15 days' closing prices
    def rolling_slope(series, window=15):
        return series.rolling(window=window).apply(lambda x: linregress(np.arange(len(x)), x)[0])
    slope_15 = rolling_slope(df['close'])
    
    # Combine factors
    heuristics_matrix = close_to_sma_50 + volume_diff + slope_15
    
    return heuristics_matrix
