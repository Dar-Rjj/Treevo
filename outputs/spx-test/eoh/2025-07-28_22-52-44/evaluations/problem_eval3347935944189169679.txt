def heuristics_v2(df):
    # Calculate the percentage change in closing prices
    close_pct_change = df['close'].pct_change()
    # Calculate the product of daily volume and percentage change in closing price
    vol_close_pct_product = close_pct_change * df['volume']
    # Sum the product and the volume over a 50-day rolling window
    vol_close_pct_product_sum = vol_close_pct_product.rolling(window=50).sum()
    vol_sum = df['volume'].rolling(window=50).sum()
    # Calculate the ratio of the sum of the product to the sum of volumes
    heuristics_matrix = vol_close_pct_product_sum / vol_sum
    return heuristics_matrix
