import pandas as pd

def heuristics_v2(df):
    # Momentum Factor
    df['momentum'] = df['close'].pct_change(periods=12)
    
    # Moving Average Crossover
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()
    df['crossover'] = df['SMA_50'] > df['SMA_200']
    
    # Volume Surge
    df['volume_surge'] = df['volume'].pct_change(periods=1) > 0.5
    
    # Composite Heuristic
    df['composite_heuristic'] = (df['momentum'] + df['crossover'].astype(int) + df['volume_surge'].astype(int)) / 3
    
    heuristics_matrix = df['composite_heuristic']
    
    return heuristics_matrix
