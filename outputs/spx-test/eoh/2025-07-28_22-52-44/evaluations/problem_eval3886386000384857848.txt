import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the log ratio of close to open
    log_ratio = np.log(df['close']) - np.log(df['open'])
    # Apply a 14-day exponentially weighted moving average to smooth out the factor
    heuristics_matrix = log_ratio.ewm(span=14).mean()
    return heuristics_matrix
