def heuristics_v2(df):
    atr_20 = df['close'].rolling(window=20).apply(lambda x: talib.ATR(x, df['high'], df['low'], timeperiod=20), raw=False)
    max_close_20 = df['close'].rolling(window=20).max()
    ratio_atr = df['close'] / atr_20
    ratio_max_log = -np.log(df['close'] / max_close_20)
    heuristics_matrix = (ratio_atr + ratio_max_log).dropna()
    return heuristics_matrix
