def heuristics_v2(df):
    def calculate_moving_average(series, window=30):
        return series.rolling(window=window).mean()
    
    df['close_ma'] = calculate_moving_average(df['close'])
    df['heuristic_factor'] = (df['close'] - df['close_ma']).pct_change()
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
