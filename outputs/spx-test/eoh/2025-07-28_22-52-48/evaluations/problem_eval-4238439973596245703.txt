import pandas as pd

def heuristics_v2(df):
    def compute_macd(price_series, n_fast=12, n_slow=26):
        ema_fast = price_series.ewm(span=n_fast, min_periods=n_fast).mean()
        ema_slow = price_series.ewm(span=n_slow, min_periods=n_slow).mean()
        macd = ema_fast - ema_slow
        return macd

    def compute_rsi(price_series, periods=14):
        delta = price_series.diff(1)
        gain = (delta.where(delta > 0, 0)).fillna(0)
        loss = (-delta.where(delta < 0, 0)).fillna(0)
        avg_gain = gain.rolling(window=periods, min_periods=periods).mean()
        avg_loss = loss.rolling(window=periods, min_periods=periods).mean()
        rs = avg_gain / avg_loss
        rsi = 100 - (100 / (1 + rs))
        return rsi

    def compute_obv(close, volume):
        obv = (close.diff() / close.abs().diff()).fillna(0) * volume
        obv = obv.cumsum()
        return obv

    close_prices = df['close']
    volume = df['volume']

    macd_values = compute_macd(close_prices)
    rsi_values = compute_rsi(close_prices)
    obv_values = compute_obv(close_prices, volume)

    # Heuristic matrix: combination of MACD, RSI, and OBV
    heuristics_matrix = (macd_values + rsi_values + obv_values) / 3
    return heuristics_matrix
