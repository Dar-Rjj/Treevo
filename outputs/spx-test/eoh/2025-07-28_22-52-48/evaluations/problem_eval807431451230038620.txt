def heuristics_v2(df):
    avg_volume_30 = df['volume'].rolling(window=30).mean()
    sma_close_10 = df['close'].rolling(window=10).mean()
    sma_close_20 = df['close'].rolling(window=20).mean()
    std_close_10 = df['close'].rolling(window=10).std()
    std_close_20 = df['close'].rolling(window=20).std()
    ratio_volume_log = np.log(df['volume'] / avg_volume_30)
    diff_sma_normalized = (sma_close_10 - sma_close_20) / (std_close_10 + std_close_20)
    heuristics_matrix = (ratio_volume_log + diff_sma_normalized).dropna()
    return heuristics_matrix
