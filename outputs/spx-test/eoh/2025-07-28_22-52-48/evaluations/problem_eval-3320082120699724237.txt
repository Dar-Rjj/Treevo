import pandas as pd

def heuristics_v2(df):
    def compute_obv(close, volume):
        obv = (volume * ((close > close.shift(1)).astype(int) - (close < close.shift(1)).astype(int))).cumsum()
        return obv

    def compute_adx(high, low, close, periods=14):
        plus_dm = high.diff(1)
        minus_dm = low.diff(1)
        plus_dm[plus_dm < 0] = 0
        minus_dm[minus_dm > 0] = 0
        tr = pd.DataFrame({'high-low': high - low, 'high-close': high - close.shift(1), 'low-close': low - close.shift(1)}).max(axis=1)
        atr = tr.rolling(window=periods, min_periods=periods).mean()
        
        plus_di = 100 * (plus_dm.rolling(window=periods, min_periods=periods).sum() / atr)
        minus_di = 100 * (minus_dm.abs().rolling(window=periods, min_periods=periods).sum() / atr)
        
        dx = (abs(plus_di - minus_di) / (plus_di + minus_di)) * 100
        adx = dx.rolling(window=periods, min_periods=periods).mean()
        return adx

    close_prices = df['close']
    high_prices = df['high']
    low_prices = df['low']
    volumes = df['volume']

    obv_values = compute_obv(close_prices, volumes)
    adx_values = compute_adx(high_prices, low_prices, close_prices)

    heuristics_matrix = (obv_values + adx_values) / 2
    return heuristics_matrix
