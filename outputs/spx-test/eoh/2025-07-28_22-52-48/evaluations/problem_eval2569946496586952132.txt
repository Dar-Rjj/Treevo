import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the percentage change over a short window
    pct_change = df.pct_change()
    
    # Define a list of lookback periods for the weighted moving average
    lookbacks = [5, 10, 20]
    
    # Initialize an empty DataFrame for the heuristics matrix
    heuristics_matrix = pd.DataFrame(index=df.index)
    
    # Apply a weighted moving average (WMA) with different lookbacks
    for lookback in lookbacks:
        weights = np.arange(1, lookback+1)
        wma = pct_change.rolling(window=lookback).apply(lambda x: np.dot(x, weights)/weights.sum(), raw=True)
        heuristics_matrix[f'wma_{lookback}'] = wma.mean(axis=1)  # Average across all columns
    
    return heuristics_matrix
