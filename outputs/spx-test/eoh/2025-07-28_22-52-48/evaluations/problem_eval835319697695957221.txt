import pandas as pd

def heuristics_v2(df):
    ema_window = 20
    sma_window = 50
    df['ema_close'] = df['close'].ewm(span=ema_window, min_periods=ema_window).mean()
    df['sma_close'] = df['close'].rolling(window=sma_window, min_periods=sma_window).mean()
    df['volume_roc'] = df['volume'].pct_change()
    heuristics_matrix = (df['ema_close'] - df['sma_close']) * df['volume_roc']
    return heuristics_matrix
