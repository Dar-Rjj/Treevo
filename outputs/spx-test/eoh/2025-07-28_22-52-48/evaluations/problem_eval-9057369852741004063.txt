import pandas as pd
    
    # Step 1: Calculate daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Step 2: Derive momentum and volatility measures
    df['momentum_30'] = df['close'].pct_change(30)
    df['volatility_30'] = df['close'].pct_change().rolling(window=30).std()
    
    # Step 3: Calculate relative strength index (RSI)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Step 4: Create a volume-based factor
    df['volume_change'] = df['volume'].pct_change()
    
    # Step 5: Construct the heuristics matrix as a linear combination of the new factors
    heuristics_matrix = 0.4 * df['momentum_30'] + 0.3 * (100 - df['rsi']) + 0.2 * df['volatility_30'] + 0.1 * df['volume_change']
    
    # Return the heuristics as a Series indexed by date
    return heuristics_matrix
