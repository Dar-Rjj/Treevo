def heuristics_v2(df):
    window = 14
    df['high_low_diff'] = df['high'] - df['low']
    df['avg_gain'] = df['high_low_diff'].rolling(window=window).apply(lambda x: x[x > 0].sum() / window, raw=False)
    df['avg_loss'] = df['high_low_diff'].rolling(window=window).apply(lambda x: abs(x[x < 0].sum()) / window, raw=False)
    df['rs'] = df['avg_gain'] / df['avg_loss'].replace(0, 1e-6)
    df['rsi'] = 100 - (100 / (1 + df['rs']))
    heuristics_matrix = (df['high_low_diff'] / df['close']).mul(df['rsi'])
    return heuristics_matrix
