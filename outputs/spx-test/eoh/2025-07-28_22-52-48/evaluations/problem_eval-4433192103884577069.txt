def heuristics_v2(df):
    def compute_roc(price_series, n=21):
        return price_series.pct_change(n)

    def compute_cmf(high_series, low_series, close_series, volume_series, n=30):
        mfv = ((close_series - low_series) - (high_series - close_series)) / (high_series - low_series)
        mfv = mfv.fillna(0.0) * volume_series
        cmf = mfv.rolling(window=n).sum() / volume_series.rolling(window=n).sum()
        return cmf

    def compute_sma(price_series, n=5):
        return price_series.rolling(window=n).mean()

    close_prices = df['close']
    high_prices = df['high']
    low_prices = df['low']
    volume = df['volume']

    roc_values = compute_roc(close_prices)
    cmf_values = compute_cmf(high_prices, low_prices, close_prices, volume)
    sma_values = compute_sma(close_prices)

    # Heuristic matrix: weighted combination of ROC and CMF with momentum adjustment
    heuristics_matrix = (roc_values * 0.7 + cmf_values * 0.3) * (close_prices / sma_values)
    return heuristics_matrix
