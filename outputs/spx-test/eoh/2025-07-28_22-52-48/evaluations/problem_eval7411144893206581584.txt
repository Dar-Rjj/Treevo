def heuristics_v2(df):
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    rsi_14 = 100 - (100 / (1 + (df['close'].diff(1).clip(lower=0).rolling(window=14).mean() / 
                                df['close'].diff(1).clip(upper=0).rolling(window=14).mean().abs())))
    heuristics_matrix = (np.log(df['close'] / ema_50) * rsi_14).dropna()
    return heuristics_matrix
