import numpy as np

def heuristics_v2(df):
    geom_mean_close_30 = df['close'].rolling(window=30).apply(lambda x: np.exp(np.mean(np.log(x))))
    ratio_geom_mean = np.log(df['close'] / geom_mean_close_30)
    heuristics_matrix = ratio_geom_mean.dropna()
    return heuristics_matrix
