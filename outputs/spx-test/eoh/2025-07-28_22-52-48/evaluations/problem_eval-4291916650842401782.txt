import numpy as np

def heuristics_v2(df):
    geo_mean_close_30 = df['close'].rolling(window=30).apply(lambda x: np.exp(np.log(x).mean()), raw=True)
    log_ratio = np.log(df['close'] / geo_mean_close_30)
    heuristics_matrix = log_ratio.dropna()
    return heuristics_matrix
