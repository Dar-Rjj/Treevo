import numpy as np
    log_close = np.log(df['close'])
    avg_log_close_50 = log_close.rolling(window=50).mean()
    log_diff = log_close - avg_log_close_50
    avg_volume_20 = df['volume'].rolling(window=20).mean()
    volume_ratio = df['volume'] / avg_volume_20
    heuristics_matrix = (log_diff + volume_ratio).dropna()
    return heuristics_matrix
