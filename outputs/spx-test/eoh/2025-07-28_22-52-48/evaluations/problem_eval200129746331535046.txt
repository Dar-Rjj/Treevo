def heuristics_v2(df):
    # Calculate the daily price change
    df['price_change'] = df['close'] - df['open']
    
    # Calculate the 5-day and 20-day moving standard deviation of price changes
    std_5 = df['price_change'].rolling(window=5).std()
    std_20 = df['price_change'].rolling(window=20).std()
    
    # Calculate the ratio of 5-day to 20-day moving standard deviation
    std_ratio = std_5 / std_20
    
    # Calculate the 5-day and 20-day moving average of volume
    vol_ma_5 = df['volume'].rolling(window=5).mean()
    vol_ma_20 = df['volume'].rolling(window=20).mean()
    
    # Calculate the ratio of 5-day to 20-day moving average volume
    vol_ratio = vol_ma_5 / vol_ma_20
    
    # Create the heuristic factor
    heuristics_matrix = (df['price_change'] / std_20) * (vol_ratio * std_ratio)
    
    return heuristics_matrix
