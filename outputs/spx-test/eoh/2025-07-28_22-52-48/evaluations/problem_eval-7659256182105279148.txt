def heuristics_v2(df):
    avg_high_low_20 = (df['high'].rolling(window=20).mean() + df['low'].rolling(window=20).mean()) / 2
    ratio_price = df['close'] / avg_high_low_20
    log_volume_diff = (df['volume'] - df['volume'].rolling(window=20).mean()).apply(lambda x: np.log1p(x) if x > 0 else -np.log1p(-x))
    heuristics_matrix = (ratio_price + log_volume_diff) / 2
    return heuristics_matrix
