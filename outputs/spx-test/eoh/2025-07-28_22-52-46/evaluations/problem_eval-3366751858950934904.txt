import pandas as pd

def heuristics_v2(df):
    short_window = 12
    long_window = 26
    df['EMA_short'] = df['close'].ewm(span=short_window, adjust=False).mean()
    df['EMA_long'] = df['close'].ewm(span=long_window, adjust=False).mean()
    df['MACD'] = df['EMA_short'] - df['EMA_long']
    df['Volume_Change'] = df['volume'].pct_change(5)
    df['Volume_Z_Score'] = (df['Volume_Change'] - df['Volume_Change'].rolling(window=30).mean()) / df['Volume_Change'].rolling(window=30).std()
    heuristics_matrix = df['MACD'] * df['Volume_Z_Score']
    return heuristics_matrix
