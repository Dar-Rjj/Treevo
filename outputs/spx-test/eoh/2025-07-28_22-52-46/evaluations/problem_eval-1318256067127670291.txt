def heuristics_v2(df):
    # Compute daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Exponential Moving Averages
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['ema_50'] = df['close'].ewm(span=50, adjust=False).mean()
    
    # Relative Strength Index (RSI)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Average Directional Index (ADX)
    tr = df[['high', 'low', 'close']].transform('max', axis=1) - df[['high', 'low', 'close']].transform('min', axis=1)
    atr = tr.rolling(window=14).mean()
    plus_dm = (df['high'].diff().fillna(0)).apply(lambda x: x if x > 0 else 0)
    minus_dm = (-df['low'].diff().fillna(0)).apply(lambda x: x if x > 0 else 0)
    plus_di = (plus_dm.rolling(window=14).sum() / atr) * 100
    minus_di = (minus_dm.rolling(window=14).sum() / atr) * 100
    dx = (abs(plus_di - minus_di) / (plus_di + minus_di)) * 100
    df['adx'] = dx.rolling(window=14).mean()
    
    # Rolling 60-day historical Sharpe ratios
    sharpe_ratios_ema_12 = (df['ema_12'] * df['daily_return'].shift(-1)).rolling(window=60).mean() / df['ema_12'].rolling(window=60).std()
    sharpe_ratios_ema_26 = (df['ema_26'] * df['daily_return'].shift(-1)).rolling(window=60).mean() / df['ema_26'].rolling(window=60).std()
    sharpe_ratios_ema_50 = (df['ema_50'] * df['daily_return'].shift(-1)).rolling(window=60).mean() / df['ema_50'].rolling(window=60).std()
    sharpe_ratios_rsi = (df['rsi'] * df['daily_return'].shift(-1)).rolling(window=60).mean() / df['rsi'].rolling(window=60).std()
    sharpe_ratios_adx = (df['adx'] * df['daily_return'].shift(-1)).rolling(window=60).mean() / df['adx'].rolling(window=60).std()
    
    # Generate heuristic matrix
    heuristics_matrix = (df['ema_12'] * sharpe_ratios_ema_12 +
                         df['ema_26'] * sharpe_ratios_ema_26 +
                         df['ema_50'] * sharpe_ratios_ema_50 +
                         df['rsi'] * sharpe_ratios_rsi +
                         df['adx'] * sharpe_ratios_adx)
    
    return heuristics_matrix
