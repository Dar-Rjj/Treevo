defined as a significant change in volume relative to its recent average, and then weights these accumulations by the distance from the 20-day moving average of the closing price.}

```python
def heuristics_v2(df):
    # Calculate the 20-day moving average of the close price
    df['ma_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate the distance from the 20-day moving average
    df['distance_from_ma_20'] = (df['close'] - df['ma_20']).abs()
    
    # Calculate the rolling mean of volume over 10 days
    df['avg_volume_10'] = df['volume'].rolling(window=10).mean()
    
    # Define a volume shock as a 2x increase or decrease in volume compared to the 10-day average
    df['volume_shock'] = (df['volume'] - df['avg_volume_10']) / df['avg_volume_10']
    
    # Identify positive and negative volume shocks
    df['positive_shock'] = df['volume_shock'].apply(lambda x: x if x > 1 else 0)
    df['negative_shock'] = df['volume_shock'].apply(lambda x: x if x < -1 else 0)
    
    # Accumulate positive and negative volume shocks
    df['acc_positive_shocks'] = df['positive_shock'].cumsum()
    df['acc_negative_shocks'] = df['negative_shock'].cumsum().abs()
    
    # Generate heuristic matrix
    heuristics_matrix = (df['acc_positive_shocks'] - df['acc_negative_shocks']) * df['distance_from_ma_20']
    
    return heuristics_matrix
