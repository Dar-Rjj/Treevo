def heuristics_v2(df):
    # Compute the numerator (|Close - Open|) and the denominator (High + Low)/2
    num = abs(df['close'] - df['open'])
    denom = (df['high'] + df['low']) / 2
    
    # Calculate the base heuristic
    base_heuristic = num / denom
    
    # Apply a 20-day moving average to smooth the series
    heuristics_matrix = base_heuristic.rolling(window=20).mean()
    
    return heuristics_matrix
