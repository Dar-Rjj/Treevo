def heuristics_v2(df):
    # Compute daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Compute RSI
    def rsi(data, window=14):
        delta = data.diff(1)
        up_days = delta.copy()
        up_days[delta<=0]=0.0
        down_days = abs(delta.copy())
        down_days[delta>0]=0.0
        RS_up = up_days.rolling(window).mean()
        RS_down = down_days.rolling(window).mean().replace({0.0:0.0001})
        rsi = 100 - 100/(1.0+RS_up/RS_down)
        return rsi

    df['rsi_5'] = rsi(df['close'], window=5)
    df['rsi_20'] = rsi(df['close'], window=20)
    
    # Compute EMA
    df['ema_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['ema_30'] = df['close'].ewm(span=30, adjust=False).mean()
    
    # Calculate EMA crossover
    df['ema_crossover'] = df['ema_10'] - df['ema_30']
    
    # Volume-Weighted Average Price (VWAP) trend
    df['vwap_5'] = (df['close'] * df['volume']).rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    
    # Historical Sharpe ratios
    sharpe_ratios = {
        'rsi_5': (df['rsi_5'] * df['daily_return'].shift(-1)).mean() / df['rsi_5'].std(),
        'rsi_20': (df['rsi_20'] * df['daily_return'].shift(-1)).mean() / df['rsi_20'].std(),
        'ema_crossover': (df['ema_crossover'] * df['daily_return'].shift(-1)).mean() / df['ema_crossover'].std(),
        'vwap_5': (df['vwap_5'] * df['daily_return'].shift(-1)).mean() / df['vwap_5'].std()
    }
    
    # Generate heuristic matrix
    heuristics_matrix = (df['rsi_5'] * sharpe_ratios['rsi_5'] +
                         df['rsi_20'] * sharpe_ratios['rsi_20'] +
                         df['ema_crossover'] * sharpe_ratios['ema_crossover'] +
                         df['vwap_5'] * sharpe_ratios['vwap_5'])
    
    return heuristics_matrix
