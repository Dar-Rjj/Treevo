import pandas as pd

def heuristics_v2(df):
    # Compute the MACD line and signal line
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    
    # Calculate the MACD histogram
    df['macd_hist'] = df['macd_line'] - df['signal_line']
    
    # Calculate the Williams %R
    high_highest = df['high'].rolling(window=14).max()
    low_lowest = df['low'].rolling(window=14).min()
    df['williams_r'] = -100 * (high_highest - df['close']) / (high_highest - low_lowest)
    
    # Generate heuristic matrix
    heuristics_matrix = df['macd_hist'] + df['williams_r']
    
    return heuristics_matrix
