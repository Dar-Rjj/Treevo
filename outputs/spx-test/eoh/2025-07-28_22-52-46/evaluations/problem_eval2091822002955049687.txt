def heuristics_v2(df):
    df['daily_return'] = df['close'].pct_change()
    df['ma_200'] = df['close'].rolling(window=200).mean()
    df['dist_from_ma200'] = df['close'] - df['ma_200']
    df['volume_roc_10'] = df['volume'].pct_change(periods=10)
    df['volatility_60'] = df['daily_return'].rolling(window=60).std()
    corr_dist_from_ma200 = df['dist_from_ma200'].rolling(window=90).corr(df['daily_return'].shift(-1))
    corr_volume_roc_10 = df['volume_roc_10'].rolling(window=90).corr(df['daily_return'].shift(-1))
    corr_volatility_60 = df['volatility_60'].rolling(window=90).corr(df['daily_return'].shift(-1))
    heuristics_matrix = (df['dist_from_ma200'] * corr_dist_from_ma200 +
                         df['volume_roc_10'] * corr_volume_roc_10 +
                         df['volatility_60'] * corr_volatility_60)
    return heuristics_matrix
