def heuristics_v2(df):
    def calc_moving_averages(data, short_window=50, long_window=200):
        data['SMA_short'] = data['close'].rolling(window=short_window).mean()
        data['SMA_long'] = data['close'].rolling(window=long_window).mean()
        return data

    def calc_momentum(data, window=14):
        data['Momentum'] = (data['close'] - data['close'].shift(window)) / data['close'].shift(window)
        return data

    def calc_volume_trend(data, window=10):
        data['Avg_Volume'] = data['volume'].rolling(window=window).mean()
        data['Volume_Trend'] = (data['volume'] - data['Avg_Volume']) / data['Avg_Volume']
        return data

    df = calc_moving_averages(df.copy())
    df = calc_momentum(df)
    df = calc_volume_trend(df)

    df['Alpha_Factor'] = (df['SMA_short'] - df['SMA_long']) + df['Momentum'] + df['Volume_Trend']
    heuristics_matrix = df['Alpha_Factor']

    return heuristics_matrix
