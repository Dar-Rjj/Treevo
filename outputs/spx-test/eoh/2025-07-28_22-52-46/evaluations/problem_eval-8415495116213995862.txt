def heuristics_v2(df):
    # Compute daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Price-to-Volume Ratio
    df['price_to_volume'] = df['close'] / df['volume']
    
    # Relative Strength Index (RSI)
    delta = df['close'].diff()
    up_gain = delta.where(delta > 0, 0)
    down_loss = -delta.where(delta < 0, 0)
    avg_up_gain = up_gain.rolling(window=14).mean()
    avg_down_loss = down_loss.rolling(window=14).mean()
    rs = avg_up_gain / avg_down_loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Bollinger Bands
    df['bb_middle'] = df['close'].rolling(window=20).mean()
    df['bb_std'] = df['close'].rolling(window=20).std()
    df['bb_upper'] = df['bb_middle'] + 2 * df['bb_std']
    df['bb_lower'] = df['bb_middle'] - 2 * df['bb_std']
    df['bollinger_band_diff'] = (df['close'] - df['bb_middle']) / (df['bb_upper'] - df['bb_lower'])
    
    # Rolling 30-day historical correlations
    corr_price_to_volume = df['price_to_volume'].rolling(window=30).corr(df['daily_return'])
    corr_rsi = df['rsi'].rolling(window=30).corr(df['daily_return'])
    corr_bollinger_band = df['bollinger_band_diff'].rolling(window=30).corr(df['daily_return'])
    
    # Generate heuristic matrix
    heuristics_matrix = (df['price_to_volume'] * corr_price_to_volume +
                         df['rsi'] * corr_rsi +
                         df['bollinger_band_diff'] * corr_bollinger_band)
    
    return heuristics_matrix
