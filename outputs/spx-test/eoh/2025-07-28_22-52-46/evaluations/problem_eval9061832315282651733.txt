def heuristics_v2(df):
    # Compute daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate 10-day and 30-day price change
    df['price_change_10'] = df['close'] - df['close'].shift(10)
    df['price_change_30'] = df['close'] - df['close'].shift(30)
    
    # Calculate MACD
    df['ema_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['ema_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['macd_line'] = df['ema_12'] - df['ema_26']
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['macd_histogram'] = df['macd_line'] - df['signal_line']

    # Historical alphas
    alpha_price_change_10 = (df['price_change_10'] * df['daily_return'].shift(-1)).mean() / (df['price_change_10'] * df['daily_return'].shift(-1)).std()
    alpha_price_change_30 = (df['price_change_30'] * df['daily_return'].shift(-1)).mean() / (df['price_change_30'] * df['daily_return'].shift(-1)).std()
    alpha_macd_histogram = (df['macd_histogram'] * df['daily_return'].shift(-1)).mean() / (df['macd_histogram'] * df['daily_return'].shift(-1)).std()

    # Generate heuristic matrix
    heuristics_matrix = (df['price_change_10'] * alpha_price_change_10 + 
                         df['price_change_30'] * alpha_price_change_30 + 
                         df['macd_histogram'] * alpha_macd_histogram)

    return heuristics_matrix
