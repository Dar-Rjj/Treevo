import pandas as pd

def heuristics_v2(df):
    def calc_price_rate_of_change(data, window=14):
        data['ROC'] = (data['close'] - data['close'].shift(window)) / data['close'].shift(window)
        return data
    
    def calc_rsi(data, window=14):
        delta = data['close'].diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=window).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=window).mean()
        rs = gain / loss
        data['RSI'] = 100 - (100 / (1 + rs))
        return data
    
    def calc_on_balance_volume(data):
        data['OBV'] = (data['close'] > data['close'].shift(1)).astype(int) * data['volume']
        data['OBV'] = data['OBV'].cumsum()
        return data

    df = calc_price_rate_of_change(df.copy())
    df = calc_rsi(df)
    df = calc_on_balance_volume(df)

    heuristics_matrix = (df['ROC'] + df['RSI'] + (df['OBV'] - df['OBV'].shift(1))) / 3

    return heuristics_matrix
