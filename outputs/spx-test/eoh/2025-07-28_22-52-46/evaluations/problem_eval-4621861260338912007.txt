def heuristics_v2(df):
    # Compute daily return
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate RSI
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Calculate ADX
    df['high_low'] = df['high'] - df['low']
    df['high_close_prev'] = abs(df['high'] - df['close'].shift())
    df['low_close_prev'] = abs(df['low'] - df['close'].shift())
    df['tr'] = df[['high_low', 'high_close_prev', 'low_close_prev']].max(axis=1)
    df['dmp'] = (df['high'] - df['high'].shift()).apply(lambda x: max(x, 0))
    df['dmn'] = (df['low'].shift() - df['low']).apply(lambda x: max(x, 0))
    df['dmi_plus'] = (df['dmp'] / df['tr']).rolling(window=14).mean() * 100
    df['dmi_minus'] = (df['dmn'] / df['tr']).rolling(window=14).mean() * 100
    df['adx'] = (abs(df['dmi_plus'] - df['dmi_minus']) / (df['dmi_plus'] + df['dmi_minus'])) * 100
    
    # Calculate MFI
    tp = (df['high'] + df['low'] + df['close']) / 3
    mf = tp * df['volume']
    df['mfi_positive'] = mf.where(df['close'] > df['close'].shift(1), 0).rolling(window=14).sum()
    df['mfi_negative'] = mf.where(df['close'] < df['close'].shift(1), 0).rolling(window=14).sum()
    mr = df['mfi_positive'] / df['mfi_negative']
    df['mfi'] = 100 - (100 / (1 + mr))
    
    # Calculate Z-scores
    df['z_rsi'] = (df['rsi'] - df['rsi'].rolling(window=60).mean()) / df['rsi'].rolling(window=60).std()
    df['z_adx'] = (df['adx'] - df['adx'].rolling(window=60).mean()) / df['adx'].rolling(window=60).std()
    df['z_mfi'] = (df['mfi'] - df['mfi'].rolling(window=60).mean()) / df['mfi'].rolling(window=60).std()
    
    # Calculate 60-day rolling MAE
    mae_rsi = (df['z_rsi'] * df['daily_return'].shift(-1)).abs().rolling(window=60).mean()
    mae_adx = (df['z_adx'] * df['daily_return'].shift(-1)).abs().rolling(window=60).mean()
    mae_mfi = (df['z_mfi'] * df['daily_return'].shift(-1)).abs().rolling(window=60).mean()
    
    # Generate heuristic matrix
    heuristics_matrix = (df['z_rsi'] * mae_rsi + df['z_adx'] * mae_adx + df['z_mfi'] * mae_mfi)
    
    return heuristics_matrix
