def heuristics_v2(df):
    mad_close_30_day = df['close'].rolling(window=30).apply(lambda x: np.median(np.abs(x - np.median(x))), raw=True)
    avg_high_low_30_day = (df['close'].rolling(window=30).max() + df['close'].rolling(window=30).min()) / 2
    heuristics_matrix = mad_close_30_day / avg_high_low_30_day
    return heuristics_matrix
