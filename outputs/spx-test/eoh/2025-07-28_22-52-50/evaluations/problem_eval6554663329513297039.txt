def heuristics_v2(df):
    ema_close_20_day = df['close'].ewm(span=20, adjust=False).mean()
    daily_returns = df['close'].pct_change()
    pos_returns = daily_returns[daily_returns > 0].fillna(0)
    neg_returns = daily_returns[daily_returns < 0].fillna(0)
    pos_sum_20_day = pos_returns.rolling(window=20).sum()
    neg_sum_20_day = neg_returns.rolling(window=20).sum()
    heuristics_matrix = (pos_sum_20_day + neg_sum_20_day) / ema_close_20_day
    return heuristics_matrix
