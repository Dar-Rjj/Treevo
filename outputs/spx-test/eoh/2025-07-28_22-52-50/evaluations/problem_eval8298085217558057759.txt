import pandas as pd

def heuristics_v2(df):
    close_prices = df['close']
    open_prices = df['open']
    volume = df['volume']
    
    # Custom price ratio: today's close divided by yesterday's open
    price_ratio = close_prices / open_prices.shift(1)
    
    # Exponential moving average of volume over 20 days
    ema_volume = volume.ewm(span=20).mean()
    
    # Directional Movement (+/- DI) using high and low prices for 14 periods
    high_prices = df['high']
    low_prices = df['low']
    positive_dm = (high_prices - high_prices.shift(1)).apply(lambda x: max(x, 0))
    negative_dm = (low_prices.shift(1) - low_prices).apply(lambda x: max(x, 0))
    tr = (df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)).rolling(window=14).sum()
    positive_di = (positive_dm.rolling(window=14).sum() / tr) * 100
    negative_di = (negative_dm.rolling(window=14).sum() / tr) * 100
    
    # Combined heuristic factor
    heuristics_matrix = price_ratio + ema_volume + (positive_di - negative_di)
    
    return heuristics_matrix
