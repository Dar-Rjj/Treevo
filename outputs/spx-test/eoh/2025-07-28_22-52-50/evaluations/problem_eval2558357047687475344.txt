def heuristics_v2(df):
    momentum_30_day = df['close'].pct_change(periods=30)
    log_volume_ratio_30_day = (df['volume'].rolling(window=30).max() / df['volume'].rolling(window=30).min()).apply(np.log)
    heuristics_matrix = momentum_30_day * log_volume_ratio_30_day
    return heuristics_matrix
