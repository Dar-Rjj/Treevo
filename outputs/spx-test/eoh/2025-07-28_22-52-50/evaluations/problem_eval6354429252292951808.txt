def heuristics_v2(df):
    vwap_30_day = (df['close'] * df['volume']).rolling(window=30).sum() / df['volume'].rolling(window=30).sum()
    daily_returns = df['close'].pct_change()
    cum_sum_returns = daily_returns.rolling(window=30).sum()
    rsi_30_day = 100 - (100 / (1 + (df['close'].diff().where(lambda x: x > 0, 0).rolling(window=30).mean() / -df['close'].diff().where(lambda x: x < 0, 0).rolling(window=30).mean())))
    heuristics_matrix = (vwap_30_day / cum_sum_returns) * (rsi_30_day / 50)
    return heuristics_matrix
