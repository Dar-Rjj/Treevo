def heuristics_v2(df):
    # Calculate ATR
    df['H-L'] = df['high'] - df['low']
    df['H-PC'] = abs(df['high'] - df['close'].shift(1))
    df['L-PC'] = abs(df['low'] - df['close'].shift(1))
    df['TR'] = df[['H-L', 'H-PC', 'L-PC']].max(axis=1)
    atr_period = 14
    df['ATR'] = df['TR'].rolling(window=atr_period).mean()

    # Calculate ADX
    df['DMp'] = df['high'].diff().apply(lambda x: max(x, 0))
    df['DMm'] = -df['low'].diff().apply(lambda x: min(x, 0))
    df['DMp_smoothed'] = df['DMp'].ewm(alpha=1/atr_period, adjust=False).mean()
    df['DMm_smoothed'] = df['DMm'].ewm(alpha=1/atr_period, adjust=False).mean()
    df['DIp'] = 100 * (df['DMp_smoothed'] / df['ATR'])
    df['DIm'] = 100 * (df['DMm_smoothed'] / df['ATR'])
    df['ADX'] = 100 * ((df['DIp'] - df['DIm']).abs() / (df['DIp'] + df['DIm']))

    # Calculate Rate of Change (ROC)
    roc_period = 10
    df['ROC'] = df['close'].pct_change(periods=roc_period)

    # Combined heuristic: ATR adjusted by ADX and ROC
    heuristics_matrix = df['ATR'] + (df['ADX'] - 25) * 0.02 * df['ATR'] + df['ROC']

    return heuristics_matrix
