def heuristics_v2(df):
    vwap_30_day = (df['close'] * df['volume']).rolling(window=30).sum() / df['volume'].rolling(window=30).sum()
    sma_close_30_day = df['close'].rolling(window=30).mean()
    total_volume_30_day = df['volume'].rolling(window=30).sum()
    heuristics_matrix = (vwap_30_day - sma_close_30_day) * total_volume_30_day
    return heuristics_matrix
