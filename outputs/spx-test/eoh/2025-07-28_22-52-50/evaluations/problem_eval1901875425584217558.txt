def heuristics_v2(df):
    close_30_day_momentum = df['close'] - df['close'].shift(30)
    tr = df[['high', 'low', 'close']].diff().abs().max(axis=1)
    avg_true_range_30_day = tr.rolling(window=30).mean()
    heuristics_matrix = close_30_day_momentum / avg_true_range_30_day
    return heuristics_matrix
