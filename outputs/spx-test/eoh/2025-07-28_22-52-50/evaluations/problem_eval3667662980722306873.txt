import pandas as pd

def heuristics_v2(df):
    # Momentum: 12-day rate of change (ROC)
    roc = df['close'].pct_change(periods=12)
    
    # Volatility: Standard deviation of daily log returns over the last 20 days
    log_returns = df['close'].apply(lambda x: np.log(x)) - df['close'].shift(1).apply(lambda x: np.log(x))
    volatility = log_returns.rolling(window=20).std()
    
    # Volume Signal: 5-day average volume compared to the 20-day average volume
    avg_vol_5 = df['volume'].rolling(window=5).mean()
    avg_vol_20 = df['volume'].rolling(window=20).mean()
    volume_signal = avg_vol_5 / avg_vol_20
    
    # Composite factor
    heuristics_matrix = roc + volatility + volume_signal
    
    return heuristics_matrix
