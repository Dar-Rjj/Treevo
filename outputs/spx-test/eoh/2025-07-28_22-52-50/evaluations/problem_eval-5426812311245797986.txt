import pandas as pd
import ta

def heuristics_v2(df):
    short_window = 5
    long_window = 20
    rsi_window = 14
    df['short_ema'] = df['close'].ewm(span=short_window, adjust=False).mean()
    df['long_ema'] = df['close'].ewm(span=long_window, adjust=False).mean()
    df['rsi'] = ta.momentum.RSIIndicator(df['close'], window=rsi_window).rsi()
    df['heuristic_factor'] = (df['short_ema'] - df['long_ema']) + df['rsi']
    heuristics_matrix = df['heuristic_factor'].dropna()
    return heuristics_matrix
