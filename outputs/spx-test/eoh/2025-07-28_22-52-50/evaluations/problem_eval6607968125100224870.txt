def heuristics_v2(df):
    close_30_day_change = df['close'].pct_change(periods=30)
    std_close_30_day = df['close'].rolling(window=30).std()
    rsi_30_day = 100 - (100 / (1 + (df['close'].diff().where(lambda x: x > 0, 0).rolling(window=30).mean() / -df['close'].diff().where(lambda x: x < 0, 0).rolling(window=30).mean())))
    heuristics_matrix = close_30_day_change * (std_close_30_day / df['close']) * (rsi_30_day / 50)
    return heuristics_matrix
