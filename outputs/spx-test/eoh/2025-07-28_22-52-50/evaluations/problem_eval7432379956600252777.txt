import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages
    short_window = 20
    long_window = 100
    df['SMA_Short'] = df['close'].rolling(window=short_window).mean()
    df['SMA_Long'] = df['close'].rolling(window=long_window).mean()

    # Modified momentum calculation (logarithmic price change over a period)
    momentum_period = 21
    df['Log_Returns'] = np.log(df['close']).diff(momentum_period)
    df['Momentum'] = df['Log_Returns'].ewm(span=momentum_period, adjust=False).mean()

    # Adjusted volatility (mean absolute deviation of daily returns)
    vol_period = 30
    df['Daily_Returns'] = df['close'].pct_change()
    df['Volatility'] = df['Daily_Returns'].rolling(window=vol_period).apply(lambda x: np.mean(np.abs(x - x.mean())), raw=True)

    # Combined heuristic: Difference between short and long SMAs, adjusted by momentum and volatility
    heuristics_matrix = (df['SMA_Short'] - df['SMA_Long']) + df['Momentum'] - df['Volatility']

    return heuristics_matrix
