def heuristics_v2(df):
    momentum = df['close'] - df['close'].shift(30)
    vol_30_day = df['close'].rolling(window=30).std()
    avg_volume_30_day = df['volume'].rolling(window=30).mean()
    vol_ratio = df['volume'] / avg_volume_30_day
    heuristics_matrix = (momentum + vol_30_day) * vol_ratio
    return heuristics_matrix
