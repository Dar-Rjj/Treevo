def heuristics_v2(df):
    # Calculate the Volume-Adjusted Close (VAC)
    vac = df['close'] * df['volume']
    
    # Calculate the difference between the 10-day and 30-day moving averages of VAC as a momentum signal
    vac_ma_10 = vac.rolling(window=10).mean()
    vac_ma_30 = vac.rolling(window=30).mean()
    vac_momentum = vac_ma_10 - vac_ma_30
    
    # Calculate the 20-day standard deviation of the VAC as a measure of volatility
    vac_std_20 = vac.rolling(window=20).std()
    
    # Calculate the 20-day average true range (ATR) for a more robust volatility measure
    df['H-L'] = df['high'] - df['low']
    df['H-PC'] = abs(df['high'] - df['close'].shift(1))
    df['L-PC'] = abs(df['low'] - df['close'].shift(1))
    df['TR'] = df[['H-L', 'H-PC', 'L-PC']].max(axis=1)
    atr_period = 20
    df['ATR'] = df['TR'].rolling(window=atr_period).mean()
    
    # Combine the momentum and volatility measures
    heuristics_matrix = vac_momentum / df['ATR']
    
    return heuristics_matrix
