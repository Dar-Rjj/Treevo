def heuristics_v2(df):
    price_changes = df['close'].diff().abs().rolling(window=30).sum()
    total_volume = df['volume'].rolling(window=30).sum()
    gain = df['close'].diff().clip(lower=0).rolling(window=30).mean()
    loss = -df['close'].diff().clip(upper=0).rolling(window=30).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    heuristics_matrix = (price_changes / total_volume) * (1 + (rsi / 50))
    return heuristics_matrix
