import pandas as pd

def heuristics_v2(df):
    # Calculate Bollinger Bands Width
    sma_period = 20
    df['SMA'] = df['close'].rolling(window=sma_period).mean()
    df['stddev'] = df['close'].rolling(window=sma_period).std()
    df['Upper_Band'] = df['SMA'] + (2 * df['stddev'])
    df['Lower_Band'] = df['SMA'] - (2 * df['stddev'])
    df['BB_Width'] = df['Upper_Band'] - df['Lower_Band']

    # Calculate RSI
    rsi_period = 14
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    avg_gain = gain.rolling(window=rsi_period).mean()
    avg_loss = loss.rolling(window=rsi_period).mean()
    rs = avg_gain / avg_loss
    df['RSI'] = 100 - (100 / (1 + rs))

    # Calculate SMA crossovers
    short_sma_period = 50
    long_sma_period = 200
    df['SMA_Short'] = df['close'].rolling(window=short_sma_period).mean()
    df['SMA_Long'] = df['close'].rolling(window=long_sma_period).mean()
    sma_crossover = df['SMA_Short'] - df['SMA_Long']

    # Combined heuristic: BB Width adjusted by RSI and SMA crossover
    heuristics_matrix = df['BB_Width'] + (df['RSI'] - 50) * 0.01 * df['BB_Width'] + sma_crossover

    return heuristics_matrix
