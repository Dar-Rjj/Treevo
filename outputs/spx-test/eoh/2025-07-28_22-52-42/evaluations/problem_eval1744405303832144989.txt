import pandas as pd

def heuristics_v2(df):
    # Calculate the exponentially weighted moving average of close prices over a 10-day period
    ewma_close = df['close'].ewm(span=10).mean()
    # Calculate the difference between the actual close and its EWMA
    diff_close_ewma = df['close'] - ewma_close
    # Apply a logarithmic transformation to the volume
    log_volume = df['volume'].apply(lambda x: x if x <= 0 else np.log(x))
    # Generate the heuristics matrix by combining the difference with the logarithmic volume
    heuristics_matrix = diff_close_ewma * log_volume
    return heuristics_matrix
