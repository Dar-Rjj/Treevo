import pandas as pd

def heuristics_v2(df):
    # Calculate the EMA of closing prices over a 5-day window
    ema_close = df['close'].ewm(span=5, adjust=False).mean()
    # Calculate the EMA of volume over a 5-day window
    ema_volume = df['volume'].ewm(span=5, adjust=False).mean()
    # Calculate the ratio between EMA of close and EMA of volume
    ratio_ema = ema_close / ema_volume
    # Apply a logarithmic transformation to the ratio
    heuristics_matrix = ratio_ema.apply(lambda x: x if x > 0 else 1e-10).apply(np.log)
    return heuristics_matrix
