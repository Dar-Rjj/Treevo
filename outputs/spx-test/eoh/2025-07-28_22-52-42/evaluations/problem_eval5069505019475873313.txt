def heuristics_v2(df):
    # Momentum: 20-day change in closing price
    momentum = df['close'] - df['close'].shift(20)
    
    # Volatility: 30-day standard deviation of closing price
    vol = df['close'].rolling(window=30).std()
    
    # Volume ratio: current volume compared to its 40-day moving average
    avg_vol_40d = df['volume'].rolling(window=40).mean()
    vol_ratio = df['volume'] / avg_vol_40d
    
    # Directional movement: difference between 10-day high and low
    high_10d = df['high'].rolling(window=10).max()
    low_10d = df['low'].rolling(window=10).min()
    dir_movement = (high_10d - low_10d) / df['close']
    
    # Composite heuristic with different weights
    heuristics_matrix = (momentum * 0.4 + (vol * vol_ratio) * 0.3 + dir_movement * 0.3)
    
    return heuristics_matrix
