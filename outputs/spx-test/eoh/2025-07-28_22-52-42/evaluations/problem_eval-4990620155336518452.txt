def heuristics_v2(df):
    df['log_close'] = np.log(df['close'])
    df['log_low'] = np.log(df['low'])
    df['EMA_20_log_close'] = df['log_close'].ewm(span=20, adjust=False).mean()
    df['SMA_20_log_low'] = df['log_low'].rolling(window=20).mean()
    heuristics_matrix = df['SMA_20_log_low'] - df['EMA_20_log_close']
    heuristics_matrix = heuristics_matrix.ewm(span=5, adjust=False).mean()  # Additional 5-day EMA smoothing
    return heuristics_matrix
