def heuristics_v2(df):
    # Calculate the ratio of the difference between high and low prices to the trading volume
    price_diff_to_volume = (df['high'] - df['low']) / df['volume']
    # Apply a non-linear square root transformation
    transformed_price_diff_to_volume = (price_diff_to_volume + price_diff_to_volume.min()).pow(0.5)
    # Generate the heuristics matrix as the sum of the transformed value and its one-period lagged version
    heuristics_matrix = transformed_price_diff_to_volume + transformed_price_diff_to_volume.shift(1).fillna(0)
    return heuristics_matrix
