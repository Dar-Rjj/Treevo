import pandas as pd
import numpy as np

def heuristics_v2(df):
    price_diff_to_volume = (df['high'] - df['low']) / df['volume'].shift(1)
    log_transformed_ratio = np.log(price_diff_to_volume + 1)  # Adding 1 to avoid log(0)
    cumsum_adj_close = df['close'].pct_change().cumsum()
    heuristics_matrix = log_transformed_ratio * cumsum_adj_close
    return heuristics_matrix
