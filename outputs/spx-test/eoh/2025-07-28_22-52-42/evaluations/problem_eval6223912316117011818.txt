import pandas as pd

def heuristics_v2(df):
    def calculate_momentum(series, window=10):
        return series.pct_change(window)
    
    def calculate_volatility(series, window=10):
        return series.rolling(window=window).std()
    
    def calculate_sma(series, window=10):
        return series.rolling(window=window).mean()
    
    momentum = df['close'].apply(calculate_momentum)
    volatility = df['close'].apply(calculate_volatility)
    sma = df['close'].apply(calculate_sma)
    
    heuristics_matrix = (momentum + volatility / sma) / 3
    
    return heuristics_matrix
