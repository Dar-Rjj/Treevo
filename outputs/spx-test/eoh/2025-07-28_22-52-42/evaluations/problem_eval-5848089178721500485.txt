import pandas as pd

def heuristics_v2(df):
    def stochastic_oscillator(series, period=14):
        high_high = df['high'].rolling(window=period).max()
        low_low = df['low'].rolling(window=period).min()
        k = 100 * ((df['close'] - low_low) / (high_high - low_low))
        return k

    def obv(series):
        obv = pd.Series(0, index=df.index)
        prev_obv = 0
        for i in range(1, len(df)):
            if df['close'].iloc[i] > df['close'].iloc[i-1]:
                current_obv = prev_obv + df['volume'].iloc[i]
            elif df['close'].iloc[i] < df['close'].iloc[i-1]:
                current_obv = prev_obv - df['volume'].iloc[i]
            else:
                current_obv = prev_obv
            obv.iloc[i] = current_obv
            prev_obv = current_obv
        return obv

    stochastic_values = stochastic_oscillator(df['close'])
    obv_values = obv(df['close'])

    heuristics_matrix = (stochastic_values + obv_values) / 2

    return heuristics_matrix
