import pandas as pd

def heuristics_v2(df):
    # Calculate the daily price range
    price_range = df['high'] - df['low']
    # Compute the ratio of the daily price range to the closing price
    price_ratio = price_range / df['close']
    # Calculate the 10-day exponential moving average of the price ratio
    ema_price_ratio = price_ratio.ewm(span=10, adjust=False).mean()
    # Calculate the natural logarithm of the trading volume
    log_volume = df['volume'].apply(lambda x: math.log(x+1))
    # Compute the 5-day simple moving average of the log volume
    sma_log_volume = log_volume.rolling(window=5).mean()
    # Generate the heuristics matrix by subtracting EMA of price ratio from SMA of log volume
    heuristics_matrix = sma_log_volume - ema_price_ratio
    return heuristics_matrix
