import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the difference between closing and opening prices
    close_open_diff = df['close'] - df['open']
    # Calculate the average of high and low prices
    avg_high_low = (df['high'] + df['low']) / 2
    # Compute the ratio of the close-open difference to the average of high and low
    price_ratio = close_open_diff / avg_high_low
    # Apply square root to the volume
    sqrt_volume = np.sqrt(df['volume'])
    # Generate the heuristics matrix as the product of the price ratio and the square root of volume
    heuristics_matrix = price_ratio * sqrt_volume
    return heuristics_matrix
