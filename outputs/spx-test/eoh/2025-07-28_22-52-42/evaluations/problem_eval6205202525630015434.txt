import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the natural logarithm of the close, open prices, and volume
    df['log_close'] = np.log(df['close'])
    df['log_open'] = np.log(df['open'])
    df['log_volume'] = np.log(df['volume'])

    # Calculate the 30-day cumulative sum of the log difference between close and open prices
    df['cumsum_log_diff'] = (df['log_close'] - df['log_open']).rolling(window=30).sum()

    # Calculate the 30-day standard deviation of the log of volume
    df['std_log_volume'] = df['log_volume'].rolling(window=30).std()

    # Create the heuristic: product of cumsum_log_diff and std_log_volume
    heuristics_matrix = df['cumsum_log_diff'] * df['std_log_volume']

    return heuristics_matrix
