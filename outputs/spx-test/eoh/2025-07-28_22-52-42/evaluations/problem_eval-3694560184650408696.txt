def heuristics_v2(df):
    # Calculate the natural logarithm of the close prices and the volume
    df['log_close'] = np.log(df['close'])
    df['log_volume'] = np.log(df['volume'])

    # Calculate the 20-day EMA of the logarithm of the volume
    df['EMA_20_log_volume'] = df['log_volume'].ewm(span=20, adjust=False).mean()
    
    # Create the heuristic: ratio of log_close to EMA_20_log_volume
    heuristics_matrix = df['log_close'] / df['EMA_20_log_volume']
    
    return heuristics_matrix
