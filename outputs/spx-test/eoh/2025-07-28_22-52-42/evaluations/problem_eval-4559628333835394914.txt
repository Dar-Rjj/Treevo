import pandas as pd

def heuristics_v2(df):
    def adx(high, low, close, period=14):
        plus_dm = high.diff()
        minus_dm = -low.diff()
        plus_dm[plus_dm < 0] = 0
        minus_dm[minus_dm < 0] = 0
        
        tr = pd.DataFrame({'a': high - low,
                           'b': (high - close.shift(1)).abs(),
                           'c': (low - close.shift(1)).abs()}).max(axis=1)
        atr = tr.rolling(window=period).mean()
        
        smoothed_plus_dm = plus_dm.ewm(alpha=1/period, adjust=False).mean()
        smoothed_minus_dm = minus_dm.ewm(alpha=1/period, adjust=False).mean()
        
        plus_di = 100 * (smoothed_plus_dm / atr)
        minus_di = 100 * (smoothed_minus_dm / atr)
        
        dx = 100 * (plus_di - minus_di).abs() / (plus_di + minus_di)
        adx_value = dx.rolling(window=period).mean()
        
        return adx_value
    
    def wma(series, periods, weights):
        return (series * weights).rolling(window=periods).sum() / weights.sum()

    adx_values = adx(df['high'], df['low'], df['close'])
    volume_weights = df['volume'] / df['volume'].rolling(window=14).sum()
    wma_close = wma(df['close'], 14, volume_weights)
    
    heuristics_matrix = (adx_values + wma_close) / 2
    
    return heuristics_matrix
