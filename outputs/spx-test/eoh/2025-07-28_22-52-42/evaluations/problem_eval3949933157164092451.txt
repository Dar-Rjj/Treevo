def heuristics_v2(df):
    df['log_high'] = np.log(df['high'])
    df['log_volume'] = np.log(df['volume'])

    df['SMA_20_log_high'] = df['log_high'].rolling(window=20).mean()

    df['EWMA_20_log_volume'] = df['log_volume'].ewm(span=20, adjust=False).mean()

    df['std_close_15'] = df['close'].rolling(window=15).std()
    df['mean_close_15'] = df['close'].rolling(window=15).mean()
    df['CV_close_15'] = df['std_close_15'] / df['mean_close_15']

    heuristics_matrix = (df['EWMA_20_log_volume'] - df['SMA_20_log_high']) * df['CV_close_15']

    return heuristics_matrix
