import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the natural logarithm of the volume
    df['log_volume'] = np.log(df['volume'])
    
    # Calculate the 14-day Simple Moving Average (SMA) for log_volume
    df['SMA_14_log_volume'] = df['log_volume'].rolling(window=14).mean()
    
    # Calculate the 7-day minimum of the high prices
    df['min_7_high'] = df['high'].rolling(window=7).min()
    
    # Calculate the 30-day maximum of the low prices
    df['max_30_low'] = df['low'].rolling(window=30).max()
    
    # Create the heuristic: sum of SMA_14_log_volume and min_7_high, then subtract max_30_low
    heuristics_matrix = (df['SMA_14_log_volume'] + df['min_7_high']) - df['max_30_low']
    
    return heuristics_matrix
