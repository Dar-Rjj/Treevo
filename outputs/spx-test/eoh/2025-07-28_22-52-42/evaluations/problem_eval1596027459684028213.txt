def heuristics_v2(df):
    # Calculate the natural logarithm of the high prices
    df['log_high'] = np.log(df['high'])
    
    # Calculate the 15-day Weighted Moving Average (WMA) for log_high
    weights = np.arange(1, 16)
    df['WMA_15_log_high'] = df['log_high'].rolling(window=15).apply(lambda x: np.dot(x, weights) / weights.sum(), raw=True)
    
    # Calculate the 30-day sum of the volume
    df['sum_30_volume'] = df['volume'].rolling(window=30).sum()
    
    # Create the heuristic: ratio of WMA_15_log_high to sum_30_volume
    heuristics_matrix = df['WMA_15_log_high'] / df['sum_30_volume']
    
    return heuristics_matrix
