import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the difference between closing and opening prices
    close_open_diff = df['close'] - df['open']
    # Calculate the average price as the mean of high and low
    avg_price = (df['high'] + df['low']) / 2
    # Calculate the ratio of the difference to the average price
    diff_avg_ratio = close_open_diff / avg_price
    # Apply square root to the volume
    sqrt_volume = np.sqrt(df['volume'])
    # Generate the heuristics matrix as the product of the diff-avg ratio and the square root of volume
    heuristics_matrix = diff_avg_ratio * sqrt_volume
    return heuristics_matrix
