import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 30-day Exponentially Weighted Moving Average (EWMA) for volume
    df['EWMA_30_vol'] = df['volume'].ewm(span=30, adjust=False).mean()
    
    # Calculate the 60-day Simple Moving Average (SMA) for volume
    df['SMA_60_vol'] = df['volume'].rolling(window=60).mean()
    
    # Create the heuristic: ratio of EWMA_30_vol to SMA_60_vol
    heuristics_matrix = df['EWMA_30_vol'] / df['SMA_60_vol']
    
    return heuristics_matrix
