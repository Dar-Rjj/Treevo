def heuristics_v2(df):
    # Momentum: 7-day change in closing price
    momentum = df['close'] - df['close'].shift(7)
    
    # Volatility: 10-day standard deviation of closing price
    vol = df['close'].rolling(window=10).std()
    
    # Volume ratio: current volume compared to its 10-day moving average
    avg_vol_10d = df['volume'].rolling(window=10).mean()
    vol_ratio = df['volume'] / avg_vol_10d
    
    # Directional movement: average of 5-day high and low
    high_5d = df['high'].rolling(window=5).max()
    low_5d = df['low'].rolling(window=5).min()
    dir_movement_avg = (high_5d + low_5d) / (2 * df['close'])
    
    # Composite heuristic
    heuristics_matrix = (momentum + (vol * vol_ratio) + dir_movement_avg) / 3
    
    return heuristics_matrix
