import pandas as pd

def heuristics_v2(df):
    # Calculate the 10-day EMA of closing prices
    ema_close_10 = df['close'].ewm(span=10, adjust=False).mean()
    # Calculate the 30-day EMA of closing prices
    ema_close_30 = df['close'].ewm(span=30, adjust=False).mean()
    # Calculate the 10-day EMA of volumes
    ema_volume_10 = df['volume'].ewm(span=10, adjust=False).mean()
    # Calculate the 30-day EMA of volumes
    ema_volume_30 = df['volume'].ewm(span=30, adjust=False).mean()
    # Generate the heuristics matrix as a weighted sum of EMAs
    heuristics_matrix = 0.6 * (ema_close_10 - ema_close_30) + 0.4 * (ema_volume_10 - ema_volume_30)
    return heuristics_matrix
