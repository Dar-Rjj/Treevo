def heuristics_v2(df):
    # Calculate MACD
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12 - ema_26
    
    # Calculate On-Balance Volume (OBV)
    obv = (df['volume'] * (df['close'].diff() > 0)).cumsum()
    
    # Price ratio: current close price compared to its 30-day moving average
    avg_price_30d = df['close'].rolling(window=30).mean()
    price_ratio = df['close'] / avg_price_30d
    
    # Composite heuristic
    heuristics_matrix = (macd + obv) * price_ratio
    
    return heuristics_matrix
