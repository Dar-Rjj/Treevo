def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()
    
    # Calculate the 15-day Exponential Moving Average (EMA) for daily returns
    df['EMA_15_daily_return'] = df['daily_return'].ewm(span=15, adjust=False).mean()
    
    # Calculate the 40-day Simple Moving Average (SMA) for volume
    df['SMA_40_volume'] = df['volume'].rolling(window=40).mean()
    
    # Create the heuristic: product of EMA_15_daily_return and SMA_40_volume
    heuristics_matrix = df['EMA_15_daily_return'] * df['SMA_40_volume']
    
    return heuristics_matrix
