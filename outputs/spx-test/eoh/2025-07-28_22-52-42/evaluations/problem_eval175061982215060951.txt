import pandas as pd

def heuristics_v2(df):
    # Calculate daily returns
    daily_returns = df['close'].pct_change()
    
    # Compute the natural logarithm of the volume
    ln_volume = df['volume'].apply(lambda x: max(1, x)).apply(lambda x: math.log(x))
    
    # Define different time horizons for the rolling sums
    time_horizons = [5, 10, 20]
    
    # Initialize the heuristics matrix
    heuristics_matrix = pd.Series(index=df.index, dtype=float)
    
    # Calculate the weighted sum of returns over each horizon
    for horizon in time_horizons:
        rolling_returns = daily_returns.rolling(window=horizon).sum()
        weighted_returns = rolling_returns * ln_volume.rolling(window=horizon).mean()
        heuristics_matrix += weighted_returns
    
    return heuristics_matrix
