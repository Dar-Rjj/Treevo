```txt
Calculate Intraday Return
├── Subtract Open from Close
└── Divide by Open

Calculate Volume Impact Score
├── Sum volume over 10 days
├── Average High price over 10 days
├── Average Low price over 10 days
├── Subtract Average Low from Average High
└── Divide by Sum of Volume

Generate Factor 1
├── Multiply Intraday Return by Volume Impact Score

Calculate Price Momentum
├── Get the most recent close
├── Get the close from 10 days ago
└── Compute the difference (Price Momentum = Recent Close - Close 10 days ago)

Adjust by Volume
├── Sum of Volumes Over 10 Days
│   └── Use Volume
└── Divide Price Momentum by Cumulative Volume
    └── Adjusted Momentum (Adjusted Momentum = Price Momentum / Cumulative Volume)

Calculate Cumulative Volume-Weighted Momentum
├── Use Adjusted Momentum
└── Use Volume
    ├── Multiply Adjusted Momentum by Volume
    └── Sum over a fixed period (e.g., 10 days)
        └── Cumulative Volume-Weighted Momentum

Confirm with Volume Trend
├── Compute Average Volume (Past 5 Days)
├── Get Current Day Volume
├── Compute Volume Ratio
│   ├── Divide Current Day Volume by Average Volume
├── If Volume Ratio > 1
│   ├── Combine Price and Intraday Momentum
│   │   ├── Multiply Price Momentum by Intraday Return
│   │   └── Aggregate Momentum Over M Days
│   │       └── Use Cumulative Volume-Weighted Momentum
│   │       └── Sum over M days
│   └── Final Factor = Factor 1 * Aggregated Momentum
└── Otherwise, set Final Factor to 0

Calculate Intraday High-Low Spread
├── Use High price
└── Subtract Low price

Calculate Opening Price Trend
├── Use Open price
└── Subtract Previous Day's Close price

Calculate Intraday Volume Proportion
├── Use Volume
└── Subtract Overnight Volume
    ├── Use Previous Close Volume
    └── Use Open Volume

Calculate Intraday Volume Intensity
├── Use Intraday Volume Proportion
└── Divide by High-Low Price Range
    ├── Use High price
    └── Use Low price

Calculate Volume-Weighted Intraday Movement (VWIM)
├── Multiply Intraday High-Low Spread by Volume
└── Calculate 5-day moving average of VWIM

Calculate Amount-Weighted Opening Trend (AWOT)
├── Multiply Opening Price Trend by Amount
└── Calculate 5-day moving average of AWOT

Combine Adjusted Movements and Trends (AMT)
├── Sum VWIM and AWOT
├── Subtract 5-day moving average of VWIM
└── Subtract 5-day moving average of AWOT

Calculate Cumulative Volume (CV)
├── Sum of Volumes Over N Days
│   ├── Use Volume
│   └── Sum over N days

Adjust by Cumulative Volume (CV)
├── Divide AMT by CV

Calculate Intraday and Breakout Momentum
├── Calculate High-Low Spread
│   ├── Use High price
│   └── Use Low price
│   └── Subtract Low from High
└── Divide by Previous Close
    └── Use Close price from previous day (Momentum = (High - Low) / Previous Close)

Adjust by Volume
├── Divide Momentum by Cumulative Volume
    └── Use Adjusted Momentum (Adjusted Momentum = Momentum / Cumulative Volume)

Calculate Cumulative Volume-Weighted Momentum (CVWM)
├── Multiply Adjusted Momentum by Volume
└── Sum over a fixed period (e.g., 15 days)

Confirm with Volume Trend
├── Compute Average Volume (Past 15 Days)
├── Get Current Day Volume
└── Compute Volume Ratio
    ├── Divide Current Day Volume
    └── By Average Volume
├── If Volume Ratio > 1.3
│   ├── Final Factor = Adjusted Momentum * AMT
│   ├── Aggregate Momentum Over M Days
│   │   ├── Use CVWM
│   │   └── Sum over M days
└── Otherwise, set Final Factor to 0.6 * (Adjusted Momentum + AMT)

Final Factor
├── Multiply Factor 1 by Factor 2
└── Interpretation
    ├── Higher combined factor indicates stronger momentum with both volume and intraday confirmation
    └── Lower combined factor suggests weaker momentum or less volume and intraday confirmation
```
