```python
import pandas as pd

def heuristics_v2(df, N=10, M=5):
    # Calculate Intraday and Breakout Momentum
    df['High-Low_Spread'] = df['high'] - df['low']
    df['Momentum'] = df['High-Low_Spread'] / df['close'].shift(1)
    
    # Adjust by Volume
    sum_volume = df['volume'].rolling(window=N).sum()
    avg_volume = sum_volume / N
    df['Volume-Adjusted_Momentum'] = df['Momentum'] * avg_volume
    
    # Adjust by Amount
    sum_amount = df['amount'].rolling(window=N).sum()
    avg_amount = sum_amount / N
    df['Amount-Adjusted_Momentum'] = df['Momentum'] * avg_amount
    
    # Combine Volume-Adjusted and Amount-Adjusted Momentum
    df['Combined_Momentum'] = (df['Volume-Adjusted_Momentum'] + df['Amount-Adjusted_Momentum']) / 2
    
    # Calculate Cumulative Combined Momentum over a fixed period (e.g., 10 days)
    df['Cumulative_Combined_Momentum'] = df['Combined_Momentum'].rolling(window=N).sum()
    
    # Aggregate Momentum Over M Days
    df['Final_Factor'] = df['Cumulative_Combined_Momentum'].rolling(window=M).mean()
    
    return df['Final_Factor'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', parse_dates=['date'], index_col='date')
# factor_values = heuristics_v2(df)
```
