```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Spread and Intraday Movement
    df['High-Low_Spread'] = df['high'] - df['low']
    df['Prev_Close'] = df['close'].shift(1)
    df['Breakout_Momentum'] = df['High-Low_Spread'] / df['Prev_Close']

    # Calculate Price Momentum
    df['Recent_Close'] = df['close']
    df['Close_20_Days_Ago'] = df['close'].shift(20)
    df['Price_Momentum'] = df['Recent_Close'] - df['Close_20_Days_Ago']

    # Calculate Intraday Return
    df['Intraday_Return'] = (df['close'] - df['open']) / df['open']

    # Calculate Intraday Volume Proportion
    df['Volume_Proportion'] = df['volume'] - df['volume'].shift(1)

    # Calculate Intraday Volume Intensity
    df['Intraday_Volume_Intensity'] = df['Volume_Proportion'] / (df['high'] - df['low'])

    # Calculate Volume Impact Score
    df['Sum_Volume_10_Days'] = df['volume'].rolling(window=10).sum()
    df['Avg_High_10_Days'] = df['high'].rolling(window=10).mean()
    df['Avg_Low_10_Days'] = df['low'].rolling(window=10).mean()
    df['High_Low_Range_10_Days'] = df['Avg_High_10_Days'] - df['Avg_Low_10_Days']
    df['Volume_Impact_Score'] = df['High_Low_Range_10_Days'] / df['Sum_Volume_10_Days']

    # Multiply Intraday Return by Volume Impact Score
    df['Intraday_Return_Adjusted'] = df['Intraday_Return'] * df['Volume_Impact_Score']

    # Calculate Weighted Intraday Volume Intensity
    df['Weighted_Intraday_Volume_Intensity'] = df['Intraday_Volume_Intensity'] * df['Intraday_Return']

    # Adjust by Volume
    df['Cumulative_Volume_10_Days'] = df['volume'].rolling(window=10).sum()
    df['Adjusted_Momentum'] = df['Breakout_Momentum'] / df['Cumulative_Volume_10_Days']

    # Calculate Volume-Weighted and Amount-Weighted Movements
    df['Volume_Weighted_Intraday_Movement'] = df['Intraday_Return'] * df['volume']
    df['Amount_Weighted_Intraday_Movement'] = df['Intraday_Return'] * df['amount']
    df['Volume_Adjusted_Breakout_Momentum'] = df['Breakout_Momentum'] / df['Cumulative_Volume_10_Days']
    df['Amount_Adjusted_Breakout_Momentum'] = df['Breakout_Momentum'] / df['amount'].rolling(window=10).sum()

    # Incorporate Opening Trend and Amount Impact
    df['Opening_Trend'] = df['open'] - df['Prev_Close']
    df['Amount_Weighted_Opening_Trend'] = df['Opening_Trend'] * df['amount']

    # Combine Weighted Movements
    df['Combined_Movements'] = (
        df['Volume_Weighted_Intraday_Movement'] +
        df['Volume_Adjusted_Breakout_Momentum'] +
        df['Amount_Weighted_Intraday_Movement'] +
        df['Amount_Adjusted_Breakout_Momentum'] +
        df['Amount_Weighted_Opening_Trend']
    )

    # Incorporate Trend Strength
    df['EMA_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['EMA_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = df['EMA_12'] - df['EMA_26']
    df['Trend_Adjusted_Combined_Movements'] = df['Combined_Movements'] * df['MACD']

    # Calculate Moving Averages
    df['MA_Volume_Weighted_Intraday_Movement'] = df['Volume_Weighted_Intraday_Movement'].rolling(window=5).mean()
    df['MA_Amount_Weighted_Intraday_Movement'] = df['Amount_Weighted_Intraday_Movement'].rolling(window=5).mean()
    df['MA_Amount_Weighted_Opening_T
