```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=5, M=10):
    # Calculate Intraday and Breakout Price Movements
    df['Intraday_Movement'] = df['high'] - df['low']
    df['Breakout_Momentum'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Adjust by Volume and Amount
    df['Volume_Weighted_Intraday'] = df['Intraday_Movement'] * df['volume']
    df['Cumulative_Volume'] = df['volume'].rolling(window=N).sum()
    df['Volume_Adjusted_Breakout'] = df['Breakout_Momentum'] / df['Cumulative_Volume']
    
    df['Amount_Weighted_Intraday'] = df['Intraday_Movement'] * df['amount']
    df['Cumulative_Amount'] = df['amount'].rolling(window=N).sum()
    df['Amount_Adjusted_Breakout'] = df['Breakout_Momentum'] / df['Cumulative_Amount']
    
    # Incorporate Opening Trend and Amount Impact
    df['Opening_Trend'] = df['open'] - df['close'].shift(1)
    df['Amount_Weighted_Opening_Trend'] = df['Opening_Trend'] * df['amount']
    
    # Combine Weighted Movements
    df['Combined_Movements'] = (
        df['Volume_Weighted_Intraday'] + 
        df['Volume_Adjusted_Breakout'] + 
        df['Amount_Weighted_Intraday'] + 
        df['Amount_Adjusted_Breakout'] + 
        df['Amount_Weighted_Opening_Trend']
    )
    
    # Incorporate Trend Strength
    short_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_ema = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = short_ema - long_ema
    df['Trend_Adjusted_Movements'] = df['Combined_Movements'] * df['MACD']
    
    # Calculate Moving Averages
    df['MA_Volume_Weighted_Intraday'] = df['Volume_Weighted_Intraday'].rolling(window=5).mean()
    df['MA_Amount_Weighted_Intraday'] = df['Amount_Weighted_Intraday'].rolling(window=5).mean()
    df['MA_Amount_Weighted_Opening_Trend'] = df['Amount_Weighted_Opening_Trend'].rolling(window=5).mean()
    
    # Aggregate and Adjust Momentum
    df['Aggregated_Momentum'] = df['Trend_Adjusted_Movements'].rolling(window=M).sum()
    df['Adjusted_Momentum'] = df['Aggregated_Momentum'] - (
        df['MA_Volume_Weighted_Intraday'] + 
        df['MA_Amount_Weighted_Intraday'] + 
        df['MA_Amount_Weighted_Opening_Trend']
    )
    
    # Confirm with Volume and Intraday Return
    df['Avg_Volume_15_days'] = df['volume'].rolling(window=15).mean()
    df['Volume_Ratio'] = df['volume'] / df['Avg_Volume_15_days']
    df['Intraday_Return'] = df['close'] / df['open'] - 1
    
    def confirm_momentum(row):
        if row['Volume_Ratio'] > 1.5:
            return row['Adjusted_Momentum'] * row['Intraday_Return']
        else:
            return 0.5 * (row['Adjusted_Momentum'] + row['MACD'])
    
    df['Factor'] = df.apply(confirm_momentum, axis=1)
    
    return df['Factor']
```
