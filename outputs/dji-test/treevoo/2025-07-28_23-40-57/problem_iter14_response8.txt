```python
import pandas as pd

def heuristics_v2(df, N=10, M=5):
    # Calculate Intraday and Breakout Price Movements
    intraday_movement = df['high'] - df['low']
    breakout_momentum = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Adjust by Volume and Amount
    volume_weighted_intraday = intraday_movement * df['volume']
    cumulative_volume_N_days = df['volume'].rolling(window=N).sum()
    volume_adjusted_breakout = breakout_momentum / cumulative_volume_N_days
    
    amount_weighted_intraday = intraday_movement * df['amount']
    cumulative_amount_N_days = df['amount'].rolling(window=N).sum()
    amount_adjusted_breakout = breakout_momentum / cumulative_amount_N_days
    
    # Incorporate Opening Trend and Amount Impact
    opening_trend = df['open'] - df['close'].shift(1)
    amount_weighted_opening_trend = opening_trend * df['amount']
    
    combined_movements = (
        volume_weighted_intraday + 
        volume_adjusted_breakout + 
        amount_weighted_intraday + 
        amount_adjusted_breakout + 
        amount_weighted_opening_trend
    )
    
    # Incorporate Trend Strength
    short_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_ema = df['close'].ewm(span=26, adjust=False).mean()
    macd = short_ema - long_ema
    trend_adjusted_combined_movements = combined_movements * macd
    
    # Calculate Moving Averages
    ma_volume_weighted_intraday = volume_weighted_intraday.rolling(window=5).mean()
    ma_amount_weighted_intraday = amount_weighted_intraday.rolling(window=5).mean()
    ma_amount_weighted_opening_trend = amount_weighted_opening_trend.rolling(window=5).mean()
    
    # Aggregate and Adjust Momentum
    aggregated_momentum = trend_adjusted_combined_movements.rolling(window=M).sum()
    adjusted_aggregated_momentum = (
        aggregated_momentum - 
        ma_volume_weighted_intraday - 
        ma_amount_weighted_intraday - 
        ma_amount_weighted_opening_trend
    )
    
    # Confirm with Volume Trend
    average_volume_10_days = df['volume'].rolling(window=10).mean()
    volume_ratio = df['volume'] / average_volume_10_days
    final_momentum = adjusted_aggregated_momentum.copy()
    final_momentum[volume_ratio > 1.2] *= volume_ratio
    final_momentum[volume_ratio <= 1.2] = 0.5 * (adjusted_aggregated_momentum + macd)
    
    return final_momentum
```
