```python
import pandas as pd

def heuristics_v2(df, N=10, M=5):
    # Calculate High-Low Spread
    df['High_Low_Spread'] = df['high'] - df['low']
    
    # Calculate Momentum
    df['Momentum'] = df['High_Low_Spread'] / df['close'].shift(1)
    
    # Sum of Volumes Over N Days
    df['Cumulative_Volume'] = df['volume'].rolling(window=N).sum()
    
    # Adjust Momentum by Cumulative Volume
    df['Adjusted_Momentum'] = df['Momentum'] / df['Cumulative_Volume']
    
    # Calculate High-Low Range Return
    df['High_Low_Range_Return'] = (df['high'] - df['low']) / df['open']
    
    # Assign Weights to Each Period
    weights = list(range(1, M+1))
    df['Weighted_High_Low_Return'] = 0
    for i in range(M):
        df['Weighted_High_Low_Return'] += df['High_Low_Range_Return'].shift(i) * weights[i]
    df['Weighted_High_Low_Return'] /= sum(weights)
    
    # Integrate with Volume-Weighted Traded Amount
    df['Sum_Traded_Amounts'] = df['amount'].rolling(window=M).sum()
    df['Volume_Weighted_Traded_Amount_Factor'] = df['Weighted_High_Low_Return'] * df['Sum_Traded_Amounts']
    
    # Aggregate Momentum and Volume-Weighted Traded Amount
    df['Final_Factor'] = df['Adjusted_Momentum'] + df['Volume_Weighted_Traded_Amount_Factor']
    return df['Final_Factor'].dropna()

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
```
