```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Volume Proportion
    df['Intraday_Volume_Proportion'] = df['volume'] - (df['volume'].shift(1) + df['volume'].shift(-1))
    
    # Calculate Intraday Return
    df['Intraday_Return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate Intraday Volume Intensity
    df['Intraday_Volume_Intensity'] = df['Intraday_Volume_Proportion'] / (df['high'] - df['low'])
    
    # Calculate Volume Impact Score
    n_days = 10
    df['Volume_Sum'] = df['volume'].rolling(window=n_days).sum()
    df['Avg_High'] = df['high'].rolling(window=n_days).mean()
    df['Avg_Low'] = df['low'].rolling(window=n_days).mean()
    df['High_Low_Spread'] = df['Avg_High'] - df['Avg_Low']
    df['Volume_Impact_Score'] = df['High_Low_Spread'] / df['Volume_Sum']
    
    # Multiply Intraday Return by Volume Impact Score
    df['Factor_1'] = df['Intraday_Return'] * df['Volume_Impact_Score']
    
    # Calculate Price Momentum
    df['Price_Momentum'] = df['close'] - df['close'].shift(10)
    
    # Adjust by Volume
    df['Cumulative_Volume'] = df['volume'].rolling(window=10).sum()
    df['Adjusted_Momentum'] = df['Price_Momentum'] / df['Cumulative_Volume']
    
    # Calculate Cumulative Volume-Weighted Momentum
    df['Volume_Weighted_Momentum'] = df['Adjusted_Momentum'] * df['volume']
    df['Cumulative_Volume_Weighted_Momentum'] = df['Volume_Weighted_Momentum'].rolling(window=10).sum()
    
    # Confirm with Volume Trend
    df['Avg_Volume_5_Days'] = df['volume'].rolling(window=5).mean()
    df['Volume_Ratio'] = df['volume'] / df['Avg_Volume_5_Days']
    df['Aggregated_Momentum'] = df['Cumulative_Volume_Weighted_Momentum'].rolling(window=10).sum()
    
    def confirm_volume_trend(row):
        if row['Volume_Ratio'] > 1:
            return row['Price_Momentum'] * row['Intraday_Return'] * row['Aggregated_Momentum']
        else:
            return 0
    
    df['Final_Factor'] = df.apply(confirm_volume_trend, axis=1)
    
    # Calculate Weighted Intraday Volume Intensity
    df['Weighted_Intraday_Volume_Intensity'] = df['Intraday_Volume_Intensity'] * df['Intraday_Return']
    
    # Calculate Intraday and Breakout Momentum
    df['Momentum'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Adjust by Volume
    df['Adjusted_Momentum_Breakout'] = df['Momentum'] / df['Cumulative_Volume']
    
    # Aggregate Momentum Over M Days
    df['Aggregated_Momentum_Breakout'] = df['Adjusted_Momentum_Breakout'].rolling(window=10).sum()
    
    return df['Final_Factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date')
# factor_values = heuristics_v2(df)
```
