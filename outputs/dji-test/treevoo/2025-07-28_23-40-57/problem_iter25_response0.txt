```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Spread and Intraday Movement
    df['High_Low_Spread'] = df['high'] - df['low']
    df['Previous_Close'] = df['close'].shift(1)
    df['Breakout_Momentum'] = df['High_Low_Spread'] / df['Previous_Close']
    
    # Calculate Price Momentum
    df['Recent_Close'] = df['close']
    df['Close_20_days_ago'] = df['close'].shift(20)
    df['Price_Momentum'] = df['Recent_Close'] - df['Close_20_days_ago']
    
    # Adjust by Volume
    N = 10  # Number of days for volume sum
    df['Cumulative_Volume'] = df['volume'].rolling(window=N).sum()
    df['Adjusted_Momentum'] = (df['Breakout_Momentum'] + df['Price_Momentum']) / df['Cumulative_Volume']
    
    # Incorporate Opening Trend and Amount Impact
    df['Opening_Trend'] = df['open'] - df['Previous_Close']
    df['Amount_Weighted_Opening_Trend'] = df['Opening_Trend'] * df['amount']
    
    # Combine Weighted Movements
    df['Combined_Movements'] = (df['Adjusted_Momentum'] + 
                                df['Amount_Weighted_Opening_Trend'])
    
    # Incorporate Trend Strength
    df['Short_EMA'] = df['close'].ewm(span=12, adjust=False).mean()
    df['Long_EMA'] = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = df['Short_EMA'] - df['Long_EMA']
    df['Trend_Adjusted_Combined_Movements'] = df['Combined_Movements'] * df['MACD']
    
    # Calculate Intraday Return
    df['Intraday_Return'] = (df['close'] - df['open']) / df['open']
    
    # Calculate Intraday Volume Proportion
    df['Overnight_Volume'] = df['volume'].shift(1)
    df['Intraday_Volume_Proportion'] = df['volume'] - df['Overnight_Volume']
    
    # Calculate Intraday Volume Intensity
    df['High_Low_Price_Range'] = df['high'] - df['low']
    df['Intraday_Volume_Intensity'] = df['Intraday_Volume_Proportion'] / df['High_Low_Price_Range']
    
    # Calculate Volume Impact Score
    df['Sum_Volume_N_Days'] = df['volume'].rolling(window=N).sum()
    df['Average_High'] = df['high'].rolling(window=N).mean()
    df['Average_Low'] = df['low'].rolling(window=N).mean()
    df['Volume_Impact_Score'] = (df['Average_High'] - df['Average_Low']) / df['Sum_Volume_N_Days']
    
    # Multiply Intraday Return by Volume Impact Score
    df['Intraday_Return_Volume_Impact'] = df['Intraday_Return'] * df['Volume_Impact_Score']
    
    # Aggregate and Adjust Momentum
    df['5_day_MA_VWIM'] = df['Adjusted_Momentum'].rolling(window=5).mean()
    df['5_day_MA_AWIM'] = df['Amount_Weighted_Opening_Trend'].rolling(window=5).mean()
    df['Final_Factor'] = (df['Trend_Adjusted_Combined_Movements'] -
                          df['5_day_MA_VWIM'] -
                          df['5_day_MA_AWIM'])
    
    return df['Final_Factor']
```
