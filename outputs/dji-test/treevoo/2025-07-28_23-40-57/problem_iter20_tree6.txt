```txt
Calculate Intraday Return
├── Subtract Open from Close
└── Divide by Open

Calculate Volume Impact Score
├── Sum volume over 10 days
├── Average High price over 10 days
├── Average Low price over 10 days
├── Subtract Average Low from Average High
└── Divide by Sum of Volume

Generate Factor 1
├── Multiply Intraday Return by Volume Impact Score

Calculate Intraday Volume Proportion
├── Use Volume
└── Subtract Overnight Volume
    ├── Use Previous Close Volume
    └── Use Open Volume

Calculate Intraday Volume Intensity
├── Use Intraday Volume Proportion
└── Divide by High-Low Range
    ├── Use High price
    └── Use Low price

Calculate Weighted Intraday Volume Intensity
├── Use Intraday Volume Intensity
└── Weight by Intraday Return

Calculate Intraday and Breakout Momentum
├── Calculate High-Low Spread
│   ├── Use High price
│   └── Use Low price
└── Divide by Previous Close
    └── Use Close price from previous day

Adjust by Cumulative Volume
├── Sum Volumes Over N Days
│   └── Use Volume
└── Divide Momentum by Cumulative Volume

Calculate Volume-Adjusted Momentum
├── Use Adjusted Momentum
└── Multiply by Intraday Volume Proportion

Calculate Cumulative Volume-Weighted Momentum
├── Use Volume-Adjusted Momentum
└── Multiply by Volume and Sum over a fixed period (e.g., 10 days)

Aggregate Momentum Over M Days
└── Sum over M days

Confirm with Volume Trend
├── Compute Average Volume (Past 5 Days)
├── Get Current Day Volume
├── Compute Volume Ratio
│   ├── Divide Current Day Volume by Average Volume
└── Combine Price and Intraday Momentum
    ├── If Volume Ratio > 1
    │   └── Multiply Price Momentum by Intraday Return (Factor 2)
    └── Otherwise, set Factor 2 to 0

Final Factor
├── Multiply Factor 1 by Factor 2
└── Interpretation
    ├── Higher combined factor indicates stronger momentum with both volume and intraday confirmation
    └── Lower combined factor suggests weaker momentum or less volume and intraday confirmation
```
