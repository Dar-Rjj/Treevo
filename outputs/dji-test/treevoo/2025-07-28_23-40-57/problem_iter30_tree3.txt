```txt
Calculate Intraday Return
├── Subtract Open from Close
└── Divide by Open
    └── Intraday Return

Calculate Volume Impact Score
├── Sum volume over n days (e.g., 10 days)
├── Subtract Average Low from Average High
└── Divide by Sum of Volume
    └── Volume Impact Score

Multiply Intraday Return by Volume Impact Score
└── Intermediate Factor (Factor 1)

Calculate Price Momentum
├── Get the most recent close
├── Get the close from 10 days ago
└── Compute the difference (Price Momentum = Recent Close - Close 10 days ago)

Adjust Price Momentum by Volume
├── Sum of Volumes Over N Days
└── Divide Price Momentum by Cumulative Volume
    └── Adjusted Momentum (Adjusted Momentum = Price Momentum / Cumulative Volume)

Calculate Cumulative Volume-Weighted Momentum
├── Multiply Adjusted Momentum by Volume
└── Sum over a fixed period (e.g., 10 days)
    └── Cumulative Volume-Weighted Momentum

Confirm with Volume Trend
├── Compute Average Volume (Past 5 Days)
├── Compute Volume Ratio
│   ├── Divide Current Day Volume by Average Volume
│   └── Volume Ratio
├── If Volume Ratio > 1
│   ├── Combine Price and Intraday Momentum
│   │   ├── Multiply Price Momentum by Intraday Return
│   │   │   └── Combined Momentum
│   │   └── Aggregate Momentum Over M Days
│   │       └── Use Cumulative Volume-Weighted Momentum
│   │       └── Sum over M days
│   │           └── Aggregated Momentum
│   └── Final Factor = Factor 1 * Aggregated Momentum
├── Otherwise, set Final Factor to 0.5 * Factor 1
└── Introduce Volatility Component
    ├── Calculate Standard Deviation of Daily Returns (Last 20 Days)
    ├── Multiply Final Factor by (1 + Standard Deviation)
    └── Adjusted Final Factor
```
