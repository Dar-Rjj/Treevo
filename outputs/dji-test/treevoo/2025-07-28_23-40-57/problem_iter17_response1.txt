```python
def heuristics_v2(df):
    # Calculate the typical price
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    
    # Calculate the money flow
    money_flow = typical_price * df['volume']
    
    # Calculate the money flow index
    money_flow_index = money_flow.rolling(window=14).sum() / (typical_price.rolling(window=14).sum())
    
    # Calculate the price change
    price_change = df['close'].diff()
    
    # Calculate the positive and negative price changes
    pos_price_change = price_change.apply(lambda x: x if x > 0 else 0)
    neg_price_change = price_change.apply(lambda x: -x if x < 0 else 0)
    
    # Calculate the positive and negative money flows
    pos_money_flow = money_flow * pos_price_change
    neg_money_flow = money_flow * neg_price_change
    
    # Calculate the positive and negative money flow indices
    pos_money_flow_index = pos_money_flow.rolling(window=14).sum() / (pos_price_change.rolling(window=14).sum())
    neg_money_flow_index = neg_money_flow.rolling(window=14).sum() / (neg_price_change.rolling(window=14).sum())
    
    # Calculate the money flow ratio
    money_flow_ratio = pos_money_flow_index / neg_money_flow_index
    
    # Calculate the final alpha factor
    alpha_factor = money_flow_ratio - money_flow_index
    
    return alpha_factor
```
