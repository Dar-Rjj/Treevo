```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Spread and Intraday Movement
    df['high_low_spread'] = (df['high'] - df['low']) / df['close'].shift(1)

    # Calculate Price Momentum
    df['price_momentum'] = df['close'] - df['close'].shift(20)
    
    # Calculate Intraday Returns
    df['intraday_return'] = (df['high'] - df['low']) / df['low']
    
    # Adjust by Volume
    N = 20
    df['cumulative_volume'] = df['volume'].rolling(window=N).sum()
    df['adjusted_momentum'] = (df['high_low_spread'] + df['price_momentum']) / df['cumulative_volume']
    
    # Volume-Weighted and Amount-Weighted Movements
    df['volume_weighted_intraday'] = df['intraday_return'] * df['volume']
    df['cumulative_amount'] = df['amount'].rolling(window=N).sum()
    df['amount_weighted_intraday'] = df['intraday_return'] * df['amount']
    df['volume_adjusted_breakout'] = df['high_low_spread'] / df['cumulative_volume']
    df['amount_adjusted_breakout'] = df['high_low_spread'] / df['cumulative_amount']
    
    # Incorporate Opening Trend and Amount Impact
    df['opening_trend'] = df['open'] - df['close'].shift(1)
    df['amount_weighted_opening_trend'] = df['opening_trend'] * df['amount']
    
    # Combine Weighted Movements
    df['combined_movements'] = (
        df['volume_weighted_intraday'] + 
        df['volume_adjusted_breakout'] + 
        df['amount_weighted_intraday'] + 
        df['amount_adjusted_breakout'] + 
        df['amount_weighted_opening_trend']
    )
    
    # Incorporate Trend Strength
    short_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_ema = df['close'].ewm(span=26, adjust=False).mean()
    df['macd'] = short_ema - long_ema
    df['trend_adjusted_combined_movements'] = df['combined_movements'] * df['macd']
    
    # Calculate Moving Averages
    df['ma_volume_weighted_intraday'] = df['volume_weighted_intraday'].rolling(window=5).mean()
    df['ma_amount_weighted_intraday'] = df['amount_weighted_intraday'].rolling(window=5).mean()
    df['ma_amount_weighted_opening_trend'] = df['amount_weighted_opening_trend'].rolling(window=5).mean()
    
    # Aggregate and Adjust Momentum
    M = 5
    df['trend_adjusted_sum'] = df['trend_adjusted_combined_movements'].rolling(window=M).sum()
    df['final_factor'] = (
        df['trend_adjusted_sum'] - 
        df['ma_volume_weighted_intraday'] - 
        df['ma_amount_weighted_intraday'] - 
        df['ma_amount_weighted_opening_trend']
    )

    return df['final_factor']
```
