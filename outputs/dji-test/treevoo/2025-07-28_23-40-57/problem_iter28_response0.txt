```python
import pandas as pd

def heuristics_v2(df, n=10, m=5):
    # Calculate Intraday Volume Proportion
    intraday_vol_prop = df['volume'] - (df['volume'].shift(1) - df['volume'])

    # Calculate Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']

    # Calculate Intraday Volume Intensity
    intraday_vol_intensity = intraday_vol_prop / (df['high'] - df['low'])

    # Calculate Volume Impact Score
    vol_impact_score = (df['volume'].rolling(window=n).sum()) / ((df['high'].rolling(window=n).mean() - df['low'].rolling(window=n).mean()))

    # Calculate Weighted Intraday Volume Intensity
    weighted_intraday_vol_intensity = intraday_vol_intensity * intraday_return

    # Calculate Intraday and Breakout Momentum
    breakout_momentum = (df['high'] - df['low']) / df['close'].shift(1)

    # Adjust by Cumulative Volume
    adj_breakout_momentum = breakout_momentum / df['volume'].rolling(window=n).sum()

    # Generate Factor 1
    factor_1 = intraday_return * vol_impact_score

    # Confirm with Volume Trend
    volume_ratio = df['volume'] / df['volume'].rolling(window=15).mean()
    factor_2 = intraday_return * breakout_momentum
    factor_2[volume_ratio <= 1] = 0

    # Adjust by Enhanced Volume Trend
    agg_momentum = 0.3 * (breakout_momentum + intraday_return)
    high_volume_days = (volume_ratio > 1.5)
    agg_momentum[high_volume_days] = (adj_breakout_momentum * df['volume']).rolling(window=m).sum()
    
    # Final Factor
    final_factor = factor_1 * agg_momentum
    
    return final_factor
```
