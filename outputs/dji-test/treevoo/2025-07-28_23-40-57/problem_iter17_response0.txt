```python
import pandas as pd

def heuristics_v2(df, N=5, M=10):
    # Intraday and Breakout Movements
    df['intraday_movement'] = df['high'] - df['low']
    df['breakout_momentum'] = (df['high'] - df['low']) / df['close'].shift(1)
    
    # Volume-Weighted Adjustments
    df['volume_weighted_intraday'] = df['intraday_movement'] * df['volume']
    df['cumulative_volume_N_days'] = df['volume'].rolling(window=N).sum()
    df['volume_adjusted_breakout'] = df['breakout_momentum'] / df['cumulative_volume_N_days']
    
    # Amount-Weighted Adjustments
    df['amount_weighted_intraday'] = df['intraday_movement'] * df['amount']
    df['cumulative_amount_N_days'] = df['amount'].rolling(window=N).sum()
    df['amount_adjusted_breakout'] = df['breakout_momentum'] / df['cumulative_amount_N_days']
    
    # Opening Trend Impact
    df['opening_trend'] = df['open'] - df['close'].shift(1)
    df['amount_weighted_opening_trend'] = df['opening_trend'] * df['amount']
    
    # MACD for Trend Strength
    short_ema = df['close'].ewm(span=12, adjust=False).mean()
    long_ema = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = short_ema - long_ema
    
    # Combine Weighted Movements
    df['combined_movements'] = (
        df['volume_weighted_intraday'] + 
        df['volume_adjusted_breakout'] +
        df['amount_weighted_intraday'] +
        df['amount_adjusted_breakout'] +
        df['amount_weighted_opening_trend']
    ) * df['MACD']
    
    # Calculate Moving Averages
    df['vol_weighted_intraday_5d_ma'] = df['volume_weighted_intraday'].rolling(window=5).mean()
    df['amt_weighted_intraday_5d_ma'] = df['amount_weighted_intraday'].rolling(window=5).mean()
    df['amt_weighted_opening_trend_5d_ma'] = df['amount_weighted_opening_trend'].rolling(window=5).mean()
    
    # Aggregate and Adjust Momentum
    df['trend_adjusted_combined_momentum'] = df['combined_movements'].rolling(window=M).sum()
    df['aggregated_momentum'] = (
        df['trend_adjusted_combined_momentum'] - 
        df['vol_weighted_intraday_5d_ma'] - 
        df['amt_weighted_intraday_5d_ma'] - 
        df['amt_weighted_opening_trend_5d_ma']
    )
    
    # Confirm with Volume Trend
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=15).mean()
    df['final_alpha'] = df.apply(lambda row: 
        row['aggregated_momentum'] if row['volume_ratio'] > 1.5 else 0.5 * (row['aggregated_momentum'] + row['MACD']), axis=1
    )
    
    return df['final_alpha']
```
