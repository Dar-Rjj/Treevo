```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']

    # Volume Impact Score
    volume_10d_sum = df['volume'].rolling(window=10).sum()
    avg_high_10d = df['high'].rolling(window=10).mean()
    avg_low_10d = df['low'].rolling(window=10).mean()
    price_range_10d = avg_high_10d - avg_low_10d
    volume_impact_score = price_range_10d / volume_10d_sum

    # Generate Factor 1
    factor_1 = intraday_return * volume_impact_score

    # Intraday and Breakout Price Movements
    intraday_movement = df['high'] - df['low']
    breakout_momentum = (df['high'] - df['low']) / df['close'].shift(1)

    # Adjust by Volume and Amount
    volume_weighted_intraday_movement = intraday_movement * df['volume']
    cumulative_volume_10d = df['volume'].rolling(window=10).sum()
    volume_adjusted_breakout_momentum = breakout_momentum / cumulative_volume_10d

    amount_weighted_intraday_movement = intraday_movement * df['amount']
    cumulative_amount_10d = df['amount'].rolling(window=10).sum()
    amount_adjusted_breakout_momentum = breakout_momentum / cumulative_amount_10d

    # Incorporate Opening Trend and Amount Impact
    opening_trend = df['open'] - df['close'].shift(1)
    amount_weighted_opening_trend = opening_trend * df['amount']

    # Combine Weighted Movements
    combined_movements = (
        volume_weighted_intraday_movement +
        volume_adjusted_breakout_momentum +
        amount_weighted_intraday_movement +
        amount_adjusted_breakout_momentum +
        amount_weighted_opening_trend
    )

    # Incorporate Trend Strength
    ema_short = df['close'].ewm(span=12, adjust=False).mean()
    ema_long = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_short - ema_long
    trend_adjusted_combined_momentum = combined_movements * macd

    # Calculate Moving Averages
    ma_volume_weighted_intraday_5d = volume_weighted_intraday_movement.rolling(window=5).mean()
    ma_amount_weighted_intraday_5d = amount_weighted_intraday_movement.rolling(window=5).mean()
    ma_amount_weighted_opening_trend_5d = amount_weighted_opening_trend.rolling(window=5).mean()

    # Aggregate and Adjust Momentum
    aggregated_momentum = trend_adjusted_combined_momentum.rolling(window=5).sum()
    adjusted_aggregated_momentum = aggregated_momentum - ma_volume_weighted_intraday_5d - ma_amount_weighted_intraday_5d - ma_amount_weighted_opening_trend_5d

    # Confirm with Volume and Intraday Return
    average_volume_15d = df['volume'].rolling(window=15).mean()
    volume_ratio = df['volume'] / average_volume_15d
    confirmed_momentum = np.where(volume_ratio > 2.0, adjusted_aggregated_momentum * intraday_return, 0.5 * (adjusted_aggregated_momentum + macd))

    # Final Factor
    final_factor = factor_1 * confirmed_momentum

    return final_factor
```
