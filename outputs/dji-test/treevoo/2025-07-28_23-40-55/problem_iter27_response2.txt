```python
import pandas as pd

def heuristics_v2(df):
    # Calculate short-term price momentum
    df['short_momentum'] = df['close'] - df['close'].rolling(window=5).mean()
    
    # Calculate medium-term price momentum
    df['medium_momentum'] = df['close'] - df['close'].rolling(window=20).mean()
    
    # Calculate long-term price momentum
    df['long_momentum'] = df['close'] - df['close'].rolling(window=60).mean()
    
    # Analyze recent volatility
    df['returns'] = df['close'].pct_change()
    df['volatility_5'] = df['returns'].rolling(window=5).std()
    df['volatility_20'] = df['returns'].rolling(window=20).std()
    df['volatility_60'] = df['returns'].rolling(window=60).std()
    
    # Examine trading volume trends
    df['volume_ratio_5'] = df['volume'] / df['volume'].rolling(window=5).mean()
    df['volume_ratio_20'] = df['volume'] / df['volume'].rolling(window=20).mean()
    df['volume_ratio_60'] = df['volume'] / df['volume'].rolling(window=60).mean()
    
    # Investigate the relationship between price and volume
    df['return_volume_corr_5'] = df['returns'].rolling(window=5).corr(df['volume'])
    df['return_volume_corr_20'] = df['returns'].rolling(window=20).corr(df['volume'])
    df['return_volume_corr_60'] = df['returns'].rolling(window=60).corr(df['volume'])
    
    # Analyze intraday price movement
    df['high_low_diff'] = df['high'] - df['low']
    df['open_close_diff'] = df['close'] - df['open']
    df['close_high_low_ratio'] = df['close'] / (df['high'] - df['low'])
    
    # Combine price and volume indicators
    df['composite_momentum'] = df['short_momentum'] + df['medium_momentum'] + df['long_momentum']
    df['composite_volatility'] = df['volatility_5'] + df['volatility_20'] + df['volatility_60']
    df['composite_price_volume'] = df['short_momentum'] * df['volume_ratio_5']
    
    # Evaluate the impact of gaps
    df['gap'] = df['open'] - df['close'].shift(1)
    df['gap_positive'] = df['gap'] > 0
    df['gap_negative'] = df['gap'] < 0
    df['consecutive_gap_pos'] = df['gap_positive'].groupby((df['gap_positive'] != df['gap_positive'].shift()).cumsum()).cumsum()
    df['consecutive_gap_neg'] = df['gap_negative'].groupby((df['gap_negative'] != df['gap_negative'].shift()).cumsum()).cumsum()
    
    # Investigate the impact of transaction amount
    df['amount_ratio_5'] = df['amount'] / df['amount'].rolling(window=5).mean()
    df['amount_ratio_20'] = df['amount'] / df['amount'].rolling(window=20).mean()
    df['amount_ratio_60'] = df['amount'] / df['amount'].rolling(window=60).mean()
    
    # Consider the relationship between price and transaction amount
    df['return_amount_corr_5'] = df['returns'].rolling(window=5).corr(df['amount'])
    df['return_amount_corr_20'] = df['returns'].rolling(window=20).corr(df['amount'])
    df['return_amount_corr_60'] = df['returns'].rolling(window=60).corr(df['amount'])
    
    # Final factor: a composite of all the above factors
    df['alpha_factor'] = (
        df['composite_momentum'] + 
        df['composite_volatility'] + 
        df['composite_price_volume'] + 
        df['high_low_diff'] + 
        df['open_close_diff'] + 
        df['close_high_low_ratio'] + 
        df['gap'] + 
        df['consecutive_gap_pos'] - 
        df['consecutive_gap_neg'] + 
        df['amount_ratio_5'] + 
        df['amount_ratio_20'] + 
        df['amount_ratio_60'] + 
        df['return_amount_corr_5'] + 
        df['return_amount_corr_20'] + 
        df['return_amount_corr_60']
    )
    
    return df['alpha_factor
