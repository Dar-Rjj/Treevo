```python
import pandas as pd

def heuristics_v2(df):
    # Simple Moving Averages
    df['SMA5'] = df['close'].rolling(window=5).mean()
    df['SMA10'] = df['close'].rolling(window=10).mean()
    df['SMA20'] = df['close'].rolling(window=20).mean()
    
    # SMA Heuristics
    df['SMA5_10'] = (df['SMA5'] - df['SMA10']) / df['SMA10']
    df['SMA10_20'] = (df['SMA10'] - df['SMA20']) / df['SMA20']
    
    # Weighted Moving Averages
    df['WMA5'] = df['close'].rolling(window=5).apply(lambda x: (x * pd.Series(range(1, 6))).sum() / 15)
    df['WMA10'] = df['close'].rolling(window=10).apply(lambda x: (x * pd.Series(range(1, 11))).sum() / 55)
    df['WMA20'] = df['close'].rolling(window=20).apply(lambda x: (x * pd.Series(range(1, 21))).sum() / 210)
    
    # WMA Heuristics
    df['WMA5_10'] = (df['WMA5'] - df['WMA10']) / df['WMA10']
    df['WMA10_20'] = (df['WMA10'] - df['WMA20']) / df['WMA20']
    
    # Average True Range
    df['TR'] = df[['high', 'low']].apply(lambda x: x['high'] - x['low'], axis=1)
    df['ATR14'] = df['TR'].rolling(window=14).mean()
    df['ATR_Ratio'] = df['ATR14'] / df['close']
    
    # On-Balance Volume
    df['OBV'] = 0.0
    df.loc[df['close'] > df['close'].shift(1), 'OBV'] = df['volume']
    df.loc[df['close'] < df['close'].shift(1), 'OBV'] = -df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    # Chaikin Money Flow
    df['MF_Multiplier'] = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    df['MF_Volume'] = df['MF_Multiplier'] * df['volume']
    df['CMF20'] = df['MF_Volume'].rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Price and Volume Ratios
    df['Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=20).mean()
    df['Price_Ratio'] = df['close'] / df['close'].rolling(window=20).mean()
    df['PV_Ratio'] = df['Volume_Ratio'] * df['Price_Ratio']
    
    # Candlestick Patterns
    df['Bullish_Engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] > df['open'].shift(1))).astype(int)
    df['Bearish_Engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] < df['open'].shift(1))).astype(int)
    df['Engulfing_Score'] = df['Bullish_Engulfing'] - df['Bearish_Engulfing']
    
    # Combine all the features into a final heuristic factor
    factor = (
        df['SMA5_10'] + 
        df['SMA10_20'] + 
        df['WMA5_10'] + 
        df['WMA10_20'] + 
        df['ATR_Ratio'] + 
        df['CMF20'] + 
        df['PV_Ratio'] + 
        df['Engulfing_Score']
    )
    
    return factor
```
