```python
import pandas as pd

def heuristics_v2(df):
    # Intraday volatility measures
    df['daily_price_range'] = df['high'] - df['low']
    df['intraday_true_range'] = df[['high', 'close', 'open']].max(axis=1) - df[['high', 'close', 'open']].min(axis=1)
    
    # Trading activity through volume
    df['volume_20d_ma'] = df['volume'].rolling(window=20).mean()
    df['volume_rel_20d_ma'] = df['volume'] / df['volume_20d_ma']
    df['volume_spike'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    
    # Price movement indicators
    df['close_minus_open'] = df['close'] - df['open']
    df['close_position'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    
    # Incorporate amount traded
    df['amount_per_share'] = df['amount'] / df['volume']
    df['amount_to_close_ratio'] = df['amount'] / df['close']
    
    # Momentum in price and volume
    df['momentum_close_10d'] = df['close'] - df['close'].shift(10)
    df['momentum_volume_10d'] = df['volume'] - df['volume'].shift(10)
    
    # Technical patterns
    df['doji'] = (abs(df['close'] - df['open']) < 0.005 * (df['high'] - df['low'])) & (df['high'] - df['low'] > 0.02 * df['close'])
    df['hammer'] = (df['close'] > df['open']) & ((df['close'] - df['open']) > 0.5 * (df['high'] - df['low']))
    
    # Historical returns
    df['return_5d'] = df['close'].pct_change(periods=5)
    df['return_20d'] = df['close'].pct_change(periods=20)
    
    # Trend indicators
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['sma_200'] = df['close'].rolling(window=200).mean()
    df['sma_crossover'] = (df['sma_50'] > df['sma_200']).astype(int)
    
    # Accumulation/Distribution
    df['ad_line'] = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']
    df['ad_line'] = df['ad_line'].cumsum()
    df['ad_oscillator'] = df['ad_line'] - df['ad_line'].rolling(window=14).mean()
    
    # Combine all factors into a single alpha factor
    alpha_factor = (df['close_position'] + 
                    df['momentum_close_10d'] + 
                    df['sma_crossover'] + 
                    df['ad_oscillator'] + 
                    df['return_5d'] + 
                    df['return_20d'] + 
                    df['volume_rel_20d_ma'] + 
                    df['volume_spike'] + 
                    df['doji'].astype(int) + 
                    df['hammer'].astype(int))
    
    return alpha_factor
```
