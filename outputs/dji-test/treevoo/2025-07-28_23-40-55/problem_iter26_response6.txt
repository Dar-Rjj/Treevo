```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 1-day, 5-day, 20-day, and 60-day returns
    df['1d_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['5d_return'] = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    df['20d_return'] = (df['close'] - df['close'].shift(20)) / df['close'].shift(20)
    df['60d_return'] = (df['close'] - df['close'].shift(60)) / df['close'].shift(60)

    # Calculate 20-day standard deviation of daily returns
    df['daily_return'] = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    df['20d_volatility'] = df['daily_return'].rolling(window=20).std()

    # Calculate 5-day and 20-day average trading volume
    df['5d_avg_volume'] = df['volume'].rolling(window=5).mean()
    df['20d_avg_volume'] = df['volume'].rolling(window=20).mean()

    # Calculate 20-day moving average
    df['20d_ma'] = df['close'].rolling(window=20).mean()

    # Count the number of days where close is above and below the 20-day moving average
    df['days_above_20d_ma'] = (df['close'] > df['20d_ma']).rolling(window=20).sum()
    df['days_below_20d_ma'] = (df['close'] < df['20d_ma']).rolling(window=20).sum()

    # Calculate the proportion of up and down days over a 20-day period
    df['up_day'] = (df['close'] > df['open'])
    df['down_day'] = (df['close'] < df['open'])
    df['20d_up_proportion'] = df['up_day'].rolling(window=20).mean()
    df['20d_down_proportion'] = df['down_day'].rolling(window=20).mean()

    # Create the alpha factor by combining all the sub-factors
    df['alpha_factor'] = (
        df['1d_return'] + 
        df['5d_return'] + 
        df['20d_return'] + 
        df['60d_return'] -
        df['20d_volatility'] +
        df['5d_avg_volume'] +
        df['20d_avg_volume'] +
        df['days_above_20d_ma'] -
        df['days_below_20d_ma'] +
        df['20d_up_proportion'] -
        df['20d_down_proportion']
    )

    return df['alpha_factor']
```
