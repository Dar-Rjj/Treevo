```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday volatility and momentum measures
    df['daily_price_range'] = df['high'] - df['low']
    df['intraday_true_range'] = df[['high', 'close', 'open']].max(axis=1) - df[['high', 'close', 'open']].min(axis=1)
    df['1_day_return'] = (df['close'].shift(-1) - df['close']) / df['close']
    df['5_day_return'] = (df['close'].shift(-5) - df['close']) / df['close']
    df['20_day_return'] = (df['close'].shift(-20) - df['close']) / df['close']
    df['60_day_return'] = (df['close'].shift(-60) - df['close']) / df['close']
    df['20_day_std'] = df['1_day_return'].rolling(window=20).std()
    df['10_day_momentum'] = df['close'] / df['close'].shift(10) - 1
    
    # Analyze trading activity and volume
    df['volume_20_ma'] = df['volume'].rolling(window=20).mean()
    df['volume_spike'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['5_day_avg_volume'] = df['volume'].rolling(window=5).mean()
    df['20_day_avg_volume'] = df['volume'].rolling(window=20).mean()
    
    # Price movements and support/resistance levels
    df['C_O'] = df['close'] - df['open']
    df['C_L_relative'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    df['above_20dma'] = (df['close'] > df['close'].rolling(window=20).mean()).astype(int)
    df['below_20dma'] = (df['close'] < df['close'].rolling(window=20).mean()).astype(int)
    
    # Amount traded
    df['amount_per_share'] = df['amount'] / df['volume']
    df['amount_to_close_ratio'] = df['amount'] / df['close']
    
    # Historical returns and trend indicators
    df['5_day_simple_return'] = df['close'].pct_change(periods=5)
    df['20_day_simple_return'] = df['close'].pct_change(periods=20)
    df['50_sma'] = df['close'].rolling(window=50).mean()
    df['200_sma'] = df['close'].rolling(window=200).mean()
    df['sma_crossover'] = (df['50_sma'] > df['200_sma']).astype(int)
    
    # Accumulation/Distribution and technical patterns
    df['A_D_Line'] = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']
    df['A_D_Oscillator'] = df['A_D_Line'] - df['A_D_Line'].shift(14)
    df['doji_pattern'] = (abs(df['close'] - df['open']) < 0.005 * (df['high'] - df['low'])) & (df['high'] - df['low'] > 0.005 * df['close'])
    df['hammer_pattern'] = (df['close'] > df['open']) & ((df['high'] - df['close']) < 0.1 * (df['high'] - df['low']))
    
    # Intraday sentiment
    df['up_days'] = (df['close'] > df['open']).rolling(window=20).sum() / 20
    df['down_days'] = (df['close'] < df['open']).rolling(window=20).sum() / 20
    
    # Composite factor
    df['alpha_factor'] = (df['5_day_return'] + 
                          df['20_day_return'] + 
                          df['10_day_momentum'] + 
                          df['volume_spike'] + 
                          df['C_O'] + 
                          df['C_L_relative'] + 
                          df['sma_crossover'] + 
                          df['A_D_Oscillator'] + 
                          df['up_days'] - 
                          df['down_days'])
    
    return df['alpha_factor']
```
