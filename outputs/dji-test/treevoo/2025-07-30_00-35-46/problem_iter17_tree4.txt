```txt
Intraday Momentum with Enhanced Volume-Adjusted Synchronization, Smoothed Shocks, and OBV Factor
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Compute Open-Close Return
│   │   ├── Use Open price
│   │   └── Use Close price
│   └── Combine High-Low and Open-Close Returns
│       ├── Weighted Average of High-Low Difference and Open-Close Return
│       │   ├── Assign Weights based on Volatility
│       │   │   ├── Compute Historical Volatility
│       │   │   │   ├── Use High, Low, and Close prices
│       │   │   │   └── Compute Daily Returns
│       │   │   └── Assign Higher Weight to More Volatile Days
├── Apply Enhanced Volume and Price Shock Filter
│   ├── Determine Volume Change
│   │   ├── Use Current Volume
│   │   └── Use Previous Day Volume
│   ├── Compute Volume Ratio
│   │   ├── Current Volume / Previous Day Volume
│   ├── Determine Amount Change
│   │   ├── Use Current Amount
│   │   └── Use Previous Day Amount
│   ├── Compute Amount Ratio
│   │   ├── Current Amount / Previous Day Amount
│   ├── Determine Price Shock
│   │   ├── Compute Absolute Price Change
│   │   │   ├── Use Close price
│   │   │   └── Use Previous Day Close price
│   │   └── Compute Price Shock Ratio
│   │       ├── Absolute Price Change / Historical Price Range
│   │       │   ├── Use High and Low prices
│   └── Threshold Filter
│       ├── Set a Volume Shock Threshold (e.g., 1.5)
│       ├── Set an Amount Shock Threshold (e.g., 1.5)
│       ├── Set a Price Shock Threshold (e.g., 0.05)
│       └── Include Intraday Momentum if (Volume Ratio > Volume Threshold) AND (Amount Ratio > Amount Threshold) AND (Price Shock Ratio > Price Shock Threshold)
├── Adjust for Volume
│   ├── Use Volume
│   └── Divide Combined Metric by Volume
├── Measure Volume Synchronization
│   ├── Compute Volume Change
│   │   ├── Use Volume
│   │   └── Subtract Previous Day's Volume
│   ├── Compute Price Change
│   │   ├── Use Close price
│   │   └── Subtract Previous Day's Close
│   └── Synchronize Changes
│       ├── Multiply Volume Change and Price Change
│       └── Sign of the Synchronized Product
├── Introduce Smoothing Factor
│   ├── Apply Exponential Moving Average (EMA) to Volume and Amount Ratios
│   │   ├── Set EMA Alpha (e.g., 0.2)
│   └── Apply Exponential Moving Average (EMA) to Price Shock Ratio
│       ├── Set EMA Alpha (e.g., 0.2)
├── Trend Confirmation
│   ├── Moving Average Crossover
│   │   ├── Short-Term Moving Average (e.g., 5 days)
│   │   │   ├── Use Close prices
│   │   └── Long-Term Moving Average (e.g., 20 days)
│   │       ├── Use Close prices
│   │   └── Crossover Signal
│   │       ├── Generate Buy Signal if Short-Term > Long-Term
│   │       └── Generate Sell Signal if Short-Term < Long-Term
│   └── Integrate with Intraday Momentum
│       ├── If Crossover is Bullish, Amplify Intraday Momentum
│       └── If Crossover is Bearish, Dampen Intraday Momentum
├── Calculate On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by Difference between Short and Long EMA
│   └── Weight = |Short EMA - Long EMA|
├── Multiply OBV by Weight
│   └── Final OBV Factor = OBV * Weight
├── Synthesize Combined Factor
    ├── Combine Volume-Adjusted Intraday Metric with Synchronization
    │   ├── Add Volume-Adjusted Intraday Metric
    │   └── Add Synchronization Value
    ├── Incorporate Smoothed Price Shock
    │   ├── Add
