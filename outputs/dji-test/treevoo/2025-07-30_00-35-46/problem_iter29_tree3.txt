```txt
Integrated and Enhanced Intraday Momentum, Volume Dynamics, and OBV Factor with EMA and MACD Weights
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference (High - Low)
│   └── Compute Open-Close Return (Close / Open - 1)
│   ├── Combine High-Low and Open-Close Returns
│       ├── Average of Intraday Return and High-Low Difference
├── Apply Volume and Price Shock Filter
│   ├── Determine Volume Ratio (Current Volume / Previous Day Volume)
│   ├── Determine Amount Ratio (Current Amount / Previous Day Amount)
│   ├── Determine Price Shock
│       ├── Absolute Price Change (|Close - Previous Close|)
│       └── Price Shock Ratio (Absolute Price Change / Historical Price Range)
│   └── Threshold Filter
│       └── Include Intraday Momentum if (Volume Ratio > 1.5) AND (Amount Ratio > 1.5) AND (Price Shock Ratio > 0.05)
├── Adjust for Volume
│   └── Divide Combined Metric by Current Volume
├── Measure Volume Synchronization
│   ├── Compute Volume Change (Current Volume - Previous Day Volume)
│   ├── Compute Price Change (Close - Previous Day Close)
│   ├── Apply Volume Shock Filter (Volume Ratio > 1.5)
│   └── Synchronize Changes
│       └── Sign of (Volume Change * Price Change)
├── Trend Confirmation
│   ├── Short-Term EMA (5 days)
│   │   └── Use Close prices
│   ├── Long-Term EMA (20 days)
│   │   └── Use Close prices
│   └── Crossover Signal
│       ├── Generate Buy Signal if Short-Term > Long-Term
│       └── Generate Sell Signal if Short-Term < Long-Term
├── Integrate with Intraday Momentum
│   ├── If Crossover is Bullish, Amplify Intraday Momentum
│   └── If Crossover is Bearish, Dampen Intraday Momentum
├── Smoothing
│   ├── Exponential Moving Average (EMA) with Span of 5
│       └── On the synthesized and filtered Combined Momentum
├── Calculate On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by EMA and MACD Line Differences
│   ├── EMA Weight = |Short EMA - Long EMA|
│   ├── MACD Line
│   │   └── 12-day EMA of Close - 26-day EMA of Close
│   ├── Signal Line
│   │   └── 9-day EMA of MACD Line
│   └── MACD Weight = |MACD Line - Signal Line|
├── Final OBV Factor
│   └── OBV * (EMA Weight + MACD Weight)
└── Synthesize Final Alpha Factor
    ├── Add Volume-Adjusted Intraday Metric, Synchronization Value, and OBV-Momentum Factor
    └── Integrate Volume-Weighted Intraday Momentum with OBV Factor
        ├── Multiply Smoothed Intraday Momentum by Final OBV Factor
        └── Final Alpha Factor = Smoothed Intraday Momentum * Final OBV Factor (if Volume Ratio > 1.5)
```
