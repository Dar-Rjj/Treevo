```txt
Volume and Momentum Enhanced Alpha Factor with Intraday Activity and Shock Filter
├── Intraday Price Range
│   └── Subtract Low from High
├── Volume Adjustment
│   ├── Divide Volume by Mean of last 5 days Volume
│   └── Add 0.01 to avoid division by zero
├── Adjusted Intraday Range
│   └── Multiply Intraday Range by Volume Adjustment
├── Smoothed Intraday Range
│   └── Apply EMA with Span of 7
├── EMA Cross Signal
│   ├── Short EMA of Close (Span 7)
│   └── Long EMA of Close (Span 25)
├── Momentum
│   ├── If Short EMA > Long EMA, mark as Bullish
│   └── If Short EMA < Long EMA, mark as Bearish
├── On-Balance Volume (OBV)
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by EMA Difference
│   └── Weight = (Short EMA - Long EMA)^2
├── Final OBV Factor
│   └── Final OBV Factor = OBV * Weight
├── Measure Close Position in Range
│   ├── Ensure Range is non-zero before division
│   └── Calculate (Close - Low) / (High - Low)
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Sum of (Open * Volume, High * Volume, Low * Volume, Close * Volume)
│   └── Divide by sum of Volumes
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Compute Open-Close Return
│   │   ├── Use Open price
│   │   └── Use Close price
│   └── Weighted Average of High-Low Difference and Open-Close Return
│       ├── Assign Weight to High-Low Difference
│       └── Assign Weight to Open-Close Return
├── Apply Volume and Amount Shock Filter
│   ├── Compute Volume Ratio
│   │   ├── Current Volume / Previous Day Volume
│   ├── Compute Amount Ratio
│   │   ├── Current Amount / Previous Day Amount
│   └── Include Intraday Momentum if (Volume Ratio > 1.5) AND (Amount Ratio > 1.5)
├── Calculate Intraday Volatility
│   ├── Compute the absolute difference between High and Low
│   └── Calculate the rolling standard deviation of this difference over the last 5 days
├── Combine Factors
    ├── Use Smoothed Intraday Range
    ├── Use Close Position in Range
    ├── Use VWAP
    ├── Use Filtered Intraday Momentum
    ├── Use Intraday Volatility
    └── Compute weighted average of the five factors
        ├── For Smoothed Intraday Range, compute recent standard deviation
        ├── For Close Position in Range, compute recent standard deviation
        ├── For VWAP, compute recent standard deviation
        ├── For Filtered Intraday Momentum, compute recent standard deviation
        ├── For Intraday Volatility, compute recent standard deviation
        └── Assign weights inversely proportional to the standard deviations
└── Final Alpha Factor
    └── Final Alpha Factor = Combined Factors * Final OBV Factor
```
