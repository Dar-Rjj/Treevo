```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Momentum
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Open_Close_Return'] = df['close'] / df['open'] - 1
    df['Intraday_Momentum'] = (df['High_Low_Diff'] + df['Open_Close_Return']) / 2
    
    # Apply Volume and Price Shock Filter
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    df['Amount_Ratio'] = df['amount'] / df['amount'].shift(1)
    df['Abs_Price_Change'] = abs(df['close'] - df['close'].shift(1))
    df['Price_Shock_Ratio'] = df['Abs_Price_Change'] / (df['high'] - df['low']).rolling(window=20).max()
    
    # Threshold Filter
    df['Filtered_Intraday_Momentum'] = df['Intraday_Momentum'] * ((df['Volume_Ratio'] > 1.5) & 
                                                                   (df['Amount_Ratio'] > 1.5) & 
                                                                   (df['Price_Shock_Ratio'] > 0.05))
    
    # Adjust for Volume
    df['Volume_Adjusted_Momentum'] = df['Filtered_Intraday_Momentum'] / df['volume']
    
    # Measure Volume Synchronization
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Price_Change'] = df['close'] - df['close'].shift(1)
    df['Volume_Shock'] = (df['Volume_Ratio'] > 1.5).astype(int)
    df['Synchronization'] = np.sign(df['Volume_Change'] * df['Price_Change']) * df['Volume_Shock']
    
    # Trend Confirmation
    df['Short_EMA'] = df['close'].ewm(span=5, adjust=False).mean()
    df['Long_EMA'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Crossover_Signal'] = np.where(df['Short_EMA'] > df['Long_EMA'], 1, -1)
    
    # Integrate with Intraday Momentum
    df['Amplified_Momentum'] = df['Volume_Adjusted_Momentum'] * df['Crossover_Signal']
    
    # Smoothing
    df['Smoothed_Momentum'] = df['Amplified_Momentum'].ewm(span=5, adjust=False).mean()
    
    # Calculate On-Balance Volume (OBV)
    obv = [0]
    for i in range(1, len(df)):
        if df['close'][i] > df['close'][i-1]:
            obv.append(obv[-1] + df['volume'][i])
        elif df['close'][i] < df['close'][i-1]:
            obv.append(obv[-1] - df['volume'][i])
        else:
            obv.append(obv[-1])
    df['OBV'] = obv
    
    # Weight OBV by EMA and MACD Line Differences
    df['EMA_Weight'] = abs(df['Short_EMA'] - df['Long_EMA'])
    df['MACD_Line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['Signal_Line'] = df['MACD_Line'].ewm(span=9, adjust=False).mean()
    df['MACD_Weight'] = abs(df['MACD_Line'] - df['Signal_Line'])
    
    # Final OBV Factor
    df['Final_OBV_Factor'] = df['OBV'] * (df['EMA_Weight'] + df['MACD_Weight'])
    
    # Synthesize Final Alpha Factor
    df['Final_Alpha_Factor'] = df['Smoothed_Momentum'] * df['Final_OBV_Factor'] * (df['Volume_Ratio'] > 1.5)
    
    return df['Final_Alpha_Factor']
```
