```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Momentum
    high_low_diff = df['high'] - df['low']
    open_close_return = (df['close'] - df['open']) / df['open']
    intraday_momentum = 0.5 * (high_low_diff + open_close_return)
    
    # Volume and Amount Shock Filter
    volume_change = df['volume'] / df['volume'].shift(1)
    amount_change = df['amount'] / df['amount'].shift(1)
    volume_shock_threshold = 1.5
    amount_shock_threshold = 1.5
    shock_filter = (volume_change > volume_shock_threshold) & (amount_change > amount_shock_threshold)
    intraday_momentum_filtered = intraday_momentum * shock_filter
    
    # Trend Confirmation
    short_term_ma = df['close'].rolling(window=5).mean()
    long_term_ma = df['close'].rolling(window=20).mean()
    crossover_signal = (short_term_ma > long_term_ma).astype(int) - (short_term_ma < long_term_ma).astype(int)
    intraday_momentum_adjusted = intraday_momentum_filtered * crossover_signal
    
    # Intraday Price Range
    intraday_range = df['high'] - df['low']
    
    # Adjust for Volume
    avg_volume_5d = df['volume'].rolling(window=5).mean()
    volume_adjustment = (df['volume'] / avg_volume_5d).fillna(1) + 1
    range_volume_adjusted = intraday_range * volume_adjustment
    
    # Smoothing
    smoothed_intraday_momentum = range_volume_adjusted.ewm(span=5).mean()
    
    # EMA Cross Signal
    ema_short = df['close'].ewm(span=5).mean()
    ema_long = df['close'].ewm(span=20).mean()
    ema_cross_signal = (ema_short > ema_long).astype(int) - (ema_short < ema_long).astype(int)
    
    # On-Balance Volume (OBV)
    obv = (np.sign(df['close'].diff()) * df['volume']).cumsum()
    obv.fillna(0, inplace=True)
    
    # Weight OBV by Difference between Short and Long EMA
    weight = np.abs(ema_short - ema_long)
    final_obv_factor = obv * weight
    
    # Dynamic Volume Shock Filter
    avg_volume_last_5d = df['volume'].rolling(window=5).mean()
    volume_ratio = df['volume'] / avg_volume_last_5d
    dynamic_shock_filter = volume_ratio > 1.8
    
    # Final Alpha Factor
    final_alpha_factor = smoothed_intraday_momentum * final_obv_factor
    final_alpha_factor[~dynamic_shock_filter] = 0
    
    return final_alpha_factor
```
