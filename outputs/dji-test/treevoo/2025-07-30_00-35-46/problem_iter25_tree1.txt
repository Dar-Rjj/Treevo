```txt
Intraday Momentum and Volume Shock with Enhanced EMA Cross Signal and OBV Factor
├── Intraday Momentum
│   ├── High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Open-Close Return
│   │   ├── Use Open price
│   │   └── Use Close price
│   └── Weighted Average of High-Low and Open-Close
├── Volume Shock Filter
│   ├── Compute Volume Ratio
│   │   ├── Current Volume / Average of Last 5 Days Volume
│   └── Apply Threshold
│       └── Include Intraday Momentum if Ratio > 1.8
├── Trend Confirmation
│   ├── Short-Term EMA (5 days)
│   │   └── Use Close prices
│   ├── Long-Term EMA (20 days)
│   │   └── Use Close prices
│   └── Crossover Signal
│       ├── Generate Buy Signal if Short-Term > Long-Term
│       └── Generate Sell Signal if Short-Term < Long-Term
├── Integrate with Intraday Momentum
│   ├── If Crossover is Bullish, Amplify Intraday Momentum
│   └── If Crossover is Bearish, Dampen Intraday Momentum
├── Calculate On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by EMA Difference
│   └── Weight = |Short EMA - Long EMA|
├── Final OBV Factor
│   └── Final OBV Factor = OBV * Weight
└── Final Alpha Factor
    └── Final Alpha Factor = Smoothed Intraday Momentum * Final OBV Factor (if Volume Ratio > 1.8)
```
