```txt
Intraday Activity and Momentum with Volume and Amount Shock Filter
├── Calculate Intraday Range
│   ├── Use High price
│   └── Use Low price
│       └── Subtract Low from High to get Range
├── Measure Close Position in Range
│   ├── Use Close price
│   ├── Use High price
│   ├── Use Low price
│   ├── Calculate (Close - Low) / (High - Low)
│   └── Ensure Range is non-zero before division
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Use Open, High, Low, and Close prices
│   ├── Use Volume
│   │   └── For each price point, multiply by corresponding Volume
│   │       └── Sum of all products
│   │           └── Divide by sum of Volumes
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   └── Compute Open-Close Return
│       ├── Use Open price
│       └── Use Close price
│   └── Combine High-Low and Open-Close Returns
│       ├── Weighted Average of High-Low Difference and Open-Close Return
│       │   ├── Assign Weight to High-Low Difference
│       │   └── Assign Weight to Open-Close Return
├── Apply Volume and Amount Shock Filter
│   ├── Determine Volume Change
│   │   ├── Use Current Volume
│   │   └── Use Previous Day Volume
│   ├── Compute Volume Ratio
│   │   ├── Current Volume / Previous Day Volume
│   ├── Determine Amount Change
│   │   ├── Use Current Amount
│   │   └── Use Previous Day Amount
│   ├── Compute Amount Ratio
│   │   ├── Current Amount / Previous Day Amount
│   └── Threshold Filter
│       ├── Set a Volume Shock Threshold (e.g., 1.5)
│       ├── Set an Amount Shock Threshold (e.g., 1.5)
│       └── Include Intraday Momentum if (Volume Ratio > Volume Threshold) AND (Amount Ratio > Amount Threshold)
└── Combine Factors
    ├── Use Intraday Range
    ├── Use Close Position in Range
    ├── Use VWAP
    ├── Use Filtered Intraday Momentum
    └── Compute weighted average of the four factors
        ├── Use a dynamic weight for each factor based on their recent volatility
        │   ├── For Intraday Range, compute recent standard deviation
        │   ├── For Close Position in Range, compute recent standard deviation
        │   ├── For VWAP, compute recent standard deviation
        │   └── For Filtered Intraday Momentum, compute recent standard deviation
        └── Assign weights inversely proportional to the standard deviations
```
