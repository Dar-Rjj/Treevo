```txt
Volume and Momentum Enhanced Alpha Factor with Additional Market Sentiment
├── Calculate Intraday Price Range
│   ├── Use High price
│   └── Use Low price
│       └── Subtract Low from High to get Range
├── Combine Intraday Range and Volume
│   ├── Multiply Intraday Range by Volume
│   └── Apply Simple Moving Average (SMA) with Span of 5
├── Calculate Moving Average Convergence Divergence (MACD)
│   ├── Short-term EMA of Close Price (last 12 days)
│   └── Long-term EMA of Close Price (last 26 days)
│   ├── Calculate MACD Line
│   │   └── Subtract Long-term EMA from Short-term EMA
│   └── Signal Line
│       └── 9-day EMA of MACD Line
├── Determine Momentum
│   ├── Compare MACD Line and Signal Line
│   ├── If MACD Line > Signal Line, mark as Bullish
│   └── If MACD Line < Signal Line, mark as Bearish
├── Calculate On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by the Difference between MACD Line and Signal Line
│   └── Weight = |MACD Line - Signal Line|
├── Multiply OBV by Weight
│   └── Final OBV Factor = OBV * Weight
├── Incorporate Market Sentiment
│   ├── Calculate Price Change
│   │   └── (Close - Open) / Open
│   ├── Calculate Sentiment Score
│   │   ├── If Price Change > 0.005, set Sentiment Score = 1
│   │   ├── If Price Change < -0.005, set Sentiment Score = -1
│   │   └── Otherwise, set Sentiment Score = 0
├── Adjust OBV Factor by Sentiment
│   └── Adjusted OBV Factor = Final OBV Factor * Sentiment Score
├── Combine Smoothed Intraday Momentum with Adjusted OBV Factor
│   └── Multiply Smoothed Intraday Momentum by Adjusted OBV Factor
└── Final Alpha Factor
    └── Final Alpha Factor = Smoothed Intraday Momentum * Adjusted OBV Factor
```
