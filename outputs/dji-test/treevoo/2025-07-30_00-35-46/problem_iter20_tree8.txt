```txt
Volume, Momentum, and Intraday Activity Enhanced Alpha Factor with Shock Filter
├── Intraday Price Range
│   └── Subtract Low from High
├── Volume Adjustment
│   ├── Divide Volume by Mean of last 5 days Volume
│   └── Add 0.01 to avoid division by zero
├── Adjusted Intraday Range
│   └── Multiply Intraday Range by Volume Adjustment
├── Smoothed Intraday Range
│   └── Apply EMA with Span of 7
├── Base Intraday Return
│   ├── (Close - Open) / Open
├── High-Low Momentum Component
│   ├── Use High price
│   └── Subtract Low price
│       └── Divide by Open price
├── Combined Intraday and High-Low Momentum
│   ├── Weighted Average of Base Intraday Return and High-Low Momentum
│   │   ├── Base Intraday Return * 0.6
│   │   └── High-Low Momentum * 0.4
├── Volume Impact
│   ├── Use Current Volume
│   └── Use Previous Volume
│       └── Volume Ratio
│           └── Adjust Combined Momentum by Volume Ratio
├── Amount Impact
│   ├── Use Current Amount
│   ├── Use Previous Amount
│   │   └── Amount Ratio
│   └── Multiply by Change in High-Low Spread
│       └── Adjust Combined Momentum by Amount Ratio
├── Synthesize and Filter
│   ├── Multiply Combined Momentum by Volume and Amount Adjustment
│   ├── Apply Volume Shock Filter
│   │   ├── Determine Volume Change
│   │   │   ├── Use Current Volume
│   │   │   └── Use Previous Day Volume
│   │   ├── Compute Volume Ratio
│   │   │   ├── Current Volume / Previous Day Volume
│   │   └── Threshold Filter
│   │       ├── Set a Volume Shock Threshold (e.g., 1.5)
│   │       └── Include Momentum if Volume Ratio > Threshold
│   └── Smoothing
│       ├── Apply Exponential Moving Average (EMA) with Span of 5
│           └── On the synthesized and filtered Combined Momentum
├── EMA Cross Signal
│   ├── Short EMA of Close (Span 7)
│   └── Long EMA of Close (Span 25)
├── Momentum
│   ├── If Short EMA > Long EMA, mark as Bullish
│   └── If Short EMA < Long EMA, mark as Bearish
├── On-Balance Volume (OBV)
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by EMA Difference and MACD-Signal Line Difference
│   ├── EMA Difference Weight = (Short EMA - Long EMA)^2
│   ├── Calculate MACD
│   │   ├── Short-term EMA of Close Price (last 12 days)
│   │   └── Long-term EMA of Close Price (last 26 days)
│   ├── MACD Line
│   │   └── Subtract Long-term EMA from Short-term EMA
│   ├── Signal Line
│   │   └── 9-day EMA of MACD Line
│   └── MACD-Signal Line Difference Weight = |MACD Line - Signal Line|
├── Final OBV Factor
│   └── Final OBV Factor = OBV * (EMA Difference Weight + MACD-Signal Line Difference Weight)
├── Measure Close Position in Range
│   ├── Ensure Range is non-zero before division
│   └── Calculate (Close - Low) / (High - Low)
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Sum of (Open * Volume, High * Volume, Low * Volume, Close * Volume)
│   └── Divide by sum of Volumes
├── Combine Factors
│   ├── Use Smoothed Intraday Range
│   ├── Use Close Position in Range
│   ├── Use VWAP
│   ├── Use Filtered Intraday Momentum
│   ├── Use Intraday Volatility
│   └── Compute weighted average of the five factors
│       ├── For Smoothed Intraday Range, compute recent standard deviation
│       ├── For Close Position in Range, compute recent standard deviation
│       ├── For VWAP, compute recent standard deviation
│       ├── For Filtered Intraday Momentum, compute recent standard deviation
│      
