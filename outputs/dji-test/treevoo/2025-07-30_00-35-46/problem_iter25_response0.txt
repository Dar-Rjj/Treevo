```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Momentum
    high_low_diff = df['high'] - df['low']
    open_close_return = df['close'] / df['open'] - 1
    daily_volatility = np.sqrt((df['high'] - df['close'])**2 + (df['low'] - df['close'])**2) / df['close']
    intraday_momentum = (high_low_diff * daily_volatility + open_close_return) / (daily_volatility + 1)

    # Apply Volume and Price Shock Filter
    volume_ratio = df['volume'] / df['volume'].shift(1)
    amount_ratio = df['amount'] / df['amount'].shift(1)
    price_shock = abs(df['close'] - df['close'].shift(1))
    historical_price_range = df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min()
    filter_condition = (volume_ratio > 1.5) & (amount_ratio > 1.5) & (price_shock > historical_price_range * 0.05)
    intraday_momentum_filtered = intraday_momentum.where(filter_condition, 0)

    # Adjust for Volume
    intraday_momentum_adjusted = intraday_momentum_filtered / df['volume']

    # Measure Volume Synchronization
    volume_change = df['volume'] - df['volume'].shift(1)
    price_change = df['close'] - df['close'].shift(1)
    synchronization_value = np.sign(volume_change * price_change)

    # Calculate EMAs and Determine Momentum
    short_ema = df['close'].ewm(span=5, adjust=False).mean()
    long_ema = df['close'].ewm(span=20, adjust=False).mean()
    momentum = (short_ema > long_ema).astype(int)

    # Calculate On-Balance Volume (OBV)
    obv = (np.sign(df['close'] - df['close'].shift(1)) * df['volume']).cumsum()

    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']

    # Measure Close Position in Range
    close_position_in_range = (df['close'] - df['low']) / (intraday_range + 1e-9)

    # Calculate Volume-Weighted Average Price (VWAP)
    vwap = (df['open'] * df['volume'] + df['high'] * df['volume'] + df['low'] * df['volume'] + df['close'] * df['volume']) / (4 * df['volume'])

    # Combine Momentum and OBV into a Factor
    weight = abs(short_ema - long_ema)
    obv_momentum_factor = obv * weight

    # Synthesize Final Alpha Factor
    recent_std_intraday_momentum = intraday_momentum_adjusted.rolling(window=20).std()
    recent_std_synchronization = synchronization_value.rolling(window=20).std()
    recent_std_obv_momentum = obv_momentum_factor.rolling(window=20).std()
    recent_std_intraday_range = intraday_range.rolling(window=20).std()
    recent_std_close_position = close_position_in_range.rolling(window=20).std()
    recent_std_vwap = vwap.rolling(window=20).std()

    total_std = (recent_std_intraday_momentum + recent_std_synchronization + recent_std_obv_momentum +
                 recent_std_intraday_range + recent_std_close_position + recent_std_vwap)
    
    weights = 1 / (np.array([recent_std_intraday_momentum, recent_std_synchronization, recent_std_obv_momentum,
                             recent_std_intraday_range, recent_std_close_position, recent_std_vwap]) / total_std)
    weights = weights / weights.sum()

    alpha_factor = (weights[0] * intraday_momentum_adjusted + 
                    weights[1] * synchronization_value + 
                    weights[2] * obv_momentum_factor + 
                    weights[3] * intraday_range + 
                    weights[4] * close_position_in_range + 
                    weights[5] * vwap)

    return alpha_factor
```
