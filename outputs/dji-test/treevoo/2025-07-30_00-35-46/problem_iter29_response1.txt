```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Base Intraday Momentum
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Open_Close_Return'] = df['close'] / df['open'] - 1
    
    # Compute Daily Volatility (Garman-Klass)
    df['Volatility'] = np.sqrt(0.5 * (np.log(df['high'] / df['low']) ** 2) - (2 * np.log(2) - 1) * (np.log(df['close'] / df['open']) ** 2))
    
    # Combine High-Low and Open-Close Returns
    df['Intraday_Momentum'] = (df['High_Low_Diff'] + df['Open_Close_Return']) / 2
    
    # Apply Volume and Price Shock Filter
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    df['Amount_Ratio'] = df['amount'] / df['amount'].shift(1)
    df['Price_Shock'] = np.abs(df['close'] - df['close'].shift(1))
    df['Historical_Price_Range'] = df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min()
    df['Price_Shock_Ratio'] = df['Price_Shock'] / df['Historical_Price_Range']
    
    # Threshold Filter
    df['Filtered_Intraday_Momentum'] = df['Intraday_Momentum'] * ((df['Volume_Ratio'] > 1.5) & (df['Amount_Ratio'] > 1.5) & (df['Price_Shock_Ratio'] > 0.05))
    
    # Adjust for Volume
    df['Volume_Adjusted_Momentum'] = df['Filtered_Intraday_Momentum'] / df['volume']
    
    # Synchronize Volume Dynamics
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Price_Change'] = df['close'] - df['close'].shift(1)
    df['Synchronization_Value'] = np.sign(df['Volume_Change'] * df['Price_Change'])
    
    # Calculate On-Balance Volume (OBV)
    df['OBV'] = 0
    df.loc[df['close'] > df['close'].shift(1), 'OBV'] = df['volume']
    df.loc[df['close'] < df['close'].shift(1), 'OBV'] = -df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    # Calculate Intraday Range
    df['Intraday_Range'] = df['high'] - df['low']
    
    # Measure Close Position in Range
    df['Close_Position_in_Range'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    
    # Integrate Volume-Weighted Intraday Momentum with OBV Factor
    df['MACD'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['Signal_Line'] = df['MACD'].ewm(span=9, adjust=False).mean()
    df['OBV_Factor'] = df['OBV'] * np.abs(df['MACD'] - df['Signal_Line'])
    
    # Synthesize Final Alpha Factor
    factors = [
        df['Volume_Adjusted_Momentum'],
        df['Synchronization_Value'],
        df['OBV_Factor'],
        df['Intraday_Range'],
        df['Close_Position_in_Range']
    ]
    
    # Assign weights inversely proportional to the standard deviations
    weights = [1 / f.std() for f in factors]
    total_weight = sum(weights)
    weights = [w / total_weight for w in weights]
    
    df['Final_Alpha_Factor'] = sum(w * f for w, f in zip(weights, factors))
    
    # Smoothing
    df['Smoothed_Final_Alpha_Factor'] = df['Final_Alpha_Factor'].ewm(span=5, adjust=False).mean()
    
    return df['Smoothed_Final_Alpha_Factor']
```
