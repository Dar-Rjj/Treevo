```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Momentum
    df['high_low_diff'] = df['high'] - df['low']
    df['open_close_return'] = df['close'] / df['open'] - 1
    df['daily_volatility'] = (df['high'] - df['low']) / df['close']
    df['intraday_momentum'] = (df['high_low_diff'] + df['open_close_return']) * (df['daily_volatility'] / df['daily_volatility'].mean())
    
    # Apply Volume and Price Shock Filter
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    df['amount_ratio'] = df['amount'] / df['amount'].shift(1)
    df['price_shock'] = abs(df['close'] - df['close'].shift(1))
    df['price_range'] = df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min()
    df['price_shock_ratio'] = df['price_shock'] / df['price_range']
    df['intraday_momentum_filtered'] = df['intraday_momentum'].where((df['volume_ratio'] > 1.5) & (df['amount_ratio'] > 1.5) & (df['price_shock_ratio'] > 0.05), 0)
    
    # Adjust for Volume
    df['intraday_momentum_adjusted'] = df['intraday_momentum_filtered'] / df['volume']
    
    # Measure Volume Synchronization
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    df['price_change'] = df['close'] - df['close'].shift(1)
    df['synchronization'] = np.sign(df['volume_change'] * df['price_change'])
    
    # Calculate EMAs and SMAs
    df['short_ema'] = df['close'].ewm(span=5, adjust=False).mean()
    df['long_ema'] = df['close'].ewm(span=20, adjust=False).mean()
    df['short_sma'] = df['close'].rolling(window=5).mean()
    df['long_sma'] = df['close'].rolling(window=20).mean()
    df['trend_signal'] = np.where((df['short_ema'] > df['long_ema']) | (df['short_sma'] > df['long_sma']), 1, -1)
    
    # Analyze Price Momentum
    df['roc'] = df['close'].pct_change(periods=5)
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Investigate Trading Volume
    df['avg_volume_5'] = df['volume'].rolling(window=5).mean()
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean()
    df['volume_signal'] = np.where(df['volume'] > df['avg_volume_20'], 1, -1)
    
    # Calculate On-Balance Volume (OBV)
    obv = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    df['obv'] = obv
    
    # Combine Momentum and OBV into a Factor
    df['ema_weight'] = abs(df['short_ema'] - df['long_ema'])
    df['obv_momentum_factor'] = df['obv'] * df['ema_weight']
    
    # Integrate Volume-Weighted Intraday Momentum with OBV Factor
    df['intraday_momentum_smoothed'] = df['intraday_momentum_adjusted'].ewm(span=5, adjust=False).mean()
    df['volume_adjusted_intraday_momentum'] = df['intraday_momentum_smoothed'] * df['obv_momentum_factor']
    
    # Combine Multiple Factors
    df['composite_alpha'] = (df['trend_signal'] * 0.3 + df['roc'] * 0.3 + df['rsi'] * 0.2 + df['volume_signal'] * 0.2)
    
    # Synthesize Final Alpha Factor
    df['final_alpha_factor'] = (df['volume_adjusted_intraday_momentum'] + 
                                df['
