```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Momentum
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Open_Close_Return'] = df['close'] / df['open'] - 1
    
    # Compute Daily Volatility
    df['Daily_Volatility'] = df[['high', 'low', 'close']].std(axis=1)
    
    # Weighted Average based on Volatility
    df['Weighted_Avg'] = (df['High_Low_Diff'] * df['Daily_Volatility'] + df['Open_Close_Return']) / (df['Daily_Volatility'] + 1e-8)
    
    # Non-Linear Transformation
    df['Intraday_Momentum'] = df['Weighted_Avg'].pow(2)
    
    # Apply Volume and Price Shock Filter
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    df['Amount_Ratio'] = df['amount'] / df['amount'].shift(1)
    df['Price_Shock'] = np.abs(df['close'] - df['close'].shift(1))
    df['Price_Range'] = df['high'].rolling(window=20).max() - df['low'].rolling(window=20).min()
    df['Price_Shock_Ratio'] = df['Price_Shock'] / df['Price_Range']
    
    # Threshold Filter
    df['Filtered_Intraday_Momentum'] = df.apply(lambda row: row['Intraday_Momentum'] if (row['Volume_Ratio'] > 1.5) and (row['Amount_Ratio'] > 1.5) and (row['Price_Shock_Ratio'] > 0.05) else 0, axis=1)
    
    # Introduce Smoothing Factor
    df['Smoothed_Volume_Ratio'] = df['Volume_Ratio'].ewm(alpha=0.2).mean()
    df['Smoothed_Amount_Ratio'] = df['Amount_Ratio'].ewm(alpha=0.2).mean()
    
    # Adjust for Volume
    df['Volume_Adjusted_Intraday'] = df['Filtered_Intraday_Momentum'] / df['volume']
    
    # Measure Volume Synchronization
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Price_Change'] = df['close'] - df['close'].shift(1)
    df['Synchronization'] = np.sign(df['Volume_Change'] * df['Price_Change'])
    
    # Trend Confirmation
    df['Short_EMA'] = df['close'].ewm(span=5, adjust=False).mean()
    df['Long_EMA'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Crossover_Signal'] = np.where(df['Short_EMA'] > df['Long_EMA'], 1, np.where(df['Short_EMA'] < df['Long_EMA'], -1, 0))
    
    # Integrate with Intraday Momentum
    df['Adjusted_Intraday_Momentum'] = df['Filtered_Intraday_Momentum'] * df['Crossover_Signal']
    
    # Calculate On-Balance Volume (OBV)
    df['OBV'] = (df['close'] > df['close'].shift(1)).astype(int) * df['volume'] - (df['close'] < df['close'].shift(1)).astype(int) * df['volume']
    df['OBV'] = df['OBV'].cumsum()
    
    # Weight OBV by EMA Difference
    df['Weight'] = np.abs(df['Short_EMA'] - df['Long_EMA'])
    df['Final_OBV_Factor'] = df['OBV'] * df['Weight']
    
    # Synthesize Final Alpha Factor
    df['Final_Alpha_Factor'] = df['Volume_Adjusted_Intraday'] + df['Synchronization'] + df['Final_OBV_Factor']
    df['Final_Alpha_Factor'] = df['Adjusted_Intraday_Momentum'] * df['Final_OBV_Factor']
    
    return df['Final_Alpha_Factor']
```
