```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Base Intraday Momentum
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Open_Close_Return'] = df['close'] / df['open'] - 1
    df['Daily_Volatility'] = (df[['high', 'low', 'close']].std(axis=1) / df[['high', 'low', 'close']].mean(axis=1))
    df['Weighted_Momentum'] = (df['High_Low_Diff'] * df['Daily_Volatility'] + df['Open_Close_Return']) / (df['Daily_Volatility'] + 1)

    # Apply Volume and Price Shock Filter
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    df['Amount_Ratio'] = df['amount'] / df['amount'].shift(1)
    df['Price_Shock'] = abs(df['close'] - df['close'].shift(1))
    df['Price_Shock_Ratio'] = df['Price_Shock'] / (df['high'].rolling(window=5).max() - df['low'].rolling(window=5).min())
    df['Filtered_Momentum'] = df['Weighted_Momentum'] * (df['Volume_Ratio'] > 1.5) * (df['Amount_Ratio'] > 1.5) * (df['Price_Shock_Ratio'] > 0.05)

    # Adjust for Volume
    df['Adjusted_Momentum'] = df['Filtered_Momentum'] / df['volume']

    # Synchronize Volume Dynamics
    df['Volume_Change'] = df['volume'] - df['volume'].shift(1)
    df['Price_Change'] = df['close'] - df['close'].shift(1)
    df['Synchronization_Value'] = np.sign(df['Volume_Change'] * df['Price_Change']) * (df['Volume_Ratio'] > 1.5)

    # Calculate EMAs and Determine Momentum
    df['Short_EMA'] = df['close'].ewm(span=5, adjust=False).mean()
    df['Long_EMA'] = df['close'].ewm(span=20, adjust=False).mean()
    df['Momentum_Signal'] = (df['Short_EMA'] > df['Long_EMA']).astype(int)

    # Calculate On-Balance Volume (OBV)
    df['OBV'] = ((df['close'] > df['close'].shift(1)) * df['volume'] - (df['close'] < df['close'].shift(1)) * df['volume']).cumsum()

    # Calculate Intraday Range
    df['Intraday_Range'] = df['high'] - df['low']

    # Measure Close Position in Range
    df['Close_Position'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    df['Close_Position'] = df['Close_Position'].fillna(0)  # Ensure no division by zero

    # Calculate Volume-Weighted Average Price (VWAP)
    df['VWAP'] = (df['open'] * df['volume'] + df['high'] * df['volume'] + df['low'] * df['volume'] + df['close'] * df['volume']) / (4 * df['volume'])

    # Calculate Intraday Volatility
    df['Intraday_Volatility'] = (df['high'] - df['low']).rolling(window=5).std()

    # Integrate Volume-Weighted Intraday Momentum with OBV Factor
    df['MACD'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['Signal_Line'] = df['MACD'].ewm(span=9, adjust=False).mean()
    df['OBV_Factor'] = df['OBV'] * (abs(df['MACD'] - df['Signal_Line']))

    # Synthesize Final Alpha Factor
    factors = [
        df['Adjusted_Momentum'],
        df['Synchronization_Value'],
        df['OBV_Factor'],
        df['Intraday_Range'],
        df['Close_Position'],
        df['VWAP'],
        df['Intraday_Volatility']
    ]
    
    factor_stds = [f.std() for f in factors]
    weights = [1/std if std > 0 else 0 for std in factor_stds]
    total_weight = sum(weights)
    normalized_weights = [w/total_weight for w in weights]

    df['Final_Alpha_Factor'] = sum(f *
