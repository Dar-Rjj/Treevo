```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Volatility (High, Low, Close)
    df['Daily_Volatility'] = (df['High'] - df['Low']) / df['Close']
    
    # Compute High-Low Difference and Open-Close Return
    df['High_Low_Diff'] = df['High'] - df['Low']
    df['Open_Close_Return'] = df['Close'] / df['Open'] - 1
    
    # Assign Higher Weight to More Volatile Days
    df['Intraday_Momentum'] = (df['High_Low_Diff'] + df['Open_Close_Return']) * df['Daily_Volatility']
    
    # Non-Linear Transformation
    df['Intraday_Momentum_Transformed'] = df['Intraday_Momentum'].apply(lambda x: x**2)
    
    # Volume and Amount Ratios
    df['Volume_Ratio'] = df['Volume'] / df['Volume'].shift(1)
    df['Amount_Ratio'] = df['Amount'] / df['Amount'].shift(1)
    
    # Price Shock
    df['Price_Shock'] = np.abs(df['Close'] - df['Close'].shift(1))
    df['Historical_Price_Range'] = df['High'].rolling(window=30).max() - df['Low'].rolling(window=30).min()
    df['Price_Shock_Ratio'] = df['Price_Shock'] / df['Historical_Price_Range']
    
    # Threshold Filter
    df['Intraday_Momentum_Filtered'] = np.where(
        (df['Volume_Ratio'] > 1.5) & (df['Amount_Ratio'] > 1.5) & (df['Price_Shock_Ratio'] > 0.05),
        df['Intraday_Momentum_Transformed'],
        0
    )
    
    # Smoothing Factor
    df['Volume_Ratio_Smoothed'] = df['Volume_Ratio'].ewm(alpha=0.2).mean()
    df['Amount_Ratio_Smoothed'] = df['Amount_Ratio'].ewm(alpha=0.2).mean()
    
    # Adjust for Volume
    df['Intraday_Momentum_Adjusted'] = df['Intraday_Momentum_Filtered'] / df['Volume']
    
    # Synchronized Volume and Price Changes
    df['Volume_Change'] = df['Volume'] - df['Volume'].shift(1)
    df['Price_Change'] = df['Close'] - df['Close'].shift(1)
    df['Synchronized_Volume_Price'] = np.sign(df['Volume_Change'] * df['Price_Change'])
    df['Synchronized_Volume_Price'] = np.where(df['Volume_Ratio'] > 1.5, df['Synchronized_Volume_Price'], 0)
    
    # EMAs and SMAs
    df['Short_EMA'] = df['Close'].ewm(span=5, adjust=False).mean()
    df['Long_EMA'] = df['Close'].ewm(span=20, adjust=False).mean()
    df['Short_SMA'] = df['Close'].rolling(window=5).mean()
    df['Long_SMA'] = df['Close'].rolling(window=20).mean()
    
    # Categorize as Bullish or Bearish
    df['EMA_Crossover'] = np.where((df['Short_EMA'] > df['Long_EMA']), 1, -1)
    df['SMA_Crossover'] = np.where((df['Short_SMA'] > df['Long_SMA']), 1, -1)
    df['Trend_Signal'] = np.where((df['EMA_Crossover'] == 1) | (df['SMA_Crossover'] == 1), 1, -1)
    
    # Rate of Change (ROC)
    df['ROC_5'] = (df['Close'] / df['Close'].shift(5)) - 1
    
    # Relative Strength Index (RSI)
    delta = df['Close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Trading Volume Analysis
    df['Avg_Volume_5'] = df['Volume'].rolling(window=5).mean()
    df['Avg_Volume_20'] = df['Volume'].rolling(window=20).mean()
    df['Volume_Signal'] = np.where(df['
