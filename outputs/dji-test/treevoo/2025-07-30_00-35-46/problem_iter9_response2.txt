```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Intraday Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Measure Close Position in Range
    df['close_position_in_range'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    df['close_position_in_range'].fillna(0, inplace=True)  # Handle division by zero
    
    # Calculate Volume-Weighted Average Price (VWAP)
    prices = (df[['open', 'high', 'low', 'close']].values * df[['volume']].values).sum(axis=1)
    total_volume = df['volume'].sum()
    df['vwap'] = prices / total_volume
    
    # Calculate Intraday Momentum
    df['high_low_diff'] = df['high'] - df['low']
    df['open_close_return'] = df['close'] / df['open'] - 1
    df['intraday_momentum'] = 0.5 * df['high_low_diff'] + 0.5 * df['open_close_return']
    
    # Apply Volume and Amount Shock Filter
    df['volume_ratio'] = df['volume'] / df['volume'].shift(1)
    df['amount_ratio'] = df['amount'] / df['amount'].shift(1)
    volume_threshold = 1.5
    amount_threshold = 1.5
    df['filtered_intraday_momentum'] = df['intraday_momentum'] * (df['volume_ratio'] > volume_threshold) * (df['amount_ratio'] > amount_threshold)
    
    # Compute recent standard deviations for dynamic weights
    window = 30  # Rolling window for volatility
    df['intraday_range_volatility'] = df['intraday_range'].rolling(window=window).std()
    df['close_position_in_range_volatility'] = df['close_position_in_range'].rolling(window=window).std()
    df['vwap_volatility'] = df['vwap'].rolling(window=window).std()
    df['filtered_intraday_momentum_volatility'] = df['filtered_intraday_momentum'].rolling(window=window).std()
    
    # Assign weights inversely proportional to the standard deviations
    df['weight_intraday_range'] = 1 / df['intraday_range_volatility']
    df['weight_close_position_in_range'] = 1 / df['close_position_in_range_volatility']
    df['weight_vwap'] = 1 / df['vwap_volatility']
    df['weight_filtered_intraday_momentum'] = 1 / df['filtered_intraday_momentum_volatility']
    
    total_weight = df['weight_intraday_range'] + df['weight_close_position_in_range'] + df['weight_vwap'] + df['weight_filtered_intraday_momentum']
    df['weight_intraday_range'] /= total_weight
    df['weight_close_position_in_range'] /= total_weight
    df['weight_vwap'] /= total_weight
    df['weight_filtered_intraday_momentum'] /= total_weight
    
    # Combine Factors
    df['combined_factor'] = (df['weight_intraday_range'] * df['intraday_range'] +
                             df['weight_close_position_in_range'] * df['close_position_in_range'] +
                             df['weight_vwap'] * df['vwap'] +
                             df['weight_filtered_intraday_momentum'] * df['filtered_intraday_momentum'])
    
    # Introduce New Factor: Cumulative Volume and Amount Shock Score
    shock_window = 5  # Window for cumulative shock
    df['cumulative_volume_shock'] = (df['volume'] / df['volume'].shift(1)).rolling(window=shock_window).mean()
    df['cumulative_amount_shock'] = (df['amount'] / df['amount'].shift(1)).rolling(window=shock_window).mean()
    df['combined_shock_score'] = 0.5 * df['cumulative_volume_shock'] + 0.5 * df['cumulative_amount_shock']
    df['normalized_combined_shock_score'] = (df['combined_shock_score'] - df['combined_shock_score'].rolling(window=window).min()) / \
                                           (df['combined_shock_score'].rolling(window=window).max() - df['combined_shock_score'].rolling(window=window).min())
    
    # Update Combined Factors
    df['combined_shock_score_volatility'] = df['normalized_combined_shock_score'].rolling(window=window).std()
    df['weight_combined_shock_score'] = 1 / df['combined_shock_score_volatility']
    
    total_weight_with_shock = total_weight
