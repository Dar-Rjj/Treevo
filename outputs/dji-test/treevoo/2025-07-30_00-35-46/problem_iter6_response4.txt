```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute High-Low Difference
    high_low_diff = df['high'] - df['low']
    
    # Compute Open-Close Return
    open_close_return = (df['close'] - df['open']) / df['open']
    
    # Compute Historical Volatility
    daily_returns = df['close'].pct_change()
    historical_volatility = daily_returns.rolling(window=20).std()
    
    # Assign Weights based on Volatility
    weights = historical_volatility / historical_volatility.rolling(window=20).mean()
    weights = weights.fillna(1)  # Fill NaN with 1 for the first 20 days
    
    # Weighted Average of High-Low Difference and Open-Close Return
    intraday_momentum = (high_low_diff * weights + open_close_return * (2 - weights)) / 2
    
    # Determine Volume Change
    volume_ratio = df['volume'] / df['volume'].shift(1)
    
    # Determine Price Shock
    price_change = df['close'] - df['close'].shift(1)
    price_shock_ratio = price_change / (df['high'] - df['low'])
    
    # Apply Enhanced Volume and Price Shock Filter
    enhanced_factor = intraday_momentum.where((volume_ratio > 1.5) & (price_shock_ratio.abs() > 0.05), 0)
    
    return enhanced_factor
```
