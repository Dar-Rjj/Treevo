```python
import pandas as pd

def heuristics(df):
    # Calculate Intraday Range
    df['Intraday_Range'] = df['high'] - df['low']
    
    # Measure Close Position in Range
    df['Close_Position_in_Range'] = (df['close'] - df['low']) / (df['high'] - df['low'])
    df['Close_Position_in_Range'].fillna(0.5, inplace=True)  # Fill NaN with 0.5 if range is zero
    
    # Calculate Volume-Weighted Average Price (VWAP)
    df['Typical_Price'] = (df['open'] + df['high'] + df['low'] + df['close']) / 4
    df['VWAP'] = (df['Typical_Price'] * df['volume']).cumsum() / df['volume'].cumsum()
    
    # Calculate Intraday Momentum
    df['High_Low_Diff'] = df['high'] - df['low']
    df['Open_Close_Return'] = (df['close'] - df['open']) / df['open']
    df['Intraday_Momentum'] = 0.5 * df['High_Low_Diff'] + 0.5 * df['Open_Close_Return']
    
    # Apply Volume and Amount Shock Filter
    df['Volume_Ratio'] = df['volume'] / df['volume'].shift(1)
    df['Amount_Ratio'] = df['amount'] / df['amount'].shift(1)
    volume_threshold = 1.5
    amount_threshold = 1.5
    df['Filtered_Intraday_Momentum'] = df['Intraday_Momentum'] * (df['Volume_Ratio'] > volume_threshold) * (df['Amount_Ratio'] > amount_threshold)
    
    # Combine Factors
    recent_volatility_periods = 20
    df['Intraday_Range_Std'] = df['Intraday_Range'].rolling(window=recent_volatility_periods).std()
    df['Close_Position_in_Range_Std'] = df['Close_Position_in_Range'].rolling(window=recent_volatility_periods).std()
    df['VWAP_Std'] = df['VWAP'].rolling(window=recent_volatility_periods).std()
    df['Filtered_Intraday_Momentum_Std'] = df['Filtered_Intraday_Momentum'].rolling(window=recent_volatility_periods).std()
    
    df['Total_Std'] = df['Intraday_Range_Std'] + df['Close_Position_in_Range_Std'] + df['VWAP_Std'] + df['Filtered_Intraday_Momentum_Std']
    
    df['Intraday_Range_Weight'] = df['Intraday_Range_Std'] / df['Total_Std']
    df['Close_Position_in_Range_Weight'] = df['Close_Position_in_Range_Std'] / df['Total_Std']
    df['VWAP_Weight'] = df['VWAP_Std'] / df['Total_Std']
    df['Filtered_Intraday_Momentum_Weight'] = df['Filtered_Intraday_Momentum_Std'] / df['Total_Std']
    
    df['Factor'] = (df['Intraday_Range'] * df['Intraday_Range_Weight'] +
                    df['Close_Position_in_Range'] * df['Close_Position_in_Range_Weight'] +
                    df['VWAP'] * df['VWAP_Weight'] +
                    df['Filtered_Intraday_Momentum'] * df['Filtered_Intraday_Momentum_Weight'])
    
    return df['Factor']
```
