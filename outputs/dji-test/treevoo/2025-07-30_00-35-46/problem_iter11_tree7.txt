```txt
Volume, Momentum, and Synchronization Enhanced Alpha Factor with Combined Shock Filter
├── Calculate Intraday Price Range
│   └── Subtract Low from High to get Range
├── Adjust for Volume
│   ├── Divide Volume by Mean of last 5 days Volume
│   └── Add 1 to avoid division by zero
├── Combine Intraday Range and Volume Adjustment
│   └── Multiply Intraday Range by Volume Adjustment
├── Smoothing
│   └── Apply Exponential Moving Average (EMA) with Span of 5
│       └── On the combined Intraday Range and Volume Adjustment
├── Calculate EMA Cross Signal
│   ├── EMA of Close Price over Short Period (last 5 days)
│   └── EMA of Close Price over Long Period (last 20 days)
├── Determine Momentum
│   ├── Compare Short and Long EMA
│   │   ├── If Short EMA > Long EMA, mark as Bullish
│   │   └── If Short EMA < Long EMA, mark as Bearish
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference (High - Low)
│   ├── Compute Open-Close Return (Close - Open)
│   └── Combine High-Low and Open-Close Returns
│       ├── Weighted Average of High-Low Difference and Open-Close Return
│       │   ├── Assign Weight to High-Low Difference
│       │   └── Assign Weight to Open-Close Return
├── Calculate On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Weight OBV by Difference between Short and Long EMA
│   └── Weight = |Short EMA - Long EMA|
├── Multiply OBV by Weight
│   └── Final OBV Factor = OBV * Weight
├── Apply Volume and Amount Shock Filter
│   ├── Compute Volume Ratio (Current Volume / Previous Day Volume)
│   ├── Compute Amount Ratio (Current Amount / Previous Day Amount)
│   └── Threshold Filter
│       └── Include Intraday Momentum if (Volume Ratio > 1.5) AND (Amount Ratio > 1.5)
├── Measure Volume Synchronization
│   ├── Compute Volume Change (Volume - Previous Day's Volume)
│   ├── Compute Price Change (Close - Previous Day's Close)
│   └── Synchronize Changes
│       ├── Multiply Volume Change and Price Change
│       └── Sign of the Synchronized Product
├── Synthesize Combined Factor
│   ├── Add Volume-Adjusted Intraday Metric
│   ├── Add Synchronization Value
│   └── Ensure Positive Values
└── Final Alpha Factor
    └── Final Alpha Factor = Smoothed Intraday Momentum * Final OBV Factor (if combined shock filter is met)
```
