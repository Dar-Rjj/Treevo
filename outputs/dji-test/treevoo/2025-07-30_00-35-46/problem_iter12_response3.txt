```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Price Range
    intraday_range = df['high'] - df['low']
    
    # Adjust for Volume
    volume_adjustment = (df['volume'] / df['volume'].rolling(window=5).mean()).fillna(1) + 1
    
    # Combine Intraday Range and Volume Adjustment
    combined_intraday_vol = intraday_range * volume_adjustment
    
    # Smoothing
    ema_5 = combined_intraday_vol.ewm(span=5).mean()
    
    # Calculate EMA Cross Signal
    ema_short = df['close'].ewm(span=5).mean()
    ema_long = df['close'].ewm(span=20).mean()
    
    # Determine Momentum
    momentum = (ema_short > ema_long).astype(int) - (ema_short < ema_long).astype(int)
    
    # Calculate Intraday Momentum
    high_low_diff = df['high'] - df['low']
    open_close_ret = (df['close'] - df['open']) / df['open']
    intraday_momentum = (high_low_diff + open_close_ret) / 2
    
    # Smooth Intraday Momentum
    smoothed_intraday_momentum = intraday_momentum.ewm(span=5).mean()
    
    # Calculate On-Balance Volume (OBV)
    obv = df['volume'].copy()
    obv.iloc[0] = 0
    obv[(df['close'] >= df['close'].shift(1))] += df['volume']
    obv[(df['close'] < df['close'].shift(1))] -= df['volume']
    
    # Weight OBV by Difference between Short and Long EMA
    weight = (ema_short - ema_long).abs()
    final_obv_factor = obv * weight
    
    # Apply Dynamic Volume Shock Filter
    avg_volume_5 = df['volume'].rolling(window=5).mean()
    volume_ratio = df['volume'] / avg_volume_5
    dynamic_filter = (volume_ratio > 1.8).astype(int)
    
    # Final Alpha Factor
    alpha_factor = smoothed_intraday_momentum * final_obv_factor * dynamic_filter
    
    return alpha_factor
```
