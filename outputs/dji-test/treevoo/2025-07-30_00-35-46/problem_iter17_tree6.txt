```txt
Integrated Intraday Activity, Momentum, and Volume Dynamics with Enhanced Shock Filter
├── Calculate Intraday Range
│   ├── Subtract Low from High to get Range
├── Measure Close Position in Range
│   ├── Ensure Range is non-zero before division
│   ├── Calculate (Close - Low) / (High - Low)
├── Calculate Volume-Weighted Average Price (VWAP)
│   ├── Sum of (Open * Volume, High * Volume, Low * Volume, Close * Volume)
│   └── Divide by sum of Volumes
├── Calculate Intraday Momentum
│   ├── Compute High-Low Difference
│   │   ├── Use High price
│   │   └── Use Low price
│   ├── Compute Open-Close Return
│   │   ├── Use Open price
│   │   └── Use Close price
│   └── Weighted Average of High-Low Difference and Open-Close Return
│       ├── Assign Weight to High-Low Difference
│       └── Assign Weight to Open-Close Return
├── Synchronized Volume
│   ├── Volume Change
│   │   ├── Current Volume
│   │   └── Previous Day's Volume
│   ├── Price Change
│   │   ├── Close price
│   │   └── Previous Day's Close
│   ├── Volume Ratio
│   │   ├── Current Volume / Previous Day Volume
│   ├── Apply Shock Filter
│   │   ├── Volume Ratio > 1.5
│   │   └── Include if True
│   └── Synchronize Changes
│       ├── Multiply Volume Change and Price Change
│       └── Sign of the Product
├── EMA Cross Signal
│   ├── Short EMA (5 days)
│   └── Long EMA (20 days)
├── Momentum
│   ├── Compare Short and Long EMA
│   └── Categorize as Bullish or Bearish
│       ├── Short EMA > Long EMA: Bullish
│       └── Short EMA < Long EMA: Bearish
├── On-Balance Volume (OBV)
│   ├── Initialize OBV to 0
│   ├── If Close > Previous Close, increment OBV by Volume
│   ├── If Close < Previous Close, decrement OBV by Volume
│   └── If Close = Previous Close, leave OBV unchanged
├── Combined Momentum and OBV Factor
│   ├── Weight = |Short EMA - Long EMA|
│   └── OBV * Weight
├── Apply Volume and Amount Shock Filter
│   ├── Compute Volume Ratio
│   │   ├── Current Volume / Previous Day Volume
│   ├── Compute Amount Ratio
│   │   ├── Current Amount / Previous Day Amount
│   └── Include Intraday Momentum if (Volume Ratio > 1.5) AND (Amount Ratio > 1.5)
├── Calculate Intraday Volatility
│   ├── Compute the absolute difference between High and Low
│   └── Calculate the rolling standard deviation of this difference over the last 5 days
├── Combine Factors
    ├── Use Intraday Range
    ├── Use Close Position in Range
    ├── Use VWAP
    ├── Use Filtered Intraday Momentum
    ├── Use Intraday Volatility
    ├── Use Synchronized Volume
    ├── Use Combined Momentum and OBV Factor
    └── Compute weighted average of the seven factors
        ├── For Intraday Range, compute recent standard deviation
        ├── For Close Position in Range, compute recent standard deviation
        ├── For VWAP, compute recent standard deviation
        ├── For Filtered Intraday Momentum, compute recent standard deviation
        ├── For Intraday Volatility, compute recent standard deviation
        ├── For Synchronized Volume, compute recent standard deviation
        ├── For Combined Momentum and OBV, compute recent standard deviation
        └── Assign weights inversely proportional to the standard deviations
```
