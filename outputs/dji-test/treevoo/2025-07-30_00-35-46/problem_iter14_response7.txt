```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Momentum
    df['high_low_diff'] = df['high'] - df['low']
    df['open_close_return'] = (df['close'] - df['open']) / df['open']
    
    # Combine Returns
    df['intraday_momentum'] = 0.5 * (df['high_low_diff'] / df['open']) + 0.5 * df['open_close_return']
    
    # Volume and Amount Shock Filter
    df['volume_change_ratio'] = df['volume'] / df['volume'].shift(1)
    df['amount_change_ratio'] = df['amount'] / df['amount'].shift(1)
    
    volume_shock_threshold = 1.5
    amount_shock_threshold = 1.5
    
    df['volume_amount_shock'] = (df['volume_change_ratio'] > volume_shock_threshold) & (df['amount_change_ratio'] > amount_shock_threshold)
    
    # Trend Confirmation with Moving Averages
    df['sma_5'] = df['close'].rolling(window=5).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['crossover_signal'] = np.where(df['sma_5'] > df['sma_20'], 1, -1)
    
    # Adjust Intraday Momentum based on Crossover Signal
    df['intraday_momentum_adjusted'] = df['intraday_momentum'] * df['crossover_signal']
    
    # Calculate Intraday Price Range
    df['intraday_range'] = df['high'] - df['low']
    
    # Adjust for Volume
    df['volume_adj'] = df['volume'] / df['volume'].rolling(window=5).mean() + 1
    
    # Combine Intraday Range and Volume Adjustment
    df['intraday_range_volume_adj'] = df['intraday_range'] * df['volume_adj']
    
    # Smoothing with EMA
    df['ema_5'] = df['intraday_range_volume_adj'].ewm(span=5, adjust=False).mean()
    
    # Calculate EMA Cross Signal
    df['ema_close_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['ema_close_20'] = df['close'].ewm(span=20, adjust=False).mean()
    
    # Determine Momentum from EMA Cross
    df['momentum'] = np.where(df['ema_close_5'] > df['ema_close_20'], 1, -1)
    
    # On-Balance Volume (OBV)
    df['obv'] = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    
    # Weight OBV by Difference between Short and Long EMA
    df['weight'] = np.abs(df['ema_close_5'] - df['ema_close_20'])
    df['weighted_obv'] = df['obv'] * df['weight']
    
    # Apply Dynamic Volume Shock Filter
    df['avg_volume_5'] = df['volume'].rolling(window=5).mean()
    df['dynamic_volume_ratio'] = df['volume'] / df['avg_volume_5']
    df['final_alpha_factor'] = np.where(df['dynamic_volume_ratio'] > 1.8, df['ema_5'] * df['weighted_obv'], 0)
    
    return df['final_alpha_factor']
```
