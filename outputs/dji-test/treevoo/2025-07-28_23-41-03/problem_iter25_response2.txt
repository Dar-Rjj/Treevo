```python
import pandas as pd

def heuristics_v2(df):
    # Momentum-Based Factors
    def simple_moving_average(price, window):
        return price.rolling(window=window).mean()

    for window in [5, 10, 20, 50]:
        df[f'SMA_{window}'] = simple_moving_average(df['close'], window)
        df[f'Close_SMA_{window}_diff'] = df['close'] - df[f'SMA_{window}']

    for lookback in [5, 20, 60, 120]:  # 1 week, 1 month, 3 months, 6 months
        df[f'return_{lookback}'] = df['close'].pct_change(lookback)

    # Volume-Weighted Price Indicators
    def volume_weighted_average_price(df, period):
        return (df['volume'] * df['close']).rolling(window=period).sum() / df['volume'].rolling(window=period).sum()
    
    for period in [1, 5, 20]:  # 1 day, 1 week, 1 month
        df[f'VWAP_{period}'] = volume_weighted_average_price(df, period)
        df[f'Close_VWAP_{period}_dev'] = df['close'] - df[f'VWAP_{period}']

    def volume_weighted_moving_average(df, period):
        return (df['volume'] * df['close']).rolling(window=period).sum() / df['volume'].rolling(window=period).sum()
    
    for period in [5, 20, 50]:  # 5 days, 1 month, 3 months
        df[f'VWMA_{period}'] = volume_weighted_moving_average(df, period)
        df[f'VWMA_{period}_slope'] = df[f'VWMA_{period}'].pct_change()

    # Volatility and Range-Based Indicators
    for window in [5, 20, 60]:  # 1 week, 1 month, 3 months
        df[f'volatility_{window}'] = df['close'].pct_change().rolling(window=window).std()

    def average_true_range(df, window):
        tr = df[['high', 'low']].diff().abs().max(axis=1)
        atr = tr.rolling(window=window).mean()
        return atr
    
    for window in [5, 14, 20]:  # 1 week, 2 weeks, 1 month
        df[f'ATR_{window}'] = average_true_range(df, window)

    # Pattern Recognition and Technical Indicator-Based Factors
    def detect_doji(df):
        body_size = (df['open'] - df['close']).abs()
        doji = (body_size < (df['high'] - df['low']) * 0.1)
        return doji.astype(int)

    def detect_hammer(df):
        body_size = (df['open'] - df['close']).abs()
        lower_shadow = df['low'] - df[['open', 'close']].min(axis=1)
        hammer = (lower_shadow > 2 * body_size) & (df['high'] - df['low'] > 3 * body_size)
        return hammer.astype(int)

    def detect_engulfing(df):
        bull_bear = (df['close'] > df['open']).astype(int) - (df['close'] < df['open']).astype(int)
        engulfing = (bull_bear.diff() == 2) | (bull_bear.diff() == -2)
        return engulfing.astype(int)

    df['doji'] = detect_doji(df)
    df['hammer'] = detect_hammer(df)
    df['engulfing'] = detect_engulfing(df)

    def rsi(df, window):
        delta = df['close'].diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=window).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=window).mean()
        rs = gain / loss
        return 100 - (100 / (1 + rs))

    def macd(df):
        ema12 = df['close'].ewm(span=12, adjust=False).mean()
        ema26 = df['close'].ewm(span=26, adjust=False).mean()
        macd_line = ema12 - ema26
        signal_line = macd_line.ewm(span=9, adjust=False).mean()
        return macd_line, signal_line

    df['RSI_14'] = rsi(df, 1
