```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the ratio of close to high (C/H)
    df['C_H_ratio'] = df['close'] / df['high']
    
    # Compute the difference between high and low prices adjusted by volume (VWAP-like metric)
    df['VWAP_like_metric'] = (df['high'] - df['low']) * df['volume']
    
    # Measure the gap between opening and closing prices (O-C) to gauge market momentum
    df['O_C_gap'] = df['open'] - df['close']
    
    # Calculate Intraday Return using Open and Close prices
    df['intraday_return'] = df['close'] - df['open']
    df['reversal_signal'] = df['intraday_return'].apply(lambda x: -1 if x > 0 else 1 if x < 0 else 0)
    
    # Develop a simple moving average (SMA) of close prices
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Construct a volume-weighted moving average (VWMA) of close prices
    df['VWMA_20'] = (df['close'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Calculate 20-Day Weighted Moving Average of Returns
    daily_returns = df['close'].pct_change()
    df['weighted_returns'] = (daily_returns * df['volume']).rolling(window=22).sum() / df['volume'].rolling(window=22).sum()
    
    # Adjust for Price Volatility
    df['daily_price_range'] = df['high'] - df['low']
    df['avg_daily_price_range_20'] = df['daily_price_range'].rolling(window=20).mean()
    
    # Final Factor Value
    df['factor_value_1'] = df['weighted_returns'] - df['avg_daily_price_range_20']
    
    # Incorporate volume-weighted price change and ATR for enhanced combined factor
    df['volume_weighted_price'] = (df['close'] * df['volume']).rolling(window=22).sum() / df['volume'].rolling(window=22).sum()
    df['price_diff_to_vwap'] = df['close'] - df['volume_weighted_price']
    
    # Compute Average True Range (ATR)
    df['true_range'] = df[['high', 'low']].diff(axis=1).max(axis=1)
    df['ATR_20'] = df['true_range'].rolling(window=20).mean()
    
    # Multiply ATR by Reversal Signal
    df['ATR_reversal_signal'] = df['ATR_20'] * df['reversal_signal']
    
    # Add to 20-Day Weighted Moving Average of Returns
    df['factor_value_2'] = df['weighted_returns'] + df['ATR_reversal_signal']
    
    # Apply Exponential Moving Average (EMA) with Short Period
    df['final_factor_value'] = df['factor_value_2'].ewm(span=5, adjust=False).mean()
    
    return df['final_factor_value']
```
