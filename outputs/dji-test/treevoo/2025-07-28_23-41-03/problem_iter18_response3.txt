```python
import pandas as pd

def heuristics_v2(df):
    # Momentum-Based Factors
    def simple_moving_average(df, window):
        return df['close'].rolling(window=window).mean()

    def momentum_factor(df, window):
        sma = simple_moving_average(df, window)
        return df['close'] - sma

    # Calculate different SMAs
    sma_5 = simple_moving_average(df, 5)
    sma_10 = simple_moving_average(df, 10)
    sma_20 = simple_moving_average(df, 20)
    sma_50 = simple_moving_average(df, 50)

    # Calculate momentum factors
    momentum_5 = momentum_factor(df, 5)
    momentum_10 = momentum_factor(df, 10)
    momentum_20 = momentum_factor(df, 20)
    momentum_50 = momentum_factor(df, 50)

    # Return-based momentum
    returns_1w = df['close'].pct_change(periods=5)
    returns_1m = df['close'].pct_change(periods=20)
    returns_3m = df['close'].pct_change(periods=60)

    # Composite momentum indicator
    composite_momentum = (momentum_5 + momentum_10 + momentum_20 + momentum_50) / 4

    # Volume-Weighted Price Indicators
    def volume_weighted_average_price(df, window):
        vwap = (df['close'] * df['volume']).rolling(window=window).sum() / df['volume'].rolling(window=window).sum()
        return vwap

    vwap_1d = volume_weighted_average_price(df, 1)
    vwap_1w = volume_weighted_average_price(df, 5)
    vwap_1m = volume_weighted_average_price(df, 20)

    # VWAP deviation factor
    vwap_deviation_1d = df['close'] - vwap_1d
    vwap_deviation_1w = df['close'] - vwap_1w
    vwap_deviation_1m = df['close'] - vwap_1m

    # Volume-weighted moving average (VWMA)
    vwma_10 = volume_weighted_average_price(df, 10)
    vwma_20 = volume_weighted_average_price(df, 20)

    # Slope of VWMA
    vwma_slope_10 = vwma_10.diff()
    vwma_slope_20 = vwma_20.diff()

    # Correlation between returns and volume
    daily_returns = df['close'].pct_change()
    vol_changes = df['volume'].pct_change()
    correlation_factor = daily_returns.rolling(window=20).corr(vol_changes)

    # Volatility and Range-Based Indicators
    historical_volatility = df['close'].pct_change().rolling(window=20).std()

    # Average True Range (ATR)
    tr = df[['high', 'low']].diff(axis=0).abs().max(axis=1)
    atr = tr.rolling(window=14).mean()

    # Bollinger Bands
    bb_upper = sma_20 + 2 * df['close'].rolling(window=20).std()
    bb_lower = sma_20 - 2 * df['close'].rolling(window=20).std()
    bb_distance = (df['close'] - sma_20) / (2 * df['close'].rolling(window=20).std())

    # Pattern Recognition and Technical Indicator-Based Factors
    # RSI
    delta = df['close'].diff()
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))

    # MACD
    ema_12 = df['close'].ewm(span=12, adjust=False).mean()
    ema_26 = df['close'].ewm(span=26, adjust=False).mean()
    macd = ema_12 - ema_26
    signal = macd.ewm(span=9, adjust=False).mean()
    macd_histogram = macd - signal

    # Stochastic Oscillator
    low_14 = df['low'].rolling(window=14).min()
    high_14 = df['high'].rolling(window=1
