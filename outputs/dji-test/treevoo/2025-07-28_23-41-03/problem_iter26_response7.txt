```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Real Body
    df['Real_Body'] = df['Close'] - df['Open']
    
    # Count Consecutive Bullish Candles
    df['Bullish_Candle'] = (df['Real_Body'] > 0).astype(int)
    df['Consecutive_Bullish'] = df['Bullish_Candle'].groupby((df['Bullish_Candle'] != df['Bullish_Candle'].shift()).cumsum()).cumsum()
    df['Sum_Consecutive_Bullish_Real_Bodies'] = df.groupby('Consecutive_Bullish')['Real_Body'].cumsum()
    
    # Count Consecutive Bearish Candles
    df['Bearish_Candle'] = (df['Real_Body'] < 0).astype(int)
    df['Consecutive_Bearish'] = df['Bearish_Candle'].groupby((df['Bearish_Candle'] != df['Bearish_Candle'].shift()).cumsum()).cumsum()
    df['Sum_Consecutive_Bearish_Real_Bodies'] = df.groupby('Consecutive_Bearish')['Real_Body'].cumsum()
    
    # Calculate Shadow Lengths
    df['Upper_Shadow'] = df['High'] - df[['Close', 'Open']].max(axis=1)
    df['Lower_Shadow'] = df[['Close', 'Open']].min(axis=1) - df['Low']
    df['Avg_Upper_Shadow_5D'] = df['Upper_Shadow'].rolling(window=5).mean()
    df['Avg_Lower_Shadow_5D'] = df['Lower_Shadow'].rolling(window=5).mean()
    
    # Calculate Volume and Amount Changes
    df['Volume_Change'] = df['Volume'] - df['Volume'].shift(1)
    df['Sign_Volume_Change'] = df['Volume_Change'].apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    df['Amount_Change'] = df['Amount'] - df['Amount'].shift(1)
    df['Sign_Amount_Change'] = df['Amount_Change'].apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    # Combine Price and Volume Indicators
    df['Bullish_Candle_Increasing_Volume'] = ((df['Real_Body'] > 0) & (df['Volume_Change'] > 0)).astype(int)
    df['Bearish_Candle_Decreasing_Volume'] = ((df['Real_Body'] < 0) & (df['Volume_Change'] < 0)).astype(int)
    
    # Calculate Simple Moving Averages
    df['SMA_5'] = df['Close'].rolling(window=5).mean()
    df['SMA_10'] = df['Close'].rolling(window=10).mean()
    df['Close_Relative_to_SMA_5'] = df['Close'] - df['SMA_5']
    df['SMA_5_Relative_to_SMA_10'] = df['SMA_5'] - df['SMA_10']
    
    # Use Price and Volume Combination with Moving Averages
    df['Bullish_Candles_Above_SMA_5'] = ((df['Real_Body'] > 0) & (df['Close'] > df['SMA_5'])).astype(int)
    df['Bearish_Candles_Below_SMA_5'] = ((df['Real_Body'] < 0) & (df['Close'] < df['SMA_5'])).astype(int)
    
    # Calculate Momentum
    df['Price_Momentum_5D'] = df['Close'] - df['Close'].shift(5)
    df['Volume_Momentum_5D'] = df['Volume'] - df['Volume'].shift(5)
    
    # Combine Momentum and Moving Averages
    df['Positive_Price_Momentum_Above_SMA_5'] = ((df['Price_Momentum_5D'] > 0) & (df['Close'] > df['SMA_5'])).astype(int)
    df['Negative_Price_Momentum_Below_SMA_5'] = ((df['Price_Momentum_5D'] < 0) & (df['Close'] < df['SMA_5'])).astype(int)
    
    # Calculate True Range and ATR
    df['True_Range'] = df[['High' - df['Low'], abs(df['High'] - df['Close'].shift()), abs(df['Low'] - df['Close'].shift())]].max(axis=1)
    df['ATR_5D'] = df
