```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Simple Moving Averages (SMA)
    sma_50 = df['close'].rolling(window=50).mean()
    sma_100 = df['close'].rolling(window=100).mean()
    sma_200 = df['close'].rolling(window=200).mean()

    # Subtract Longer SMA from Shorter SMA
    sma_diff_100_200 = sma_100 - sma_200
    sma_diff_50_100 = sma_50 - sma_100

    # Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']

    # Reversal Signal
    reversal_signal = intraday_return.apply(lambda x: -1 if x > 0 else 1)

    # Momentum Signals
    momentum_100_200 = sma_diff_100_200 * reversal_signal
    momentum_50_100 = sma_diff_50_100 * reversal_signal

    # High-Low Range Momentum
    high_low_range = df['high'] - df['low']
    high_low_range_momentum = high_low_range - high_low_range.shift(1)

    # Volume Adjustment
    avg_volume = df['volume'].rolling(window=30).sum() / 30

    # Adjusted High-Low Range Momentum
    adjusted_high_low_range_momentum = high_low_range_momentum / avg_volume

    # Combined Momentum and Reversal
    combined_momentum_reversal_100_200 = sma_diff_100_200 * reversal_signal
    combined_momentum_reversal_50_100 = sma_diff_50_100 * reversal_signal

    # Price Change Momentum
    price_change_momentum = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)

    # Combined Price and Volume Momentum
    combined_price_volume_momentum = price_change_momentum * (df['volume'] / df['volume'].rolling(window=30).mean())

    # Calculate 20-Day Weighted Moving Average of Returns
    weighted_returns = (df['close'].pct_change() * df['volume']).rolling(window=20).sum()
    weighted_volume = df['volume'].rolling(window=20).sum()
    weighted_avg_returns = weighted_returns / weighted_volume

    # Adjust for Price Volatility
    avg_daily_price_range = (df['high'] - df['low']).rolling(window=20).mean()
    adjusted_weighted_avg_returns = weighted_avg_returns - avg_daily_price_range

    # Compute Average True Range (ATR)
    tr1 = df['high'] - df['low']
    tr2 = abs(df['high'] - df['close'].shift(1))
    tr3 = abs(df['low'] - df['close'].shift(1))
    true_range = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
    atr = true_range.rolling(window=14).mean()

    # Multiply ATR by Combined Signal
    atr_combined_signal = atr * (sma_diff_100_200 * reversal_signal)

    # Smooth Result with Exponential Moving Average (EMA)
    ema_atr_combined_signal = atr_combined_signal.ewm(span=14, adjust=False).mean()

    # Final Alpha Factor
    alpha_factor = (
        combined_momentum_reversal_100_200 + 
        combined_momentum_reversal_50_100 + 
        adjusted_high_low_range_momentum + 
        combined_price_volume_momentum + 
        adjusted_weighted_avg_returns + 
        ema_atr_combined_signal
    )

    return alpha_factor
```
