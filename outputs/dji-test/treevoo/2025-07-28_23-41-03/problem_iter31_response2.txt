```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Real Body
    df['Real_Body'] = df['Close'] - df['Open']
    
    # Create Factor: Sum of Consecutive Bullish Real Bodies
    df['Bullish_Sum'] = (df['Real_Body'].clip(lower=0).rolling(window=5, min_periods=1).sum())
    
    # Create Factor: Sum of Consecutive Bearish Real Bodies
    df['Bearish_Sum'] = (df['Real_Body'].clip(upper=0).rolling(window=5, min_periods=1).sum())

    # Calculate Shadow Lengths
    df['Upper_Shadow'] = df['High'] - df[['Close', 'Open']].max(axis=1)
    df['Lower_Shadow'] = df[['Close', 'Open']].min(axis=1) - df['Low']

    # Create Factor: Average of Last 5 Days' Upper Shadows
    df['Upper_Shadow_Avg'] = df['Upper_Shadow'].rolling(window=5, min_periods=1).mean()

    # Create Factor: Average of Last 5 Days' Lower Shadows
    df['Lower_Shadow_Avg'] = df['Lower_Shadow'].rolling(window=5, min_periods=1).mean()

    # Calculate Volume Change
    df['Volume_Change'] = df['Volume'] - df['Volume'].shift(1)
    
    # Create Factor: Sign of Volume Change
    df['Volume_Change_Sign'] = df['Volume_Change'].apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0))

    # Calculate Amount Change
    df['Amount_Change'] = df['Amount'] - df['Amount'].shift(1)
    
    # Create Factor: Sign of Amount Change
    df['Amount_Change_Sign'] = df['Amount_Change'].apply(lambda x: 1 if x > 0 else (-1 if x < 0 else 0))

    # Create Factor: Bullish Candles with Increasing Volume
    df['Bullish_Increasing_Volume'] = ((df['Real_Body'] > 0) & (df['Volume_Change'] > 0)).astype(int)

    # Create Factor: Bearish Candles with Decreasing Volume
    df['Bearish_Decreasing_Volume'] = ((df['Real_Body'] < 0) & (df['Volume_Change'] < 0)).astype(int)

    # Calculate Simple Moving Averages
    df['SMA_5'] = df['Close'].rolling(window=5, min_periods=1).mean()
    df['SMA_10'] = df['Close'].rolling(window=10, min_periods=1).mean()

    # Create Factor: Close Price Relative to SMA_5
    df['Close_Relative_to_SMA_5'] = df['Close'] / df['SMA_5']

    # Create Factor: SMA_5 Relative to SMA_10
    df['SMA_5_Relative_to_SMA_10'] = df['SMA_5'] / df['SMA_10']

    # Calculate Price Momentum
    df['Price_Momentum'] = df['Close'] - df['Close'].shift(5)

    # Create Factor: Price Momentum over 5 Days
    df['Price_Momentum_5D'] = df['Price_Momentum']

    # Calculate Volume Momentum
    df['Volume_Momentum'] = df['Volume'] - df['Volume'].shift(5)

    # Create Factor: Volume Momentum over 5 Days
    df['Volume_Momentum_5D'] = df['Volume_Momentum']

    # Create Factor: Positive Price Momentum Above SMA_5
    df['Positive_Price_Momentum_Above_SMA_5'] = ((df['Price_Momentum'] > 0) & (df['Close'] > df['SMA_5'])).astype(int)

    # Create Factor: Negative Price Momentum Below SMA_5
    df['Negative_Price_Momentum_Below_SMA_5'] = ((df['Price_Momentum'] < 0) & (df['Close'] < df['SMA_5'])).astype(int)

    # Calculate True Range
    df['True_Range'] = df[['High', 'Low', 'Close']].diff().abs().max(axis=1)

    # Create Factor: Average True Range (ATR) over 5 Days
    df['ATR_5D'] = df['True_Range'].rolling(window=5, min_periods=1).mean()

    # Create Factor: High Volatility and Positive Momentum
    threshold = df['ATR_5D'].quantile(0.75)
    df['High_Vol
