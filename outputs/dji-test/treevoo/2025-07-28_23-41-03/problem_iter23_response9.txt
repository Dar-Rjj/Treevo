```python
def heuristics_v2(data):
    # Calculate the relative close price to the high-low range
    data['close_to_range'] = (data['close'] - data['low']) / (data['high'] - data['low'])
    
    # Calculate the volume weighted by the close to range
    data['volume_weighted'] = data['close_to_range'] * data['volume']
    
    # Calculate the moving average of the volume weighted
    data['volume_weighted_ma'] = data['volume_weighted'].rolling(window=20).mean()
    
    # Calculate the factor as the ratio of the current volume weighted to its moving average
    factor_values = data['volume_weighted'] / data['volume_weighted_ma']
    
    return factor_values
```
