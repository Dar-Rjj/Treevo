```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the ratio of close to high (C/H) as a measure of day's performance
    df['C_H_Ratio'] = df['close'] / df['high']
    
    # Compute the difference between high and low prices adjusted by volume (VWAP-like metric)
    df['VWAP_Diff'] = (df['high'] - df['low']) * df['volume']
    
    # Measure the gap between opening and closing prices (O-C) to gauge market momentum
    df['O_C_Gap'] = df['open'] - df['close']
    
    # Calculate Intraday Return using Open and Close prices
    df['Intraday_Return'] = df['close'] - df['open']
    
    # Assign reversal signals based on the sign of intraday return
    df['Reversal_Signal'] = np.where(df['Intraday_Return'] > 0, -1, 1)
    
    # Develop a simple moving average (SMA) of close prices
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Construct a volume-weighted moving average (VWMA) of close prices
    df['VWMA_20'] = (df['close'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Calculate 20-Day Weighted Moving Average of Returns
    df['Weighted_Avg_Return_20'] = (df['Intraday_Return'] * df['volume']).rolling(window=22).sum() / df['volume'].rolling(window=22).sum()
    
    # Calculate Daily Price Range
    df['Daily_Price_Range'] = df['high'] - df['low']
    
    # Calculate 20-Day Average Daily Price Range
    df['Avg_Daily_Price_Range_20'] = df['Daily_Price_Range'].rolling(window=20).mean()
    
    # Final Factor Value: 20-Day Weighted Moving Average of Returns - 20-Day Average Daily Price Range
    df['Factor_Value'] = df['Weighted_Avg_Return_20'] - df['Avg_Daily_Price_Range_20']
    
    # Calculate Volume-Weighted Price
    df['Volume_Weighted_Price'] = (df['close'] * df['volume']).rolling(window=22).sum() / df['volume'].rolling(window=22).sum()
    
    # Calculate Difference between Current Close and Volume-Weighted Price
    df['Close_VW_Price_Diff'] = df['close'] - df['Volume_Weighted_Price']
    
    # Compute Average True Range (ATR)
    df['True_Range'] = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    df['ATR_20'] = df['True_Range'].rolling(window=20).mean()
    
    # Multiply ATR by Reversal Signal
    df['ATR_Reversal'] = df['ATR_20'] * df['Reversal_Signal']
    
    # Add to 20-Day Weighted Moving Average of Returns
    df['Enhanced_Factor'] = df['Weighted_Avg_Return_20'] + df['ATR_Reversal']
    
    # Apply Exponential Moving Average (EMA) with Short Period
    df['Final_Factor'] = df['Enhanced_Factor'].ewm(span=5, adjust=False).mean()
    
    # Output the final factor values
    return df['Final_Factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# factor_values = heuristics_v2(df)
# print(factor_values)
```
