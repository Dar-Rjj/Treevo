```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 20-Day Weighted Moving Average of Returns
    df['daily_return'] = df['close'].pct_change()
    df['weighted_return'] = df['daily_return'] * df['volume']
    sum_weighted_return_20 = df['weighted_return'].rolling(window=20).sum()
    sum_volume_20 = df['volume'].rolling(window=20).sum()
    wma_20 = sum_weighted_return_20 / sum_volume_20
    
    # Adjust for Price Volatility
    avg_daily_price_range_20 = (df['high'] - df['low']).rolling(window=20).mean()
    adjusted_wma_20 = wma_20 - avg_daily_price_range_20
    
    # Calculate Intraday Return Ratio
    intraday_return_ratio = df['high'] / df['low']
    
    # Calculate Weighted Open-to-Close Return
    weighted_open_to_close_return = (df['close'] - df['open']) * df['volume']
    
    # High-Low Range Momentum
    high_low_range_today = df['high'] - df['low']
    high_low_range_yesterday = (df['high'].shift(1) - df['low'].shift(1)).fillna(0)
    high_low_momentum = high_low_range_today - high_low_range_yesterday
    
    # Adjust by Volume
    avg_volume_30 = df['volume'].rolling(window=30).mean()
    
    # Price Trend
    sma_50 = df['close'].rolling(window=50).mean()
    price_trend = sma_50 - df['close']
    
    # Combine Factors
    combined_factors = adjusted_wma_20 + intraday_return_ratio + weighted_open_to_close_return + high_low_momentum + price_trend
    
    # Final Alpha Factor
    final_alpha_factor = combined_factors / avg_volume_30
    
    return final_alpha_factor
```
