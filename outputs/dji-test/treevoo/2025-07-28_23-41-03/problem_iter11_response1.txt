```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    intraday_return = df['close'] / df['open'] - 1
    
    # Calculate Reversal Signal
    reversal_signal = intraday_return.apply(lambda x: -1 if x > 0 else 1)
    
    # Calculate Average True Range (ATR)
    high_low = df['high'] - df['low']
    high_close_prev = (df['high'] - df['close'].shift(1)).abs()
    low_close_prev = (df['low'] - df['close'].shift(1)).abs()
    tr = pd.concat([high_low, high_close_prev, low_close_prev], axis=1).max(axis=1)
    atr = tr.rolling(window=14).mean()
    
    # Multiply ATR by Reversal Signal
    atr_reversal = atr * reversal_signal
    
    # Exponential Moving Average (EMA) of ATR * Reversal
    ema_atr_reversal = atr_reversal.ewm(span=7, adjust=False).mean()
    
    # Calculate Simple Moving Averages
    sma_50 = df['close'].rolling(window=50).mean()
    sma_100 = df['close'].rolling(window=100).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    
    # Subtract Longer SMA from Shorter SMA
    sma_diff_100_200 = sma_100 - sma_200
    sma_diff_50_100 = sma_50 - sma_100
    
    # Calculate Daily Price Return
    daily_price_return = df['close'] / df['close'].shift(1) - 1
    
    # Calculate 20-Day Weighted Moving Average of Returns
    weighted_returns = (daily_price_return * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Adjust for Price Volatility
    avg_daily_range = (df['high'] - df['low']).rolling(window=20).mean()
    adjusted_weighted_returns = weighted_returns - avg_daily_range
    
    # Calculate Intraday Return Ratio
    intraday_return_ratio = (df['high'] - df['low']) / (df['open'] + df['close'])
    
    # Calculate Weighted Open-to-Close Return
    weighted_open_to_close = (df['close'] - df['open']) * df['volume']
    
    # Combine Momentum and Volume Indicators
    combined_factor = (
        0.3 * adjusted_weighted_returns +
        0.2 * intraday_return_ratio +
        0.1 * weighted_open_to_close +
        0.2 * sma_diff_100_200 +
        0.2 * sma_diff_50_100
    ) + ema_atr_reversal
    
    return combined_factor
```
