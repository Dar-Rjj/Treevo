```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()

    # Price momentum
    df['5_day_MA'] = df['close'].rolling(window=5).mean()
    df['short_term_deviation'] = df['close'] - df['5_day_MA']
    
    df['20_day_MA'] = df['close'].rolling(window=20).mean()
    df['long_term_deviation'] = df['close'] - df['20_day_MA']

    # Volatility
    df['volatility'] = df['daily_return'].rolling(window=20).std()

    # Volume-Weighted Price Movement Factor
    df['VWAP'] = (df['high'] + df['low'] + df['close']) / 3 * df['volume']
    df['10_day_EMA_VWAP'] = df['VWAP'].ewm(span=10, adjust=False).mean()
    df['50_day_EMA_VWAP'] = df['VWAP'].ewm(span=50, adjust=False).mean()
    df['VWAP_factor'] = df['10_day_EMA_VWAP'] / df['50_day_EMA_VWAP']

    # Volume change
    df['volume_change'] = df['volume'].pct_change()

    # Price and volume relationship
    df['high_close_ratio'] = df['high'] / df['close'].shift(1) * df['volume']
    df['low_close_ratio'] = df['low'] / df['close'].shift(1) * df['volume']

    # Money Flow Index (MFI)
    df['TP'] = (df['high'] + df['low'] + df['close']) / 3
    df['MF'] = df['TP'] * df['volume']
    df['PMF'] = np.where(df['TP'] > df['TP'].shift(1), df['MF'], 0)
    df['NMF'] = np.where(df['TP'] < df['TP'].shift(1), df['MF'], 0)
    df['14_day_PMF'] = df['PMF'].rolling(window=14).sum()
    df['14_day_NMF'] = df['NMF'].rolling(window=14).sum()
    df['MFI'] = 100 - (100 / (1 + (df['14_day_PMF'] / df['14_day_NMF'])))

    # Daily average amount traded
    df['avg_amount_traded_20'] = df['amount'].rolling(window=20).mean()

    # Correlation between amount traded and daily returns
    df['corr_amount_return'] = df['amount'].rolling(window=20).corr(df['daily_return'])

    # Relative Strength Index (RSI)
    df['price_change'] = df['close'].diff()
    df['gain'] = np.where(df['price_change'] > 0, df['price_change'], 0)
    df['loss'] = np.where(df['price_change'] < 0, abs(df['price_change']), 0)
    df['14_day_avg_gain'] = df['gain'].rolling(window=14).mean()
    df['14_day_avg_loss'] = df['loss'].rolling(window=14).mean()
    df['RSI'] = 100 - (100 / (1 + (df['14_day_avg_gain'] / df['14_day_avg_loss'])))

    # Range-based factor
    df['range'] = df['high'] - df['low']
    df['true_range'] = df[['high', 'close']].max(axis=1) - df[['low', 'close']].min(axis=1).shift(1)

    # Intraday momentum factor
    df['open_close_diff'] = df['open'] - df['close']
    df['close_prev_close_diff'] = df['close'] - df['close'].shift(1)

    # Volatility Factor using ATR
    df['ATR'] = df['high'] - df['low']
    df['ATR_14_sma'] = df['ATR'].rolling(window=14).mean()

    # Alpha factor
    alpha_factor = (
        df['short_term_deviation'] 
        + df['long_term_deviation']
        + df['volatility']
        + df['VWAP_factor']
        + df['volume_change']
        + df['high_close_ratio']
        + df['low_close_ratio']
        + df['MFI']
        + df['avg_amount_traded_20']
        +
