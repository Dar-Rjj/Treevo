```python
import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving averages (SMA)
    df['SMA_5'] = df['close'].rolling(window=5).mean()
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    df['SMA_50'] = df['close'].rolling(window=50).mean()

    # Calculate the difference between current close and SMA
    df['SMA_5_diff'] = df['close'] - df['SMA_5']
    df['SMA_10_diff'] = df['close'] - df['SMA_10']
    df['SMA_20_diff'] = df['close'] - df['SMA_20']
    df['SMA_50_diff'] = df['close'] - df['SMA_50']

    # Calculate returns over various look-back periods
    df['return_1W'] = df['close'].pct_change(periods=5)
    df['return_1M'] = df['close'].pct_change(periods=21)
    df['return_3M'] = df['close'].pct_change(periods=63)

    # Composite momentum indicator
    df['composite_momentum'] = 0.3 * df['return_1W'] + 0.4 * df['return_1M'] + 0.3 * df['return_3M']
    df['composite_momentum'] /= df['close'].pct_change().rolling(window=21).std()

    # Volume-Weighted Average Price (VWAP)
    df['VWAP_1D'] = (df['volume'] * df['close']).cumsum() / df['volume'].cumsum()
    df['VWAP_1W'] = (df['volume'] * df['close']).rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    df['VWAP_1M'] = (df['volume'] * df['close']).rolling(window=21).sum() / df['volume'].rolling(window=21).sum()

    # Deviation of the current close from VWAP
    df['VWAP_1D_dev'] = df['close'] - df['VWAP_1D']
    df['VWAP_1W_dev'] = df['close'] - df['VWAP_1W']
    df['VWAP_1M_dev'] = df['close'] - df['VWAP_1M']

    # Volume-Weighted Moving Average (VWMA)
    df['VWMA_10'] = (df['volume'] * df['close']).rolling(window=10).sum() / df['volume'].rolling(window=10).sum()
    df['VWMA_20'] = (df['volume'] * df['close']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()

    # Slope of VWMA
    df['VWMA_10_slope'] = df['VWMA_10'].diff()
    df['VWMA_20_slope'] = df['VWMA_20'].diff()

    # Historical volatility
    df['volatility_21D'] = df['close'].pct_change().rolling(window=21).std()
    df['volatility_50D'] = df['close'].pct_change().rolling(window=50).std()

    # Average True Range (ATR)
    df['tr'] = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    df['ATR_14'] = df['tr'].rolling(window=14).mean()

    # Bollinger Bands
    df['BB_upper'] = df['SMA_20'] + 2 * df['close'].rolling(window=20).std()
    df['BB_lower'] = df['SMA_20'] - 2 * df['close'].rolling(window=20).std()

    # Distance from Bollinger Bands
    df['BB_distance'] = (df['close'] - df['SMA_20']) / (df['BB_upper'] - df['SMA_20'])

    # Composite score
    df['composite_score'] = 0.3 * df['composite_momentum'] + 0.3 * df['VWAP_1M_dev'] + 0.2 * df['VWMA_2
