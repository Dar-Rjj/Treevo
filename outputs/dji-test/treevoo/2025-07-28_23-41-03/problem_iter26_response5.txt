```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Short-Term Momentum
    df['5_day_return'] = df['close'].pct_change(5)
    df['10_day_return'] = df['close'].pct_change(10)
    
    # Medium-Term Momentum
    df['20_day_return'] = df['close'].pct_change(20)
    df['50_day_return'] = df['close'].pct_change(50)
    
    # Volume Growth
    df['5_day_volume_change'] = df['volume'].pct_change(5)
    df['20_day_volume_change'] = df['volume'].pct_change(20)
    
    # Amount Growth
    df['5_day_amount_change'] = df['amount'].pct_change(5)
    df['20_day_amount_change'] = df['amount'].pct_change(20)
    
    # Price-Volume Trend Indicator
    df['5_day_PVT'] = (df['close'] - df['close'].shift(4)) * (df['volume'] / 5)
    df['20_day_PVT'] = (df['close'] - df['close'].shift(19)) * (df['volume'] / 20)
    
    # High-Low Range
    df['5_day_avg_high_low_range'] = (df['high'] - df['low']).rolling(window=5).mean()
    df['20_day_avg_high_low_range'] = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Volatility
    df['5_day_historical_volatility'] = np.sqrt(((np.log(df['close'] / df['close'].shift(1)))**2).rolling(window=5).sum() / 4)
    df['20_day_historical_volatility'] = np.sqrt(((np.log(df['close'] / df['close'].shift(1)))**2).rolling(window=20).sum() / 19)
    
    # EMA Crossovers
    df['EMA_5'] = df['close'].ewm(span=5, adjust=False).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    df['EMA_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['EMA_50'] = df['close'].ewm(span=50, adjust=False).mean()
    df['5_day_EMA_cross_20_day_EMA'] = np.where(df['EMA_5'] > df['EMA_20'], 1, np.where(df['EMA_5'] < df['EMA_20'], -1, 0))
    df['10_day_EMA_cross_50_day_EMA'] = np.where(df['EMA_10'] > df['EMA_50'], 1, np.where(df['EMA_10'] < df['EMA_50'], -1, 0))
    
    # Gap Up/Down
    df['gap_up'] = np.where(df['open'] > df['high'].shift(1), 1, 0)
    df['gap_down'] = np.where(df['open'] < df['low'].shift(1), -1, 0)
    
    # Combine all factors into a single alpha factor
    alpha_factor = (
        df['5_day_return'] + 
        df['10_day_return'] + 
        df['20_day_return'] + 
        df['50_day_return'] + 
        df['5_day_volume_change'] + 
        df['20_day_volume_change'] + 
        df['5_day_amount_change'] + 
        df['20_day_amount_change'] + 
        df['5_day_PVT'] + 
        df['20_day_PVT'] + 
        df['5_day_avg_high_low_range'] + 
        df['20_day_avg_high_low_range'] + 
        df['5_day_historical_volatility'] + 
        df['20_day_historical_volatility'] + 
        df['5_day_EMA_cross_20_day_EMA'] + 
        df['10_day_EMA_cross_50_day_EMA'] + 
        df['gap_up'] + 
        df['gap_down']
    )
    
    return alpha_factor
```
