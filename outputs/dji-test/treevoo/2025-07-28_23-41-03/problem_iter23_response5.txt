```python
import pandas as pd

def heuristics_v2(df):
    # Calculate SMAs
    df['SMA_50'] = df['close'].rolling(window=50).mean()
    df['SMA_100'] = df['close'].rolling(window=100).mean()
    df['SMA_200'] = df['close'].rolling(window=200).mean()

    # Momentum Signals
    df['Momentum_100_200'] = df['SMA_100'] - df['SMA_200']
    df['Momentum_50_100'] = df['SMA_50'] - df['SMA_100']

    # Daily Price Return
    df['Daily_Return'] = df['close'].pct_change()

    # 20-Day Volume-Weighted Average Return
    df['Volume_Weighted_Return'] = (df['Daily_Return'] * df['volume']).rolling(window=20).sum() / df['volume'].rolling(window=20).sum()

    # Adjust for Price Volatility
    df['20_Day_Avg_Price_Range'] = (df['high'] - df['low']).rolling(window=20).mean()
    df['Adjusted_VW_Return'] = df['Volume_Weighted_Return'] - df['20_Day_Avg_Price_Range']

    # Intraday Return
    df['Intraday_Return'] = (df['close'] - df['open']) / df['open']

    # Reversal Signal
    df['Reversal_Signal'] = df['Intraday_Return'].apply(lambda x: -1 if x > 0 else 1)

    # Combine Momentum and Reversal
    df['Combined_Momentum_100_200'] = df['Momentum_100_200'] * df['Reversal_Signal']
    df['Combined_Momentum_50_100'] = df['Momentum_50_100'] * df['Reversal_Signal']

    # High-Low Range Momentum
    df['High_Low_Range'] = df['high'] - df['low']
    df['HL_Range_Momentum'] = df['High_Low_Range'] - df['High_Low_Range'].shift(1)

    # Volume Adjustment
    df['Avg_Volume'] = df['volume'].rolling(window=20).mean()

    # Adjusted High-Low Range Momentum
    df['Adjusted_HL_Range_Momentum'] = df['HL_Range_Momentum'] / df['Avg_Volume']

    # Intraday Return Ratio
    df['Intraday_Return_Ratio'] = df['high'] / df['low']

    # Weighted Open-to-Close Return
    df['Open_to_Close_Return'] = (df['close'] - df['open']) / df['open']
    df['Weighted_Open_to_Close_Return'] = df['Open_to_Close_Return'] * df['volume']

    # Combine Adjusted Momentum and Intraday Factors
    df['Combined_Factor'] = df['Adjusted_VW_Return'] + df['Intraday_Return_Ratio'] + df['Weighted_Open_to_Close_Return']

    # True Range
    df['True_Range'] = df[['high', 'low']].max(axis=1) - df[['high', 'low']].min(axis=1)
    df['True_Range'] = df[['True_Range', (df['high'] - df['close'].shift(1)).abs(), (df['close'].shift(1) - df['low']).abs()]].max(axis=1)

    # Average True Range (ATR)
    df['ATR_14'] = df['True_Range'].rolling(window=14).mean()

    # Exponential Moving Average (EMA) of ATR * Reversal Signal
    df['EMA_ATR_Reversal'] = (df['ATR_14'] * df['Reversal_Signal']).ewm(span=14, adjust=False).mean()

    # Final Alpha Factor
    df['Final_Alpha_Factor'] = (df['Combined_Momentum_50_100'] + df['Combined_Momentum_100_200']) + df['Adjusted_HL_Range_Momentum'] + df['Combined_Factor'] + df['EMA_ATR_Reversal']

    return df['Final_Alpha_Factor']
```
