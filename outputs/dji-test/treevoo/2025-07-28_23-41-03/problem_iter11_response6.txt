```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Range
    high_low_range = df['high'] - df['low']
    high_low_range_prev = high_low_range.shift(1)
    
    # Calculate High-Low Range Momentum
    high_low_momentum = high_low_range - high_low_range_prev
    
    # Calculate Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']
    
    # Calculate Reversal Signal
    reversal_signal = intraday_return.apply(lambda x: -1 if x > 0 else 1)
    
    # Adjust by Volume and Amount
    n = 5  # Number of days for volume average
    m = 5  # Number of days for amount average
    avg_volume = df['volume'].rolling(window=n).mean()
    avg_amount = df['amount'].rolling(window=m).mean()
    combined_vol_amt = avg_volume + avg_amount
    
    # Combine High-Low Range Momentum and Adjusted Volume-Amount
    high_low_adj = high_low_momentum / combined_vol_amt
    
    # Calculate Daily Price Return
    daily_price_return = (df['close'] - df['close'].shift(1)) / df['close'].shift(1)
    
    # Calculate 20-Day Weighted Moving Average of Returns
    weighted_returns = (daily_price_return * df['volume']).rolling(window=22).sum() / df['volume'].rolling(window=22).sum()
    
    # Adjust for Price Volatility
    daily_price_range = df['high'] - df['low']
    avg_daily_price_range = daily_price_range.rolling(window=20).mean()
    final_factor_value = weighted_returns - avg_daily_price_range
    
    # Compute Average True Range (ATR)
    tr = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    atr = tr.rolling(window=14).mean()
    
    # Multiply ATR by Reversal Signal
    atr_reversal = atr * reversal_signal
    
    # Combine Factors
    factor = reversal_signal + weighted_returns + final_factor_value + high_low_adj + atr_reversal
    factor = factor.ewm(span=10, adjust=False).mean()
    
    return factor
```
