```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Intraday Return
    intraday_return = (df['close'] - df['open']) / df['open']
    
    # Calculate Reversal Signal
    reversal_signal = intraday_return.apply(lambda x: -1 if x > 0 else 1)
    
    # Calculate Daily Price Return
    daily_price_return = (df['close'] / df['close'].shift(1)) - 1
    
    # Calculate 20-Day Weighted Moving Average of Returns
    weighted_returns_22 = (daily_price_return * df['volume']).rolling(window=22).sum()
    total_volume_22 = df['volume'].rolling(window=22).sum()
    wma_22 = weighted_returns_22 / total_volume_22
    
    # Adjust for Price Volatility
    daily_price_range = df['high'] - df['low']
    avg_daily_price_range_22 = daily_price_range.rolling(window=22).mean()
    adjusted_wma_22 = wma_22 - avg_daily_price_range_22
    
    # Calculate Exponential Moving Averages
    ema_20 = df['close'].ewm(span=20, adjust=False).mean()
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    ema_100 = df['close'].ewm(span=100, adjust=False).mean()
    
    # Subtract Longer EMA from Shorter EMA
    ema_diff_50_100 = ema_50 - ema_100
    ema_diff_20_50 = ema_20 - ema_50
    
    # Calculate True Range
    true_range = pd.concat([df['high'] - df['low'], abs(df['high'] - df['close'].shift(1)), abs(df['low'] - df['close'].shift(1))], axis=1).max(axis=1)
    
    # Calculate 20-Day Volume-Weighted Average Return
    weighted_returns_20 = (daily_price_return * df['volume']).rolling(window=20).sum()
    total_volume_20 = df['volume'].rolling(window=20).sum()
    vwa_20 = weighted_returns_20 / total_volume_20
    
    # Adjust for Price Volatility
    avg_daily_price_range_20 = daily_price_range.rolling(window=20).mean()
    adjusted_vwa_20 = vwa_20 - avg_daily_price_range_20
    
    # Calculate Intraday Return Ratio
    intraday_return_ratio = (df['high'] - df['low']) / df['close']
    
    # Calculate Weighted Open-to-Close Return
    open_to_close_return = (df['close'] - df['open']) / df['open']
    weighted_open_to_close_return = open_to_close_return * df['volume']
    
    # Combine All Factors
    combined_factors = (
        ema_diff_20_50 + 
        adjusted_vwa_20 + 
        intraday_return_ratio + 
        weighted_open_to_close_return + 
        reversal_signal
    )
    
    # Apply Exponential Moving Average (EMA) with Short Period
    final_factor = combined_factors.ewm(span=5, adjust=False).mean()
    
    return final_factor
```
