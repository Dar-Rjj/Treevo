```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Simple Moving Average (SMA) of Close Price over a 10-day period
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    
    # Relative Strength Index (RSI) using close price with a 14-day lookback
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['RSI_14'] = 100 - (100 / (1 + rs))
    
    # On-Balance Volume (OBV)
    df['OBV'] = (np.sign(df['close'].diff()) * df['volume']).fillna(0).cumsum()
    
    # Chaikin Money Flow (CMF) using volume and high, low, close prices over a 20-day period
    money_flow_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    money_flow_volume = money_flow_multiplier * df['volume']
    df['CMF_20'] = money_flow_volume.rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Bollinger Bands for the close price with a 20-day moving average and 2 standard deviations
    df['BB_middle'] = df['close'].rolling(window=20).mean()
    df['BB_std'] = df['close'].rolling(window=20).std()
    df['BB_upper'] = df['BB_middle'] + 2 * df['BB_std']
    df['BB_lower'] = df['BB_middle'] - 2 * df['BB_std']
    
    # Average True Range (ATR) using the true range of high, low, and previous close over a 14-day period
    df['TR'] = df[['high', 'low', 'close']].shift(1).join(df[['high', 'low']]).apply(lambda x: max(x[0], x[1]) - min(x[0], x[1]), axis=1)
    df['ATR_14'] = df['TR'].rolling(window=14).mean()
    
    # Moving Average Convergence Divergence (MACD) using close price with 12-day and 26-day EMA and a 9-day signal line
    df['EMA_12'] = df['close'].ewm(span=12, adjust=False).mean()
    df['EMA_26'] = df['close'].ewm(span=26, adjust=False).mean()
    df['MACD'] = df['EMA_12'] - df['EMA_26']
    df['MACD_signal'] = df['MACD'].ewm(span=9, adjust=False).mean()
    
    # Williams %R using high, low, and close prices over a 14-day period
    df['Williams_R'] = ((df['high'].rolling(window=14).max() - df['close']) / 
                        (df['high'].rolling(window=14).max() - df['low'].rolling(window=14).min())) * -100
    
    # Doji Candlestick Pattern
    df['Doji'] = (abs(df['open'] - df['close']) / (df['high'] - df['low']) < 0.1).astype(int)
    
    # Engulfing Pattern
    df['Engulfing'] = (((df['close'] > df['open']) & (df['close'].shift(1) < df['open'].shift(1)) & 
                        (df['close'] > df['open'].shift(1)) & (df['open'] < df['close'].shift(1))) |
                       ((df['close'] < df['open']) & (df['close'].shift(1) > df['open'].shift(1)) & 
                        (df['close'] < df['open'].shift(1)) & (df['open'] > df['close'].shift(1)))).astype(int)
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (df['SMA_10'] + df['RSI_14'] + df['OBV'] + df['CMF_20'] + 
                          (df['close'] - df['BB_middle']) / df['BB_std'] + df['ATR_14'] + 

