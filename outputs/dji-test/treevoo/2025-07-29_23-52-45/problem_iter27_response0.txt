```python
import pandas as pd

def heuristics_v2(df):
    # Calculate simple moving average (SMA) of closing prices over a 10-day period
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    
    # Evaluate the difference between today's close and the SMA
    df['Close_SMA_Diff'] = df['close'] - df['SMA_10']
    
    # Compute the ratio of today's volume to the average volume over the past 10 days
    df['Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=10).mean()
    
    # Measure the cumulative volume over a window, say 20 days
    df['Cum_Volume_20'] = df['volume'].rolling(window=20).sum()
    
    # Determine if there is a higher high and lower low pattern in the last 5 days
    df['Higher_High'] = df['high'].rolling(window=5).max() > df['high'].shift(1).rolling(window=5).max()
    df['Lower_Low'] = df['low'].rolling(window=5).min() < df['low'].shift(1).rolling(window=5).min()
    
    # Check for a bullish or bearish engulfing pattern using open, high, low, and close prices
    df['Bullish_Engulfing'] = ((df['open'] > df['close'].shift(1)) & (df['close'] > df['open'].shift(1)) & 
                               (df['close'] >= df['open'].shift(1)) & (df['open'] <= df['close'].shift(1)))
    df['Bearish_Engulfing'] = ((df['open'] < df['close'].shift(1)) & (df['close'] < df['open'].shift(1)) & 
                               (df['close'] <= df['open'].shift(1)) & (df['open'] >= df['close'].shift(1)))
    
    # Calculate the percentage change from the opening to the closing price
    df['Open_Close_Change'] = (df['close'] - df['open']) / df['open'] * 100
    
    # Create a flag for up days (close > open)
    df['Up_Day'] = (df['close'] > df['open']).astype(int)
    
    # Daily range (high - low), and its average over the last 10 days
    df['Daily_Range'] = df['high'] - df['low']
    df['Avg_Range_10'] = df['Daily_Range'].rolling(window=10).mean()
    
    # Difference between the daily range and the 10-day average range
    df['Range_Diff_Avg'] = df['Daily_Range'] - df['Avg_Range_10']
    
    # Identify gaps by comparing today's open to yesterday's close
    df['Gap_Up'] = (df['open'] > df['close'].shift(1))
    df['Gap_Down'] = (df['open'] < df['close'].shift(1))
    
    # Composite factor: Combine multiple indicators into a single factor
    df['Composite_Factor'] = (df['Close_SMA_Diff'] + df['Volume_Ratio'] + df['Cum_Volume_20'] + 
                              df['Higher_High'].astype(int) - df['Lower_Low'].astype(int) + 
                              df['Bullish_Engulfing'].astype(int) - df['Bearish_Engulfing'].astype(int) + 
                              df['Open_Close_Change'] + df['Up_Day'] + df['Range_Diff_Avg'] + 
                              df['Gap_Up'].astype(int) - df['Gap_Down'].astype(int))
    
    return df['Composite_Factor']
```
