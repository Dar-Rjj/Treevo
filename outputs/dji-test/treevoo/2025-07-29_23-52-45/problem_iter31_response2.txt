```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Momentum Indicators
    def calculate_sma(data, window):
        return data.rolling(window=window).mean()

    def calculate_rsi(data, window):
        delta = data.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=window).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=window).mean()
        rs = gain / loss
        rsi = 100 - (100 / (1 + rs))
        return rsi

    # Volume-Based Indicators
    def calculate_obv(data, volume):
        obv = volume.copy()
        obv[data['close'] == data['close'].shift(1)] = 0
        obv[data['close'] > data['close'].shift(1)] = volume
        obv[data['close'] < data['close'].shift(1)] = -volume
        return obv.cumsum()

    def calculate_cmf(data, volume, window):
        mfv = ((data['close'] - data['low']) - (data['high'] - data['close'])) / (data['high'] - data['low'])
        mfv = mfv * volume
        cmf = mfv.rolling(window=window).sum() / volume.rolling(window=window).sum()
        return cmf

    # Volatility and Range Indicators
    def calculate_bollinger_bands(data, window, std_dev):
        sma = data.rolling(window=window).mean()
        std = data.rolling(window=window).std()
        upper_band = sma + (std * std_dev)
        lower_band = sma - (std * std_dev)
        return upper_band, lower_band

    def calculate_atr(data, window):
        high_low = data['high'] - data['low']
        high_close = np.abs(data['high'] - data['close'].shift())
        low_close = np.abs(data['low'] - data['close'].shift())
        tr = np.maximum(high_low, np.maximum(high_close, low_close))
        atr = tr.rolling(window=window).mean()
        return atr

    # Market Sentiment and Trend Indicators
    def calculate_macd(data, fast_window, slow_window, signal_window):
        ema_fast = data.ewm(span=fast_window, adjust=False).mean()
        ema_slow = data.ewm(span=slow_window, adjust=False).mean()
        macd = ema_fast - ema_slow
        signal = macd.ewm(span=signal_window, adjust=False).mean()
        return macd, signal

    def calculate_williams_r(data, window):
        hh = data['high'].rolling(window=window).max()
        ll = data['low'].rolling(window=window).min()
        wpr = -100 * (hh - data['close']) / (hh - ll)
        return wpr

    # Pattern Recognition
    def identify_doji(data):
        doji = (np.abs(data['open'] - data['close']) / (data['high'] - data['low']) < 0.05) & (data['high'] - data['low'] > 0)
        return doji

    def identify_engulfing(data):
        bullish_engulfing = (data['close'] > data['open']) & (data['close'].shift(1) < data['open'].shift(1)) & (data['open'] < data['close'].shift(1)) & (data['close'] > data['open'].shift(1))
        bearish_engulfing = (data['close'] < data['open']) & (data['close'].shift(1) > data['open'].shift(1)) & (data['open'] > data['close'].shift(1)) & (data['close'] < data['open'].shift(1))
        return bullish_engulfing | bearish_engulfing

    # Calculate the alpha factor
    df['sma_10'] = calculate_sma(df['close'], 10)
    df['rsi_14'] = calculate_rsi(df['close'], 14)
    df['obv'] = calculate_obv(df, df['volume'])
    df['cmf_20'] = calculate_cmf(df, df['volume'], 20)
    df['upper_bb'], df['lower_bb'] = calculate_bollinger_bands(df['close'], 20, 2)
    df['atr_14'] = calculate_atr(df, 14)
    df['macd'], df['macd_signal'] = calculate_macd(df['close'], 12,
