```python
import pandas as pd

def heuristics_v2(df):
    # Calculate the difference between close and open prices
    df['price_diff'] = df['close'] - df['open']
    
    # Count the number of days in the past 10 days where the close was higher than the open
    df['close_higher_than_open'] = (df['close'] > df['open']).rolling(window=10).sum()
    
    # Calculate the Average True Range (ATR) over the last 10 days
    df['true_range'] = df[['high', 'low', 'close']].apply(lambda x: max(x[0], x[1]) - min(x[0], x[1]), axis=1)
    df['atr_10'] = df['true_range'].rolling(window=10).mean()
    df['atr_20'] = df['true_range'].rolling(window=20).mean()
    df['volatility_signal'] = (df['atr_10'] < df['atr_20']).astype(int)
    
    # Examine the trading volume relative to the price movement
    df['volume_30_day_avg'] = df['volume'].rolling(window=30).mean()
    df['positive_price_change'] = (df['close'] > df['open'])
    df['volume_above_30_day_avg'] = (df['volume'] > df['volume_30_day_avg'])
    df['buying_pressure'] = ((df['positive_price_change'] & df['volume_above_30_day_avg']).rolling(window=30).sum())
    
    # Analyze the relationship between the highest and lowest prices of the day
    df['intraday_ratio'] = (df['high'] - df['open']) / (df['open'] - df['low'])
    
    # Combine the factors into a composite alpha factor
    df['alpha_factor'] = (df['close_higher_than_open'] * 0.4 +
                          df['volatility_signal'] * 0.3 +
                          df['buying_pressure'] * 0.2 +
                          df['intraday_ratio'] * 0.1)
    
    return df['alpha_factor']

# Example usage:
# df = pd.read_csv('your_data.csv', index_col='date', parse_dates=True)
# alpha_factor = heuristics_v2(df)
```
