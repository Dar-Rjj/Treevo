```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Price Change
    df['price_change'] = df['close'] - df['close'].shift(1)
    
    # Compute Volume-Averaged Daily Return
    N = 20  # Example period
    df['volume_weighted_return'] = (df['price_change'] * df['volume']).rolling(window=N).sum() / df['volume'].rolling(window=N).sum()
    
    # Calculate Raw Momentum
    df['raw_momentum'] = df['close'] - df['close'].shift(7)
    
    # Adjust for Volatility and Volume
    df['short_term_volatility'] = df['close'].rolling(window=7).std()
    df['volume_factor'] = df['volume'] / df['volume'].rolling(window=7).mean()
    df['adjusted_momentum'] = df['raw_momentum'] / (df['short_term_volatility'] * df['volume_factor'])
    
    # Combine Factors
    df['combined_factor'] = df['adjusted_momentum'] * df['volume_weighted_return']
    
    # Calculate M-Day Exponential Moving Average (EMA) Volume
    M = 10  # Example period
    df['ema_volume'] = df['volume'].ewm(span=M, adjust=False).mean()
    
    # Compare Latest Volume to EMA Volume
    df['volume_score'] = np.where(df['volume'] > df['ema_volume'], 1, -1)
    
    # Calculate K-Day Exponential Moving Average (EMA) Amount
    K = 10  # Example period
    df['ema_amount'] = df['amount'].ewm(span=K, adjust=False).mean()
    
    # Compare Latest Amount to EMA Amount
    df['amount_score'] = np.where(df['amount'] > df['ema_amount'], 1, -1)
    
    # Compute LMA-SMA Difference
    L = 200  # Long-term moving average period
    S = 50   # Short-term moving average period
    df['lma'] = df['close'].rolling(window=L).mean()
    df['sma'] = df['close'].rolling(window=S).mean()
    df['lma_sma_diff'] = df['lma'] - df['sma']
    
    # Apply EMA Smoothing on LMA-SMA Difference
    smooth_period = 10
    df['smoothed_lma_sma_diff'] = df['lma_sma_diff'].ewm(span=smooth_period, adjust=False).mean()
    
    # Final factor
    df['final_factor'] = df['combined_factor'] * df['volume_score'] * df['amount_score'] * df['smoothed_lma_sma_diff']
    
    return df['final_factor'].dropna()
```
