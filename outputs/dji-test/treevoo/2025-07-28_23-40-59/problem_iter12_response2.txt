```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Smoothed Momentum
    raw_momentum = df['close'] - df['close'].shift(10)
    smoothed_momentum = (df['close'] - df['close'].shift(21) + raw_momentum) / 2
    
    # Incorporate Volume Change
    avg_volume_21_days = df['volume'].rolling(window=21).mean()
    volume_factor = df['volume'] / avg_volume_21_days
    
    # Adjust for Volatility
    short_term_volatility = df['close'].rolling(window=21).std()
    adjusted_momentum = smoothed_momentum * (1 / short_term_volatility) * volume_factor
    
    # Calculate Intraday Range Indicator
    intraday_range = (df['high'] - df['low']) * volume_factor
    
    # Integrate Volume Weighted Average Price (VWAP)
    vwap = (df['close'] * df['volume']).cumsum() / df['volume'].cumsum()
    vwap_diff = (df['close'] - vwap) * (1 / short_term_volatility)
    
    # Calculate Market Sentiment
    avg_amount_21_days = df['amount'].rolling(window=21).mean()
    sentiment_ratio = df['amount'] / avg_amount_21_days
    
    # Combine Indicators
    final_factor = (adjusted_momentum + intraday_range + vwap_diff + sentiment_ratio)
    
    return final_factor
```
