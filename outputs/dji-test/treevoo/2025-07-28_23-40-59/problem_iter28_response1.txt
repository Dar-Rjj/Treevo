```python
import pandas as pd

def heuristics_v2(df):
    # Calculate Daily Price Change
    df['daily_price_change'] = df['close'].diff()
    
    # Compute Volume-Weighted Daily Return over N days (e.g., 5, 10, 20)
    N = 5
    df['volume_weighted_daily_return'] = (df['daily_price_change'] * df['volume']).rolling(window=N).sum() / df['volume'].rolling(window=N).sum()
    
    # Introduce Enhanced Price Directional Component
    df['close_open_diff'] = df['close'] - df['open']
    df['price_direction'] = df['close_open_diff'].apply(lambda x: 1 if x > 0 else -1 if x < 0 else 0)
    
    # Incorporate Dynamic Volume Spike Indicator
    rolling_window = 20
    df['vol_spike'] = (df['volume'] > df['volume'].rolling(window=rolling_window).mean() + 2 * df['volume'].rolling(window=rolling_window).std())
    df['volume_weighted_daily_return'] = df.apply(lambda row: row['volume_weighted_daily_return'] * (1 + (row['volume'] - df['volume'].rolling(window=rolling_window).mean()) / df['volume'].rolling(window=rolling_window).std()) if row['vol_spike'] else row['volume_weighted_daily_return'], axis=1)
    
    # Calculate Intraday High-Low Spread
    df['intraday_spread'] = df['high'] - df['low']
    
    # Compute Intraday Range Weighted Average Price (IRWAP)
    df['irwap'] = (df['close'] * df['volume']).rolling(window=1).sum() / df['volume'].rolling(window=1).sum()
    
    # Evaluate IRWAP Difference
    df['irwap_diff'] = df['close'] - df['irwap']
    
    # Calculate Adjusted Volume
    df['adjusted_volume'] = df['volume'] / df['intraday_spread']
    
    # Integrate Volume-Adjusted Log Return
    df['log_return'] = df['close'].pct_change().apply(lambda x: np.log(1 + x))
    df['volume_adjusted_log_return'] = df['log_return'] * df['adjusted_volume']
    
    # Combine Adjusted Volume, Log Return, and Enhanced Price Direction
    df['combined'] = df['volume_adjusted_log_return'] * df['price_direction'] * ((df['high'] - df['close']) > 0).astype(int) * 2 - 1
    
    # Smooth the Combined Adjusted Volume, Log Return, and Enhanced Price Direction
    df['smoothed_combined'] = df['combined'].rolling(window=5).mean()
    
    # Compare Latest Volume to M-day Average
    M = 10
    df['average_volume'] = df['volume'].rolling(window=M).mean()
    df['volume_score'] = (df['volume'] > df['average_volume']).astype(int) * 2 - 1
    
    # Compare Latest Amount to K-day Average
    K = 10
    df['average_amount'] = df['amount'].rolling(window=K).mean()
    df['amount_score'] = (df['amount'] > df['average_amount']).astype(int) * 2 - 1
    
    # Calculate Price Momentum
    df['n_day_return'] = df['close'].pct_change(periods=N)
    
    # Calculate Long-Term (LMA) and Short-Term (SMA) Moving Averages
    LMA = 200
    SMA = 50
    df['lma'] = df['close'].rolling(window=LMA).mean()
    df['sma'] = df['close'].rolling(window=SMA).mean()
    
    # Calculate Volume-Weighted Difference Between LMA and SMA
    df['lma_sma_diff'] = (df['lma'] - df['sma']) * df['volume']
    df['volume_weighted_lma_sma_diff'] = df['lma_sma_diff'].rolling(window=10).mean()
    
    # Final Alpha Factor
    alpha_factor = df['smoothed_combined'] + df['volume_score'] + df['amount_score'] + df['n_day_return'] + df['volume_weighted_lma_sma_diff']
    
    return alpha_factor
```
