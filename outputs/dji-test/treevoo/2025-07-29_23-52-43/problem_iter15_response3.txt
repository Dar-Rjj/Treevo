```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Intraday Return
    intraday_return = df['close'] / df['open'] - 1

    # Volume Spike Detection
    daily_volume_change = df['volume'].pct_change()
    spike_threshold = (daily_volume_change.rolling(window=21).quantile(0.75) * 1.5).shift(1)
    volume_spike = (daily_volume_change > spike_threshold).astype(int)

    # Volume Increase Ratio
    volume_increase_ratio = df['volume'] / df['volume'].shift(1)

    # Close Price Momentum
    close_momentum = df['close'] - df['close'].rolling(window=5).mean().shift(1)

    # Price Range
    price_range = df['high'] - df['low']

    # Intermediate Factor
    intermediate_factor = (volume_increase_ratio * close_momentum) / price_range

    # Moving Average of High-Low Differences (10-day period)
    avg_high_low_diff = price_range.rolling(window=10).mean()

    # Trend Strength
    trend_strength = price_range.rolling(window=21).max() - price_range.rolling(window=21).min()

    # Final Composite Factor
    final_factor = (intermediate_factor + avg_high_low_diff + trend_strength).dropna()

    return final_factor
```
