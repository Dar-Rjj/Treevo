```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Breakout Intensity
    df['Breakout_Intensity'] = (df['high'] - df['low']) / df['close']
    df['Breakout_Intensity'] = df['Breakout_Intensity'].apply(lambda x: max(x, 0))
    
    # Weight by Volume
    df['Volume_Weighted_Breakout_Intensity'] = df['volume'] * df['Breakout_Intensity']
    
    # Calculate Daily Log Return
    df['Log_Return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Aggregate Cumulative Log Return over the past 20 days
    df['Cumulative_Log_Return'] = df['Log_Return'].rolling(window=20).sum() - df['Log_Return']
    
    # Identify Volume Shock
    df['Volume_Change'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    df['Volume_Shock'] = df['Volume_Change'].apply(lambda x: 1 if x > 1.5 else 0)
    
    # Combine Volume-Weighted Breakout Intensity and Cumulative Log Return with Volume Shock
    df['Factor'] = df['Cumulative_Log_Return'] * df['Volume_Shock'] + df['Volume_Weighted_Breakout_Intensity']
    
    return df['Factor']
```
