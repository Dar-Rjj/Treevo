```txt
Synthesize Momentum, Volume-Weighted and Trend Adjusted Analysis with Comprehensive Volatility and Efficiency Considerations
├── Intraday Return
│   ├── Close Price
│   └── Open Price
├── Volume Spike Detection
│   ├── Daily Volume Change
│   │   ├── Current Day Volume
│   │   └── Previous Day Volume
│   ├── Spike Threshold
│   │   ├── 90th Percentile (Past 21 Days' Volume Changes)
│   │   └── Multiplier (e.g., 2.0)
│   └── Apply Spike Condition
├── Volume Increase Ratio
│   └── (Volume_t / Volume_t-1)
├── Close Price Momentum
│   └── (Close_t - Avg(Close_t-5...t-1))
├── Intermediate Factor
│   └── ((Volume_t / Volume_t-1) * (Close_t - Avg(Close_t-5...t-1)))
├── Price Range
│   └── (High_t - Low_t)
├── Final Composite Factor
│   ├── Intermediate Factor
│   └── Price Range
├── Calculate Daily High-Low Range Percentage
│   └── Compute (High - Low) / Open
├── Confirm Momentum with Volume-Weighted Difference
│   ├── Calculate Volume-Weighted Intraday Momentum
│   │   └── Compute (Close - Open) * (Volume / Max(Volume))
│   ├── Intraday High-Low Spread
│   │   └── Use High price - Low price
│   ├── Combine Intraday High-Low Range and Volume-Weighted Intraday Momentum
│   │   └── Multiply Daily High-Low Range Percentage by Volume-Weighted Intraday Momentum
│   ├── Calculate Momentum Difference
│   │   └── Intraday High-Low Spread - Previous Day's High-Low Spread
│   ├── Calculate VWAP Difference
│   │   ├── Daily VWAP
│   │   │   └── Sum of (Close * Volume) for the day / Total Volume for the day
│   │   ├── Previous Day's VWAP
│   │   │   └── Sum of (Close * Volume) for the previous day / Total Volume for the previous day
│   │   └── Subtract Previous Day's VWAP from Daily VWAP
│   ├── Calculate Open-Close Spread Difference
│   │   └── (Close - Open) - (Previous Day's Close - Previous Day's Open)
│   └── Final Combined Indicator
│       └── Combine Momentum Difference, VWAP Difference, and Open-Close Spread Difference
├── Adjust for Price Trend
│   ├── Calculate Short-Term Price Trend
│   │   └── Average(Close_t, Close_t-1, ..., Close_t-4)
│   ├── Calculate Long-Term Price Trend
│   │   └── Average(Close_t, Close_t-1, ..., Close_t-19)
│   └── Adjust Combined Indicator by Price Trends
│       └── Adjust Combined Indicator based on difference between long-term and short-term trends
├── Adjust for Volatility
│   ├── Calculate Rolling Volatility
│   │   └── Standard Deviation of High-Low Daily Range over a Window
│   └── Divide Combined Indicator by Rolling Volatility
├── Calculate Cumulative Log Return
│   └── Sum of Daily Log Returns over the past 20 days
├── Identify Volume Shock
│   └── Compute (Volume_today - Volume_yesterday) / Volume_yesterday
├── Introduce New Factor: Intraday Price Efficiency
│   ├── Calculate Intraday Efficiency Ratio
│   │   └── (Close - Open) / (High - Low)
│   └── Adjust Combined Indicator by Intraday Efficiency Ratio
│       └── Multiply Combined Indicator by Intraday Efficiency Ratio
└── Combine All Factors
    ├── Combine Cumulative Log Return, Volume Shock, and Adjusted Combined Indicator
    └── Introduce New Factor: Intraday Volume Efficiency
        ├── Calculate Intraday Volume Efficiency
        │   └── (Volume_today - Volume_yesterday) / (High - Low)
        └── Adjust Combined Indicator by Intraday Volume Efficiency
            └── Multiply Combined Indicator by Intraday Volume Efficiency
```
