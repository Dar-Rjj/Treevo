```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily High-Low Difference
    df['high_low_diff'] = df['high'] - df['low']
    
    # Calculate Moving Sum of High-Low Differences (10-day period)
    df['hl_diff_10d_sum'] = df['high_low_diff'].rolling(window=10).sum()
    
    # Divide by Close Price
    df['hl_diff_close_ratio'] = df['hl_diff_10d_sum'] / df['close']
    
    # Calculate Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    
    # Identify Volume Spikes
    df['volume_change'] = df['volume'] - df['volume'].shift(1)
    spike_threshold = df['volume_change'].rolling(window=21).quantile(0.75) * 1.5
    df['is_spike'] = df['volume_change'] > spike_threshold
    
    # Calculate Volume-Weighted Intraday Return
    df['vweighted_intraday_return'] = df['intraday_return'] * df['volume']
    
    # Filter with Spike Condition
    df['vweighted_intraday_return'] = df.apply(lambda row: row['vweighted_intraday_return'] if row['is_spike'] else 0, axis=1)
    
    # Volume Weighted Close Price Momentum
    avg_close_5d = df['close'].rolling(window=5).mean().shift(1)
    avg_volume_5d = df['volume'].rolling(window=5).mean().shift(1)
    df['vweighted_close_momentum'] = (df['close'] - avg_close_5d) * (df['volume'] / avg_volume_5d)
    
    # Price Volatility
    df['price_volatility'] = df['close'].rolling(window=6).std() / df['close'].shift(1)
    
    # Calculate Daily High-Low Range Percentage
    df['hl_range_pct'] = (df['high'] - df['low']) / df['open']
    
    # Confirm Momentum with Volume-Weighted Difference
    df['vweighted_intraday_momentum'] = (df['close'] - df['open']) * (df['volume'] / df['volume'].max())
    df['prev_day_hl_spread'] = (df['high'].shift(1) - df['low'].shift(1))
    df['combined_indicator'] = df['hl_range_pct'] * df['vweighted_intraday_momentum']
    
    # Adjust for Price Trend
    short_term_trend = df['close'].rolling(window=5).mean()
    long_term_trend = df['close'].rolling(window=20).mean()
    trend_difference = long_term_trend - short_term_trend
    df['combined_indicator'] = df.apply(lambda row: row['combined_indicator'] + trend_difference[row.name] if trend_difference[row.name] > 0 else row['combined_indicator'] - trend_difference[row.name], axis=1)
    
    # Volume Increase Ratio
    df['volume_increase_ratio'] = df['volume'] / df['volume'].shift(1)
    
    # Close Price Momentum
    df['close_price_momentum'] = df['close'] - avg_close_5d
    
    # Price Range
    df['price_range'] = df['high'] - df['low']
    
    # Final Alpha Factor
    df['final_factor'] = (df['hl_range_pct'] * df['vweighted_intraday_momentum'] * df['combined_indicator'] + 
                           df['volume_increase_ratio'] * df['close_price_momentum'] / df['price_range'])
    
    return df['final_factor']
```
