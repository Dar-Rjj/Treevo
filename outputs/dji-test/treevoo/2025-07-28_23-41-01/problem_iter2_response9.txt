```python
import pandas as pd

def heuristics_v2(df):
    # Calculate 7-day and 21-day returns using Close price
    df['7_day_return'] = df['close'].pct_change(7)
    df['21_day_return'] = df['close'].pct_change(21)
    
    # Combine returns
    df['price_momentum'] = df['7_day_return'] + df['21_day_return']

    # Calculate 7-day and 21-day average volume
    df['7_day_avg_volume'] = df['volume'].rolling(window=7).mean()
    df['21_day_avg_volume'] = df['volume'].rolling(window=21).mean()
    
    # Combine volume averages
    df['volume_activity'] = df['7_day_avg_volume'] / df['21_day_avg_volume']
    
    # Calculate intraday range
    df['intraday_range'] = df['high'] - df['low']

    # Calculate close position in range
    df['close_position_in_range'] = (df['close'] - df['low']) / df['intraday_range']

    # Calculate daily return
    df['daily_return'] = df['close'].pct_change()

    # Weighted by volume
    df['weighted_daily_return'] = df['volume'] * df['daily_return']

    # Combine price momentum and volume activity
    df['combined_price_vol'] = df['price_momentum'] * df['volume_activity']

    # Combine all factors for the final factor
    df['combined_factor'] = (
        df['close_position_in_range'] 
        + df['weighted_daily_return'] 
        + df['combined_price_vol']
    )

    # Adjust for trend
    df['trend_adjustment'] = df['close'] - df['close'].rolling(window=21).mean()
    
    # Final alpha factor
    df['final_alpha_factor'] = df['combined_factor'] + df['trend_adjustment']

    return df['final_alpha_factor'].dropna()
```
