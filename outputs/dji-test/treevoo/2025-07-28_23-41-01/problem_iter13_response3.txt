```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Range Ratio
    df['daily_high_low_range'] = df['high'] - df['low']
    df['recent_avg_high_low_range'] = (df['daily_high_low_range'].rolling(window=21).sum()) / (df['volume'].rolling(window=21).sum())
    
    # Breakout Strength
    df['breakout_strength'] = df['daily_high_low_range'] / df['recent_avg_high_low_range']
    
    # Volume Weighted Momentum
    df['price_change'] = df['close'].pct_change()
    df['vol_weighted_momentum'] = df['price_change'] * df['volume']
    
    # Combine Breakout Strength and Volume Weighted Momentum
    df['combined_breakout_volmom'] = (df['breakout_strength'] + df['vol_weighted_momentum']) / 2
    
    # Price Momentum
    df['7_day_return'] = df['close'].pct_change(7)
    df['21_day_return'] = df['close'].pct_change(21)
    
    # Volume Activity
    df['7_day_avg_volume'] = df['volume'].rolling(window=7).mean()
    df['21_day_avg_volume'] = df['volume'].rolling(window=21).mean()
    
    # Momentum Indicators
    df['SMA_7'] = df['close'].rolling(window=7).mean()
    df['SMA_21'] = df['close'].rolling(window=21).mean()
    df['EMA_7'] = df['close'].ewm(span=7, adjust=False).mean()
    df['EMA_21'] = df['close'].ewm(span=21, adjust=False).mean()
    df['ROC_7'] = df['close'].pct_change(7)
    
    # Determine Volume Impact
    df['volume_ratio'] = df['volume'] / df['21_day_avg_volume']
    df['weighted_SMA'] = df['SMA_7'] * df['volume_ratio']
    df['weighted_EMA'] = df['EMA_7'] * df['volume_ratio']
    df['weighted_ROC'] = df['ROC_7'] * df['volume_ratio']
    
    # Trend Indicator: DMI and ADX
    df['+DM'] = df['high'].diff().apply(lambda x: x if x > 0 else 0)
    df['-DM'] = -df['low'].diff().apply(lambda x: x if x < 0 else 0)
    df['+DI'] = (df['+DM'].rolling(window=14).sum() / df['daily_high_low_range'].rolling(window=14).sum()) * 100
    df['-DI'] = (df['-DM'].rolling(window=14).sum() / df['daily_high_low_range'].rolling(window=14).sum()) * 100
    df['ADX'] = (abs(df['+DI'] - df['-DI']) / (df['+DI'] + df['-DI'])) * 100
    
    # Final Alpha Factor
    df['alpha_factor'] = (
        df['combined_breakout_volmom'] + 
        df['7_day_return'] + 
        df['21_day_return'] + 
        df['7_day_avg_volume'] + 
        df['21_day_avg_volume'] + 
        df['weighted_SMA'] + 
        df['weighted_EMA'] + 
        df['weighted_ROC'] + 
        df['ADX']
    ) / 9
    
    return df['alpha_factor']
```
