```txt
Integrated and Enhanced Intraday, Breakout, Momentum, and Trend Factors with Volume-Weighted Close-to-Open Return
├── Calculate Intraday Range
│   ├── Subtract Low from High
├── Calculate Close Position in Range
│   ├── Divide (Close - Low) by Intraday Range
├── Calculate Daily Return
│   ├── Subtract and then Divide by Previous Day's Close
├── Weighted Daily Return
│   ├── Multiply by Volume
├── Combine Initial Factors
│   ├── Add Close Position in Range and Weighted Daily Return
├── Calculate Breakout Strength
│   ├── Use Current Day's High-Low Range
│   └── Use Recent Average High-Low Range
│       ├── 21-Day Rolling Sum of High-Low Range
│       └── 21-Day Rolling Sum of Volume
├── Calculate Intraday Reversal Score
│   ├── Subtract Open from Close
│   └── Divide by Intraday Range
│       └── Multiply by Volume
├── Calculate Close-to-Open Return
│   ├── Subtract Open from Close
└── Weight by Volume
    ├── Use Volume
    └── Multiply by Close-to-Open Return
├── Combine Breakout and Intraday Factors
│   ├── Add Combined Initial Factors, Breakout Strength, and Intraday Reversal Score
├── Combine All Factors
│   ├── Add Weighted Close-to-Open Return to Combined Breakout and Intraday Factors
├── Calculate Price Momentum
│   ├── Sum of 7-day and 21-day Returns
├── Determine Volume Impact
│   ├── Divide Volume by mean volume over a period
│   └── Multiply Combined All Factors by Volume Ratio
├── Incorporate Momentum
│   ├── Add Price Momentum to Adjusted Factor
├── Introduce Trend Indicator
│   ├── Compare 50-day MA to 200-day MA
└── Final Alpha Factor
    ├── Combine Breakout Strength, Volume-Weighted Intraday Reversal, and Price Momentum
    ├── Multiply by Volume Activity
    └── Apply Trend Indicator
        ├── If 50-day MA > 200-day MA, use result
        └── If 50-day MA < 200-day MA, use -result
```
