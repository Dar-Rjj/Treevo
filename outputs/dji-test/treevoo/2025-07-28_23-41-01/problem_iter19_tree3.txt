```txt
Integrated and Weighted Intraday, Breakout, and Momentum Factors with Enhanced Trend Indicator
├── Calculate Intraday Range
│   ├── Subtract Low from High
├── Calculate Close Position in Range
│   ├── Divide (Close - Low) by Intraday Range
├── Calculate Daily Return
│   ├── Subtract and then Divide by Previous Day's Close
├── Weighted by Volume
│   ├── Multiply Daily Return by Volume
├── Combine Initial Factors
│   ├── Add Close Position in Range and Weighted Daily Return
├── Calculate Breakout Strength
│   ├── Use Current Day's High-Low Range
│   └── Use Recent Average High-Low Range
│       ├── Calculate 21-Day Rolling Sum of High-Low Range
│       └── Calculate 21-Day Rolling Sum of Volume
├── Calculate Intraday Reversal Score
│   ├── Subtract Open from Close
│   └── Divide Intraday Close-to-Open Delta by Intraday Range
│       └── Multiply by Volume for Weighting
├── Combine Breakout and Intraday Factors
│   ├── Add Combined Initial Factors, Breakout Strength, and Intraday Reversal Score
├── Calculate Price Momentum
│   ├── Compute 7-day Return
│   └── Compute 21-day Return
│   └── Sum of 7-day and 21-day Returns
├── Determine Volume Impact
│   ├── Divide Volume by mean volume over a period
│   └── Multiply Combined Breakout and Intraday Factors by Volume Ratio
├── Incorporate Momentum
│   ├── Add Price Momentum to Adjusted Factor
├── Introduce Trend Indicator
│   ├── Calculate 50-day Moving Average
│   └── Calculate 200-day Moving Average
│   └── Compare 50-day MA to 200-day MA
└── Final Alpha Factor
    ├── Multiply Combined Indicators by Volume Activity
    └── Adjust Result Based on Trend Indicator
        ├── If 50-day MA > 200-day MA, use result
        └── If 50-day MA < 200-day MA, use -result
```
