```txt
Integrated and Enhanced Intraday, Breakout, Momentum, and Trend Factors with Volume-Weighted Close-to-Open Return
├── Calculate Intraday Range
│   ├── High - Low
├── Calculate Close Position in Range
│   ├── (Close - Low) / (High - Low)
├── Calculate Daily Return
│   ├── (Close - Previous Day's Close) / Previous Day's Close
├── Weighted Daily Return
│   ├── Daily Return * Volume
├── Combine Initial Factors
│   ├── Close Position in Range + Weighted Daily Return
├── Calculate Breakout Strength
│   ├── Current Day's High-Low Range / 21-Day Rolling Sum of High-Low Range
├── Calculate Intraday Reversal Score
│   ├── (Close - Open) / (High - Low) * Volume
├── Combine Breakout and Intraday Factors
│   ├── Combined Initial Factors + Breakout Strength + Intraday Reversal Score
├── Calculate Price Momentum
│   ├── 7-day Return + 21-day Return
├── Determine Volume Impact
│   ├── Volume / mean volume over a period
├── Incorporate Momentum
│   ├── Adjusted Factor + Price Momentum
├── Calculate Volume Activity
│   ├── 7-day Average Volume / 21-day Average Volume
├── Introduce Trend Indicator
│   ├── 50-day Moving Average > 200-day Moving Average
├── Calculate Close-to-Open Return
│   ├── (Close - Open) / Open
└── Final Alpha Factor
    ├── (Combined Breakout and Intraday Factors + Price Momentum) * Volume Activity
    ├── Multiply by Volume
    ├── Weight by Close-to-Open Return
    └── Adjust Result Based on Trend Indicator
        ├── If 50-day MA > 200-day MA, use result
        └── If 50-day MA < 200-day MA, use -result
```
