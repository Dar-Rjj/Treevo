```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate High-Low Range Ratio
    df['High_Low_Range'] = df['high'] - df['low']
    df['Avg_High_Low_Range'] = (df['High_Low_Range'].rolling(window=21).sum() / 
                                df['volume'].rolling(window=21).sum())
    
    # Breakout Strength
    df['Breakout_Strength'] = df['High_Low_Range'] / df['Avg_High_Low_Range']
    
    # Volume Weighted Momentum
    df['Price_Change'] = df['close'].pct_change()
    df['Volume_Weighted_Momentum'] = df['Price_Change'] * df['volume']
    
    # Combine Breakout Strength and Volume Weighted Momentum
    df['Combined_Breakout_VolMomentum'] = (df['Breakout_Strength'] + 
                                           df['Volume_Weighted_Momentum'])
    
    # Price Momentum
    df['7_day_Return'] = df['close'].pct_change(7)
    df['21_day_Return'] = df['close'].pct_change(21)
    df['Price_Momentum'] = df['7_day_Return'] + df['21_day_Return']
    
    # Volume Activity
    df['7_day_Avg_Volume'] = df['volume'].rolling(window=7).mean()
    df['21_day_Avg_Volume'] = df['volume'].rolling(window=21).mean()
    df['Volume_Activity'] = df['7_day_Avg_Volume'] / df['21_day_Avg_Volume']
    
    # Momentum Indicators
    df['SMA_7'] = df['close'].rolling(window=7).mean()
    df['SMA_21'] = df['close'].rolling(window=21).mean()
    df['EMA_7'] = df['close'].ewm(span=7, adjust=False).mean()
    df['EMA_21'] = df['close'].ewm(span=21, adjust=False).mean()
    df['ROC'] = df['close'].pct_change()
    
    # Determine Volume Impact
    df['Volume_Ratio'] = df['7_day_Avg_Volume'] / df['21_day_Avg_Volume']
    df['Weighted_SMA'] = df['SMA_7'] * df['Volume_Ratio']
    df['Weighted_EMA'] = df['EMA_7'] * df['Volume_Ratio']
    df['Weighted_ROC'] = df['ROC'] * df['Volume_Ratio']
    
    # Trend Indicator
    df['+DI'] = 100 * (df['high'] - df['high'].shift(1)).rolling(window=14).sum() / df['Avg_High_Low_Range']
    df['-DI'] = 100 * (df['low'].shift(1) - df['low']).rolling(window=14).sum() / df['Avg_High_Low_Range']
    df['ADX'] = 100 * (abs(df['+DI'] - df['-DI']) / (df['+DI'] + df['-DI'])).rolling(window=14).mean()
    
    # Volatility Indicator
    df['21_day_STD'] = df['close'].rolling(window=21).std()
    df['Bollinger_Upper'] = df['SMA_21'] + 2 * df['21_day_STD']
    df['Bollinger_Lower'] = df['SMA_21'] - 2 * df['21_day_STD']
    
    # Final Alpha Factor
    df['Final_Alpha_Factor'] = (df['Combined_Breakout_VolMomentum'] + 
                                df['Price_Momentum'] + 
                                df['Volume_Activity'] + 
                                df['Weighted_SMA'] + 
                                df['Weighted_EMA'] + 
                                df['Weighted_ROC'] + 
                                df['ADX'] + 
                                df['21_day_STD'])
    
    return df['Final_Alpha_Factor']
```
