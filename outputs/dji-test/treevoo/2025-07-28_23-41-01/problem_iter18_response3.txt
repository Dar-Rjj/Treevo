```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Range Ratio
    daily_range = df['high'] - df['low']
    recent_avg_range = (df['high'].rolling(window=21).sum() - df['low'].rolling(window=21).sum()) / 21
    range_ratio = daily_range / recent_avg_range

    # Breakout Strength
    breakout_strength = daily_range / recent_avg_range

    # Volume Weighted Momentum
    price_change = df['close'].diff()
    volume_weighted_momentum = price_change * df['volume']

    # Combine Breakout Strength and Volume Weighted Momentum
    combined_breakout_momentum = (breakout_strength + volume_weighted_momentum) / 2

    # Price Momentum
    seven_day_return = df['close'].pct_change(7)
    twenty_one_day_return = df['close'].pct_change(21)

    # Volume Activity
    seven_day_avg_volume = df['volume'].rolling(window=7).mean()
    twenty_one_day_avg_volume = df['volume'].rolling(window=21).mean()

    # Momentum Indicators
    sma_50 = df['close'].rolling(window=50).mean()
    sma_200 = df['close'].rolling(window=200).mean()
    ema_50 = df['close'].ewm(span=50, adjust=False).mean()
    ema_200 = df['close'].ewm(span=200, adjust=False).mean()
    roc_21 = df['close'].pct_change(21)

    # Determine Volume Impact
    volume_ratio = df['volume'] / df['volume'].rolling(window=21).mean()
    weighted_sma = sma_50 * volume_ratio
    weighted_ema = ema_50 * volume_ratio
    weighted_roc = roc_21 * volume_ratio

    # Trend Indicator (DMI and ADX)
    dmi_period = 14
    plus_di = 100 * (df['high'] - df['high'].shift(1)).rolling(window=dmi_period).sum() / (df['high'] - df['low']).rolling(window=dmi_period).sum()
    minus_di = 100 * (df['low'].shift(1) - df['low']).rolling(window=dmi_period).sum() / (df['high'] - df['low']).rolling(window=dmi_period).sum()
    adx = 100 * (abs(plus_di - minus_di) / (plus_di + minus_di)).rolling(window=dmi_period).mean()

    # Market Sentiment Factor
    five_day_open_close_diff = (df['open'] - df['close']).rolling(window=5).mean()
    twenty_day_open_close_diff = (df['open'] - df['close']).rolling(window=20).mean()

    # Volatility Factor
    twenty_one_day_std = df['close'].pct_change().rolling(window=21).std()
    sixty_three_day_std = df['close'].pct_change().rolling(window=63).std()

    # Final Alpha Factor
    alpha_factor = (
        combined_breakout_momentum +
        (seven_day_return + twenty_one_day_return) / 2 +
        (weighted_sma + weighted_ema + weighted_roc) / 3 +
        adx +
        (five_day_open_close_diff + twenty_day_open_close_diff) / 2 -
        (twenty_one_day_std + sixty_three_day_std) / 2
    )

    return alpha_factor
```
