```python
import pandas as pd

def heuristics_v2(df):
    # Calculate High-Low Range Ratio
    df['daily_high_low_range'] = df['high'] - df['low']
    df['recent_avg_high_low_range'] = (df['daily_high_low_range'].rolling(window=21).sum() 
                                       / df['volume'].rolling(window=21).sum())
    
    # Breakout Strength
    df['breakout_strength'] = df['daily_high_low_range'] / df['recent_avg_high_low_range']

    # Volume Weighted Momentum
    df['price_change'] = df['close'].pct_change()
    df['volume_weighted_momentum'] = df['price_change'] * df['volume']

    # Combine Breakout Strength and Volume Weighted Momentum
    df['combined_breakout_volume_momentum'] = df['breakout_strength'] + df['volume_weighted_momentum']

    # Price Momentum
    df['7_day_return'] = df['close'].pct_change(7)
    df['21_day_return'] = df['close'].pct_change(21)

    # Volume Activity
    df['7_day_avg_volume'] = df['volume'].rolling(window=7).mean()
    df['21_day_avg_volume'] = df['volume'].rolling(window=21).mean()

    # Simple Moving Average (SMA) and Exponential Moving Average (EMA)
    df['sma_10'] = df['close'].rolling(window=10).mean()
    df['ema_10'] = df['close'].ewm(span=10, adjust=False).mean()
    df['sma_20'] = df['close'].rolling(window=20).mean()
    df['ema_20'] = df['close'].ewm(span=20, adjust=False).mean()

    # Rate of Change (ROC)
    df['roc_10'] = df['close'].pct_change(10)
    df['roc_20'] = df['close'].pct_change(20)

    # Volume Ratio
    df['volume_ratio'] = df['volume'] / df['volume'].rolling(window=21).mean()

    # Weighted Indicators
    df['weighted_sma_10'] = df['sma_10'] * df['volume_ratio']
    df['weighted_ema_10'] = df['ema_10'] * df['volume_ratio']
    df['weighted_roc_10'] = df['roc_10'] * df['volume_ratio']

    # Directional Movement Index (DMI)
    df['positive_dm'] = df['high'].diff().apply(lambda x: max(x, 0))
    df['negative_dm'] = -df['low'].diff().apply(lambda x: min(x, 0))
    df['+di'] = 100 * (df['positive_dm'].rolling(window=14).sum()) / (df['daily_high_low_range'].rolling(window=14).sum())
    df['-di'] = 100 * (df['negative_dm'].rolling(window=14).sum()) / (df['daily_high_low_range'].rolling(window=14).sum())

    # Average Directional Index (ADX)
    df['dx'] = 100 * (df['+di'] - df['-di']) / (df['+di'] + df['-di'])
    df['adx'] = df['dx'].rolling(window=14).mean()

    # Market Sentiment Factor
    df['5_day_avg_open_close_diff'] = (df['open'] - df['close']).rolling(window=5).mean()
    df['20_day_avg_open_close_diff'] = (df['open'] - df['close']).rolling(window=20).mean()

    # Final Alpha Factor
    df['alpha_factor'] = (df['combined_breakout_volume_momentum'] 
                          + df['7_day_return'] + df['21_day_return'] 
                          + df['weighted_sma_10'] + df['weighted_ema_10'] + df['weighted_roc_10'] 
                          + df['adx'] 
                          + df['5_day_avg_open_close_diff'] + df['20_day_avg_open_close_diff'])

    return df['alpha_factor']
```
