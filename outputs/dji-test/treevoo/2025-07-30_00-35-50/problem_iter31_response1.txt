```python
import pandas as pd

def heuristics_v2(df, n=20):
    # Calculate Price Momentum
    df['price_momentum_diff'] = df['close'] - df['close'].shift(n)
    df['price_momentum_pct'] = df['close'].pct_change(periods=n)

    # Calculate Volume Momentum
    df['volume_momentum_diff'] = df['volume'] - df['volume'].shift(n)
    df['volume_momentum_pct'] = df['volume'].pct_change(periods=n)

    # Combine Price and Volume Momentum
    weight_price = 0.7
    weight_volume = 0.3
    df['combined_momentum'] = (weight_price * df['price_momentum_pct']) + (weight_volume * df['volume_momentum_pct'])

    # Smooth out the combined momentum with a Simple Moving Average (SMA)
    df['combined_momentum_sma'] = df['combined_momentum'].rolling(window=n).mean()

    # Identify Trend Reversals
    df['price_trend_reversal'] = (df['price_momentum_pct'] > 0) != (df['price_momentum_pct'].shift(1) > 0)
    df['volume_trend_reversal'] = (df['volume_momentum_pct'] > 0) != (df['volume_momentum_pct'].shift(1) > 0)

    # Evaluate Momentum Consistency
    df['consecutive_positive_momentum'] = df['combined_momentum'].gt(0).astype(int).groupby((df['combined_momentum'] <= 0).cumsum()).cumsum()
    df['consecutive_negative_momentum'] = df['combined_momentum'].lt(0).astype(int).groupby((df['combined_momentum'] >= 0).cumsum()).cumsum()

    # Create the final alpha factor
    df['alpha_factor'] = df['combined_momentum_sma'] * (df['consecutive_positive_momentum'] - df['consecutive_negative_momentum'])

    return df['alpha_factor']
```
