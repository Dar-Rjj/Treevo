```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=20):
    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Weight by Volume
    df['volume_weighted_log_return'] = df['volume'] * df['log_return']
    
    # Moving Average of Volume-Weighted Log Returns
    df['sum_volume_weighted_log_return'] = df['volume_weighted_log_return'].rolling(window=N).sum()
    df['sum_volume'] = df['volume'].rolling(window=N).sum()
    df['moving_average'] = df['sum_volume_weighted_log_return'] / df['sum_volume']
    
    # Volatility Component
    df['volatility'] = df['volume_weighted_log_return'].rolling(window=M).std()
    df['adjusted_volatility'] = df['moving_average'] - df['volatility']
    
    # Identify Positive and Negative Returns
    positive_return_days = df['log_return'] > 0
    negative_return_days = df['log_return'] <= 0
    
    # Calculate Sum of Upward Volume and Downward Volume
    df['upward_volume'] = df['volume'] * positive_return_days
    df['downward_volume'] = df['volume'] * negative_return_days
    df['sum_upward_volume'] = df['upward_volume'].rolling(window=N).sum()
    df['sum_downward_volume'] = df['downward_volume'].rolling(window=N).sum()
    df['total_volume'] = df['sum_upward_volume'] + df['sum_downward_volume']
    
    # Compute Trend Reversal Signal
    df['upward_volume_ratio'] = df['sum_upward_volume'] / df['total_volume']
    df['downward_volume_ratio'] = df['sum_downward_volume'] / df['total_volume']
    df['reversal_signal'] = (df['upward_volume_ratio'] > df['downward_volume_ratio']).astype(int) * df['log_return']
    
    # Combine Components
    df['factor'] = df['moving_average'] - df['adjusted_volatility'] * df['reversal_signal']
    
    return df['factor']
```
