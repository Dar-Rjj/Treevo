```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate the 20-day Simple Moving Average (SMA)
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate the 14-day Relative Strength Index (RSI)
    delta = df['close'].diff(1)
    gain = delta.where(delta > 0, 0)
    loss = -delta.where(delta < 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['RSI_14'] = 100 - (100 / (1 + rs))
    
    # Calculate the 20-day Standard Deviation of daily returns
    daily_returns = df['close'].pct_change()
    df['STD_20'] = daily_returns.rolling(window=20).std()
    
    # Calculate the 10-day average volume and its percentage change
    df['avg_vol_10'] = df['volume'].rolling(window=10).mean()
    df['vol_change'] = df['avg_vol_10'].pct_change()
    
    # Calculate the 14-day Average True Range (ATR)
    tr = df[['high', 'low']].sub(df['close'].shift(1), axis=0).abs().max(axis=1)
    df['ATR_14'] = tr.rolling(window=14).mean()
    df['normalized_ATR'] = df['ATR_14'] / df['SMA_20']
    
    # Calculate the 5-day smoothed open-to-close percentage change
    df['open_close_pct'] = (df['close'] - df['open']) / df['open']
    df['smoothed_open_close'] = df['open_close_pct'].rolling(window=5).mean()
    
    # Create the composite alpha factor
    df['z_SMA_20'] = (df['SMA_20'] - df['SMA_20'].rolling(window=20).mean()) / df['SMA_20'].rolling(window=20).std()
    df['z_RSI_14'] = (df['RSI_14'] - df['RSI_14'].rolling(window=20).mean()) / df['RSI_14'].rolling(window=20).std()
    df['z_STD_20'] = (df['STD_20'] - df['STD_20'].rolling(window=20).mean()) / df['STD_20'].rolling(window=20).std()
    df['z_vol_change'] = (df['vol_change'] - df['vol_change'].rolling(window=20).mean()) / df['vol_change'].rolling(window=20).std()
    
    df['composite_alpha'] = df['z_SMA_20'] + df['z_RSI_14'] + df['z_STD_20'] + df['z_vol_change']
    
    # Add the ATR-based and intraday momentum factors
    df['intraday_momentum_ATR'] = df['smoothed_open_close'] * df['normalized_ATR']
    df['final_alpha'] = df['composite_alpha'] + df['intraday_momentum_ATR']
    
    return df['final_alpha']
```
