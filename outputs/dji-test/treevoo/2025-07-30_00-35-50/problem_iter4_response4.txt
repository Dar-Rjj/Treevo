```python
import pandas as pd
import numpy as np

def heuristics_v2(df, N=20, M=20):
    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    
    # Weight by Volume
    df['volume_weighted_log_return'] = df['log_return'] * df['volume']
    
    # Moving Average of Volume-Weighted Log Returns
    sum_volume_weighted_returns = df['volume_weighted_log_return'].rolling(window=N).sum()
    sum_volumes = df['volume'].rolling(window=N).sum()
    df['moving_average'] = sum_volume_weighted_returns / sum_volumes
    
    # Volatility Component
    df['volatility'] = df['volume_weighted_log_return'].rolling(window=M).std()
    
    # Combine Momentum and Volatility
    df['alpha_factor'] = df['moving_average'] - df['volatility']
    
    return df['alpha_factor']

# Example usage:
# df = pd.DataFrame({
#     'open': [100, 101, 102, 103, 104],
#     'high': [105, 106, 107, 108, 109],
#     'low': [95, 96, 97, 98, 99],
#     'close': [102, 103, 104, 105, 106],
#     'volume': [1000, 1500, 2000, 2500, 3000]
# })
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
