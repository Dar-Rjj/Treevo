```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Compute the 5-day and 20-day moving averages of close prices
    df['5_day_ma'] = df['close'].rolling(window=5).mean()
    df['20_day_ma'] = df['close'].rolling(window=20).mean()
    
    # Subtract the 5-day moving average from the 20-day moving average
    df['momentum_diff'] = df['20_day_ma'] - df['5_day_ma']
    
    # Calculate the ratio of today's close price to the 10-day average close price
    df['10_day_avg_close'] = df['close'].rolling(window=10).mean()
    df['recent_price_strength'] = df['close'] / df['10_day_avg_close']
    
    # Calculate the standard deviation of log returns over a 10-day period
    df['log_returns'] = np.log(df['close'] / df['close'].shift(1))
    df['volatility'] = df['log_returns'].rolling(window=10).std()
    
    # Evaluate the daily value based on volume and closing position
    df['money_flow_multiplier'] = (df['close'] - df['low']) - (df['high'] - df['close']) / (df['high'] - df['low'])
    df['money_flow_volume'] = df['money_flow_multiplier'] * df['volume']
    df['accumulation_distribution'] = df['money_flow_volume'].rolling(window=30).sum()
    
    # Combine factors into a composite signal
    df['composite_signal'] = (df['momentum_diff'] + 
                             df['recent_price_strength'] - 
                             df['volatility'] + 
                             df['accumulation_distribution'])
    
    # Return the composite signal as the alpha factor
    return df['composite_signal']

# Example usage
# df = pd.DataFrame(...)  # Load your data into a DataFrame
# alpha_factor = heuristics_v2(df)
# print(alpha_factor)
```
