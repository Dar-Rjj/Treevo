```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate Daily Log Return
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Identify Positive and Negative Returns
    positive_returns = df[df['log_return'] > 0]
    negative_returns = df[df['log_return'] <= 0]
    
    # Calculate Sum of Upward Volume
    upward_volume = (positive_returns['volume']).fillna(0)
    total_upward_volume = upward_volume.rolling(window=len(df), min_periods=1).sum()
    
    # Calculate Sum of Downward Volume
    downward_volume = (negative_returns['volume']).fillna(0)
    total_downward_volume = downward_volume.rolling(window=len(df), min_periods=1).sum()
    
    # Compute Total Volume
    total_volume = total_upward_volume + total_downward_volume
    
    # Compute Trend Reversal Signal
    upward_volume_ratio = total_upward_volume / total_volume
    downward_volume_ratio = total_downward_volume / total_volume
    
    reversal_signal = (upward_volume_ratio > downward_volume_ratio).astype(int)
    
    # Generate the final factor
    factor = reversal_signal * df['log_return']
    
    return factor
```
