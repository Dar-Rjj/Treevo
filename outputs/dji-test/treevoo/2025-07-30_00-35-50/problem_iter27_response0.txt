```python
import pandas as pd
import numpy as np

def heuristics_v2(df):
    # Calculate daily returns
    df['daily_return'] = df['close'].pct_change()
    df['log_return'] = np.log(df['close']) - np.log(df['close'].shift(1))
    
    # Volume change percentage
    df['volume_change'] = df['volume'].pct_change()
    
    # Volume surprise factor
    df['avg_volume_20'] = df['volume'].rolling(window=20).mean().shift(1)
    df['volume_surprise'] = df['volume'] - df['avg_volume_20']
    
    # True range and Average true range
    df['high_low'] = df['high'] - df['low']
    df['high_close_prev'] = abs(df['high'] - df['close'].shift(1))
    df['low_close_prev'] = abs(df['low'] - df['close'].shift(1))
    df['true_range'] = df[['high_low', 'high_close_prev', 'low_close_prev']].max(axis=1)
    df['atr_14'] = df['true_range'].rolling(window=14).mean()
    
    # Accumulation/Distribution (ADL) line
    df['adl'] = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low']) * df['volume']
    df['adl'] = df['adl'].cumsum()
    
    # Money Flow Index (MFI)
    df['typical_price'] = (df['high'] + df['low'] + df['close']) / 3
    df['raw_money_flow'] = df['typical_price'] * df['volume']
    df['positive_money_flow'] = df['raw_money_flow'].where(df['typical_price'] > df['typical_price'].shift(1), 0)
    df['negative_money_flow'] = df['raw_money_flow'].where(df['typical_price'] < df['typical_price'].shift(1), 0)
    df['pos_money_flow_14'] = df['positive_money_flow'].rolling(window=14).sum()
    df['neg_money_flow_14'] = df['negative_money_flow'].rolling(window=14).sum()
    df['mfi'] = 100 - (100 / (1 + df['pos_money_flow_14'] / df['neg_money_flow_14']))
    
    # Rate of Change (ROC) for Close prices
    df['roc_25'] = df['close'].pct_change(periods=25)
    
    # On-balance Volume (OBV)
    df['obv'] = 0.0
    df.loc[df['close'] > df['close'].shift(1), 'obv'] = df['obv'].shift(1) + df['volume']
    df.loc[df['close'] < df['close'].shift(1), 'obv'] = df['obv'].shift(1) - df['volume']
    df.loc[df['close'] == df['close'].shift(1), 'obv'] = df['obv'].shift(1)
    df['obv'] = df['obv'].fillna(0).cumsum()
    
    # Daily traded amount change
    df['amount_change'] = df['amount'].pct_change()
    
    # Ratio of traded amount to volume
    df['amount_volume_ratio'] = df['amount'] / df['volume']
    
    # Historical Volatility
    df['hist_volatility_20'] = df['log_return'].rolling(window=20).std() * np.sqrt(252)
    
    # Combine all factors into a single alpha factor
    df['alpha_factor'] = (
        df['daily_return'] + 
        df['log_return'] +
        df['volume_change'] +
        df['volume_surprise'] +
        df['atr_14'] +
        df['adl'] +
        df['mfi'] +
        df['roc_25'] +
        df['obv'] +
        df['amount_change'] +
        df['amount_volume_ratio'] +
        df['hist_volatility_20']
    )
    
    return df['alpha_factor']
```
