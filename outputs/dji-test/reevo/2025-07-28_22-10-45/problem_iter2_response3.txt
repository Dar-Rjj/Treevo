```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between closing price and average of high and low
    avg_high_low = (df['high'] + df['low']) / 2
    close_to_avg = df['close'] - avg_high_low
    
    # Volume change compared to the previous day, use .shift(1) for lag
    volume_change = (df['volume'] - df['volume'].shift(1)) / (df['volume'].shift(1) + 1e-7)
    
    # Momentum: calculate the 5-day and 20-day moving averages of the closing price
    ma_5d = df['close'].rolling(window=5).mean()
    ma_20d = df['close'].rolling(window=20).mean()
    
    # Volatility: calculate the standard deviation of the closing price over the last 20 days
    volatility = df['close'].rolling(window=20).std()
    
    # Market sentiment: ratio of volume to the 5-day moving average of volume
    volume_sentiment = df['volume'] / df['volume'].rolling(window=5).mean()
    
    # Adaptive window: use a dynamic window for the momentum based on the current volatility
    adaptive_window = (volatility * 5).astype(int).clip(lower=5, upper=20)
    adaptive_ma = df['close'].rolling(window=adaptive_window).mean()
    
    # Alpha factor: weighted sum of close to average movement, volume change, momentum, and market sentiment
    alpha_factor = (
        close_to_avg * (1 + volume_change) +
        (ma_5d - ma_20d) * (1 + volume_sentiment) +
        (df['close'] - adaptive_ma) / (volatility + 1e-7)
    )
    
    return alpha_factor
```
