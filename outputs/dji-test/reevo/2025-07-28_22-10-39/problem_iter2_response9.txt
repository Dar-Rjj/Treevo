```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate price range
    price_range = df['high'] - df['low']
    
    # Calculate the body of the candle (difference between close and open)
    body = (df['close'] - df['open']).abs()
    
    # Calculate the shadow size as a ratio to the total range
    upper_shadow = df['high'] - df['close'].where(df['close'] > df['open'], df['open'])
    lower_shadow = df['open'].where(df['close'] < df['open'], df['close']) - df['low']
    shadow_ratio = (upper_shadow + lower_shadow) / (price_range + 1e-7)
    
    # Incorporate volume into the factor
    volume_factor = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Calculate the factor
    factor = (body / (price_range + 1e-7)) * (shadow_ratio + 1) * volume_factor
    
    # Apply a simple moving average for smoothing
    smoothed_factor = factor.rolling(window=5).mean()

    return smoothed_factor
```
