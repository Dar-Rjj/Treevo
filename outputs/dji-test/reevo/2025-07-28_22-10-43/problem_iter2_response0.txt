```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between high and low, this is a measure of volatility
    volatility = df['high'] - df['low']
    
    # Calculate the change in closing price from one day to the next, this gives us the momentum
    df['close_lag_1'] = df['close'].shift(1)
    momentum_1d = df['close'] - df['close_lag_1']
    
    # Calculate the 5-day momentum
    df['close_lag_5'] = df['close'].shift(5)
    momentum_5d = df['close'] - df['close_lag_5']
    
    # Calculate the 20-day moving average of the close price
    df['ma_20'] = df['close'].rolling(window=20).mean()
    
    # Calculate the 50-day moving average of the close price
    df['ma_50'] = df['close'].rolling(window=50).mean()
    
    # Calculate the trend factor, which is the 20-day MA minus the 50-day MA
    trend_factor = df['ma_20'] - df['ma_50']
    
    # Create a factor that combines 1-day momentum, 5-day momentum, and trend factor, 
    # while also considering the volatility.
    factor = (momentum_1d + momentum_5d + trend_factor) / (volatility + 1e-7)
    
    return factor
```
