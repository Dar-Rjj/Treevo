```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 5-day momentum by comparing the current close to the close 5 days ago
    df['close_lag_5d'] = df['close'].shift(5)
    momentum_5d = df['close'] - df['close_lag_5d']
    
    # Calculate the 10-day relative strength as the ratio of the 10-day cumulative return to the absolute value of the 10-day cumulative return
    df['close_lag_10d'] = df['close'].shift(10)
    rel_strength_10d = (df['close'] / df['close_lag_10d']) / ((df['close'] / df['close_lag_10d']).abs())
    
    # Calculate the adjusted volatility as the standard deviation of the last 20 days' log returns
    df['log_return'] = np.log(df['close'] / df['close'].shift(1))
    adj_volatility_20d = df['log_return'].rolling(window=20).std()
    
    # Calculate the liquidity factor as the average volume over the last 30 days
    avg_volume_30d = df['volume'].rolling(window=30).mean()
    
    # Combine the factors with weights to form the final factor
    # The idea is to favor stocks with strong 5-day momentum, high relative strength, low volatility, and high liquidity.
    factor = (momentum_5d * 0.4) + (rel_strength_10d * 0.3) + (1 / (adj_volatility_20d + 1e-7) * 0.2) + (avg_volume_30d * 0.1)
    
    return factor
```
