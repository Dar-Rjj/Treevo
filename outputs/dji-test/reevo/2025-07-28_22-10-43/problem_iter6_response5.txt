```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 10-day and 30-day moving averages of the close price
    df['close_ma_10'] = df['close'].rolling(window=10).mean()
    df['close_ma_30'] = df['close'].rolling(window=30).mean()
    
    # Calculate the 50-day and 200-day moving averages for longer-term context
    df['close_ma_50'] = df['close'].rolling(window=50).mean()
    df['close_ma_200'] = df['close'].rolling(window=200).mean()
    
    # Calculate the relative strength (momentum) of the close price over 14 days
    df['rsi_14'] = 100 - (100 / (1 + (df['close'].diff(1).clip(lower=0).rolling(window=14).mean() / 
                                    -df['close'].diff(1).clip(upper=0).rolling(window=14).mean())))
    
    # Calculate the 14-day ATR (Average True Range) for volatility
    df['tr'] = df[['high', 'low', 'close']].apply(lambda x: max(x) - min(x), axis=1)
    df['atr_14'] = df['tr'].rolling(window=14).mean()
    
    # Calculate the volume relative to its 5-period moving average
    df['volume_ma_5'] = df['volume'].rolling(window=5).mean()
    df['volume_relative'] = df['volume'] / (df['volume_ma_5'] + 1e-7)
    
    # Calculate the 14-day Money Flow Index (MFI) for money flow
    typical_price = (df['high'] + df['low'] + df['close']) / 3
    raw_money_flow = typical_price * df['volume']
    positive_money_flow = raw_money_flow.where(typical_price > typical_price.shift(1), 0)
    negative_money_flow = raw_money_flow.where(typical_price < typical_price.shift(1), 0)
    positive_money_flow_sum = positive_money_flow.rolling(window=14).sum()
    negative_money_flow_sum = negative_money_flow.rolling(window=14).sum()
    df['mfi_14'] = 100 - (100 / (1 + (positive_money_flow_sum / (negative_money_flow_sum + 1e-7))))
    
    # Calculate the 14-day Stochastic Oscillator for momentum
    df['lowest_low_14'] = df['low'].rolling(window=14).min()
    df['highest_high_14'] = df['high'].rolling(window=14).max()
    df['stoch_k_14'] = 100 * (df['close'] - df['lowest_low_14']) / (df['highest_high_14'] - df['lowest_low_14'])
    
    # Adaptive weighting based on market conditions
    df['volatility_weight'] = 1 / (df['atr_14'] + 1e-7)
    weight_momentum = 0.4 * (df['volatility_weight'] / df['volatility_weight'].rolling(window=20).mean())
    weight_rsi = 0.3 * (df['volatility_weight'] / df['volatility_weight'].rolling(window=20).mean())
    weight_mfi = 0.2 * (df['volatility_weight'] / df['volatility_weight'].rolling(window=20).mean())
    weight_volume = 0.1 * (df['volatility_weight'] / df['volatility_weight'].rolling(window=20).mean())
    
    # Combine the factors with adaptive weights
    factor = (df['close'] - df['close_ma_10']) * weight_momentum + \
             df['rsi_14'] * weight_rsi + \
             df['mfi_14'] * weight_mfi + \
             df['volume_relative'] * weight_volume
    
    return factor
```
