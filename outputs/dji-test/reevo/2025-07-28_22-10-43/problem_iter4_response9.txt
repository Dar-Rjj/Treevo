```python
import pandas as pd
import numpy as np

def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the difference between high and low, this is a measure of volatility
    volatility = df['high'] - df['low']
    
    # Calculate the change in closing price from one day to the next, this gives us the momentum
    df['close_lag'] = df['close'].shift(1)
    momentum = df['close'] - df['close_lag']
    
    # Volume adjustment factor: higher volume might indicate stronger trend
    volume_adjustment = df['volume'] / df['volume'].rolling(window=20).mean()
    
    # Create a factor that combines volatility, momentum, and volume adjustment.
    # The idea is stocks with higher momentum tend to keep going up (trend continuation), but 
    # if the stock has high volatility, it might not be a stable trend. Volume adjustment helps to
    # weigh the trend based on the trading volume.
    base_factor = (momentum / (volatility + 1e-7)) * volume_adjustment
    
    # Adaptive window for smoothing the factor
    adaptive_span = np.where(momentum > 0, 5, 15)
    smoothed_factor = base_factor.ewm(span=adaptive_span, adjust=False).mean()
    
    # Integrate market sentiment or macroeconomic indicators
    # For simplicity, we will use the 50-day moving average of the close price as a proxy for market sentiment
    market_sentiment = df['close'].rolling(window=50).mean()
    market_sentiment_adj = df['close'] / market_sentiment
    
    # Combine the smoothed factor with the market sentiment
    final_factor = smoothed_factor * market_sentiment_adj
    
    return final_factor
```
