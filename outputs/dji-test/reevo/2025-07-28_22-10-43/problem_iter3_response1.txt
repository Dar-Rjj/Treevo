```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 10-day and 30-day moving average of the close price
    df['close_ma_10'] = df['close'].rolling(window=10).mean()
    df['close_ma_30'] = df['close'].rolling(window=30).mean()
    
    # Multi-period momentum: calculate the 10-day and 30-day momentum
    df['momentum_10'] = (df['close'] - df['close_ma_10']) / df['close_ma_10']
    df['momentum_30'] = (df['close'] - df['close_ma_30']) / df['close_ma_30']
    
    # Combine the two momentum signals
    df['combined_momentum'] = (df['momentum_10'] + df['momentum_30']) / 2
    
    # ATR-normalized volatility: calculate the 14-day Average True Range (ATR)
    df['true_range'] = df[['high', 'low']].apply(lambda x: max(x['high'], x['low']) - min(x['high'], x['low']), axis=1)
    df['atr'] = df['true_range'].rolling(window=14).mean()
    
    # Normalize the 10-day standard deviation with ATR
    df['volatility'] = df['close'].rolling(window=10).std() / df['atr']
    
    # Volume anomalies: calculate the 5-period and 20-period moving averages of volume
    df['volume_ma_5'] = df['volume'].rolling(window=5).mean()
    df['volume_ma_20'] = df['volume'].rolling(window=20).mean()
    
    # Calculate relative volume surge
    df['volume_relative'] = df['volume'] / (df['volume_ma_20'] + 1e-7)
    
    # Factor combining the multi-period momentum, ATR-normalized volatility, and volume surge
    factor = df['combined_momentum'] * (1 / df['volatility']) * df['volume_relative']
    
    return factor
```
