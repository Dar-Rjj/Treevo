```python
def heuristics_v2(df: pd.DataFrame) -> pd.Series:
    # Calculate the 10-day and 30-day moving average of the close price
    df['close_ma_10'] = df['close'].rolling(window=10).mean()
    df['close_ma_30'] = df['close'].rolling(window=30).mean()
    
    # Calculate the 14-day Relative Strength Index (RSI)
    delta = df['close'].diff(1)
    gain = (delta.where(delta > 0, 0)).rolling(window=14).mean()
    loss = (-delta.where(delta < 0, 0)).rolling(window=14).mean()
    rs = gain / loss
    df['rsi'] = 100 - (100 / (1 + rs))
    
    # Calculate the Average True Range (ATR) for volatility normalization
    df['tr'] = df[['high', 'low']].apply(lambda x: max(x['high'], df['close'].shift(1)) - min(x['low'], df['close'].shift(1)), axis=1)
    df['atr'] = df['tr'].rolling(window=14).mean()
    
    # Calculate the 5-day rolling average of volume
    df['volume_ma_5'] = df['volume'].rolling(window=5).mean()
    df['volume_relative'] = df['volume'] / (df['volume_ma_5'] + 1e-7)
    
    # Factor combining multi-period momentum, ATR-normalized volatility, and volume anomalies
    df['momentum_factor'] = (df['close'] - df['close_ma_30']) / df['atr']
    factor = df['momentum_factor'] * df['rsi'] * df['volume_relative']
    
    return factor
```
