def heuristics_v2(df):
    close_price = df['close']
    gain = (close_price - close_price.shift(1)).apply(lambda x: x if x > 0 else 0)
    loss = (close_price - close_price.shift(1)).apply(lambda x: -x if x < 0 else 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    rsi = 100 - (100 / (1 + rs))
    volume_range_ratio = df['volume'] / (df['high'] - df['low'])
    combined_factor = rsi * volume_range_ratio
    heuristics_matrix = combined_factor.ewm(span=30, adjust=False).mean()
    return heuristics_matrix
