def heuristics_v2(df):
    # Calculate percentage change in closing prices
    pct_change_close = df['close'].pct_change().fillna(0)
    
    # Calculate percentage change in volume
    pct_change_volume = df['volume'].pct_change().fillna(0)
    
    # Calculate the ratio of high to low prices
    high_low_ratio = (df['high'] / df['low']).fillna(1)
    
    # Combine factors into a heuristics matrix using a weighted sum
    heuristics_matrix = 0.4 * pct_change_close + 0.3 * pct_change_volume + 0.3 * (high_low_ratio - 1)
    
    return heuristics_matrix
