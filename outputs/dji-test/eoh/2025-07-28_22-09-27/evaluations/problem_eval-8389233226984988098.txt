def heuristics_v2(df):
    avg_price = (df['high'] + df['low'] + df['close']) / 3
    volume_avg_ratio = df['volume'] / avg_price
    ema_10 = volume_avg_ratio.ewm(span=10, adjust=False).mean()
    sma_50 = volume_avg_ratio.rolling(window=50).mean()
    heuristics_matrix = ema_10 - sma_50
    return heuristics_matrix
