def heuristics_v2(df):
    w_avg_price = (df['volume'] * df['high'] + df['volume'] * df['low'] + df['volume'] * df['close']) / (3 * df['volume'])
    adj_volume = df['volume'] - df['volume'].rolling(window=50).mean()
    volume_w_avg_ratio = w_avg_price / adj_volume
    heuristics_matrix = volume_w_avg_ratio.ewm(span=20, adjust=False).mean()
    return heuristics_matrix
