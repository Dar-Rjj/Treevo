import pandas as pd

def heuristics_v2(df):
    daily_returns = df['close'].pct_change()
    positive_returns = (daily_returns > 0).rolling(window=30).sum()
    negative_returns = (daily_returns < 0).rolling(window=30).sum()
    heuristics_matrix = positive_returns / (negative_returns + 1e-8)  # Small constant to avoid division by zero
    return heuristics_matrix
