def heuristics_v2(df):
    w_avg_price = (0.3 * df['high'] + 0.2 * df['low'] + 0.5 * df['close'])
    volume_w_avg_ratio = df['volume'] / w_avg_price
    heuristics_matrix = volume_w_avg_ratio.ewm(span=50, adjust=False).mean()
    return heuristics_matrix
