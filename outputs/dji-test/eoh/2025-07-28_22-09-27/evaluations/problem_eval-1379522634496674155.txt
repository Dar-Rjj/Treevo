import pandas as pd

def heuristics_v2(df):
    # Calculate the rate of change (ROC) for momentum
    roc = df['close'].pct_change(periods=20)
    
    # Calculate the standard deviation of returns for volatility
    returns = df['close'].pct_change()
    std_dev_volatility = returns.rolling(window=20).std()
    
    # Adjusted liquidity: sum of 90-day volumes
    liquidity = df['volume'].rolling(window=90).sum()
    
    # Heuristics matrix with new factors and weights
    heuristics_matrix = 0.5 * roc + 0.3 * std_dev_volatility + 0.2 * liquidity
    
    return heuristics_matrix
