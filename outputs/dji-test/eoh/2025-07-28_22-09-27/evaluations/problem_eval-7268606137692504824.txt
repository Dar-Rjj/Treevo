import pandas as pd

def heuristics_v2(df):
    # Calculate ADX for trend strength
    tr = df['high'] - df['low']
    tr1 = (df['high'] - df['close'].shift()).abs()
    tr2 = (df['low'] - df['close'].shift()).abs()
    true_range = pd.concat([tr, tr1, tr2], axis=1).max(axis=1)
    atr = true_range.rolling(window=14).mean()
    
    plus_dm = (df['high'] - df['high'].shift(1)).apply(lambda x: max(x, 0))
    minus_dm = (df['low'].shift(1) - df['low']).apply(lambda x: max(x, 0))
    
    plus_di = 100 * (plus_dm.rolling(window=14).sum() / atr)
    minus_di = 100 * (minus_dm.rolling(window=14).sum() / atr)
    
    dx = 100 * (plus_di - minus_di).abs() / (plus_di + minus_di)
    adx = dx.rolling(window=14).mean()
    
    # Calculate CMF for buying/selling pressure
    mfm = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
    mf_volume = mfm * df['volume']
    cmf = mf_volume.rolling(window=20).sum() / df['volume'].rolling(window=20).sum()
    
    # Combine factors into a heuristics matrix using a simple weighted sum
    heuristics_matrix = 0.5 * adx + 0.5 * cmf
    heuristics_matrix = heuristics_matrix.rolling(window=20).mean()
    
    return heuristics_matrix
