def heuristics_v2(df):
    # Calculate simple returns
    simple_returns = df['close'].pct_change()
    
    # Calculate volume change
    volume_change = df['volume'].pct_change()
    
    # Historical consistency score for simple returns
    consistency_score_returns = (simple_returns > 0).rolling(window=20).mean()
    
    # Historical consistency score for volume change
    consistency_score_volume = (volume_change > 0).rolling(window=20).mean()
    
    # Normalized consistency scores
    total_consistency = consistency_score_returns + consistency_score_volume
    weight_returns = consistency_score_returns / total_consistency
    weight_volume = 1 - weight_returns
    
    # Heuristic factor
    heuristics_matrix = weight_returns * simple_returns + weight_volume * volume_change
    return heuristics_matrix
