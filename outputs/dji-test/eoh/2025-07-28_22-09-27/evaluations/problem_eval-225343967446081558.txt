def heuristics_v2(df):
    n = 10  # Number of days to consider for the calculation
    df['price_diff'] = df['close'] - df['open']
    df['volume_change'] = df['volume'].pct_change()
    df['weight'] = (df['volume_change'] + 1).cumprod()  # Adjusting weights dynamically
    heuristics_matrix = df['price_diff'].rolling(window=n).apply(lambda x: (x * df.loc[x.index, 'weight']).sum(), raw=False)
    return heuristics_matrix
