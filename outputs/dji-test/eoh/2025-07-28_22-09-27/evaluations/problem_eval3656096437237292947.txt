def heuristics_v2(df):
    df['avg_price'] = (df['open'] + df['close']) / 2
    df['volume_weighted_avg'] = df['avg_price'] * df['volume']
    ewma_14 = df['volume_weighted_avg'].ewm(span=14).mean()
    ewma_28 = df['volume_weighted_avg'].ewm(span=28).mean()
    heuristics_matrix = ewma_14 - ewma_28
    return heuristics_matrix
