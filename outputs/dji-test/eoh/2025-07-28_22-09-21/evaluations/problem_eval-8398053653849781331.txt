def heuristics_v2(df):
    close_prices = df['close']
    volumes = df['volume']

    sma_10_close = close_prices.rolling(window=10).mean()
    sma_30_close = close_prices.rolling(window=30).mean()
    sma_5_volume = volumes.rolling(window=5).mean()

    volume_ratio = volumes / sma_5_volume

    heuristics_matrix = (sma_10_close - sma_30_close) * volume_ratio

    return heuristics_matrix
