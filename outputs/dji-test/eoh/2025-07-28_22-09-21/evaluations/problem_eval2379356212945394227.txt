def heuristics_v2(df):
    df['wma_close'] = df['close'].rolling(window=20).apply(lambda x: (x * range(1,21)).sum() / sum(range(1,21)))
    df['sma_50'] = df['close'].rolling(window=50).mean()
    df['sma_200'] = df['close'].rolling(window=200).mean()
    df['sma_diff'] = df['sma_50'] - df['sma_200']
    df['volume_min_60'] = df['volume'].rolling(window=60).min()
    heuristics_matrix = (df['wma_close'].shift(-1) * df['sma_diff']) / df['volume_min_60']
    return heuristics_matrix
