def heuristics_v2(df):
    df['high_low_ratio'] = df['high'].rolling(window=30).mean() / df['low'].rolling(window=30).mean()
    df['macd_line'] = df['close'].ewm(span=12, adjust=False).mean() - df['close'].ewm(span=26, adjust=False).mean()
    df['signal_line'] = df['macd_line'].ewm(span=9, adjust=False).mean()
    df['open_close_diff'] = (df['open'] - df['close']).abs().rolling(window=30).sum()
    heuristics_matrix = (df['high_low_ratio'] * df['signal_line']) / df['open_close_diff']
    return heuristics_matrix
