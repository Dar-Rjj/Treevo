def heuristics_v2(df):
    df['price_to_high'] = df['close'] / df['high']
    df['price_to_low'] = df['close'] / df['low']
    df['volume_change_ratio'] = (df['volume'] - df['volume'].shift(1)) / df['volume'].shift(1)
    weight_high = df['volume_change_ratio'].apply(lambda x: 1 if x > 0 else 0)
    weight_low = 1 - weight_high
    heuristics_matrix = (df['price_to_high'] * weight_high) + (df['price_to_low'] * weight_low)
    return heuristics_matrix
