import pandas as pd

def heuristics_v2(df):
    high_prices = df['high']
    low_prices = df['low']
    close_prices = df['close']
    volumes = df['volume']

    # Calculate 20-day Average True Range (as a proxy for volatility)
    tr = high_prices - low_prices
    atr_20 = tr.rolling(window=20).mean()

    # Calculate Chaikin Money Flow (CMF) over a 21-day period
    mfv = ((close_prices - low_prices) - (high_prices - close_prices)) / (high_prices - low_prices) * volumes
    cmf_21 = mfv.rolling(window=21).sum() / volumes.rolling(window=21).sum()

    # Define Heuristic Factor
    heuristics_matrix = atr_20 * cmf_21
    
    return heuristics_matrix
