import pandas as pd

def heuristics_v2(df):
    # Calculate the return from the close price
    returns = df['close'].pct_change()
    # Calculate the volume weighted average price (VWAP) for each day
    vwap = (df['volume'] * (df['high'] + df['low']) / 2).cumsum() / df['volume'].cumsum()
    # Generate the momentum heuristic using the 10-day and 30-day returns
    momentum_10d = returns.rolling(window=10).mean()
    momentum_30d = returns.rolling(window=30).mean()
    # Generate the volatility heuristic using the 10-day returns standard deviation
    volatility = returns.rolling(window=10).std()
    # Combine heuristics into a single score
    heuristics_matrix = momentum_10d - momentum_30d + volatility - vwap.pct_change()
    return heuristics_matrix
