def heuristics_v2(df):
    df['momentum'] = df['close'].pct_change(periods=14)
    df['vol_adj_volume_rate'] = (df['volume'] - df['volume'].rolling(window=14).mean()) / df['volume'].rolling(window=14).std()
    df['ma20'] = df['close'].rolling(window=20).mean()
    df['std20'] = df['close'].rolling(window=20).std()
    df['upper_band'] = df['ma20'] + 2 * df['std20']
    df['lower_band'] = df['ma20'] - 2 * df['std20']
    df['band_ratio'] = (df['close'] - df['lower_band']) / (df['upper_band'] - df['lower_band'])
    heuristics_matrix = df['momentum'] * df['vol_adj_volume_rate'] * df['band_ratio']
    return heuristics_matrix
