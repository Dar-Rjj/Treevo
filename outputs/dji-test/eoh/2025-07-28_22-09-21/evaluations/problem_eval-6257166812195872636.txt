def heuristics_v2(df):
    window = 20  # Define moving average window
    ma_high_low = (df['high'] + df['low']) / 2.0  # Calculate simple moving average of high and low
    ma_high_low = ma_high_low.rolling(window=window).mean()  # Apply rolling window to get actual moving average
    diff = df['close'] - ma_high_low  # Difference between close and moving average
    pos_diff = diff.apply(lambda x: x if x > 0 else 0)  # Positive part of the difference
    neg_diff = diff.apply(lambda x: -x if x < 0 else 0)  # Negative part of the difference
    avg_diff = (pos_diff + neg_diff) / 2.0  # Average of positive and negative differences
    heuristics_matrix = avg_diff * df['volume']  # Scale by volume
    return heuristics_matrix
