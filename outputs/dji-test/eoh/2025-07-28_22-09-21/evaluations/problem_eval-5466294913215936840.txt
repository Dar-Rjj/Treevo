import pandas as pd

def heuristics_v2(df):
    high_prices = df['high']
    low_prices = df['low']
    close_prices = df['close']
    volumes = df['volume']

    # Calculate 14-day Average True Range (as a proxy for volatility)
    tr = high_prices - low_prices
    atr_14 = tr.rolling(window=14).mean()

    # Calculate Chaikin Money Flow (CMF) over a 28-day period
    mfv = ((close_prices - low_prices) - (high_prices - close_prices)) / (high_prices - low_prices) * volumes
    cmf_28 = mfv.rolling(window=28).sum() / volumes.rolling(window=28).sum()

    # Define Heuristic Factor
    heuristics_matrix = atr_14 * cmf_28
    
    return heuristics_matrix
