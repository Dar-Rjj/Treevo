def heuristics_v2(df):
    df['wma'] = df['close'].rolling(window=14).apply(lambda x: (x * range(1, 15)).sum() / 105)
    df['volume_change'] = df['volume'].pct_change()
    gain = df['volume_change'].mask(df['volume_change'] < 0, 0)
    loss = -df['volume_change'].mask(df['volume_change'] > 0, 0)
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    rs = avg_gain / avg_loss
    df['volume_rsi'] = 100 - (100 / (1 + rs))
    df['pos_dm'] = df['high'].diff().mask(df['high'].diff() < 0, 0)
    df['neg_dm'] = -df['low'].diff().mask(df['low'].diff() > 0, 0)
    df['tr'] = df[['high', 'low', 'close']].diff(axis=1).abs().max(axis=1)
    pos_di = 100 * (df['pos_dm'] / df['tr']).rolling(window=14).mean()
    neg_di = 100 * (df['neg_dm'] / df['tr']).rolling(window=14).mean()
    df['dmi'] = abs(pos_di - neg_di) / (pos_di + neg_di)
    heuristics_matrix = (df['wma'].shift(-1) * df['volume_rsi']) * df['dmi']
    return heuristics_matrix
