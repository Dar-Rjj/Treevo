def heuristics_v2(df):
    long_volume_window = 20
    short_volume_window = 5
    momentum_window = 10
    
    # Calculate long-term and short-term average volume
    long_avg_volume = df['volume'].rolling(window=long_volume_window).mean()
    short_avg_volume = df['volume'].rolling(window=short_volume_window).mean()
    
    # Calculate the ratio of long-term to short-term volume
    volume_ratio = long_avg_volume / short_avg_volume
    
    # Calculate the momentum as the difference between the current close and the close `momentum_window` days ago
    df['Momentum'] = df['close'] - df['close'].shift(momentum_window)
    
    # Generate the heuristics factor
    heuristics_factor = (volume_ratio * df['Momentum']).rename('heuristic_factor')
    
    heuristics_matrix = heuristics_factor.dropna()
    return heuristics_matrix
