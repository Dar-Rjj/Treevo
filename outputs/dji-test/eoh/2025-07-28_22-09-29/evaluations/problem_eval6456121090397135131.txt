def heuristics_v2(df):
    def vw_price_change(close, volume, periods=10):
        return (close.pct_change(periods) * volume).rolling(window=periods).sum() / volume.rolling(window=periods).sum()

    def std_dev(close, periods=14):
        return close.rolling(window=periods).std()

    vw_signal = vw_price_change(df['close'], df['volume'])
    std_signal = std_dev(df['close'])
    combined_factor = (vw_signal + std_signal).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=20, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
