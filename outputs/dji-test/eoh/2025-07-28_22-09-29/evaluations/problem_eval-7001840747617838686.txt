def heuristics_v2(df):
    def momentum(price, periods=10):
        return price.pct_change(periods=periods)

    def rsi(series, periods=14):
        delta = series.diff()
        gain = delta.where(delta > 0, 0)
        loss = -delta.where(delta < 0, 0)
        avg_gain = gain.rolling(window=periods).mean()
        avg_loss = loss.rolling(window=periods).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))

    def sma(volume, window=5):
        return volume.rolling(window=window).mean()

    mom_close = momentum(df['close'])
    rsi_high = rsi(df['high'])
    vol_ratio = sma(df['volume'], 5) / sma(df['volume'], 20)
    
    combined_factor = (mom_close * rsi_high) * vol_ratio.rename('combined_factor')
    heuristics_matrix = combined_factor.dropna().rename('heuristic_factor')

    return heuristics_matrix
