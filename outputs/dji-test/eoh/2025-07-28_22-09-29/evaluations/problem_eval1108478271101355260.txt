def heuristics_v2(df):
    # Calculate 20-day return (longer momentum)
    df['Momentum'] = df['close'].pct_change(20)
    
    # Calculate the price change
    delta = df['close'].diff()
    
    # Calculate the average gain and loss over a 14-day period
    avg_gain = delta.where(delta > 0, 0).rolling(window=14).mean()
    avg_loss = -delta.where(delta < 0, 0).rolling(window=14).mean()
    
    # Compute the RSI
    rs = avg_gain / avg_loss
    df['RSI'] = 100 - (100 / (1 + rs))
    
    # Calculate 30-day average volume
    df['Volume_avg'] = df['volume'].rolling(window=30).mean()
    
    # Generate the heuristics factor
    df['Heuristic_Factor'] = (df['RSI'] * df['Momentum']) * df['Volume_avg']
    
    heuristics_matrix = df['Heuristic_Factor'].dropna()
    return heuristics_matrix
