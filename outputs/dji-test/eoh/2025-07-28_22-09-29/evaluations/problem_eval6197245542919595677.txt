def heuristics_v2(df):
    short_window = 10
    long_window = 30
    df['short_ma'] = df['close'].ewm(span=short_window, adjust=False).mean()
    df['long_ma'] = df['close'].ewm(span=long_window, adjust=False).mean()
    df['volume_avg'] = df['volume'].ewm(span=short_window, adjust=False).mean()
    heuristics_matrix = (df['short_ma'] / df['long_ma']) * df['volume_avg']
    return heuristics_matrix
