def heuristics_v2(df):
    def ma_diff(price, fast=10, slow=30, weight=2.0):
        ma_fast = price.rolling(window=fast).mean()
        ma_slow = price.rolling(window=slow).mean()
        return (ma_fast - ma_slow) * weight

    def roc(series, periods=14):
        return series.pct_change(periods=periods)

    ma_signal = ma_diff(df['close'])
    roc_volume = roc(df['volume'])
    combined_factor = (ma_signal + roc_volume).rename('combined_factor')
    heuristics_matrix = (combined_factor - combined_factor.rolling(window=20).mean()) / combined_factor.rolling(window=20).std().rename('heuristic_factor')

    return heuristics_matrix
