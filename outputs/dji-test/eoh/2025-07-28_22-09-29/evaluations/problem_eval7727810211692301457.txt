import pandas as pd

def heuristics_v2(df):
    def hl_diff(high, low):
        return high - low

    def roc(series, periods=20):
        return series.pct_change(periods=periods)

    def wma_line(series, window=15, weights=None):
        if weights is None:
            weights = pd.Series(range(1, window+1))
        return series.rolling(window=window).apply(lambda x: (x * weights).sum() / weights.sum(), raw=True)

    hl_signal = hl_diff(df['high'], df['low'])
    roc_close = roc(df['close'])
    combined_factor = (hl_signal + roc_close).rename('combined_factor')
    heuristics_matrix = wma_line(combined_factor).rename('heuristic_factor')

    return heuristics_matrix
