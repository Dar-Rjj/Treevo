def heuristics_v2(df):
    def diff_close_open(price_close, price_open):
        return price_close - price_open

    def std_high(high, periods=10):
        return high.rolling(window=periods).std()

    diff_signal = diff_close_open(df['close'], df['open'])
    std_high_signal = std_high(df['high'])
    combined_factor = (diff_signal + std_high_signal).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=20, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
