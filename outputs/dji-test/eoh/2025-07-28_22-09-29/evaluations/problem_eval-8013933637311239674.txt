def heuristics_v2(df):
    def wma_diff(price, weights=[0.1, 0.2, 0.3, 0.4], periods=4):
        return price.rolling(window=periods).apply(lambda x: (x * weights).sum(), raw=True)

    def pc(series, periods=20):
        return (series / series.shift(periods)) - 1

    wma_signal = wma_diff(df['close'])
    pc_low = pc(df['low'])
    combined_factor = (wma_signal + pc_low).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=20, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
