import pandas as pd

def heuristics_v2(df):
    def moving_average(series, window=14):
        return series.rolling(window=window).mean()
    
    def average_true_range(high, low, close, window=14):
        tr = pd.DataFrame(index=close.index)
        tr['h-l'] = high - low
        tr['h-c'] = (high - close.abs()).abs()
        tr['l-c'] = (low - close.abs()).abs()
        tr['tr'] = tr.max(axis=1)
        atr = tr['tr'].rolling(window=window).mean()
        return atr
    
    ma_close = moving_average(df['close'])
    ma_volume = moving_average(df['volume'])
    atr = average_true_range(df['high'], df['low'], df['close'])
    
    heuristics_matrix = ((ma_close - ma_volume) * atr).rename('heuristic_factor')
    return heuristics_matrix
