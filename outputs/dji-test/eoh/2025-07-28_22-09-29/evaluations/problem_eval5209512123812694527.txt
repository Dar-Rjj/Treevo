def heuristics_v2(df):
    def high_low_ratio(high, low, window=20):
        return (high / low).rolling(window=window).mean()

    def avg_volume(volume, window=20):
        return volume.rolling(window=window).mean()

    hl_ratio = high_low_ratio(df['high'], df['low'])
    avg_vol = avg_volume(df['volume'])
    combined_factor = (hl_ratio + avg_vol).rename('combined_factor')
    heuristics_matrix = combined_factor.rolling(window=30).mean().rename('heuristic_factor')

    return heuristics_matrix
