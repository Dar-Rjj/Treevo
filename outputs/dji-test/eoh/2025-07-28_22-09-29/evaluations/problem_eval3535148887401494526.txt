def heuristics_v2(df):
    # Calculate 30-day simple moving average for return (momentum)
    df['Momentum'] = df['close'].pct_change().rolling(window=30).mean()
    
    # Calculate 20-day rolling window for standard deviation (volatility)
    df['Volatility'] = df['close'].rolling(window=20).std()
    
    # Calculate 15-day exponential moving average for volume
    df['Volume_avg'] = df['volume'].ewm(span=15, adjust=False).mean()
    
    # Calculate 20-day simple moving average of close price
    df['SMA_20'] = df['close'].rolling(window=20).mean()
    
    # Generate the heuristics factor
    df['Heuristic_Factor'] = ((df['Momentum'] / df['Volatility']) * df['Volume_avg']) + df['SMA_20']
    
    heuristics_matrix = df['Heuristic_Factor'].dropna()
    return heuristics_matrix
