def heuristics_v2(df):
    def std_dev(series, window=30):
        return series.rolling(window=window).std()

    def ppo(price, fast=12, slow=26, signal=9):
        ema_fast = price.ewm(span=fast, adjust=False).mean()
        ema_slow = price.ewm(span=slow, adjust=False).mean()
        ppo = 100 * (ema_fast - ema_slow) / ema_slow
        return ppo.ewm(span=signal, adjust=False).mean()

    std_high = std_dev(df['high'])
    ppo_close = ppo(df['close'])
    combined_factor = (std_high + ppo_close).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=20, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
