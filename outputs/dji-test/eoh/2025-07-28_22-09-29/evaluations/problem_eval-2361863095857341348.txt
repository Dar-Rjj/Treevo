def heuristics_v2(df):
    ma_high_low = (df['high'] + df['low']) / 2
    positive_diff = (df['close'] - ma_high_low).apply(lambda x: x if x > 0 else 0)
    negative_diff = (df['close'] - ma_high_low).apply(lambda x: x if x < 0 else 0)
    avg_positive = positive_diff.rolling(window=10).mean()
    avg_negative = negative_diff.rolling(window=10).mean()
    heuristics_matrix = df['volume'] - (avg_positive + avg_negative) / 2
    return heuristics_matrix
