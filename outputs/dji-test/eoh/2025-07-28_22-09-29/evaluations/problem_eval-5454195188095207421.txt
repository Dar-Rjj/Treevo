def heuristics_v2(df):
    def weighted_sum(high, low, weight=0.5):
        return (high * weight) + (low * (1 - weight))

    def cumulative_return(close, periods=20):
        return (close / close.shift(periods) - 1).fillna(0)

    ws = weighted_sum(df['high'], df['low'])
    cum_ret = cumulative_return(df['close'])
    combined_factor = (ws + cum_ret).rename('combined_factor')
    heuristics_matrix = combined_factor.rolling(window=20).mean().rename('heuristic_factor')

    return heuristics_matrix
