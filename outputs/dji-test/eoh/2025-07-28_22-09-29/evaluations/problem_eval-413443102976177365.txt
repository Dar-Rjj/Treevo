def heuristics_v2(df):
    # Calculate 20-day exponential moving average for return (momentum)
    df['Momentum'] = df['close'].pct_change().ewm(span=20, adjust=False).mean()
    
    # Calculate 20-day exponential moving average for standard deviation (volatility)
    df['Volatility'] = df['close'].rolling(window=20).std().ewm(span=20, adjust=False).mean()
    
    # Calculate 5-day weighted average volume
    df['Volume_avg'] = df['volume'].ewm(span=5, adjust=False).mean()
    
    # Generate the heuristics factor
    df['Heuristic_Factor'] = (df['Momentum'] / df['Volatility']) * df['Volume_avg']
    
    heuristics_matrix = df['Heuristic_Factor'].dropna()
    return heuristics_matrix
