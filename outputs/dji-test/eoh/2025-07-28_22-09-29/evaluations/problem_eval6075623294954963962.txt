def heuristics_v2(df):
    def sma(price, window=30):
        return price.rolling(window=window).mean()

    def vw_price_change(df, periods=20):
        return (df['close'] - df['close'].shift(periods)) / df['volume']

    sma_close = sma(df['close'])
    vw_price_chg = vw_price_change(df)
    combined_factor = (sma_close + vw_price_chg).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=18, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
