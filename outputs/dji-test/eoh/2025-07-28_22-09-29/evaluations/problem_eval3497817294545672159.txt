def heuristics_v2(df):
    def vwap(price, volume, fast=10, slow=30):
        vwap_fast = (price * volume).rolling(window=fast).sum() / volume.rolling(window=fast).sum()
        vwap_slow = (price * volume).rolling(window=slow).sum() / volume.rolling(window=slow).sum()
        return vwap_fast - vwap_slow

    def ppo(series, fast=12, slow=26, signal=9):
        ema_fast = series.ewm(span=fast, adjust=False).mean()
        ema_slow = series.ewm(span=slow, adjust=False).mean()
        ppo_line = ((ema_fast - ema_slow) / ema_slow) * 100
        return ppo_line

    vwap_signal = vwap(df['close'], df['volume'])
    ppo_low = ppo(df['low'])
    combined_factor = (vwap_signal + ppo_low).rename('combined_factor')
    heuristics_matrix = combined_factor.rolling(window=18, win_type='gaussian').mean(std=3).rename('heuristic_factor')

    return heuristics_matrix
