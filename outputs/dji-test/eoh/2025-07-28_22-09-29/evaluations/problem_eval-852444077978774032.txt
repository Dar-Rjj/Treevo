def heuristics_v2(df):
    # Calculate the difference between close and open prices
    df['Price_Diff'] = df['close'] - df['open']
    
    # Calculate the 10-day moving average of the price difference
    df['Price_Diff_MA'] = df['Price_Diff'].rolling(window=10).mean()
    
    # Calculate the 10-day moving average of the volume
    df['Volume_MA'] = df['volume'].rolling(window=10).mean()
    
    # Compute the ratio of current day's volume to the 10-day moving average of the volume
    df['Volume_Ratio'] = df['volume'] / df['Volume_MA']
    
    # Generate the heuristics factor combining the moving average of price differences and the volume ratio
    df['Heuristic_Factor'] = df['Price_Diff_MA'] * df['Volume_Ratio']
    
    heuristics_matrix = df['Heuristic_Factor'].dropna()
    return heuristics_matrix
