def heuristics_v2(df):
    def sma(price, window):
        return price.rolling(window=window).mean()

    def std_dev(returns, window):
        return returns.rolling(window=window).std()

    sma_5 = sma(df['close'], 5)
    sma_20 = sma(df['close'], 20)
    price_diff = sma_5 - sma_20

    returns = df['close'].pct_change()
    returns_std = std_dev(returns, 10)

    combined_factor = (price_diff + returns_std).rename('combined_factor')
    heuristics_matrix = combined_factor.rolling(window=14).mean().rename('heuristic_factor')

    return heuristics_matrix
