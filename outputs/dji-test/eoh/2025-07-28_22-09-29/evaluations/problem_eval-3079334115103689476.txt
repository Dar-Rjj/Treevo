def heuristics_v2(df):
    # Calculate 10-day return (momentum)
    df['Momentum'] = df['close'].pct_change(10)
    
    # Calculate the price change and its absolute value
    delta = df['close'].diff()
    gain = (delta.where(delta > 0, 0)).fillna(0)
    loss = (-delta.where(delta < 0, 0)).fillna(0)
    
    # Calculate the average gain and loss over a 14-day period
    avg_gain = gain.rolling(window=14).mean()
    avg_loss = loss.rolling(window=14).mean()
    
    # Compute the RS
    rs = avg_gain / avg_loss
    
    # Calculate 10-day average volume
    df['Volume_avg'] = df['volume'].rolling(window=10).mean()
    
    # Generate the heuristics factor
    df['Heuristic_Factor'] = (rs * df['Momentum']) * df['Volume_avg']
    
    heuristics_matrix = df['Heuristic_Factor'].dropna()
    return heuristics_matrix
