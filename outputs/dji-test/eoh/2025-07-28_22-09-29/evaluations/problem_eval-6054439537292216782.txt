def heuristics_v2(df):
    def macd(price, fast=12, slow=26, signal=9):
        ema_fast = price.ewm(span=fast, adjust=False).mean()
        ema_slow = price.ewm(span=slow, adjust=False).mean()
        macd_line = ema_fast - ema_slow
        signal_line = macd_line.ewm(span=signal, adjust=False).mean()
        return macd_line - signal_line

    def vroc(volume, periods=20):
        return (volume - volume.shift(periods)) / volume.shift(periods)

    macd_signal = macd(df['close'])
    vroc_volume = vroc(df['volume'])
    combined_factor = (macd_signal + vroc_volume).rename('combined_factor')
    heuristics_matrix = combined_factor.rolling(window=20).std().rename('heuristic_factor')

    return heuristics_matrix
