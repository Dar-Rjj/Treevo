[*] Running ...
/home/rjj/reevo/problems/dji/tmp/gpt_temp_7_1d83ba84.py:9: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[ 0.778  0.71   0.943  3.975  1.352  0.75   0.68   1.068 10.117  4.02
  1.088  1.23   6.475  4.557  2.9    1.95   0.85   0.6    8.18   1.5
  4.1    2.79   1.32   3.48   1.71   4.55   1.03   3.88   1.45   1.76
  3.78   7.18   5.24   1.63   3.08   2.83   2.44   3.117  1.98   0.79
  2.65   1.81   0.34   0.8    0.4    0.97   2.05   1.74   2.805  0.28
  1.31   2.14   3.1    1.66   0.32   1.355  1.245  2.67   3.15   1.14
  3.03   2.065  1.112  1.095  1.01   2.33   1.69   4.74   2.18   2.63
  1.83   0.39   2.48   1.945  1.47   3.435  1.87   0.97   3.512  3.67
  4.68   4.33   4.78   4.38   2.88   2.5    1.76   1.64   2.62   3.57
  3.65   2.68   1.629  6.51   1.04   1.404  0.39   1.18   1.45   4.43
  3.48   3.07   3.22   0.6    3.61   1.17   1.222  2.65   4.725  1.685
  5.77   2.555  1.08   0.599  3.45   3.981  0.7    1.58   2.57   2.43
  1.81   2.5    1.85   4.245  5.99   4.18   1.96   1.65   0.32   2.44
  1.942  6.44   3.21   0.66   2.3    0.95   3.8    1.958  8.454  2.285
  8.32   3.31   1.61   3.91   2.92   2.05   5.469  3.56   2.52   0.66
  1.32   1.77   5.295  2.98   2.27   6.2    2.13   2.92   0.83   0.39
  1.98   4.4    2.2    3.215  1.08   2.74   0.43   2.53   3.74   2.02
  0.75   0.705  3.28   0.57   7.26   0.49   0.56   2.315  1.477  1.875
  0.36   0.77   3.171  1.09   1.66   2.13   1.635  0.49   4.41   2.4
  3.14   3.9    1.2    1.56   0.24   0.66   1.07   3.87   4.31   0.8
  0.395  2.885  0.779  1.23   0.58   2.54   2.49   0.265  2.21   3.33
  3.01   0.67   2.685  1.46   1.525  1.41   1.01   1.24   4.35   0.99
  1.23   3.28   1.62   2.84   1.25   0.65   6.21   0.63 ]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[(df['up_move'] > df['down_move']) & (df['up_move'] > 0), '+DM'] = df['up_move']
/home/rjj/reevo/problems/dji/tmp/gpt_temp_7_1d83ba84.py:10: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '[0.978 1.558 1.032 0.032 1.38  2.612 0.585 0.065 0.14  4.593 2.865 4.335
 0.232 7.068 0.495 0.51  0.7   0.293 0.892 1.19  3.63  0.883 0.045 1.602
 4.688 0.885 2.03  1.25  0.745 4.53  3.53  6.5   9.61  1.79  2.58  2.76
 2.5   2.8   1.57  3.33  2.62  2.99  6.06  2.39  1.77  2.67  5.11  0.79
 2.21  3.61  1.33  1.3   1.88  0.37  0.03  1.47  0.66  3.15  0.03  0.82
 1.86  0.31  1.4   1.66  3.44  4.48  0.4   1.41  4.52  0.535 1.92  2.31
 2.13  0.7   0.81  0.96  1.19  0.48  3.54  1.16  2.58  1.05  3.2   0.88
 1.32  0.69  0.84  2.09  0.85  0.4   0.99  2.43  1.48  1.92  2.67  6.2
 1.13  0.94  1.68  4.96  1.67  2.05  1.48  2.37  1.73  1.64  0.27  1.76
 0.06  1.43  4.83  0.96  3.71  6.49  0.72  3.68  1.    1.475 0.94  0.93
 1.45  0.63  0.078 0.902 3.32  2.06  1.39  3.2   7.21  3.84  1.69  0.66
 2.22  3.17  3.22  1.05  1.36  2.58  0.66  1.81  2.1   4.295 2.379 2.016
 0.645 1.88  2.075 1.065 0.08  1.81  1.87  1.34  2.58  3.38  1.16  1.985
 0.36  1.53  0.51  1.4   0.55  1.03  1.385 0.765 5.13  1.27  0.84  2.565
 2.665 4.04  0.52  2.01  0.68  0.39  1.92  0.73  0.1   1.34  0.53  0.61
 0.11  0.92  0.982 0.31  0.58  0.16  2.32  0.929 0.59  1.03  2.41  1.61
 0.12  1.52  0.11  2.59  1.995 1.987 1.348 4.05  0.59  1.21  4.21  1.67
 1.11  2.15  3.01  2.04  0.47  1.14  1.1   0.11  0.32  0.11  0.23  2.43
 1.8   2.62  2.94  1.65  2.28  1.26  1.35  0.29  0.68  2.68  0.06  0.69
 0.415 0.025 5.25  0.05  1.84  0.54  0.851 1.461 4.49  1.51  1.94  1.74
 2.13  0.34  0.75  2.17  0.84  1.09  0.99  4.35  0.16  0.75  0.77  1.84
 2.    3.39  1.57  0.25  0.77  1.019 0.52  3.307 1.387 1.17  0.82  0.36
 0.1   0.1   2.21  0.169 1.95  0.09  3.483 1.94  0.58  3.28  2.43  6.73
 1.92  4.56  4.06  3.22  3.32  1.06  2.23  3.03  3.12  1.46  0.39  0.05
 0.83  1.41  4.48  3.    0.61  2.86  4.    3.03  0.7   1.685 3.465 1.76
 1.88  7.6   2.32  0.46  6.71  2.8   1.21  1.22  0.27  3.47  3.35  3.51
 1.48  3.69  1.58  2.28  4.04  2.4   7.75  8.874 1.556 0.98  2.6   3.45
 3.06  3.24  3.61  3.43  1.48  4.4   3.17  3.255 2.56  2.54  0.75  4.34
 2.3   2.46  0.025 4.285 0.28  0.65  3.7   1.14  1.73  1.47  2.19  4.41
 3.04  1.74  1.34  3.98  3.05  4.31  0.54  2.69  1.44  7.12  7.01  4.31
 1.07  2.5   6.78  3.3   3.99  5.04  0.32  1.01  8.12  1.58  0.82  2.4
 0.8   3.36  4.93  5.47  5.62  0.04  3.12  0.77  1.72  4.14  3.64  0.655
 2.896 1.886 4.15  1.72  1.22  2.93  4.95  1.5   0.21  3.46  1.47  1.13
 1.48  2.25  1.39  1.26  3.68  1.2   0.95  3.65  1.21  1.945 0.55  1.81
 4.175 0.485 0.405 2.105 4.79  3.74  2.1   0.58  2.47  1.275 0.08  0.93
 2.07  5.93  0.241 2.231 3.01  3.98  2.69  2.35  5.105 4.16  2.68  0.315
 6.575 1.25  2.21  5.775 0.872 0.353 0.06  3.79  3.82  2.08  0.89  1.15
 3.351 3.36  1.32  3.91  4.1   2.79  4.13  6.25  4.14  1.291 2.897 4.87
 3.06  1.271 3.82  2.255 0.79  2.415 2.22  3.74  3.025 6.06  0.96  3.85
 1.92  1.1   0.16  3.08  5.135 2.295 2.41  1.43  2.45  0.66  0.92  2.85
 1.86  0.3   3.26  0.91  0.32  5.    1.77  2.34  0.98  2.47  1.26  2.4
 1.49  3.09  0.23  0.57  6.85  2.95  0.528 0.748 0.97  0.06  2.02  2.498
 2.445 1.245 1.52  0.62  1.82  1.11  6.13  2.33  0.7   1.605 2.615 2.4
 0.18  2.64  2.39  0.13  0.17  1.89  3.37  1.921 2.31  0.89  3.31  0.2
 1.92  0.43  0.73  2.4   0.21  0.02  1.07  0.6   0.93  2.69  0.76  1.1
 2.85  1.35  0.51  0.93  0.47  0.329 1.379 2.36  1.49  2.175 0.755 3.46
 2.329 0.605 0.14  3.17  1.47  0.42  0.49  0.14  1.82  1.34  0.44  1.93
 1.34  0.5   1.14  1.42  1.04  3.205 0.435 1.31  0.15  0.605 0.155 1.265
 1.02  0.665 1.59  1.12  3.429 1.161 8.77  4.57  0.23  0.59  0.81  0.255
 0.55  3.02  1.52  1.775 2.515 2.315 0.19  2.725 5.24  2.74  0.67  6.14
 7.93  4.25  0.45  2.52  0.84  0.4   0.96  1.73  1.54  0.1   2.49  2.61
 1.43  2.721 0.11  1.71  2.62  2.15  0.35  0.9   1.63  1.71  0.31  2.55
 2.71  1.52  0.8   4.98  1.16  0.97  5.34  2.11  2.86  2.62  0.68  2.09
 1.48  0.08  0.14  1.575 0.35  0.5   0.78  1.779 1.93  1.48  2.25  0.84
 2.61  1.5   1.06  1.33  0.53  0.14  1.74  2.08  1.445 7.84  0.455 2.55
 0.71  1.23  1.57  4.256 0.634 2.99  3.44  1.57  1.227 1.173 2.36  2.11
 3.12  0.53  4.57  6.59  0.93  1.84  1.26  0.89  1.21  3.277 1.073]' has dtype incompatible with int64, please explicitly cast to a compatible dtype first.
  df.loc[(df['down_move'] > df['up_move']) & (df['down_move'] > 0), '-DM'] = df['down_move']
Traceback (most recent call last):
  File "/home/rjj/reevo/problems/dji/eval.py", line 69, in <module>
    mean_ic = solve(market_data, heuristics)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/reevo/problems/dji/eval.py", line 28, in solve
    market_data['factor'] = market_data.groupby('stock_code').apply(lambda x: heuristics(x)).reset_index(level=0, drop=True)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/groupby.py", line 1825, in apply
    result = self._python_apply_general(f, self._selected_obj)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/groupby.py", line 1886, in _python_apply_general
    values, mutated = self._grouper.apply_groupwise(f, data, self.axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/rjj/miniconda3/envs/ReEvo/lib/python3.11/site-packages/pandas/core/groupby/ops.py", line 919, in apply_groupwise
    res = f(group)
          ^^^^^^^^
  File "/home/rjj/reevo/problems/dji/eval.py", line 28, in <lambda>
    market_data['factor'] = market_data.groupby('stock_code').apply(lambda x: heuristics(x)).reset_index(level=0, drop=True)
                                                                              ^^^^^^^^^^^^^
  File "/home/rjj/reevo/problems/dji/tmp/gpt_temp_7_1d83ba84.py", line 20, in heuristics_v2
    df['TrueRange'] = pd.concat([tr1, tr2, tr3], axis=1).max(axis=1)
                      ^^
NameError: name 'pd' is not defined. Did you mean: 'id'?
