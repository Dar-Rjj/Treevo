import pandas as pd

def heuristics_v2(df):
    def price_rate_of_change(price, periods=14):
        return (price / price.shift(periods) - 1) * 100
    
    def bollinger_bands_percent_b(price, periods=20, std_dev=2):
        sma = price.rolling(window=periods).mean()
        std = price.rolling(window=periods).std()
        upper_band = sma + std*std_dev
        lower_band = sma - std*std_dev
        bbp = (price - lower_band) / (upper_band - lower_band)
        return bbp
    
    roc = price_rate_of_change(df['close'])
    bbp = bollinger_bands_percent_b(df['close'])
    heuristics_matrix = (roc * bbp).rename('heuristic_factor')
    
    return heuristics_matrix
