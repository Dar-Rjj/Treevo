import pandas as pd

def heuristics_v2(df):
    def rsi(series, periods=14):
        delta = series.diff()
        gain = delta.where(delta > 0, 0)
        loss = -delta.where(delta < 0, 0)
        avg_gain = gain.rolling(window=periods).mean()
        avg_loss = loss.rolling(window=periods).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))

    def bollinger_bands_width(series, window=20, width=2):
        sma = series.rolling(window=window).mean()
        std = series.rolling(window=window).std()
        upper_band = sma + (std * width)
        lower_band = sma - (std * width)
        return (upper_band - lower_band) / sma

    rsi_close = rsi(df['close'])
    bbw = bollinger_bands_width(df['close'])
    combined_factor = (rsi_close + bbw).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=18, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
