def heuristics_v2(df):
    def vwap(price, high, low, volume):
        typical_price = (price + high + low) / 3
        return (typical_price * volume).cumsum() / volume.cumsum()

    def pct_change_volume(volume, periods=20):
        return (volume - volume.shift(periods)) / volume.shift(periods)

    vwap_signal = vwap(df['close'], df['high'], df['low'], df['volume'])
    pct_change_vol = pct_change_volume(df['volume'])
    combined_factor = (vwap_signal + pct_change_vol).rename('combined_factor')
    heuristics_matrix = combined_factor.ewm(span=30, adjust=False).mean().rename('heuristic_factor')

    return heuristics_matrix
