def heuristics_v2(df):
    df['change'] = df['close'].diff()
    df['gain'] = df['change'].apply(lambda x: x if x > 0 else 0)
    df['loss'] = df['change'].apply(lambda x: -x if x < 0 else 0)
    df['avg_gain_14'] = df['gain'].rolling(window=14).mean()
    df['avg_loss_14'] = df['loss'].rolling(window=14).mean()
    df['rs'] = df['avg_gain_14'] / df['avg_loss_14']
    df['rsi'] = 100 - (100 / (1 + df['rs']))
    df['vol_ratio'] = df['volume'].rolling(window=5).mean() / df['volume'].rolling(window=60).mean()
    df['roc'] = df['close'].pct_change(periods=30)
    heuristics_matrix = df['rsi'] * df['vol_ratio'] * df['roc']
    return heuristics_matrix
