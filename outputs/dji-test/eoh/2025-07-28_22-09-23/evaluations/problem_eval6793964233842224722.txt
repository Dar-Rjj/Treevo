def heuristics_v2(df):
    def macd(series, n_fast=12, n_slow=26, n_signal=9):
        ema_fast = series.ewm(span=n_fast, adjust=False).mean()
        ema_slow = series.ewm(span=n_slow, adjust=False).mean()
        macd_line = ema_fast - ema_slow
        signal_line = macd_line.ewm(span=n_signal, adjust=False).mean()
        return macd_line - signal_line  # MACD histogram

    def obv(df):
        obv_values = (df['volume'] * (df['close'] > df['close'].shift(1)).astype(int) - 
                      df['volume'] * (df['close'] < df['close'].shift(1)).astype(int))
        return obv_values.cumsum()

    close_macd = macd(df['close'])
    obv_series = obv(df)
    heuristics_matrix = (close_macd + obv_series) / 2
    return heuristics_matrix
