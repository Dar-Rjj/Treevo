def heuristics_v2(df):
    df['abs_diff'] = abs(df['open'] - df['close'])
    df['volume_ewma'] = df['volume'].ewm(span=30).mean()
    heuristics_matrix = df['abs_diff'].rolling(window=30).sum() / df['volume_ewma']
    return heuristics_matrix
