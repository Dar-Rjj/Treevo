def heuristics_v2(df):
    delta = df['close'].diff()
    up = delta.clip(lower=0)
    down = -1 * delta.clip(upper=0)
    ema_up = up.ewm(com=20, adjust=False).mean()
    ema_down = down.ewm(com=20, adjust=False).mean()
    rs = ema_up / ema_down
    rsi = 100 - (100 / (1 + rs))
    avg_price_long = df['close'].rolling(window=100).mean()
    price_to_avg_long = df['close'] / avg_price_long
    high_low_diff_daily = df['high'] - df['low']
    high_low_diff_weekly = df['high'].rolling(window=5).max() - df['low'].rolling(window=5).min()
    high_low_diff = (high_low_diff_daily + high_low_diff_weekly) / 2
    heuristics_matrix = rsi * price_to_avg_long * high_low_diff
    return heuristics_matrix
