import pandas as pd

def heuristics_v2(df):
    def exp_weighted_moving_avg(series, span=10):
        return series.ewm(span=span, adjust=False).mean()
    
    # Calculate the exponentially weighted moving average of the closing price
    ewma_close = exp_weighted_moving_avg(df['close'])
    
    # Momentum factor: current close price divided by the EWMA of the close price
    momentum_factor = df['close'] / ewma_close
    
    # Volume change: current volume divided by the EWMA of the volume
    ewma_volume = exp_weighted_moving_avg(df['volume'])
    volume_change = df['volume'] / ewma_volume
    
    # Divergence adjustment: if the volume is increasing, we slightly increase the momentum factor, and vice versa
    divergence_adjustment = 1 + (volume_change - 1) * 0.1
    adjusted_momentum = momentum_factor * divergence_adjustment
    
    # Output as a Series with the same index as input
    heuristics_matrix = pd.Series(adjusted_momentum, name='HeuristicFactor')
    
    return heuristics_matrix
