def heuristics_v2(df):
    def momentum(series, n=21):
        return series / series.shift(n) - 1

    def weighted_diff_sum(df, n=21):
        diff_high_low = (df['high'] - df['low']).diff()
        weighted_diff = diff_high_low * df['volume']
        cumsum_weighted_diff = weighted_diff.cumsum()
        return cumsum_weighted_diff

    close_momentum = momentum(df['close'])
    weighted_diff_cumulative = weighted_diff_sum(df)
    heuristics_matrix = (close_momentum + weighted_diff_cumulative) / 2
    return heuristics_matrix
