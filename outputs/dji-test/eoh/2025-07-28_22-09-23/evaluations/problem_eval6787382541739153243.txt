def heuristics_v2(df):
    df['price_sum'] = df['high'] + df['low']
    df['avg_price'] = (df['open'] + df['close']) * 0.5
    price_ratio = df['price_sum'].rolling(window=30).sum() / df['avg_price'].rolling(window=30).sum()
    heuristics_matrix = price_ratio / df['volume'].rolling(window=30).mean()
    return heuristics_matrix
