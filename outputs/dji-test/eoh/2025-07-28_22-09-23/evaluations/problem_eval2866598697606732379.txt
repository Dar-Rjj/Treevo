def heuristics_v2(df):
    # Calculate price momentum
    momentum = df['close'].pct_change(20)
    
    # Calculate volatility
    volatility = df['close'].pct_change().rolling(window=20).std()
    
    # Calculate trading volume change
    volume_change = df['volume'].pct_change(20)
    
    # Heuristic adjustment factor
    trend_factor = (df['close'] - df['close'].rolling(window=50).mean()) / df['close'].rolling(window=50).std()
    
    # Combine factors
    heuristics_matrix = 0.6 * momentum + 0.3 * volatility + 0.1 * volume_change + trend_factor
    
    return heuristics_matrix
