import pandas as pd

def heuristics_v2(df):
    def calculate_price_change(row):
        return (row['close'] - row['open']) / row['open']

    df['price_change'] = df.apply(calculate_price_change, axis=1)
    df['volume_shift'] = df['volume'].shift(1)
    df['weighted_score'] = (df['price_change'] * df['volume_shift']).rolling(window=5).mean()
    heuristics_matrix = df['weighted_score'].dropna()
    return heuristics_matrix
