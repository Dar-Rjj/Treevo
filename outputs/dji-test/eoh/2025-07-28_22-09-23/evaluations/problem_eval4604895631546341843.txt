def heuristics_v2(df):
    df['price_movement'] = (df['open'] - df['close']).abs()
    df['total_price_movement'] = df['price_movement'].rolling(window=30).sum()
    df['total_volume'] = df['volume'].rolling(window=30).sum()
    heuristics_matrix = df['total_price_movement'] / df['total_volume']
    return heuristics_matrix
