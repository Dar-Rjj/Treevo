def heuristics_v2(df):
    df['weighted_avg'] = (df['open'] * df['volume'] + df['close'] * df['volume']) / (df['volume'] + df['volume'])
    weighted_avg_matrix = df['weighted_avg'].rolling(window=30).mean()
    std_close = df['close'].rolling(window=30).std()
    heuristics_matrix = weighted_avg_matrix / std_close
    return heuristics_matrix
