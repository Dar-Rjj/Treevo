def heuristics_v2(df):
    def calculate_momentum(df, period=10):
        return df['close'].pct_change(period)
    
    def calculate_volatility(df, period=5):
        return df['close'].pct_change().rolling(window=period).std()
    
    def calculate_volume_change(df, period=5):
        return (df['volume'] - df['volume'].shift(period)) / df['volume'].shift(period)

    momentum = calculate_momentum(df)
    volatility = calculate_volatility(df)
    volume_change = calculate_volume_change(df)

    heuristics_matrix = 0.5 * momentum + 0.3 * (-volatility) + 0.2 * volume_change
    return heuristics_matrix
