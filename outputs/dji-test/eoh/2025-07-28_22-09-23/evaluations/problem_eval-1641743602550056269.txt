import pandas as pd

def heuristics_v2(df):
    def bollinger_bands(series, window=20, num_std=2):
        rolling_mean = series.rolling(window=window).mean()
        rolling_std = series.rolling(window=window).std()
        upper_band = rolling_mean + (rolling_std * num_std)
        lower_band = rolling_mean - (rolling_std * num_std)
        return (series - lower_band) / (upper_band - lower_band)
    
    def chaikin_money_flow(df, period=20):
        m_multiplier = ((df['close'] - df['low']) - (df['high'] - df['close'])) / (df['high'] - df['low'])
        money_flow_volume = m_multiplier * df['volume']
        cmf = money_flow_volume.rolling(window=period).sum() / df['volume'].rolling(window=period).sum()
        return cmf
    
    bb = bollinger_bands(df['close'])
    cmf = chaikin_money_flow(df)
    heuristics_matrix = (bb + cmf) / 2
    return heuristics_matrix
