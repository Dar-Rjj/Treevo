import pandas as pd

def heuristics_v2(df):
    def stoch_oscillator(df, n=14, k=3):
        L14 = df['low'].rolling(window=n).min()
        H14 = df['high'].rolling(window=n).max()
        K = 100 * ((df['close'] - L14) / (H14 - L14)).rolling(window=k).mean()
        return K
    
    def rsi(series, n=14):
        delta = series.diff(1)
        gain = delta.where(delta > 0, 0)
        loss = -delta.where(delta < 0, 0)
        avg_gain = gain.rolling(window=n).mean()
        avg_loss = loss.rolling(window=n).mean()
        rs = avg_gain / avg_loss
        return 100 - (100 / (1 + rs))
    
    stoch_k = stoch_oscillator(df)
    rsi_value = rsi(df['close'])
    heuristics_matrix = (stoch_k + rsi_value) / 2
    return heuristics_matrix
