def heuristics_v2(df):
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    df['EMA_20'] = df['close'].ewm(span=20, adjust=False).mean()
    vwap_5 = (df['close']*df['volume']).rolling(window=5).sum() / df['volume'].rolling(window=5).sum()
    df['Volume_Ratio'] = df['volume'] / df['volume'].rolling(window=60).mean()
    
    heuristics_matrix = (df['SMA_10'] * 0.3 + df['EMA_20'] * 0.5 + vwap_5 * 0.2) * df['Volume_Ratio']
    return heuristics_matrix
