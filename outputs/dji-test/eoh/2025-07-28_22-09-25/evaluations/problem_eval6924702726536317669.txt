def heuristics_v2(df):
    ewma_20 = df['close'].ewm(span=20).mean()
    ewma_100 = df['close'].ewm(span=100).mean()
    ratio_ema = ewma_20 / ewma_100
    std_dev_returns = df['close'].pct_change().rolling(window=50).std()
    avg_volume = df['volume'].rolling(window=20).mean()
    
    heuristics_matrix = ratio_ema * std_dev_returns * avg_volume
    return heuristics_matrix
