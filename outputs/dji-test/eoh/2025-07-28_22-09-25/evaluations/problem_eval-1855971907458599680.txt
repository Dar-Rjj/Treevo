def heuristics_v2(df):
    sma_close_21 = df['close'].rolling(window=21).mean()
    pct_change_sma_21 = sma_close_21.pct_change()

    # Calculate the 14-day accumulation/distribution line
    adl = (df['close'] - df['low']) - (df['high'] - df['close'])
    adl = adl / (df['high'] - df['low'])
    adl = adl * df['volume']
    adl = adl.rolling(window=14).sum()

    # Calculate the highest close over the last 50 days
    high_50 = df['close'].rolling(window=50).max()

    # Combine the factors and scale
    heuristics_matrix = (pct_change_sma_21 * 0.6 + adl * 0.4) * (df['close'] / high_50)
    return heuristics_matrix
