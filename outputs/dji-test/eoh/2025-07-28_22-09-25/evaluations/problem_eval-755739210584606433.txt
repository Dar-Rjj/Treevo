def heuristics_v2(df):
    # Calculate the 21-period Rate of Change (ROC) for the close price
    roc_close = df['close'].pct_change(periods=21)
    
    # Calculate the 21-period Average True Range (ATR)
    df['tr'] = df[['high', 'low']].diff(axis=1).abs().max(axis=1)
    atr = df['tr'].rolling(window=21).mean()
    
    # Calculate the relative strength of volume
    rs_volume = df['volume'] / atr
    
    # Calculate the relative strength of the close price compared to its 21-day average
    sma_close_21 = df['close'].rolling(window=21).mean()
    rs_price = df['close'] / sma_close_21

    # Heuristic combination: Weighted sum of ROC, relative strength of volume, and relative strength of price
    heuristics_matrix = 0.5 * roc_close + 0.3 * rs_volume + 0.2 * rs_price
    return heuristics_matrix
