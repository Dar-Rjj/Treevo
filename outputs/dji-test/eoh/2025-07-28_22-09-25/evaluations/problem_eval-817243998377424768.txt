def heuristics_v2(df):
    pos_changes = (df['close'].diff() > 0).astype(int) * df['close'].diff()
    neg_changes = (df['close'].diff() < 0).astype(int) * df['close'].diff().abs()
    cumsum_20_pos = pos_changes.rolling(window=20).sum()
    cumsum_50_neg = neg_changes.rolling(window=50).sum()
    heuristics_matrix = cumsum_20_pos - cumsum_50_neg
    return heuristics_matrix
