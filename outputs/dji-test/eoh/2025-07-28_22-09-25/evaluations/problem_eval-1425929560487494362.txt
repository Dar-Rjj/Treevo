def heuristics_v2(df):
    df['Return'] = df['close'].pct_change()
    ewm_std_dev = df['Return'].ewm(span=30).std()
    ema_60 = df['close'].ewm(span=60).mean()
    ema_120 = df['close'].ewm(span=120).mean()
    momentum = ema_60 - ema_120
    volume_ratio = df['volume'] / df['volume'].rolling(window=40).mean()
    
    heuristics_matrix = (ewm_std_dev * 0.5 + momentum * 0.5) * volume_ratio
    return heuristics_matrix
