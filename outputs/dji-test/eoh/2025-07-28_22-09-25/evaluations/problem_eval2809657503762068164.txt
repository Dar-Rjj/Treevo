import pandas as pd

def heuristics_v2(df):
    def chande_momentum_oscillator(series, window=20):
        gain = series.diff(1).clip(lower=0).rolling(window=window).sum()
        loss = series.diff(1).clip(upper=0).abs().rolling(window=window).sum()
        cmo = ((gain - loss) / (gain + loss)).fillna(0)
        return cmo
    
    cmo_20 = chande_momentum_oscillator(df['close'])
    std_40 = df['close'].rolling(window=40).std()
    heuristics_matrix = cmo_20 - std_40
    return heuristics_matrix
