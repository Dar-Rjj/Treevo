def heuristics_v2(df):
    df['Return'] = df['close'].pct_change()
    ewm_std_dev = df['Return'].ewm(span=20).std()
    ema_50 = df['close'].ewm(span=50).mean()
    ema_100 = df['close'].ewm(span=100).mean()
    momentum = ema_50 - ema_100
    volume_ratio = df['volume'] / df['volume'].rolling(window=50).mean()
    
    heuristics_matrix = (ewm_std_dev * 0.5 + momentum * 0.5) * volume_ratio
    return heuristics_matrix
