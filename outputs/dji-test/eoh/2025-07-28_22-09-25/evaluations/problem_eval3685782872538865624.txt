def heuristics_v2(df):
    df['Return'] = df['close'].pct_change()
    std_dev = df['Return'].rolling(window=20).std()
    sma_100 = df['close'].rolling(window=100).mean()
    momentum = df['close'] - sma_100
    volume_ratio = df['volume'] / df['volume'].rolling(window=50).mean()
    
    heuristics_matrix = (std_dev * 0.5 + momentum * 0.5) * volume_ratio
    return heuristics_matrix
