def heuristics_v2(df):
    # Compute the Simple Moving Average (SMA) of closing prices over a 10-day window
    df['SMA_10'] = df['close'].rolling(window=10).mean()
    
    # Determine the Rate of Change (ROC) of closing prices over a 20-day period
    df['ROC_20'] = df['close'].pct_change(periods=20)
    
    # Identify if the close price is above its 30-day high, indicating a potential breakout
    df['Above_30_High'] = df['close'] > df['high'].rolling(window=30).max()
    
    # Check if the close price is below its 60-day low, suggesting a breakdown
    df['Below_60_Low'] = df['close'] < df['low'].rolling(window=60).min()
    
    # Evaluate if today's volume exceeds the 50-day moving average volume, signaling increased trading activity
    df['Volume_Above_MA50'] = df['volume'] > df['volume'].rolling(window=50).mean()
    
    # Measure the percentage increase in volume from the previous day to today, capturing sudden interest spikes
    df['Volume_Change'] = df['volume'].pct_change()
    
    # Calculate the Average True Range (ATR) over a 14-day period to gauge market volatility
    df['TR'] = df[['high', 'low', 'close']].join(pd.Series(df['high'] - df['low'], name='HL')).join(pd.Series(abs(df['high'] - df['close'].shift(1)), name='HC')).join(pd.Series(abs(df['low'] - df['close'].shift(1)), name='LC')).max(axis=1)
    df['ATR_14'] = df['TR'].rolling(window=14).mean()
    
    # Find the standard deviation of the daily returns over the last 30 days as a measure of risk
    df['Daily_Returns'] = df['close'].pct_change()
    df['Std_30'] = df['Daily_Returns'].rolling(window=30).std()
    
    # Detect Bearish Engulfing patterns by checking if the current close is below the previous open and the current open is above the previous close
    df['Bearish_Engulfing'] = (df['close'] < df['open'].shift(-1)) & (df['open'] > df['close'].shift(-1))
    
    # Look for Bullish Engulfing signals where the current close is above the previous open and the current open is below the previous close
    df['Bullish_Engulfing'] = (df['close'] > df['open'].shift(-1)) & (df['open'] < df['close'].shift(-1))
    
    # Create the alpha factor using a weighted sum of the sub-thoughts
    df['Alpha_Factor'] = (
        df['ROC_20'] +
        df['Above_30_High'].astype(int) * 2 -
        df['Below_60_Low'].astype(int) * 2 +
        df['Volume_Above_MA50'].astype(int) * 2 +
        df['Volume_Change'] +
        1 / df['ATR_14'] * 2 -
        df['Std_30'] * 2 +
        df['Bullish_Engulfing'].astype(int) * 2 -
        df['Bearish_Engulfing'].astype(int) * 2
    )
    
    return df['Alpha_Factor']