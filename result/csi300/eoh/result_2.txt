def heuristics_v2(df):
    # Calculate the 10-period moving average
    ma_10 = df['close'].rolling(window=10).mean()
    
    # Distance of close price from its 10-period moving average
    dist_from_ma10 = df['close'] - ma_10
    
    # Calculate the Stochastic Oscillator
    highest_high = df['high'].rolling(window=14).max()
    lowest_low = df['low'].rolling(window=14).min()
    k_line = 100 * ((df['close'] - lowest_low) / (highest_high - lowest_low))
    
    # Calculate the rate of change (ROC) of 'volume'
    roc_volume = df['volume'].pct_change(periods=10).fillna(0)
    
    # Determine dynamic weights based on the distance from MA10
    weight_k = 1 / (1 + abs(dist_from_ma10.fillna(0)))
    weight_roc = 1 - weight_k
    
    # Compute the heuristic factor
    heuristics_matrix = (k_line * weight_k) + (roc_volume * weight_roc)
    
    return heuristics_matrix