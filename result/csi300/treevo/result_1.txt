def heuristics_v2(df, lookback_period=20, long_term_lookback=60, short_term_lookback=10, adjustment_factor=1.5):
    '''
    change
    factors.notna() & returns.notna() & np.isfinite(factors) & np.isfinite(returns)
    to
    factors.notna() & returns.notna()
    '''
    # Calculate Intraday Return
    df['intraday_return'] = (df['close'] - df['open']) / df['open']
    
    # Integrate Volume into Intraday Return
    df['volume_adjusted_intraday_return'] = df['intraday_return'] * df['volume']
    
    # Enhance Volatility Correction
    df['close_return'] = df['close'].pct_change()
    price_volatility = df['close_return'].rolling(window=lookback_period).std()
    volume_volatility = df['volume'].pct_change().rolling(window=lookback_period).std()
    
    df['corrected_intraday_momentum'] = (
        df['volume_adjusted_intraday_return'] 
        - price_volatility 
        - volume_volatility
    )
    
    # Incorporate Trend Adjustment
    long_term_trend = df['close'].rolling(window=long_term_lookback).mean()
    short_term_trend = df['close'].rolling(window=short_term_lookback).mean()
    trend_difference = long_term_trend - short_term_trend
    
    # Adjust the corrected intraday momentum factor based on the trend difference
    adjusted_factor = np.where(trend_difference > 0, adjustment_factor, -adjustment_factor)
    df['adjusted_corrected_intraday_momentum'] = df['corrected_intraday_momentum'] * adjusted_factor
    
    return df['adjusted_corrected_intraday_momentum']