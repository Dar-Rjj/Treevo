    # Calculate Simple Moving Average (SMA) of Close prices over the last 20 days
    sma = df['close'].rolling(window=20).mean()
    
    # Calculate the latest close price
    latest_close = df['close'].iloc[-1]
    
    # Subtract the latest close price from the SMA
    momentum = sma - latest_close
    
    # Calculate average volume over 20 days
    avg_volume = df['volume'].rolling(window=20).mean()
    
    # Calculate average high-low range over 20 days
    avg_high_low_range = (df['high'] - df['low']).rolling(window=20).mean()
    
    # Combine volume and price volatility
    combined_weight = avg_volume * avg_high_low_range
    
    # Weight the momentum factor by the combined weight
    weighted_momentum = momentum * combined_weight
    
    return weighted_momentum