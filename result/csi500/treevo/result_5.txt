def heuristics_v2(df):
    # Calculate Intraday Range
    intraday_range = df['high'] - df['low']
    
    # Adjust by Volume Change and Price Level
    volume_change = df['volume'] / df['volume'].shift(1)
    price_level_ratio = df['close'] / df['open']
    adjusted_range = intraday_range * volume_change * price_level_ratio
    
    # Integrate Intraday Price Movement
    adjusted_intraday_price_movement = (df['high'] - df['low']) / (df['open'] - df['open'].shift(1))
    close_difference = df['close'] - df['close'].shift(1)
    weighted_intraday_price_movement = adjusted_intraday_price_movement * (df['volume'] * close_difference)
    
    # IntradayMomentumScore
    intraday_momentum_score = intraday_range * volume_change
    
    # 5-Day Average High-Low Spread
    high_low_spread_5_day_avg = (df['high'] - df['low']).rolling(window=5).mean()
    
    # 5-Day Momentum
    five_day_momentum = (df['close'] - df['close'].shift(5)) / df['close'].shift(5)
    high_low_spread_momentum = high_low_spread_5_day_avg * five_day_momentum
    
    # IntegratedMomentumFactor
    integrated_momentum_factor = intraday_momentum_score + high_low_spread_momentum
    
    # Close-to-Open Reversal Signal
    reversal_signal = (df['close'] - df['open']) / df['open']
    
    # Construct Weighted Intraday Return and Reversal Signal
    weighted_intraday_return = df['amount'] * adjusted_intraday_price_movement
    weighted_reversal_signal = df['volume'] * reversal_signal
    combined_weighted_signal = weighted_intraday_return + weighted_reversal_signal
    
    # Volume Trend
    volume_5_day_sum = df['volume'].rolling(window=5).sum()
    volume_ratio = df['volume'] / volume_5_day_sum
    volume_trend_adjusted_factor = combined_weighted_signal * volume_ratio
    
    # Final Factor Calculation
    final_factor = (
        0.2 * adjusted_range +
        0.3 * five_day_momentum +
        0.2 * integrated_momentum_factor +
        0.1 * volume_trend_adjusted_factor +
        0.2 * combined_weighted_signal
    )
    
    return final_factor